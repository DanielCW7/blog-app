"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[911],{32932:function(e,t,n){let i,r,l;n.d(t,{$rW:function(){return y5},Ahg:function(){return kL},BoV:function(){return cn},C8M:function(){return UL},Cnp:function(){return he},Cw0:function(){return hL},Dab:function(){return Ui},Dqo:function(){return Uu},Dr7:function(){return fT},E6V:function(){return q3},EZo:function(){return fS},EyJ:function(){return bV},F2f:function(){return U_},FMn:function(){return uP},GWp:function(){return UY},H7Z:function(){return xw},HD0:function(){return cx},H__:function(){return Uw},Hdz:function(){return Vh},IIC:function(){return gZ},INm:function(){return Nt},I_y:function(){return q6},LMB:function(){return Uv},LPT:function(){return p6},LZ8:function(){return ch},L_b:function(){return f0},Lky:function(){return Ic},MUX:function(){return ct},NEx:function(){return qY},NuZ:function(){return cp},P08:function(){return Ur},PtK:function(){return gA},Q3k:function(){return RH},QMc:function(){return gx},RgL:function(){return cc},SV0:function(){return u_},Sis:function(){return UJ},UMU:function(){return Vk},Uy$:function(){return cg},YG6:function(){return p1},YtX:function(){return UP},Z7x:function(){return function e(t,n){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];if(n(t,i)){if("array"===t.type){"unchanged"!==t.action&&t.items.forEach(t=>{var r;let l="object"===t.diff.type&&(null==(r=t.diff.toValue)?void 0:r._key),a=l?{_key:l}:void 0===t.toIndex?t.fromIndex||0:t.toIndex;e(t.diff,n,i.concat(a))});return}if("object"===t.type){"unchanged"!==t.action&&Object.keys(t.fields).forEach(r=>{e(t.fields[r],n,i.concat(r))});return}"string"===t.type&&"unchanged"!==t.action&&t.segments.forEach(t=>{e(t,n,i)})}}},ZCh:function(){return UV},ZDM:function(){return hD},_2T:function(){return fW},a3k:function(){return Ni},aFb:function(){return No},ap5:function(){return Uk},cFj:function(){return Io},cWh:function(){return Id},clL:function(){return UG},d9t:function(){return q2},duV:function(){return uC},e8h:function(){return ug},eLL:function(){return fJ},ek8:function(){return ci},euX:function(){return yl},fm0:function(){return mR},hHf:function(){return Vv},iZE:function(){return UC},iav:function(){return q4},jbM:function(){return ua},jr5:function(){return ht},kJL:function(){return cm},kNp:function(){return b5},kqP:function(){return mT},kwM:function(){return bF},l$t:function(){return cH},lRb:function(){return m$},m85:function(){return qJ},mEJ:function(){return yg},mPO:function(){return cj},mbX:function(){return hV},nhK:function(){return Nl},nqf:function(){return RW},nuD:function(){return q7},oUE:function(){return uU},ogX:function(){return fL},pt$:function(){return function e(t,n,i){var r;if(0===n.length)return{...t||{},value:i};let[l,...a]=n,o=(0,lX.Fd)(l)?l._key:String(l),s=null!=(r=null==t?void 0:t.children)?r:{};return{value:null==t?void 0:t.value,children:{...s,[o]:e(s[o]||{},a,i)}}}},qGk:function(){return b6},quP:function(){return yt},qyu:function(){return cs},r8Q:function(){return v5},rq_:function(){return Uj},t2O:function(){return Vf},vSY:function(){return Vj},vsM:function(){return cd},vwM:function(){return UD},xJ:function(){return Ns},xMr:function(){return p8},z1O:function(){return q0},zEW:function(){return Ne}});var a,o,s,d,c,u,p,h,f,m,g,x,v,b,y,j,w,k,C,_,S,T,E,P,A,O,z,M,I,R,F,D,Z,L,q,N,V,U,B,K,H,W,$,X,G,Y,J,Q,ee,et,en,ei,er,el,ea,eo,es,ed,ec,eu,ep,eh,ef,em,eg,ex,ev,eb,ey,ej,ew,ek,eC,e_,eS,eT,eE,eP,eA,eO,ez,eM,eI,eR,eF,eD,eZ,eL,eq,eN,eV,eU,eB,eK,eH,eW,e$,eX,eG,eY,eJ,eQ,e0,e1,e2,e3,e4,e5,e6,e8,e9,e7,te,tt,tn,ti,tr,tl,ta,to,ts,td,tc,tu,tp,th,tf,tm,tg,tx,tv,tb,ty,tj,tw,tk,tC,t_,tS,tT,tE,tP,tA,tO,tz,tM,tI,tR,tF,tD,tZ,tL,tq,tN,tV,tU,tB,tK,tH,tW,t$,tX,tG,tY,tJ,tQ,t0,t1,t2,t3,t4,t5,t6,t8,t9,t7,ne,nt,nn,ni,nr,nl,na,no,ns,nd,nc,nu,np,nh,nf,nm,ng,nx,nv,nb,ny,nj,nw,nk,nC,n_,nS,nT,nE,nP,nA,nO,nz,nM,nI,nR,nF,nD,nZ,nL,nq,nN,nV,nU,nB,nK,nH,nW,n$,nX,nG,nY,nJ,nQ,n0,n1,n2,n3,n4,n5,n6,n8,n9,n7,ie,it,ii,ir,il,ia,io,is,id,ic,iu,ip,ih,im,ig,ix,iv,ib,iy,ij,iw,ik,iC,i_,iS,iT,iE,iP,iA,iO,iz,iM,iI,iR,iF,iD,iZ,iL,iq,iN,iV,iU,iB,iK,iH,iW,i$,iX,iG,iY,iJ,iQ,i0,i1,i2,i3,i4,i5,i6,i8,i9,i7,re,rt,rn,ri,rr,rl,ra,ro,rs,rd,rc,ru,rp,rh,rf,rm,rg,rx,rv,rb,ry,rj,rw,rk,rC,r_,rS,rT,rE,rP,rA,rO,rz,rM,rI,rR,rF,rD,rZ,rL,rq,rN,rV,rU,rB,rK,rH,rW,r$,rX,rG,rY,rJ,rQ,r0,r1,r2,r3,r4,r5,r6,r8,r9,r7,le,lt,ln,li,lr,ll,la,lo,ls,ld,lc,lu,lp,lh,lf,lm,lg,lx,lv,lb,ly,lj,lw,lk,lC,l_,lS,lT,lE,lP,lA,lO,lz,lM,lI,lR,lF,lD,lZ,lL,lq,lN,lV,lU,lB,lK,lH,lW,l$,lX=n(42930),lG=n(85893),lY=n(66996),lJ=n(67294),lQ=n(69590),l0=n.n(lQ),l1=n(23279),l2=n.n(l1),l3=n(47252),l4=n(11636),l5=n(28440),l6=n(32817),l8=n(69243),l9=n(22401),l7=n(82649),ae=n(23071),at=n(19917),an=n(83610),ai=n(6222),ar=n(9653),al=n(19293),aa=n(1545),ao=n(40564),as=n(40052),ad=n(9141),ac=n(82976),au=n(86515),ap=n(37991),ah=n(36861),af=n(30743),am=n(42006),ag=n(29127),ax=n(53741),av=n(79878),ab=n(34978),ay=n(56542),aj=n(94975),aw=n(68515),ak=n(98430),aC=n(48902),a_=n(83505),aS=n(74727),aT=n(5014),aE=n(44367),aP=n(30062),aA=n(46297),aO=n(77270),az=n(65583),aM=n(51313),aI=n(91458),aR=n(92574),aF=n(93833),aD=n(47753),aZ=n(40148),aL=n(30218),aq=n(63428),aN=n(71932),aV=n(56890),aU=n(9132),aB=n(25631),aK=n(42965),aH=n(48848),aW=n(58550),a$=n(58796),aX=n(18446),aG=n.n(aX),aY=n(58354),aJ=n(23493),aQ=n.n(aJ),a0=n(68458),a1=n(89734),a2=n.n(a1),a3=n(1014),a4=n(60754),a5=n(38993),a6=n.n(a5),a8=n(40168),a9=n(933),a7=n(7254),oe=n(94184),ot=n.n(oe),on=n(98235),oi=n(59864),or=n(55379),ol=n(79668),oa=n(88306),oo=n.n(oa),os=n(21827),od=n(47037),oc=n.n(od),ou=n(18029),op=n.n(ou),oh=n(35706),of=n(42076),om=n(30222),og=n(50361),ox=n.n(og),ov=n(27361),ob=n.n(ov),oy=n(42298),oj=n(85564),ow=n.n(oj),ok=n(45578),oC=n.n(ok),o_=n(73955),oS=n.n(o_),oT=n(43703),oE=n(86298),oP=n(8230),oA=n(77349),oO=n(13956),oz=n(3151),oM=n(49160),oI=n(34176),oR=n(16218),oF=n(11640),oD=n(44749),oZ=n(4543),oL=n(37042),oq=n(23855),oN=n(39159),oV=n(61436),oU=n(42699),oB=n(313),oK=n(92311),oH=n(83894),oW=n(69119),o$=n(80567),oX=n(46038),oG=n(28366),oY=n(18717),oJ=n(55250),oQ=n(57278),o0=n(31397),o1=n(69295),o2=n(29383),o3=n(76972),o4=n(69690),o5=n(11699),o6=n(3982),o8=n(6803),o9=n.n(o8),o7=n(81548),se=n(39693),st=n.n(se),sn=n(25325),si=n.n(sn),sr=n(24350),sl=n.n(sr),sa=n(43174),so=n.n(sa),ss=n(7334),sd=n.n(ss),sc=n(93386),su=n.n(sc),sp=n(44908),sh=n.n(sp),sf=n(58748),sm=n.n(sf),sg=n(59242),sx=n.n(sg),sv=n(92742),sb=n.n(sv),sy=n(25934),sj=n(57557),sw=n.n(sj),sk=n(75472),sC=n.n(sk),s_=n(17723),sS=n(98434),sT=n(57122),sE=n(60814),sP=n(4527),sA=n(76566),sO=n.n(sA),sz=n(40288),sM=n(7739),sI=n.n(sM),sR=n(76590),sF=n(17423),sD=n(45587),sZ=n(60887),sL=n(24285),sq=n(32339),sN=n(99119),sV=n(68630),sU=n.n(sV),sB=n(48403),sK=n.n(sB),sH=n(26642),sW=n.n(sH),s$=n(90634),sX=n.n(s$),sG=n(13311),sY=n.n(sG),sJ=n(96026),sQ=n.n(sJ),s0=n(989),s1=n.n(s0),s2=n(91966),s3=n.n(s2),s4=n(84596),s5=n.n(s4),s6=n(78718),s8=n.n(s6),s9=n(63706),s7=n.n(s9),de=n(6557),dt=n.n(de),dn=n(52628),di=n.n(dn),dr=n(28092),dl=n(85092),da=n(34167),ds=n(80979),dd=n(76356),dc=n(75175),du=n(31103),dp=n(53416),dh=n(95534),df=n.n(dh),dm=n(45933),dg=n.n(dm),dx=n(54087),dv=n.n(dx),db=n(83508),dy=n(18156),dj=n(41609),dw=n.n(dj),dk=n(9095),dC=n(18612),d_=n.n(dC),dS=n(6979),dT=n.n(dS),dE=n(36155),dP=n.n(dE),dA=n(45950),dO=n.n(dA),dz=n(96412),dM=n.n(dz),dI=n(4979),dR=n.n(dI),dF=n(55648),dD=n(3522),dZ=n.n(dD);n(20745);var dL=n(38063),dq=n(21137),dN=n(97762),dV=n(12023),dU=n(51526),dB=n(11700),dK=n.n(dB),dH=n(13218),dW=n.n(dH),d$=n(30998),dX=n.n(d$),dG=n(66678),dY=n.n(dG);function dJ(e){return"function"==typeof e?e():e}let dQ=()=>void 0,d0=!1,d1=e=>{d0||console.warn(Error('No context provided for reporter. Make sure that the component calling "useReporter('.concat(e,', ...)", is wrapped in a <Tracker> element'))),d0=!0},d2={add:d1,update:d1,remove:d1,subscribe:()=>(d0||console.warn(Error('No context provided for reporter. Make sure that the component calling "useReportedValues()", is wrapped inside a <Tracker> element')),d0=!0,()=>{}),read:function(){return d0||console.warn(Error('No context provided for reporter. Make sure that the component calling "useReportedValues()", is wrapped inside a <Tracker> element')),d0=!0,[]}},d3=0,d4=()=>++d3;function d5(){let e=lJ.createContext(d2),t=function(t,n){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Object.is,{add:r,update:l,remove:a}=lJ.useContext(e),o=lJ.useRef();lJ.useLayoutEffect(()=>{if(null===t)return dQ;let e=dJ(n);return r(t,e),o.current=e,()=>{a(t)}},[r,t,a,n]),lJ.useLayoutEffect(()=>{let e=dJ(n);void 0===o.current||i(o.current,e)||null===t||l(t,e),o.current=e})};return{Tracker:function(t){let n=lJ.useMemo(()=>(function(){let e=new Map,{publish:t,subscribe:n}=(0,l3.Z)(),i=l2()(t,10,{trailing:!0}),r=()=>Array.from(e.entries());return{add:function(t,n){e.has(t),e.set(t,n),i(r())},remove:function(t){e.has(t),e.delete(t),i(r())},update:function(t,n){e.has(t),e.set(t,n),i(r())},read:r,subscribe:n}})(),[]);return(0,lG.jsx)(e.Provider,{value:n,children:t.children})},useReportedValues:function(){let t=lJ.useContext(e),[n,i]=lJ.useState(t.read());return lJ.useLayoutEffect(()=>(i(t.read()),t.subscribe(i)),[t]),n},useReporter:t,useAutoIdReporter:function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Object.is;return t("element-".concat(lJ.useRef(d4()).current),e,n)}}}let d6=d5(),d8=d6.Tracker,d9=d6.useReportedValues,d7=d6.useReporter,ce=(0,lJ.createContext)({isReviewChangesOpen:!1,onOpenReviewChanges:()=>void 0,onSetFocus:()=>void 0}),ct=e=>{let t=lJ.useRef(null),{onSetFocus:n}=lJ.useContext(ce),[i,r]=lJ.useState(!1),l=lJ.useCallback(()=>{r(!0)},[]),a=lJ.useCallback(()=>{r(!1)},[]);d7("change-".concat(lY.BB(e.path)),()=>({element:t.current,path:e.path,isChanged:!0,hasFocus:!1,hasHover:i,hasRevertHover:e.hasHover}),l0());let o=(0,lJ.useCallback)(t=>{var i;i=e.path,t.stopPropagation(),n(i)},[n,e.path]);return(0,lG.jsx)("div",{ref:t,onClick:o,onMouseLeave:a,onMouseEnter:l,children:e.children})};function cn(e){let t=(0,lJ.useRef)(e);return aG()(t.current,e)||(t.current=e),t.current}function ci(e,t){let n=[t,!0],i={type:"tuple",tuple:n};return function(t){let r=cn(t),l=(0,l5.m2)(()=>(0,l6.of)(r).pipe((0,ab.w)(t=>(0,l8.z)((0,l6.of)({type:"loading"}),e(t).pipe((0,ag.U)(e=>({type:"value",value:e}))))),(0,ay.R)((e,t)=>{let[n]=e;return"loading"===t.type?[n,!0]:[t.value,!1]},n),(0,ax.x)((e,t)=>{let[n,i]=e,[r,l]=t;return n===r&&i===l}),(0,ag.U)(e=>({type:"tuple",tuple:e})),(0,av.K)(e=>(0,l6.of)({type:"error",error:e}))),[r],i);if("error"===l.type)throw l.error;return l.tuple}}function cr(e){return null!=e}let cl="".concat("drafts",".");function ca(e){return e.startsWith(cl)}function co(e){return{draftId:cs(e),publishedId:cd(e)}}function cs(e){return ca(e)?e:cl+e}function cd(e){return ca(e)?e.slice(cl.length):e}function cc(e){return Array.from(e.reduce((e,t)=>{let n=cd(t._id),i=e.get(n);return i||(i={id:n,type:t._type,published:void 0,draft:void 0},e.set(n,i)),i[n===t._id?"published":"draft"]=t,e},new Map).values())}function cu(e){return cc(e).map(e=>e.draft||e.published).filter(cr)}let cp=Object.freeze({}),ch=Object.freeze([]),cf=function(){if("undefined"!=typeof globalThis)return globalThis;if("undefined"!=typeof window)return window;if("undefined"!=typeof self)return self;if(void 0!==n.g)return n.g;throw Error("@sanity/ui: could not locate global scope")}();function cm(e){return Array.isArray(e)}function cg(e){return!!e&&"object"==typeof e&&!Array.isArray(e)}function cx(e){return"string"==typeof e}let cv="object"==typeof document&&"object"==typeof window&&window.ResizeObserver?window.ResizeObserver:aY.do,cb=(()=>{let e=(0,l3.Z)(),t=new cv(t=>e.publish(t));return{observe:(n,i,r)=>{let l=e.subscribe(e=>{let t=e.find(e=>e.target===n);t&&i(t)});return t.observe(n,r),()=>{l(),t.unobserve(n)}}}})(),cy=["sanity.imageAsset","sanity.fileAsset"];function cj(e){return"document"===e.type&&!("document"===e.type&&cy.includes(e.name))}let cw=["match","in","asc","desc","true","false","null"],ck=/^[a-zA-Z_][a-zA-Z0-9_]*$/,cC=e=>!ck.test(e)||cw.includes(e),c_=e=>'["'.concat(e,'"]'),cS=e=>"@".concat(c_(e)),cT=e=>Array.isArray(e)&&0===e.length,cE=e=>{let t="";for(let n=0;n<e.length;n++){let i=e[n];if(cT(i)){t+="[]";continue}if("number"==typeof i){t+="[".concat(i,"]");continue}let r=0===n;t=cC(i)?r?cS(i):"".concat(t).concat(c_(i)):r?i:"".concat(t,".").concat(i)}return t},cP="undefined"!=typeof window&&("ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0),cA={isLoading:!0,value:void 0,error:null};function cO(e,t){return(0,l5.m2)(()=>e.pipe(e=>e.pipe((0,ag.U)(e=>({isLoading:!1,value:e,error:null})),(0,av.K)(e=>(0,l6.of)({isLoading:!1,value:void 0,error:e})))),[e],void 0===t?cA:{isLoading:!1,value:t,error:null})}function cz(e,t){return null!==e&&e.roles.some(e=>e.name===t)}var cM=Object.freeze,cI=Object.defineProperty,cR=(e,t)=>cM(cI(e,"raw",{value:cM(t||e.slice())}));let cF=a0.ZP.div(e=>{let{$changed:t,$disabled:n,$isReviewChangeOpen:i}=e;return n?(0,a0.iv)(eS||(eS=cR(["\n        "," {\n          display: none;\n        }\n      "])),cZ):(0,a0.iv)(eP||(eP=cR(["\n      --change-bar-offset: 2px;\n\n      display: flex;\n      position: relative;\n\n      @media (hover: hover) {\n        &:hover {\n          z-index: 10;\n        }\n      }\n\n      /* hide when field is not changed */\n      ","\n\n      /* hide hover effect when review changes is open */\n      ","\n    "])),!t&&(0,a0.iv)(eT||(eT=cR(["\n        "," {\n          opacity: 0;\n          pointer-events: none;\n        }\n      "])),cZ),i&&(0,a0.iv)(eE||(eE=cR(["\n        "," {\n          opacity: 0;\n        }\n      "])),cq))}),cD=a0.ZP.div(eA||(eA=cR(["\n  flex-grow: 1;\n  min-width: 0;\n"]))),cZ=a0.ZP.div(eO||(eO=cR(["\n  position: relative;\n  opacity: 1;\n  transition: opacity 100ms;\n  z-index: ",";\n"])),e=>{let{$zIndex:t}=e;return t}),cL=a0.ZP.div(e=>{let{theme:t}=e,n=t.sanity.color.spot.yellow,i=t.sanity.media[0];return(0,a0.iv)(ez||(ez=cR(["\n    position: absolute;\n    top: 0;\n    left: var(--change-bar-offset);\n    width: 2px;\n    bottom: 0;\n    background-color: ",";\n    border-radius: 1px;\n\n    @media (min-width: ","px) {\n      display: unset;\n    }\n  "])),n,i)}),cq=a0.ZP.button(e=>{let{theme:t,$withHoverEffect:n}=e,i=t.sanity.color.spot.yellow;return(0,a0.iv)(eI||(eI=cR(["\n      appearance: none;\n      border: 0;\n      outline: 0;\n      display: block;\n      padding: 0;\n      background: transparent;\n      opacity: 0;\n      position: absolute;\n      height: 100%;\n      cursor: pointer;\n      pointer-events: all;\n      left: calc(-0.25rem + var(--change-bar-offset));\n      width: 1rem;\n      transition: opacity ","ms;\n\n      &:focus {\n        border: 0;\n        outline: 0;\n      }\n\n      &:after {\n        content: '';\n        width: 16px;\n        height: calc(100% + 14px);\n        display: block;\n        position: absolute;\n        top: -7px;\n        left: -3px;\n        border-radius: 8px;\n        background: ",";\n      }\n\n      &:focus {\n        border: 0;\n        outline: 0;\n      }\n\n      ","\n    "])),250,i,n&&(0,a0.iv)(eM||(eM=cR(["\n        @media (hover: hover) {\n          &:hover {\n            opacity: 0.2;\n          }\n        }\n      "]))))});function cN(e){let{children:t,disabled:n,isChanged:i,withHoverEffect:r=!0}=e,{onOpenReviewChanges:l,isReviewChangesOpen:a}=lJ.useContext(ce),{zIndex:o}=(0,l4.sJ)(),s=(0,lJ.useMemo)(()=>n||!i?null:(0,lG.jsxs)(cZ,{"data-testid":"change-bar",$zIndex:o,children:[(0,lG.jsx)(cL,{"data-testid":"change-bar__marker"}),(0,lG.jsx)(cq,{"aria-label":"Review changes","data-testid":"change-bar__button",onClick:a?void 0:l,tabIndex:-1,type:"button",$withHoverEffect:r})]}),[n,i,o,a,l,r]);return(0,lG.jsxs)(cF,{"data-testid":"change-bar-wrapper",$changed:i,$disabled:n,$isReviewChangeOpen:a,children:[(0,lG.jsx)(cD,{"data-testid":"change-bar__field-wrapper",children:t}),s]})}let cV=(0,lJ.memo)(function(e){let{children:t,disabled:n,hasFocus:i,isChanged:r,onMouseEnter:l,onMouseLeave:a,path:o=ch,withHoverEffect:s,...d}=e,c=(0,l4.sJ)(),[u,p]=(0,lJ.useState)(!1),h=(0,lJ.useCallback)(e=>{null==l||l(e),p(!0)},[l]),f=(0,lJ.useCallback)(e=>{null==a||a(e),p(!1)},[a]),m=(0,lJ.useRef)(null);return d7(n?null:"field-".concat(lY.BB(o)),()=>({element:m.current,path:o,isChanged:r,hasFocus:i,hasHover:u,zIndex:c.zIndex}),l0()),(0,lG.jsx)("div",{...d,ref:m,onMouseEnter:h,onMouseLeave:f,children:(0,lG.jsx)(cN,{isChanged:r,disabled:n,withHoverEffect:s,children:t})})});function cU(e){let{children:t,hasFocus:n,isChanged:i,path:r,withHoverEffect:l,...a}=e;return(0,lG.jsx)(cV,{...a,path:r,hasFocus:n,isChanged:i,withHoverEffect:l,children:t})}lJ.createContext({path:[],fullPath:[],focusPath:[],isChanged:!1});let cB=lJ.createContext(null),cK=()=>void 0,cH=lJ.forwardRef(function(e,t){let{as:n="div",onScroll:i,...r}=e,l=(0,l4.ts)(t),a=(0,lJ.useContext)(cB),o=(0,lJ.useMemo)(()=>(0,l3.Z)(),[]);return(0,lJ.useEffect)(()=>i?o.subscribe(i):cK,[o,i]),(0,lJ.useEffect)(()=>a?o.subscribe(a.publish):cK,[a,o]),(0,lJ.useEffect)(()=>{let e=e=>{o.publish(e)},t=l.current;if(t)return t.addEventListener("scroll",e,{passive:!0,capture:!0}),()=>{t.removeEventListener("scroll",e)}},[o,l]),(0,lG.jsx)(cB.Provider,{value:o,children:lJ.createElement(n,{ref:l,"data-testid":"scroll-container",...r})})});function cW(e){let{onScroll:t,children:n}=e;return!function(e){let t=lJ.useContext(cB);lJ.useEffect(()=>null==t?void 0:t.subscribe(e),[e,t])}(t),(0,lG.jsx)(lG.Fragment,{children:n})}function c$(e,t,n){let i;let r=t.slice(t.indexOf("-")+1)||"[]",l=lY.mL(r),a="".concat(e,"-").concat(lY.BB(l));if(n.has(a))return n.get(a);for(let[t,r]of n){if(!("path"in r)||!t.startsWith(e))continue;let n=lY.eh(l,r.path),a=r.path[r.path.length-1],o=n===r.path.length-1&&(0,lX.fU)(a);if(0!==n&&(n===r.path.length||o)&&(i=r,n===l.length))break}return i}function cX(e){let t=getComputedStyle(e).overflow;return t.includes("auto")||t.includes("scroll")}function cG(e){var t;let n=e.element;for(;!(((t=n).scrollHeight!==t.offsetHeight||t.scrollWidth!==t.offsetWidth)&&cX(t));)if(!(n=n.parentElement))return;n.scroll({top:n.scrollTop+e.rect.top-e.bounds.top+-15,left:0,behavior:"smooth"})}let cY=(e,t)=>{let n={top:0,left:0,height:t.offsetHeight,width:t.offsetWidth},i={top:0,left:0,height:e.offsetHeight,width:e.offsetWidth},r=!1,l=e;for(;l&&l!==t&&t.contains(l);)r&&(n.top+=l.offsetTop,n.left+=l.offsetLeft),cX(l)&&(n.top=l.offsetTop,n.height=l.offsetHeight,n.left=l.offsetLeft,n.width=l.offsetWidth,r=!0),i.top+=l.offsetTop-l.scrollTop,i.left+=l.offsetLeft-l.scrollLeft,l=l.offsetParent;return{rect:i,bounds:n}};function cJ(e,t,n){return["M ".concat(e-4," ").concat(t-4*n," "),"L ".concat(e," ").concat(t),"L ".concat(e+4," ").concat(t-4*n)].join("")}function cQ(e,t){return"M".concat(e," ").concat(t)}function c0(e,t){return"L".concat(e," ").concat(t)}function c1(e,t,n,i){return"Q".concat(e," ").concat(t," ").concat(n," ").concat(i)}function c2(e,t){let n=e.top+e.height/2,i=e.top+e.height<t.top+2,r=e.top>t.top+t.height-2;return{bounds:t,left:e.left,top:n,centerY:n,startY:e.top+8,endY:e.top+e.height-8,isAbove:i,isBelow:r,outOfBounds:i||r}}var c3=Object.freeze,c4=Object.defineProperty,c5=(e,t)=>c3(c4(e,"raw",{value:c3(t||e.slice())}));a0.ZP.rect(eR||(eR=c5(["\n  stroke: #ccc;\n  fill: none;\n  pointer-events: none;\n  stroke-linecap: round;\n"])));let c6=a0.ZP.path(e=>{let{theme:t}=e,n=t.sanity.color.spot.yellow;return(0,a0.iv)(eF||(eF=c5(["\n    fill: none;\n    pointer-events: none;\n    stroke-linecap: round;\n    stroke-linejoin: round;\n    stroke: ",";\n  "])),n)}),c8=a0.ZP.path(e=>{let{theme:t}=e,n=t.sanity.color.spot.yellow;return(0,a0.iv)(eD||(eD=c5(["\n    fill: none;\n    pointer-events: stroke;\n    stroke: ",";\n    cursor: pointer;\n    stroke-linecap: round;\n    stroke-linejoin: round;\n    opacity: 0;\n\n    &:hover {\n      opacity: 0.2;\n    }\n  "])),n)}),c9=(0,a0.ZP)(function(e){let{bounds:t,...n}=e,i=Math.max(t.left,e.left),r=Math.max(e.top,t.top),l=Math.max(0,e.height-(r-e.top)),a=Math.max(0,e.width-(i-e.left));return(0,lG.jsx)("rect",{...n,x:i,y:r,height:l,width:a})})(e=>{let{theme:t}=e,n=t.sanity.color.spot.yellow;return(0,a0.iv)(eZ||(eZ=c5(["\n    stroke: none;\n    pointer-events: none;\n    fill: ",";\n  "])),n)}),c7=(0,lJ.memo)(function(e){let{from:t,to:n}=e,i=function(e){let t={top:e.from.bounds.top+12,bottom:e.from.bounds.top+e.from.bounds.height-12,left:e.from.bounds.left,right:e.from.bounds.left+e.from.bounds.width,width:e.from.bounds.width,height:e.from.bounds.height-24},n=c2(e.from.rect,t);n.left=e.from.rect.left+e.from.rect.width+1;let i={top:e.to.bounds.top+12,bottom:e.to.bounds.top+e.to.bounds.height-12,left:e.to.bounds.left,right:e.to.bounds.left+e.to.bounds.width,width:e.to.bounds.width,height:e.to.bounds.height-24},r=c2(e.to.rect,i),l=Math.max(r.startY,n.startY);return n.top=Math.min(l,n.endY),n.top<i.top?n.top=Math.min(i.top,n.endY):n.top>i.bottom&&(n.top=Math.max(i.bottom,n.startY)),r.top=Math.min(l,r.endY),r.top<t.top?r.top=Math.min(t.top,r.endY):r.top>t.bottom&&(r.top=Math.max(t.bottom,r.startY)),n.top=Math.min(Math.max(n.top,t.top),t.bottom),r.top=Math.min(Math.max(r.top,i.top),i.bottom),{from:n,to:r}}({from:t,to:n});if(i.from.outOfBounds&&i.to.outOfBounds)return null;let r=function(e){let{from:t,to:n}=e,{left:i,top:r}=t,{left:l,top:a}=n,o=[],s=Math.min(4,Math.abs(r-a)/2);return t.isAbove?o.push(cQ(i+8,r-12+2),c0(i+8,r-4),c1(i+8,r,i+8+4,r)):t.isBelow?o.push(cQ(i+8,r+12-2),c0(i+8,r+4),c1(i+8,r,i+8+4,r)):o.push(cQ(i,r)),n.isAbove?r<n.bounds.top?o.push(c0(n.bounds.left-8-s,r),c1(n.bounds.left-8,r,n.bounds.left-8,r+s),c0(n.bounds.left-8,a-s),c1(n.bounds.left-8,a,n.bounds.left-8+s,a),c0(n.bounds.left+8-4,a),c1(n.bounds.left+8,a,n.bounds.left+8,a-4),c0(n.bounds.left+8,a-12+2)):o.push(c0(n.bounds.left+8-4,r),c1(n.bounds.left+8,r,n.bounds.left+8,r-4),c0(n.bounds.left+8,a-12+2)):n.isBelow?r>n.bounds.top+n.bounds.height?o.push(c0(n.bounds.left-8-s,r),c1(n.bounds.left-8,r,n.bounds.left-8,r-s),c0(n.bounds.left-8,a+s),c1(n.bounds.left-8,a,n.bounds.left-8+s,a),c0(n.bounds.left+8-4,a),c1(n.bounds.left+8,a,n.bounds.left+8,a+4),c0(n.bounds.left+8,a+12-2)):o.push(c0(n.bounds.left+8-4,r),c1(n.bounds.left+8,r,n.bounds.left+8,r+4),c0(n.bounds.left+8,a+12-2)):r<a?o.push(c0(n.bounds.left+8-s,r),c1(n.bounds.left+8,r,n.bounds.left+8,r+s),c0(n.bounds.left+8,a-s),c1(n.bounds.left+8,a,n.bounds.left+8+s,a),c0(l,a)):o.push(c0(n.bounds.left+8-s,r),c1(n.bounds.left+8,r,n.bounds.left+8,r-s),c0(n.bounds.left+8,a+s),c1(n.bounds.left+8,a,n.bounds.left+8+s,a),c0(l,a)),function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return e.join(t)}(o)}(i);return(0,lG.jsxs)(lG.Fragment,{children:[(0,lG.jsx)(c8,{d:r,strokeWidth:16}),(0,lG.jsx)(c6,{d:r,strokeWidth:2}),(0,lG.jsx)(c9,{top:n.rect.top,left:n.rect.left,height:n.rect.height,width:2,bounds:n.bounds}),i.from.isAbove&&(0,lG.jsx)(c6,{d:cJ(i.from.left+8,i.from.bounds.top-12+2,-1),strokeWidth:2}),i.from.isBelow&&(0,lG.jsx)(c6,{d:cJ(i.from.left+8,i.from.bounds.top+i.from.bounds.height+12-2,1),strokeWidth:2}),i.to.isAbove&&(0,lG.jsx)(c6,{d:cJ(i.to.bounds.left+8,i.to.bounds.top-12+2,-1),strokeWidth:2}),i.to.isBelow&&(0,lG.jsx)(c6,{d:cJ(i.to.bounds.left+8,i.to.bounds.top+i.to.bounds.height+12-2,1),strokeWidth:2}),!1]})});var ue=Object.freeze,ut=Object.defineProperty;let un=a0.ZP.svg(eL||(eL=ue(ut(a=["\n  pointer-events: none;\n  position: absolute;\n  left: 0;\n  top: 0;\n  right: 0;\n  bottom: 0;\n  width: 100%;\n  height: 100%;\n"],"raw",{value:ue(a.slice())}))));function ui(e,t,n,i){let r=[],l=[];for(let n of e){if(!("changePanel"!==n[0])||!n[1].isChanged)continue;let[e,i]=n;if(e===t||i.hasHover){r.push(n);continue}if(i.hasFocus){l.push(n);continue}}let a=r.length>0;return{connectors:(a?r:l).map(e=>{let[t]=e,i=c$("field",t,n),r=c$("change",t,n);return i&&r?{field:{id:t,...i},change:{id:t,...r}}:null}).filter(cr).map(e=>{let{field:t,change:n}=e;return{hasHover:t.hasHover||n.hasHover,hasFocus:t.hasFocus,hasRevertHover:n.hasRevertHover,field:{...t,...cY(t.element,i)},change:{...n,...cY(n.element,i)}}}),isHoverConnector:a}}function ur(e){let{rootElement:t,onSetFocus:n}=e,[i,r]=lJ.useState(null),l=d9(),a=(0,lJ.useMemo)(()=>new Map(l),[l]),[{connectors:o},s]=(0,lJ.useState)(()=>ui(l,i,a,t)),d=(0,lJ.useMemo)(()=>a2()(o,e=>0-e.field.path.length).slice(0,1),[o]),c=(0,lJ.useCallback)(()=>{s(ui(l,i,a,t))},[a,l,i,t]);return(0,lJ.useEffect)(()=>cb.observe(t,c),[t,c]),(0,lG.jsx)(cW,{onScroll:c,children:(0,lG.jsx)(un,{style:{zIndex:d[0]&&d[0].field.zIndex},children:d.map(e=>{let{field:t,change:i}=e;return i?(0,lG.jsx)(ul,{field:t,change:i,onSetFocus:n,setHovered:r},t.id):null})})})}function ul(e){let{change:t,field:n,onSetFocus:i,setHovered:r}=e,l=(0,lJ.useCallback)(()=>{cG(n),cG(t),i(n.path)},[n,t,i]),a=(0,lJ.useCallback)(()=>r(n.id),[n,r]),o=(0,lJ.useCallback)(()=>r(null),[r]),s=(0,lJ.useMemo)(()=>({rect:{left:n.rect.left+2,top:n.rect.top,height:n.rect.height,width:n.rect.width},bounds:n.bounds}),[n.bounds,n.rect]),d=(0,lJ.useMemo)(()=>({rect:t.rect,bounds:t.bounds}),[t.bounds,t.rect]);return(0,lG.jsxs)(lG.Fragment,{children:[(0,lG.jsx)("g",{onClick:l,onMouseEnter:a,onMouseLeave:o,children:(0,lG.jsx)(c7,{from:s,to:d})}),!1]})}let ua=function(e){let{children:t,className:n,isReviewChangesOpen:i,onOpenReviewChanges:r,onSetFocus:l,...a}=e,[o,s]=lJ.useState(),d=(0,lJ.useMemo)(()=>({isReviewChangesOpen:i,onOpenReviewChanges:r,onSetFocus:l}),[i,r,l]);return(0,lG.jsx)(ce.Provider,{value:d,children:(0,lG.jsx)(d8,{children:(0,lG.jsxs)(cH,{...a,ref:s,className:n,children:[t,o&&(0,lG.jsx)(ur,{rootElement:o,onSetFocus:l})]})})})};function uo(e){let{base:t,border:n,focusRing:i}=e,r=i.offset+i.width,l=0-i.offset,a=t?t.bg:"var(--card-bg-color)";return[l>0&&"inset 0 0 0 ".concat(l,"px var(--card-focus-ring-color)"),n&&"inset 0 0 0 ".concat(n.width,"px ").concat(n.color),l<0&&"0 0 0 ".concat(0-l,"px ").concat(a),r>0&&"0 0 0 ".concat(r,"px var(--card-focus-ring-color)")].filter(Boolean).join(",")}var us=Object.freeze,ud=Object.defineProperty,uc=(e,t)=>us(ud(e,"raw",{value:us(t||e.slice())}));let uu="a,button",up=a0.ZP.div(e=>{let{theme:t,offset:n}=e;return(0,a0.iv)(eq||(eq=uc(["\n    bottom: ","px;\n    border-radius: ",";\n    left: ","px;\n    pointer-events: none;\n    position: absolute;\n    right: ","px;\n    top: ","px;\n    z-index: 2;\n\n    ",":focus-visible & {\n      box-shadow: ",";\n    }\n  "])),-n,(0,l4.hO)(t.sanity.radius[1]),-n,-n,-n,uf,uo({base:t.sanity.color.base,focusRing:t.sanity.focusRing}))}),uh=a0.ZP.div(eN||(eN=uc(["\n  bottom: 0;\n  display: none;\n  left: 0;\n  position: absolute;\n  right: 0;\n  top: 0;\n  z-index: 1;\n\n  @media (hover: hover) {\n    &[data-enabled='true'] {\n      display: block;\n    }\n  }\n"]))),uf=(0,a0.ZP)(l4.xu)(eV||(eV=uc(["\n  height: 100%;\n  outline: none;\n  overflow-x: hidden;\n  overflow-y: auto;\n  overscroll-behavior: contain;\n  width: 100%;\n"]))),um=(0,a0.ZP)(l4.xu).attrs(e=>{let{$height:t}=e;return{style:{height:"".concat(t,"px")}}})(eU||(eU=uc(["\n  position: relative;\n  width: 100%;\n"]))),ug=(0,lJ.forwardRef)(function(e,t){let{activeItemDataAttr:n="data-active",ariaLabel:i,ariaMultiselectable:r=!1,autoFocus:l,canReceiveFocus:a,fixedHeight:o,focusRingOffset:s=0,getItemDisabled:d,getItemKey:c,getItemSelected:u,initialIndex:p,initialScrollAlign:h="start",inputElement:f,itemHeight:m,items:g,onEndReached:x,onEndReachedIndexOffset:v=0,onlyShowSelectionWhenActive:b,overscan:y,renderItem:j,wrapAround:w=!0,...k}=e,C=(0,lJ.useRef)(!1),_=(0,lJ.useRef)((0,lJ.useId)()),S=(0,lJ.useRef)(null!=p?p:0),[T,E]=(0,lJ.useState)(null),[P,A]=(0,lJ.useState)(!1),[O,z]=(0,lJ.useState)(null),[M,I]=(0,lJ.useState)(null),R=(0,lJ.useCallback)(e=>{if(!x)return;let[t]=[...e.getVirtualItems()].reverse();t&&t.index>=g.length-v-1&&C.current&&x()},[x,g.length,v]),F=(0,a3.MG)({count:g.length,getItemKey:c,getScrollElement:()=>M,estimateSize:()=>m,onChange:R,overscan:y}),D=(0,lJ.useMemo)(()=>{let e=-1;return g.reduce((t,n,i)=>{var r,l;let a=null!=(r=null==d?void 0:d(i))&&r,o=null!=(l=null==u?void 0:u(i))&&l;return a||(e+=1),t[i]={activeIndex:a?null:e,disabled:a,selected:o},t},[])},[d,u,g]),Z=(0,lJ.useMemo)(()=>D.filter(e=>!e.disabled).length,[D]),L=(0,lJ.useCallback)(e=>null==O?void 0:O.setAttribute("data-enabled",(!e).toString()),[O]),q=(0,lJ.useCallback)(e=>"".concat(_.current,"-item-").concat(e),[]),N=(0,lJ.useCallback)(()=>"".concat(_.current,"-children"),[]),V=(0,lJ.useCallback)(()=>{let e=[f,M].some(e=>document.activeElement===e);if(b&&!e&&!P)return;let t=Array.from((null==T?void 0:T.children)||[]);null==t||t.forEach(e=>{var t,i,r;let l=null==(i=D[Number(null==(t=e.dataset)?void 0:t.index)])?void 0:i.activeIndex;null==(r=e.querySelector(uu))||r.toggleAttribute(n,l===S.current)})},[n,null==T?void 0:T.children,P,f,D,b,M]),U=(0,lJ.useCallback)(()=>{let e=Array.from((null==T?void 0:T.children)||[]);null==e||e.forEach(e=>{var t;null==(t=e.querySelector(uu))||t.toggleAttribute(n,!1)})},[n,null==T?void 0:T.children]),B=(0,lJ.useMemo)(()=>aQ()(V,200),[V]),K=(0,lJ.useCallback)(()=>{let e=null==S?void 0:S.current;g.length>0?(null==f||f.setAttribute("aria-activedescendant",q(e)),null==M||M.setAttribute("aria-activedescendant",q(e))):(null==f||f.removeAttribute("aria-activedescendant"),null==M||M.removeAttribute("aria-activedescendant"))},[q,f,g.length,M]),H=(0,lJ.useCallback)(()=>{var e,t;let n=null==T?void 0:T.parentElement;if(T&&n){let i=n.getBoundingClientRect().top-T.getBoundingClientRect().top;return null!=(t=null==(e=F.getVirtualItemForOffset(i))?void 0:e.index)?t:-1}return -1},[T,F]),W=(0,lJ.useCallback)(e=>{let{index:t,scrollAlign:n,scrollIntoView:i=!0}=e;if(S.current=t,K(),V(),i){let e=D.findIndex(e=>e.activeIndex===t);e>-1&&F.scrollToIndex(e,n?{align:n}:{})}},[K,D,V,F]),$=(0,lJ.useCallback)(e=>{let t=-1,n=Z-1;"next"===e&&(t=S.current<Z-1?S.current+1:w?0:n),"previous"===e&&(t=S.current>0?S.current-1:w?n:0),W({index:t,scrollIntoView:!0}),L(!1)},[Z,L,W,w]),X=(0,lJ.useCallback)(e=>{switch(e){case"input":null==f||f.focus();break;case"list":null==M||M.focus()}},[f,M]),G=(0,lJ.useCallback)(()=>{null==f||f.focus()},[f]),Y=(0,lJ.useCallback)(()=>{null==M||M.focus()},[M]),J=(0,lJ.useCallback)(e=>()=>{W({index:e,scrollIntoView:!1})},[W]),Q=(0,lJ.useCallback)(()=>{V()},[V]),ee=(0,lJ.useCallback)(e=>t=>{let n=Array.from((null==T?void 0:T.children)||[]);if(n.length&&("ArrowDown"===t.key&&(t.preventDefault(),X(e),$("next")),"ArrowUp"===t.key&&(t.preventDefault(),X(e),$("previous")),"Enter"===t.key)){t.preventDefault(),X(e);let i=n.find(e=>Number(e.dataset.index)===D.findIndex(e=>e.activeIndex===S.current));if(i){let e=null==i?void 0:i.querySelector(uu);null==e||e.click()}}},[null==T?void 0:T.children,X,D,$]),et=(0,lJ.useCallback)(e=>ee("input")(e),[ee]),en=(0,lJ.useCallback)(e=>ee("list")(e),[ee]),ei=(0,lJ.useCallback)(()=>{b&&(V(),A(!0))},[b,V]),er=(0,lJ.useCallback)(()=>{b&&(U(),A(!1))},[U,b]);(0,lJ.useImperativeHandle)(t,()=>({focusInputElement(){G()},focusListElement(){Y()},getTopIndex:()=>H(),scrollToIndex(e){W({index:e}),L(!0)}}),[L,G,Y,H,W]),(0,lJ.useEffect)(()=>{void 0===p||C.current||W({index:p,scrollAlign:h,scrollIntoView:!0}),C.current=!0},[p,h,b,W]),(0,lJ.useEffect)(()=>{function e(){L(!0)}return null==M||M.addEventListener("mousemove",e),null==M||M.addEventListener("wheel",e,{passive:!0}),()=>{null==M||M.removeEventListener("mousemove",e),null==M||M.removeEventListener("wheel",e)}},[L,M]),(0,lJ.useEffect)(()=>(null==f||f.addEventListener("focus",Q),null==f||f.addEventListener("keydown",et),null==M||M.addEventListener("focus",Q),null==M||M.addEventListener("keydown",en),()=>{null==f||f.removeEventListener("focus",Q),null==f||f.removeEventListener("keydown",et),null==M||M.removeEventListener("focus",Q),null==M||M.removeEventListener("keydown",en)}),[a,Q,ee,et,en,U,f,V,M]),(0,lJ.useEffect)(()=>{K()},[K,g]),(0,lJ.useEffect)(()=>{let e=new MutationObserver(B);return T&&e.observe(T,{childList:!0,subtree:!0}),()=>{e.disconnect()}},[T,B]),(0,lJ.useEffect)(()=>{null==f||f.setAttribute("aria-autocomplete","list"),null==f||f.setAttribute("aria-expanded","true"),null==f||f.setAttribute("aria-controls",N()),null==f||f.setAttribute("role","combobox")},[N,f]),(0,lJ.useEffect)(()=>{l&&X(l)},[l,a,Y,G,X]);let el=a?0:-1;return(0,lG.jsxs)(uf,{id:N(),onMouseEnter:ei,onMouseLeave:er,ref:I,sizing:"border",tabIndex:el,...k,children:[a&&(0,lG.jsx)(up,{offset:s}),(0,lG.jsx)(uh,{"aria-hidden":"true","data-enabled":!0,ref:z}),F&&(0,lG.jsx)(um,{forwardedAs:"ul",$height:F.getTotalSize(),"aria-label":i,"aria-multiselectable":r,flex:1,ref:E,role:"listbox",children:F.getVirtualItems().map(e=>{let t=e.index,{activeIndex:n,disabled:i,selected:l}=D[t],a=j(g[t],{activeIndex:n,disabled:i,selected:l,virtualIndex:t}),s=(0,lJ.cloneElement)(a,{tabIndex:-1}),d="number"!=typeof n||i?{}:{"aria-posinset":n+1,...r?{"aria-selected":l.toString()}:{},"aria-setsize":Z,id:q(n),role:"option",onMouseEnter:J(n)};return(0,lG.jsx)(l4.Kq,{as:"li","data-index":t,ref:o?void 0:F.measureElement,style:{flex:1,...o?{height:"".concat(e.size,"px")}:{},left:0,position:"absolute",top:0,transform:"translateY(".concat(e.start,"px)"),width:"100%"},tabIndex:-1,...d,children:s},e.key)})})]})}),ux=new WeakMap,uv=0;function ub(e){let t=ux.get(e);if(t)return t;let n="".concat(e.name||e.displayName||"<anonymous>","-").concat(uv++);return ux.set(e,n),n}let uy=(0,lJ.memo)(function(e){let{hook:t,args:n,id:i,onNext:r,onReset:l,onRequestUpdate:a}=e,o=t({...n,onComplete:()=>{l(i)}});return(0,lJ.useEffect)(()=>(r(i,o),a(),()=>{r(i,null),a()}),function(e){let t=(0,lJ.useRef)(void 0);return a6()(e,t.current)||(t.current=e),[t.current]}(o)),null},(e,t)=>e.args===t.args),uj="undefined"==typeof requestIdleCallback?e=>{let t=Date.now();return setTimeout(()=>{e({didTimeout:!1,timeRemaining:()=>Math.max(0,Date.now()-t)})},1)}:requestIdleCallback,uw="undefined"==typeof cancelIdleCallback?e=>clearTimeout(e):cancelIdleCallback,uk={trailing:!0};function uC(e){var t;let{hooks:n,args:i,children:r,onReset:l}=e,a=(0,lJ.useRef)({}),[o,s]=(0,lJ.useState)(0),[d,c]=(0,lJ.useState)({}),u=(0,lJ.useRef)(null),p=(t=(0,lJ.useCallback)(()=>{u.current&&uw(u.current),u.current=uj(()=>{u.current=null,s(e=>e+1)})},[]),(0,lJ.useMemo)(()=>aQ()(t,60,uk),[t,uk,60])),h=(0,lJ.useCallback)((e,t)=>{if(null===t)delete a.current[e];else{let n=a.current[e];a.current[e]={...n,value:t}}},[]),f=(0,lJ.useCallback)(e=>{c(t=>({...t,[e]:(t[e]||0)+1})),l&&l()},[l]),m=(0,lJ.useMemo)(()=>n.map(e=>ub(e)),[n]),g=(0,lJ.useMemo)(()=>m.map(e=>{var t;return null==(t=a.current[e])?void 0:t.value}).filter(cr),[m,o]);return(0,lG.jsxs)(lG.Fragment,{children:[n.map(e=>{let t=ub(e),n=d[t]||0;return(0,lG.jsx)(uy,{hook:e,id:t,args:i,onNext:h,onRequestUpdate:p,onReset:f},"".concat(t,"-").concat(n))}),r({states:g})]})}function u_(e){let{makePlatformAware:t=!0,keys:n=[],...i}=e,r=t?n.map(uT):n;return(0,lG.jsx)(l4.p8,{...i,keys:r})}let uS="undefined"!=typeof navigator&&"string"==typeof navigator.platform&&/Mac|iPod|iPhone|iPad/.test(navigator.platform||"");function uT(e){let t=e.toLowerCase();return"alt"===t&&uS?uE(e,"option"):"option"!==t||uS?e:uE(e,"alt")}function uE(e,t){let n=e.length;return t.replace(/./g,(t,i)=>i<n&&e[i]===e[i].toUpperCase()?t.toUpperCase():t)}function uP(e){var t,n;let{currentUser:i,title:r="Insufficient permissions",operationLabel:l="access this feature"}=e,a=(null==i?void 0:i.roles)||[],o=1!==a.length;return(0,lG.jsxs)(l4.xu,{padding:2,children:[(0,lG.jsxs)(l4.gF,{space:2,children:[(0,lG.jsx)(l4.xv,{size:1,children:(0,lG.jsx)(a8.vaB,{})}),(0,lG.jsx)(l4.xv,{weight:"semibold",children:r})]}),(0,lG.jsx)(l4.gF,{marginTop:4,children:(0,lG.jsx)(l4.xv,{size:1,children:0===a.length?(0,lG.jsxs)(lG.Fragment,{children:["You have no role that grants you permission to ",l]}):(0,lG.jsxs)(lG.Fragment,{children:["Your role",o&&"s"," ",(t=a.map(e=>(0,lG.jsx)("code",{children:e.title},e.name)),n=(0,lG.jsx)(lG.Fragment,{children:", "}),t.reduce((e,t)=>null===e?[t]:[...e,n,t],null))," ","do",o||"es"," not have permissions to ",l]})})})]})}let uA=(0,a0.ZP)(l4.W2)(e=>{let{theme:t}=e,{container:n,media:i}=t.sanity;return(0,l4.Lt)(i,e.$width,e=>({width:"auto"===e?"none":(0,l4.hO)(n[e]),maxWidth:"100%"}))}),uO=lJ.forwardRef(function(e,t){let{width:n,...i}=e,r=(0,l4.Q5)(n);return(0,lG.jsx)(uA,{...i,"data-ui":"PopoverContainer",$width:r,ref:t})});var uz=Object.freeze,uM=Object.defineProperty,uI=(e,t)=>uz(uM(e,"raw",{value:uz(t||e.slice())}));let uR=(0,a0.ZP)(l4.J2)(()=>(0,a0.iv)(eB||(eB=uI(["\n    // Make the popover scrollable if it overflows the viewport\n    [data-ui='Popover__wrapper'] {\n      overflow: auto;\n    }\n  "])))),uF=(0,a0.ZP)(l4.mh)(e=>{let t=e.theme.sanity.radius[3];return(0,a0.iv)(eK||(eK=uI(["\n    position: sticky;\n    top: 0;\n    width: 100%;\n    background: var(--card-bg-color);\n    border-bottom: 1px solid var(--card-border-color);\n    border-top-left-radius: ","px;\n    border-top-right-radius: ","px;\n  "])),t,t)});function uD(e){let{children:t,header:n,onClose:i,referenceElement:r,containerRef:l,width:a}=e,o=(0,lJ.useCallback)(()=>{i(),null==r||r.focus()},[i,r]),s=(0,lG.jsx)(uO,{width:a,children:(0,lG.jsx)(a7.ZP,{autoFocus:!0,children:(0,lG.jsxs)(l4.Kq,{ref:l,children:[(0,lG.jsx)(uF,{children:(0,lG.jsx)(l4.xu,{padding:2,paddingLeft:3,children:(0,lG.jsxs)(l4.kC,{align:"center",gap:2,children:[(0,lG.jsx)(l4.xu,{flex:1,children:(0,lG.jsx)(l4.xv,{textOverflow:"ellipsis",weight:"semibold",children:n})}),(0,lG.jsx)(l4.zx,{icon:a8.Two,mode:"bleed",onClick:o})]})})}),t]})})});return(0,lG.jsx)(uR,{portal:!0,constrainSize:!0,content:s,open:!0,referenceElement:r})}var uZ=Object.freeze,uL=Object.defineProperty,uq=(e,t)=>uZ(uL(e,"raw",{value:uZ(t||e.slice())}));let uN=(0,a0.ZP)(l4.Zb)(()=>(0,a0.iv)(eH||(eH=uq(["\n    /* this is a hack to avoid layout jumps while previews are loading\n    there's probably better ways of solving this */\n    min-height: 35px;\n\n    /* TextWithTone uses its own logic to set color, and we therefore need */\n    /* to override this logic in order to set the correct color in different states */\n    &[data-selected],\n    &[data-pressed],\n    &:active {\n      [data-ui='TextWithTone'] {\n        color: inherit;\n      }\n    }\n  "])))),uV=(0,lJ.createContext)({selected:!1}),uU=(0,lJ.forwardRef)(function(e,t){let{children:n,selected:i,as:r,...l}=e;return(0,lG.jsx)(uN,{"data-ui":"PreviewCard",...l,forwardedAs:r,ref:t,selected:i,children:(0,lG.jsx)(uV.Provider,{value:{selected:i},children:n})})}),uB={block:{width:33,height:33},blockImage:{width:600,height:400},default:{width:35,height:35},detail:{width:75,height:75},inline:{width:15,height:15},media:{width:160,height:160}},uK={block:31,blockImage:45,default:33,detail:45,inline:15,media:45};var uH=Object.freeze,uW=Object.defineProperty,u$=(e,t)=>uH(uW(e,"raw",{value:uH(t||e.slice())}));let uX=a0.ZP.span(e=>{let{$dimensions:t,$layout:n,$radius:i,$responsive:r}=e,l=t.width||0,a=t.width||0,o=uK[n];return(0,a0.iv)(eW||(eW=u$(["\n    position: relative;\n    width: ",";\n    height: ",";\n    min-width: ",";\n    border-radius: ",";\n    display: flex;\n    overflow: hidden;\n    overflow: clip;\n    align-items: center;\n    justify-content: center;\n\n    & img {\n      position: absolute;\n      left: 0;\n      top: 0;\n      width: 100%;\n      height: 100%;\n      object-fit: contain;\n      border-radius: inherit;\n    }\n\n    & svg {\n      display: block;\n      flex: 1;\n      font-size: calc(21 / 16 * 1em);\n    }\n\n    & [data-sanity-icon] {\n      display: block;\n      font-size: calc(",' / 16 * 1em);\n    }\n\n    /*\n      NOTE on why we can’t use the ":after" pseudo-element:\n      The thing is we only want the shadow when then <MediaWrapper> contains\n      something else than <svg> – icons should not have the shadow.\n      This is why we use the "*:not(svg) + span" selector to target only that\n      situation to render the shadow.\n    */\n    & *:not(svg) + span {\n      display: block;\n      position: absolute;\n      left: 0;\n      top: 0;\n      right: 0;\n      bottom: 0;\n      box-shadow: inset 0 0 0 1px var(--card-fg-color);\n      opacity: 0.2;\n      border-radius: inherit;\n    }\n  '])),r?"100%":(0,l4.hO)(l),r?"100%":(0,l4.hO)(a),r?void 0:(0,l4.hO)(l),e=>{let{theme:t}=e;return(0,l4.hO)(t.sanity.radius[i])},o)});function uG(e){let{border:t=!0,dimensions:n,layout:i,media:r,radius:l=1,responsive:a=!1,styles:o}=e;return(0,lG.jsxs)(uX,{$dimensions:n,$layout:i,$radius:l,$responsive:a,className:null==o?void 0:o.media,"data-testid":"Media",children:[function(e){let{dimensions:t,layout:n,media:i,styles:r}=e;return(0,oi.isValidElementType)(i)?(0,lJ.createElement)(i,{dimensions:t,layout:n}):"string"==typeof i?(0,lG.jsx)(l4.xv,{as:"span",className:null==r?void 0:r.mediaString,children:i}):(0,lJ.isValidElement)(i)?i:null}({dimensions:n,layout:i,media:r}),t&&(0,lG.jsx)("span",{})]})}function uY(e,t,n){return"string"==typeof e?e:(0,oi.isValidElementType)(e)?(0,lJ.createElement)(e,{layout:t}):e||n}uX.displayName="MediaWrapper";var uJ=Object.freeze,uQ=Object.defineProperty,u0=(e,t)=>uJ(uQ(e,"raw",{value:uJ(t||e.slice())}));let u1={...uB.default,aspect:1,fit:"crop",dpr:(0,on.x)()},u2=(0,a0.ZP)(l4.kC)(e$||(e$=u0(["\n  height: ",";\n"])),(0,l4.hO)(uB.default.height)),u3=(0,a0.ZP)(l4.Qr).attrs({animated:!0,radius:1})(eX||(eX=u0(["\n  max-width: ",";\n  width: 80%;\n"])),(0,l4.hO)(160)),u4=(0,a0.ZP)(l4.Qr).attrs({animated:!0,radius:1,size:1})(eG||(eG=u0(["\n  max-width: ",";\n  width: 60%;\n"])),(0,l4.hO)(120));function u5(e){let{title:t,subtitle:n,media:i,status:r,isPlaceholder:l,children:a,styles:o}=e,s=ot()(null==o?void 0:o.root,!!n&&(null==o?void 0:o.hasSubtitle)),d=r&&(0,lG.jsx)(l4.xu,{className:null==o?void 0:o.status,"data-testid":"default-preview__status",paddingLeft:3,paddingRight:1,children:uY(r,"default")});return l?(0,lG.jsxs)(u2,{align:"center",className:null==o?void 0:o.placeholder,"data-testid":"default-preview",children:[!1!==i&&(0,lG.jsx)(l4.Od,{animated:!0,marginRight:2,radius:2,style:uB.default}),(0,lG.jsxs)(l4.Kq,{"data-testid":"default-preview__heading",flex:1,paddingLeft:!1===i?1:2,paddingRight:r?0:1,space:2,children:[(0,lG.jsx)(u3,{}),(0,lG.jsx)(u4,{})]}),d]}):(0,lG.jsxs)(u2,{align:"center",className:s,"data-testid":"default-preview",children:[!1!==i&&void 0!==i&&(0,lG.jsx)(uG,{dimensions:u1,layout:"default",media:i,styles:o}),(0,lG.jsxs)(l4.Kq,{className:null==o?void 0:o.heading,"data-testid":"default-preview__header",flex:1,paddingLeft:i?2:1,paddingRight:r?0:1,space:2,children:[(0,lG.jsxs)(l4.xv,{className:null==o?void 0:o.title,style:{color:"inherit"},textOverflow:"ellipsis",children:[t&&uY(t,"default"),!t&&(0,lG.jsx)("span",{style:{color:"var(--card-muted-fg-color)"},children:"Untitled"})]}),n&&(0,lG.jsx)(l4.xv,{muted:!0,size:1,textOverflow:"ellipsis",className:null==o?void 0:o.subtitle,children:uY(n,"default")}),a&&(0,lG.jsx)("div",{className:null==o?void 0:o.children,children:a})]}),d]})}var u6=Object.freeze,u8=Object.defineProperty,u9=(e,t)=>u6(u8(e,"raw",{value:u6(t||e.slice())}));let u7=(0,a0.ZP)(l4.kC).attrs({align:"center"})(eY||(eY=u9(["\n  height: ",";\n"])),(0,l4.hO)(uB.detail.height)),pe=(0,a0.ZP)(l4.xu)(eJ||(eJ=u9(["\n  white-space: nowrap;\n"]))),pt=(0,a0.ZP)(l4.Od).attrs({animated:!0,radius:2})(eQ||(eQ=u9(["\n  width: ",";\n  height: ",";\n"])),(0,l4.hO)(uB.detail.width),(0,l4.hO)(uB.detail.height)),pn=(0,a0.ZP)(l4.Qr).attrs({animated:!0,radius:1})(e0||(e0=u9(["\n  max-width: ","; /* 80% of 200px */\n  width: 80%;\n"])),(0,l4.hO)(160)),pi=(0,a0.ZP)(l4.Qr).attrs({animated:!0,radius:1,size:1})(e1||(e1=u9(["\n  max-width: ","; /* 60% of 200px */\n  width: 60%;\n"])),(0,l4.hO)(120)),pr=(0,a0.ZP)(l4.Qr).attrs({animated:!0,radius:1,size:1})(e2||(e2=u9(["\n  max-width: ","; /* 90% of 200px */\n  width: 90%;\n"])),(0,l4.hO)(180)),pl=(0,a0.ZP)(l4.xv)(e=>{let{theme:t}=e,{fonts:n}=t.sanity,i=2*n.text.sizes[1].lineHeight;return(0,a0.iv)(e3||(e3=u9(["\n    & > span {\n      max-height: ",";\n\n      /* Multi-line text overflow */\n      display: -webkit-box;\n      overflow: hidden;\n      overflow: clip;\n      text-overflow: ellipsis;\n      -webkit-line-clamp: ",";\n      -webkit-box-orient: vertical;\n    }\n  "])),(0,l4.hO)(i),2)}),pa={...uB.detail,fit:"crop",aspect:1,dpr:(0,on.x)()};var po=Object.freeze,ps=Object.defineProperty,pd=(e,t)=>po(ps(e,"raw",{value:po(t||e.slice())}));let pc=a0.ZP.svg(e4||(e4=pd(["\n  width: ","px;\n  height: ","px;\n  transform: rotate(-90deg);\n"])),43,43),pu=a0.ZP.circle(e=>{let{theme:t}=e,{color:n}=t.sanity;return(0,a0.iv)(e5||(e5=pd(["\n    fill: none;\n    stroke: ",";\n    stroke-width: ","px;\n  "])),or.VG.gray[n.dark?900:100].hex,3)}),pp=a0.ZP.circle(e=>{let{theme:t}=e,{color:n}=t.sanity;return(0,a0.iv)(e6||(e6=pd(["\n    fill: none;\n    stroke: ",";\n    stroke-width: ","px;\n    transition: stroke-dashoffset 75ms;\n  "])),or.VG.blue[n.dark?400:500].hex,3)});function ph(e){let{value:t}=e,n=2*Math.PI*20,i=(100-Math.min(Math.max(t,0),100))/100*n,r="".concat(21.5," ").concat(21.5," ").concat(43," ").concat(43);return(0,lG.jsxs)(pc,{viewBox:r,children:[(0,lG.jsx)(pu,{cx:43,cy:43,r:20}),(0,lG.jsx)(pp,{cx:43,cy:43,r:20,style:{strokeDasharray:n,strokeDashoffset:"".concat(i,"px")}})]})}var pf=Object.freeze,pm=Object.defineProperty,pg=(e,t)=>pf(pm(e,"raw",{value:pf(t||e.slice())}));let px=(0,a0.ZP)(l4.Zb)(e8||(e8=pg(["\n  overflow: hidden;\n  overflow: clip;\n"]))),pv=(0,a0.ZP)(l4.Zb)(e=>{let{theme:t}=e,{color:n}=t.sanity;return(0,a0.iv)(e9||(e9=pg(["\n    height: ","rem;\n    background: ",";\n    transition: transform 75ms;\n  "])),.5,or.VG.blue[n.dark?400:500].hex)});function pb(e){let{value:t}=e;return(0,lG.jsx)(px,{radius:5,children:(0,lG.jsx)(pv,{radius:5,style:{transform:"translate3d(".concat(t-100,"%, 0, 0)")}})})}var py=Object.freeze,pj=Object.defineProperty,pw=(e,t)=>py(pj(e,"raw",{value:py(t||e.slice())}));let pk=(0,a0.ZP)(l4.xu)(e7||(e7=pw(["\n  position: relative;\n"]))),pC=(0,a0.ZP)(l4.kC).attrs({align:"center",justify:"center"})(te||(te=pw(["\n  position: absolute;\n  left: 0;\n  top: 0;\n  right: 0;\n  bottom: 0;\n"]))),p_=(0,a0.ZP)(l4.Od).attrs({animated:!0,radius:2})(tt||(tt=pw(["\n  width: 100%;\n  height: 100%;\n"]))),pS=(0,a0.ZP)(l4.kC).attrs({align:"center",justify:"center"})(tn||(tn=pw(["\n  position: absolute;\n  left: 0;\n  top: 0;\n  right: 0;\n  bottom: 0;\n\n  &:before {\n    background-color: var(--card-bg-color);\n    opacity: 0.75;\n    content: '';\n    display: block;\n    position: absolute;\n    left: 0;\n    top: 0;\n    right: 0;\n    bottom: 0;\n  }\n\n  > svg {\n    position: relative;\n    z-index: 2;\n  }\n"]))),pT=(0,a0.ZP)(l4.Kq).attrs({padding:2,space:2})(ti||(ti=pw(["\n  max-width: ",";\n"])),(0,l4.hO)(200)),pE={...uB.media,aspect:1,fit:"crop",dpr:(0,on.x)()};var pP=Object.freeze,pA=Object.defineProperty,pO=(e,t)=>pP(pA(e,"raw",{value:pP(t||e.slice())}));let pz=(0,a0.ZP)(l4.kC).attrs({align:"center"})(tr||(tr=pO(["\n  box-shadow: 0 0 0 1px var(--card-border-color);\n  height: ",";\n  white-space: nowrap;\n  position: relative;\n  z-index: 1;\n"])),(0,l4.hO)(uB.block.height)),pM=(0,a0.ZP)(l4.Zb)(tl||(tl=pO(["\n  position: relative;\n  padding-bottom: ","%;\n\n  & > span {\n    position: absolute;\n    top: 0;\n    left: 0;\n    right: 0;\n    bottom: 0;\n  }\n"])),e=>{let{$ratio:t}=e;return t}),pI=(0,a0.ZP)(l4.xu).attrs({overflow:"hidden"})(ta||(ta=pO(["\n  border-radius: ","px;\n"])),e=>{let{theme:t}=e;return t.sanity.radius[1]}),pR={...uB.blockImage,fit:"fillmax",dpr:(0,on.x)()},pF=e=>{let{height:t,width:n}=e;return t&&n?t/n*100:1};var pD=Object.freeze,pZ=Object.defineProperty;let pL={...uB.block,aspect:1,fit:"crop",dpr:(0,on.x)()},pq=(0,a0.ZP)(l4.kC).attrs({align:"center"})(to||(to=pD(pZ(o=["\n  min-height: ",";\n"],"raw",{value:pD(o.slice())}))),(0,l4.hO)(uB.block.height));var pN=Object.freeze,pV=Object.defineProperty,pU=(e,t)=>pN(pV(e,"raw",{value:pN(t||e.slice())}));let pB=a0.ZP.span(ts||(ts=pU(["\n  display: inline-flex;\n  align-items: center;\n  vertical-align: top;\n  height: calc(1em - 1px);\n  max-width: 100%;\n"]))),pK=a0.ZP.span(td||(td=pU(["\n  position: relative;\n  display: inline-block;\n  width: calc(1em - 1px);\n  height: calc(1em - 1px);\n  min-width: calc(1em - 1px);\n\n  & img {\n    position: absolute;\n    top: 0;\n    left: 0;\n    width: 100%;\n    height: 100%;\n    object-fit: cover;\n    border-radius: ",";\n  }\n\n  & img + span {\n    position: absolute;\n    left: 0;\n    top: 0;\n    right: 0;\n    bottom: 0;\n    box-shadow: inset 0 0 0 1px var(--card-fg-color);\n    opacity: 0.2;\n    border-radius: ",";\n  }\n\n  & svg {\n    display: block;\n    font-size: calc(14 / 16 * 1em);\n    margin: 1px 0;\n\n    &[data-sanity-icon] {\n      font-size: calc(18 / 16 * 1em);\n      margin: calc(1px + (2 / 18 * -1em)) 0;\n    }\n  }\n"])),e=>{let{theme:t}=e;return(0,l4.hO)(t.sanity.radius[1])},e=>{let{theme:t}=e;return(0,l4.hO)(t.sanity.radius[1])}),pH=(0,a0.ZP)(l4.xv).attrs({forwardedAs:"span"})(e=>{let{theme:t}=e,n=t.sanity.fonts.text,i=n.sizes[1];return(0,a0.iv)(tc||(tc=pU(["\n    font-size: calc("," / 16 * 1em);\n    font-weight: ",";\n    box-sizing: border-box;\n    display: inline-block;\n    vertical-align: top;\n    line-height: ",";\n    padding-left: 0.5em;\n    padding-right: calc(0.5em - 2px);\n    min-width: 0;\n\n    & > span {\n      display: block;\n      white-space: nowrap;\n      text-overflow: ellipsis;\n      overflow: hidden;\n      overflow: clip;\n    }\n  "])),i.fontSize,n.weights.medium,i.lineHeight/i.fontSize)}),pW={...uB.inline,fit:"crop",aspect:1,dpr:(0,on.x)()};var p$=Object.freeze,pX=Object.defineProperty,pG=(e,t)=>p$(pX(e,"raw",{value:p$(t||e.slice())}));uB.default,(0,on.x)(),(0,a0.ZP)(l4.xu)(tu||(tu=pG(["\n  height: 100%;\n\n  a {\n    color: currentColor;\n    text-decoration: none;\n  }\n\n  svg[data-sanity-icon] {\n    margin: 0;\n  }\n"]))),(0,a0.ZP)(l4.kC).attrs({align:"center"})(tp||(tp=pG(["\n  height: ",";\n"])),(0,l4.hO)(uB.default.height)),(0,a0.ZP)(l4.Qr).attrs({animated:!0,radius:1})(th||(th=pG(["\n  max-width: ",";\n  width: 80%;\n"])),(0,l4.hO)(160)),(0,a0.ZP)(l4.Qr).attrs({animated:!0,radius:1,size:1})(tf||(tf=pG(["\n  max-width: ",";\n  width: 60%;\n"])),(0,l4.hO)(120));let pY=["aria-hidden","disabled","href"];function pJ(e){let{direction:t="horizontal",initialFocus:n,loop:i=!0,navigation:r=["arrows"],pause:l=!1,rootElement:a}=e,[o,s]=(0,lJ.useState)(-1),[d,c]=(0,lJ.useState)([]),u=d.length,p=u-1,h="horizontal"===t?"ArrowRight":"ArrowDown",f="horizontal"===t?"ArrowLeft":"ArrowUp",m=(0,lJ.useCallback)(()=>{a&&c([...a.querySelectorAll('a[href], button, input, textarea, select, details, [tabindex]:not([tabindex="-1"])')].filter(e=>!e.hasAttribute("disabled")&&"true"!==e.getAttribute("aria-hidden")))},[a]),g=(0,lJ.useCallback)(e=>{s(e)},[]),x=(0,lJ.useCallback)(e=>{if(l)return;let t=()=>{e.preventDefault(),s(e=>{let t=(e+p)%u;return i||t!==p?t:e})},n=()=>{e.preventDefault(),s(e=>{let t=(e+1)%u;return i||0!==t?t:e})};"Tab"===e.key&&r.includes("tab")&&(e.shiftKey?t():n()),r.includes("arrows")&&(e.key===f&&t(),e.key===h&&n())},[l,f,r,h,p,u,i]);(0,lJ.useEffect)(()=>{m()},[m,n,t]),(0,lJ.useEffect)(()=>{let e=new MutationObserver(m);return a&&e.observe(a,{childList:!0,subtree:!0,attributeFilter:pY}),()=>{e.disconnect()}},[d,m,a]),(0,lJ.useEffect)(()=>{var e;d.forEach((e,t)=>{t===o?(e.setAttribute("tabIndex","0"),e.setAttribute("aria-selected","true"),e.focus(),e.onfocus=()=>g(t),e.onblur=()=>g(-1)):(e.setAttribute("tabIndex","-1"),e.setAttribute("aria-selected","false"),e.onfocus=()=>g(t))}),-1===o&&d&&(null==(e=d["last"===n?p:0])||e.setAttribute("tabIndex","0"))},[d,o,g,n,p]),(0,lJ.useEffect)(()=>(null==a||a.addEventListener("keydown",x),()=>{null==a||a.removeEventListener("keydown",x)}),[x,a])}let pQ=(0,a0.ZP)(l4.xu)({position:"relative"}),p0=a0.ZP.div({position:"absolute",top:-4,right:-4,width:6,height:6,borderRadius:3,boxShadow:"0 0 0 1px var(--card-bg-color)"}),p1=(0,lJ.forwardRef)(function(e,t){let{disabled:n,fontSize:i,hotkey:r,icon:l,label:a,mode:o="bleed",space:s=3,text:d,tone:c,tooltip:u,...p}=e,h=(0,l4.Fg)(),f=c&&h.sanity.color.solid[c],m=(0,lJ.useMemo)(()=>({backgroundColor:null==f?void 0:f.enabled.bg}),[f]),g="object"==typeof n?(0,lG.jsx)(l4.xv,{size:1,children:n.reason}):(0,lG.jsxs)(l4.kC,{align:"center",gap:2,style:{lineHeight:0},children:[(0,lG.jsx)(l4.xv,{size:1,children:a}),r&&(0,lG.jsx)(u_,{fontSize:0,keys:r,style:{margin:-4}})]});return(0,lG.jsx)(l4.u,{padding:2,placement:"bottom",...u,content:g,disabled:!a,portal:!0,children:(0,lG.jsx)("div",{children:(0,lG.jsx)(l4.zx,{"data-ui":"StatusButton",...p,"aria-label":a,disabled:!!n,mode:o,ref:t,children:(0,lG.jsxs)(l4.kC,{gap:s,children:[(0,lG.jsxs)(pQ,{children:[(0,lG.jsxs)(l4.xv,{size:i,children:[(0,lJ.isValidElement)(l)&&l,(0,oi.isValidElementType)(l)&&(0,lJ.createElement)(l)]}),c&&(0,lG.jsx)(p0,{style:m})]}),d&&(0,lG.jsx)(l4.xu,{flex:1,children:(0,lG.jsx)(l4.xv,{size:i,children:d})})]})})})})});var p2=Object.freeze,p3=Object.defineProperty,p4=(e,t)=>p2(p3(e,"raw",{value:p2(t||e.slice())}));let p5=(0,a0.ZP)(l4.xv)(e=>{let{$tone:t,theme:n}=e,i=n.sanity.color.muted[t];return(0,a0.iv)(tm||(tm=p4(["\n    &:not([data-muted]) {\n      --card-fg-color: ",";\n    }\n\n    &[data-dimmed] {\n      opacity: 0.3;\n    }\n  "])),i?i.enabled.fg:void 0)}),p6=lJ.forwardRef(function(e,t){let{tone:n,dimmed:i,muted:r,...l}=e;return(0,lG.jsx)(p5,{"data-ui":"TextWithTone","data-dimmed":i?"":void 0,"data-muted":r?"":void 0,$tone:n,muted:r,ref:t,...l})}),p8=(0,lJ.forwardRef)(function(e,t){let{children:n,content:i,disabled:r,...l}=e;return(0,lG.jsx)(l4.u,{...l,content:i,disabled:r||!i,padding:2,ref:t,children:(0,lG.jsx)("div",{children:n})})}),p9=(0,lJ.forwardRef)((e,t)=>{let{push:n}=(0,l4.pm)();return(0,lJ.useImperativeHandle)(t,()=>({push:n})),null});p9.displayName="ImperativeToast";let p7=(0,lJ.createContext)({navbar:200,navbarPopover:5e5,navbarDialog:500001,pane:100,paneHeader:[110,15e3],paneFooter:[120,2e4],paneResizer:[130,25e3],popover:200,modal:200,movingItem:1e4,drawershade:1e6,drawer:1000001,fullscreen:12e5,toast:[100,11e3],portal:200,dropdown:200,navbarFixed:1010,fullscreenEdit:1050,popoverBackground:1060,tooltip:200,modalBackground:2e3,spinner:3e3});function he(){return(0,lJ.useContext)(p7)}function ht(e){let{children:t,zOffset:n}=e,i=he()[n];return(0,lG.jsx)(l4.li,{zOffset:i,children:t})}let hn=(0,lJ.createContext)(null);function hi(e){let{children:t}=e,n=(0,lJ.useMemo)(()=>{let e=new Map,t={};return{get:n=>{let{namespace:i,dependencies:r}=n,l=r.map(e=>null===e?t:e),a=e.get(i);return null==a?void 0:a.get(l)},set:n=>{let{namespace:i,dependencies:r,value:l}=n,a=e.get(i)||function(){let e=new WeakMap,t=new WeakMap;function n(e){return Array.from(new Set(e)).map(e=>[function(e){let n=t.get(e);if(n)return n;let i=Array.from({length:10}).map(()=>Math.floor(255*Math.random()).toString(16).padStart(2,"0")).join("");return t.set(e,i),i}(e),e]).sort((e,t)=>{let[n]=e,[i]=t;return n.localeCompare(i,"en")}).map(e=>{let[,t]=e;return t})}return{get:function(t){return function e(t,n){if(!t.length)return;let[i,...r]=t,l=n.get(i);if(l)return r.length?e(r,l.next):l.value}(n(t),e)},set:function(t,i){!function e(t,n,i){if(!t.length)return;let[r,...l]=t,a=n.get(r)||{type:"multi-key-weak-map-node",value:void 0,next:new WeakMap};if(n.set(r,a),!l.length){a.value=i;return}e(l,a.next,i)}(n(t),e,i)}}}(),o=r.map(e=>null===e?t:e);e.set(i,a),a.set(o,l)}}},[]);return(0,lG.jsx)(hn.Provider,{value:n,children:t})}function hr(){let e=(0,lJ.useContext)(hn);if(!e)throw Error("Could not find `cache` context");return e}class hl extends Error{constructor(e){let{projectId:t}=e;super("CorsOriginError"),this.projectId=t}}let ha=(()=>{let e="__tmp_supports_local_storage";try{if("undefined"==typeof localStorage)return!1;return localStorage.setItem(e,"---"),localStorage.removeItem(e),!0}catch(e){return!1}})(),ho={};function hs(e,t){ha?localStorage[e]=t:ho[e]=t}function hd(e){ha?localStorage.removeItem(e):delete ho[e]}let hc=/sid=([^&]{20,})&?/,hu=function(){if("undefined"==typeof window||"object"!=typeof window.location)return null;let e=window.location.hash,[,t]=e.match(hc)||[];if(!t)return null;let n=e.replace(hc,""),i=new URL(window.location.href);return i.hash=n.length>1?n:"",history.replaceState(null,"",i),t}(),hp=()=>{let e=hu;return e&&(hu=null),e};var hh=Object.freeze,hf=Object.defineProperty,hm=(e,t)=>hh(hf(e,"raw",{value:hh(t||e.slice())}));let hg=a0.ZP.svg(e=>{let{theme:t}=e,{fg:n}=t.sanity.color.base;return(0,a0.iv)(tg||(tg=hm(["\n    fill: ",";\n  "])),n)}),hx=a0.ZP.img(tx||(tx=hm(["\n  height: 19px;\n  width: 19px;\n  object-fit: contain;\n"])));function hv(e){let{provider:t}=e;return t.logo?(0,lG.jsx)(hx,{src:t.logo,alt:"Logo for ".concat(t.name)}):void 0}let hb={google:()=>(0,lG.jsxs)("svg",{width:"1em",height:"1em",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 48 48",children:[(0,lG.jsx)("path",{d:"M11 24a13 13 0 0 1 .66-4.08l-7.4-5.66a22.18 22.18 0 0 0 0 19.49l7.4-5.67A13 13 0 0 1 11 24z",fill:"#fbbc05"}),(0,lG.jsx)("path",{d:"M24 11a12.72 12.72 0 0 1 8.1 2.9l6.4-6.4a22 22 0 0 0-34.24 6.75l7.4 5.66A13 13 0 0 1 24 11z",fill:"#ea4335"}),(0,lG.jsx)("path",{d:"M24 37a13 13 0 0 1-12.34-8.92l-7.4 5.66A21.93 21.93 0 0 0 24 46a21 21 0 0 0 14.33-5.48l-7-5.44A13.59 13.59 0 0 1 24 37zm-12.35-8.93l-7.4 5.67 7.4-5.66z",fill:"#34a853"}),(0,lG.jsx)("path",{d:"M44.5 20H24v8.5h11.8a9.91 9.91 0 0 1-4.49 6.58l7 5.44C42.37 36.76 45 31.17 45 24a18.25 18.25 0 0 0-.5-4z",fill:"#4285f4"})]}),github:()=>(0,lG.jsx)(hg,{width:"1em",height:"1em",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 438.55 438.55",children:(0,lG.jsx)("path",{d:"M409.13 114.57a218.32 218.32 0 0 0-79.8-79.8Q278.94 5.36 219.27 5.36T109.21 34.77a218.29 218.29 0 0 0-79.8 79.8Q0 165 0 224.63q0 71.67 41.83 128.91t108.06 79.23q7.71 1.43 11.42-2a11.17 11.17 0 0 0 3.69-8.57q0-.86-.14-15.42t-.14-25.41l-6.57 1.14a83.77 83.77 0 0 1-15.85 1 120.73 120.73 0 0 1-19.84-2 44.34 44.34 0 0 1-19.11-8.51 36.23 36.23 0 0 1-12.56-17.6l-2.86-6.57a71.34 71.34 0 0 0-9-14.56q-6.14-8-12.42-10.85l-2-1.43a21 21 0 0 1-3.71-3.43 15.66 15.66 0 0 1-2.57-4q-.86-2 1.43-3.29C61.2 310.42 64 310 68 310l5.71.85q5.71 1.14 14.13 6.85a46.08 46.08 0 0 1 13.85 14.84q6.57 11.71 15.85 17.85t18.7 6.14a81.19 81.19 0 0 0 16.27-1.42 56.78 56.78 0 0 0 12.85-4.29q2.57-19.14 14-29.41a195.49 195.49 0 0 1-29.36-5.13 116.52 116.52 0 0 1-26.83-11.14 76.86 76.86 0 0 1-23-19.13q-9.14-11.42-15-30t-5.8-42.81q0-34.55 22.56-58.82-10.57-26 2-58.24 8.28-2.57 24.55 3.85t23.84 11q7.57 4.56 12.13 7.71a206.2 206.2 0 0 1 109.64 0l10.85-6.85a153.65 153.65 0 0 1 26.26-12.56q15.13-5.71 23.13-3.14 12.84 32.26 2.28 58.24 22.55 24.27 22.56 58.82 0 24.27-5.85 43t-15.12 30a79.82 79.82 0 0 1-23.13 19 116.74 116.74 0 0 1-26.84 11.14 195.29 195.29 0 0 1-29.23 5.07q14.8 12.84 14.81 40.58v60.2a11.37 11.37 0 0 0 3.57 8.56q3.57 3.42 11.28 2 66.24-22 108.07-79.23t41.83-128.91q-.03-59.62-29.43-110.05z"})})};async function hy(e){let{client:t,mode:n,providers:i=[]}=e;if("replace"===n&&Array.isArray(i))return i;let{providers:r}=await t.request({uri:"/auth/providers"});return"function"==typeof i?i(r):0===i.length?r:"replace"===n?i:r.filter(e=>i.some(t=>t.url!==e.url)).concat(i)}function hj(e){let{loginMethod:t="dual",projectId:n,url:i,basePath:r}=e,l=new URLSearchParams;return l.set("origin","".concat(window.location.origin).concat(r)),l.set("projectId",n),"token"===t?l.set("withSid","true"):l.set("type",t),"".concat(i,"?").concat(l)}let hw=e=>{if(!e)throw Error("Invalid project id");return"__studio_auth_token_".concat(e)},hk=e=>{try{var t;let n=(t=hw(e),ha?localStorage[t]:ho[t]);if(n){let{token:e}=JSON.parse(n);if(e&&"string"==typeof e)return e}}catch(e){console.error(e)}return null},hC=e=>{try{hd(hw(e))}catch(e){console.error(e)}},h_=e=>{let{token:t,projectId:n}=e;try{hs(hw(n),JSON.stringify({token:t,time:new Date().toISOString()}))}catch(e){console.error(e)}},hS=async(e,t)=>{var n;try{let t=await e.request({uri:"/users/me",withCredentials:!0,tag:"users.get-current"});return"string"==typeof(null==t?void 0:t.id)?t:null}catch(i){if(401===i.statusCode)return hC(e.config().projectId||""),t(null),null;if(await e.request({uri:"/ping",withCredentials:!1,tag:"cors-check"}).then(()=>!0,()=>!1))throw new hl({projectId:null==(n=e.config())?void 0:n.projectId});if(i.isNetworkError&&!i.message&&i.request&&i.request.url){let e=new URL(i.request.url).host;throw Error("Unknown network error attempting to reach ".concat(e))}throw i}},hT=oo()(function(e){let{clientFactory:t,projectId:n,dataset:i,apiHost:r,loginMethod:l="dual",...a}=e,{broadcast:o,messages:s}=function(e){let t="undefined"==typeof window?(0,l6.of)():(0,l9.R)(window,"storage"),n="__studio_local_storage_messaging_".concat(e),i=new l7.x;return{messages:(0,ae.T)(i,t.pipe((0,aj.h)(e=>e.key===n),(0,ag.U)(e=>e.newValue),(0,aj.h)(cr),(0,ag.U)(e=>JSON.parse(e)))).pipe((0,aw.d)(1)),broadcast:function(e){try{hs(n,JSON.stringify(e)),hd(n),i.next(e)}catch(e){}}}}("dual_mode_auth_".concat(n)),d=null!=t?t:ol.eI,c=s.pipe((0,ak.O)("dual"===l?hk(n):null)),u={};r?u.apiHost=r:"undefined"!=typeof __SANITY_STAGING__&&!0===__SANITY_STAGING__&&(u.apiHost="https://api.sanity.work");let p=c.pipe((0,ag.U)(e=>d({projectId:n,dataset:i,apiVersion:"2021-06-07",useCdn:!1,...e&&{token:e},withCredentials:!0,requestTagPrefix:"sanity.studio",ignoreBrowserTokenWarning:!0,allowReconfigure:!1,...u})),(0,ab.w)(e=>(0,at.P)(async()=>{let t=await hS(e,o);return{currentUser:t,client:e,authenticated:!!t}})),(0,ax.x)((e,t)=>aG()(e.currentUser,t.currentUser)),(0,aw.d)(1));async function h(){let e;let t=hp();if(!t){o("cookie"===l?null:hk(n));return}let r=d({projectId:n,dataset:i,useCdn:!0,withCredentials:!0,apiVersion:"2021-06-07",requestTagPrefix:"sanity.studio",...u});if(("dual"===l||"cookie"===l)&&(e=await hS(r,o)),e||"cookie"===l){o(null);return}let a=await f(r,t);o(null!=a?a:null)}async function f(e,t){let{token:i}=await e.request({method:"GET",uri:"/auth/fetch",query:{sid:t},tag:"auth.fetch-token"});return h_({token:i,projectId:n}),i}async function m(){let e=d({projectId:n,dataset:i,useCdn:!0,withCredentials:!0,apiVersion:"2021-06-07",requestTagPrefix:"sanity.studio",...u});hC(n),await e.request({uri:"/auth/logout",method:"POST"}),o(null)}let g=function(e){let{getClient:t,loginMethod:n,redirectOnSingle:i,...r}=e,l=ci(t);return function(e){let{projectId:t,basePath:a}=e,[o,s]=(0,lJ.useState)(null),[d,c]=(0,lJ.useState)(null);if(d)throw d;let[u]=l();(0,lJ.useEffect)(()=>{u&&hy({client:u,...r}).then(s).catch(c)},[u]);let p=i&&(null==o?void 0:o.length)===1&&(null==o?void 0:o[0])&&hj({loginMethod:n,projectId:t,url:o[0].url,basePath:a}),h=!o||p;return((0,lJ.useEffect)(()=>{p&&(window.location.href=p)},[p]),h)?(0,lG.jsxs)(l4.kC,{align:"center",direction:"column",gap:4,justify:"center",padding:6,sizing:"border",children:[(0,lG.jsx)(l4.xv,{muted:!0,children:"Loading…"}),(0,lG.jsx)(l4.$j,{muted:!0})]}):(0,lG.jsxs)(l4.Kq,{space:4,children:[(0,lG.jsx)(l4.X6,{align:"center",size:1,children:"Choose login provider"}),(0,lG.jsx)(l4.Kq,{space:2,children:o.map((e,i)=>(0,lG.jsx)(l4.zx,{as:"a",icon:hb[e.name]||(0,lG.jsx)(hv,{provider:e}),href:hj({loginMethod:n,projectId:t,url:e.url,basePath:a}),mode:"ghost",text:e.title},"".concat(e.url,"_").concat(i)))})]})}}({...a,getClient:()=>p.pipe((0,ag.U)(e=>e.client)),loginMethod:l});return{handleCallbackUrl:h,token:c,state:p,LoginComponent:g,logout:m}},function e(t){return"object"!=typeof t||null===t?"".concat(t):JSON.stringify(Object.fromEntries(Object.entries(t).sort((e,t)=>{let[n]=e,[i]=t;return n.localeCompare(i,"en")}).map(t=>{let[n,i]=t;return[n,e(i)]})))});function hE(e){return"google"===e?"Google":"github"===e?"GitHub":"sanity"===e?"Sanity":(null==e?void 0:e.startsWith("saml-"))?"SAML/SSO":void 0}let hP="undefined"==typeof window?(0,l6.of)({}):(0,l9.R)(window,"online"),hA="undefined"==typeof window?(0,l6.of)({}):(0,l9.R)(window,"offline"),hO=e=>100*Math.pow(2,e),hz={type:"connecting"},hM=(0,os.E)(),hI=hM[0];hM[1];let hR=e=>{let{error:t,isOffline:n,attemptNo:i,retryAt:r}=e;return{type:"error",error:t,attemptNo:i,isOffline:n,retryAt:r}},hF=(0,a0.vJ)(e=>{let{theme:t}=e,{color:n,fonts:i}=t.sanity;return{html:{backgroundColor:n.base.bg},"#sanity":{fontFamily:i.text.family}}});function hD(e){return e}function hZ(e){let t=["projectId"in e&&"`projectId` not allowed in plugin configuration","dataset"in e&&"`dataset` not allowed in plugin configuration"].filter(oc());if(t.length)throw Error("Invalid plugin configuration:\n".concat(t.map(e=>"	".concat(e)).join("\n")))}function hL(e){return"function"==typeof e?t=>{let n=e(t);return hZ(n),n}:(hZ(e),()=>e)}let hq=(e,t,n)=>{let{document:i}=t,r=null==i?void 0:i.unstable_fieldActions;if(!r)return e;if("function"==typeof r)return r(e,n);if(Array.isArray(r))return[...e,...r];throw Error("Expected `document.unstable_fieldActions` to be an array or a function, but received ".concat(typeof r))},hN=[];function hV(e){return e}let hU=class e{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.message=e,this.paths=t.paths||[],this.children=t.children,this.operation=t.operation}cloneWithMessage(t){return new e(t,{paths:this.paths,children:this.children,operation:this.operation})}};function hB(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return e.reduce((e,t,n)=>{let i=typeof t;if("number"===i)return"".concat(e,"[").concat(t,"]");if("string"===i)return"".concat(e).concat(0===n?"":".").concat(t);if((0,lX.fU)(t))return"".concat(e,'[_key=="').concat(t._key,'"]');throw Error('Unsupported path segment "'.concat(t,'"'))},"")}function hK(e){return null!==e||void 0!==e}function hH(e,t,n){var i;if(!n)throw Error("missing context");if(!0===e)return[];if(Array.isArray(e))return e.flatMap(e=>hH(e,t,n)).filter(hK);if("string"==typeof e)return hH(new hU(e),t,n);if(!(e instanceof hU)){if("string"!=typeof(null==e?void 0:e.message))throw Error("".concat(hB(n.path),": Validator must return 'true' if valid or an error message as a string on errors"));return hH(new hU(e.message,e),t,n)}return(null==(i=e.paths)?void 0:i.length)?[].concat(e.paths.map(i=>({path:(n.path||[]).concat(i),level:t||"error",item:e}))):[{level:t||"error",item:e,path:n.path||[]}]}let hW={}.toString,h$=[Object,Function,Array,String,Boolean,Number,Date,RegExp,Error];function hX(e){let t=hW.call(e).slice(8,-1);if(null==e)return t.toLowerCase();let n=e.constructor;return n&&!function(e){for(let t=0;t<h$.length;t++)if(h$[t]===e)return!0;return!1}(n)?n.name:t}function hG(e,t){if(e===t)return!0;if(Array.isArray(e)&&Array.isArray(t)){if(e.length!=t.length)return!1;for(let n=0;n<e.length;n++)if(!hG(e[n],t[n]))return!1;return!0}if(Array.isArray(e)!=Array.isArray(t))return!1;if(e&&t&&"object"==typeof e&&"object"==typeof t){let n=Object.keys(e);if(n.length!==Object.keys(t).length)return!1;if(e instanceof Date&&t instanceof Date)return e.getTime()===t.getTime();if(e instanceof Date!=t instanceof Date)return!1;if(e instanceof RegExp&&t instanceof RegExp)return e.toString()==t.toString();if(e instanceof RegExp!=t instanceof RegExp)return!1;for(let e=0;e<n.length;e++)if("_key"!==n[e]&&!Object.prototype.hasOwnProperty.call(t,n[e]))return!1;for(let i=0;i<n.length;i++){let r=n[i];if("_key"!==r&&!hG(e[r],t[r]))return!1}return!0}return!1}let hY=e=>{var t;return new hU(e.message?e.message:1===e.results.length?null==(t=e.results[0])?void 0:t.item.message:"[".concat(e.results.map(e=>e.item.message).join(" - ".concat(e.operation," - ")),"]"),{children:e.results.length>1?e.results:void 0,operation:e.operation})},hJ={type:(e,t,n)=>{let i=hX(t);return i===e||"undefined"===i||n||'Expected type "'.concat(e,'", got "').concat(i,'"')},presence:(e,t,n)=>void 0!==t||"required"!==e||n||"Value is required",all:async(e,t,n,i)=>{let r=(await Promise.all(e.map(e=>e.validate(t,i)))).flat();return!r.length||hY({message:n,results:r,operation:"AND"})},either:async(e,t,n,i)=>{let r=(await Promise.all(e.map(e=>e.validate(t,i)))).flat();return r.length<e.length||hY({message:n,results:r,operation:"OR"})},valid:(e,t,n)=>{let i=typeof t;if("undefined"===i)return!0;let r=("number"===i||"string"===i)&&"".concat(t),l=r&&r.length>30?"".concat(r.slice(0,30),"…"):r;return!!e.some(e=>hG(e,t))||n||(r?'Value "'.concat(l,'" did not match any allowed values'):"Value did not match any allowed values")},custom:async(e,t,n,i)=>{let r;let l=setTimeout(()=>{console.warn("Custom validator at ".concat(hB(i.path)," has taken more than ").concat(5e3,"ms to respond"))},5e3);try{r=await e(t,i)}finally{clearTimeout(l)}return"string"==typeof r&&n||r}},hQ={...hJ,presence:(e,t,n)=>"required"!==e||"boolean"==typeof t||n||"Required"},h0=/(?:\.(\d+))?(?:[eE]([+-]?\d+))?$/,h1={...hJ,integer:(e,t,n)=>!!Number.isInteger(t)||n||"Must be an integer",precision:(e,t,n)=>{if(void 0===t)return!0;let i=t.toString().match(h0);return!(Math.max((i[1]?i[1].length:0)-(i[2]?parseInt(i[2],10):0),0)>e)||n||"Max precision is ".concat(e)},min:(e,t,n)=>t>=e||n||"Must be greater than or equal ".concat(e),max:(e,t,n)=>t<=e||n||"Must be less than or equal ".concat(e),greaterThan:(e,t,n)=>t>e||n||"Must be greater than ".concat(e),lessThan:(e,t,n)=>t<e||n||"Must be less than ".concat(e)},h2="http://sanity",h3=e=>/^\.*\//.test(e),h4=/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,h5={...hJ,min:(e,t,n)=>!t||t.length>=e||n||"Must be at least ".concat(e," characters long"),max:(e,t,n)=>!t||t.length<=e||n||"Must be at most ".concat(e," characters long"),length:(e,t,n)=>(t||"").length===e||n||"Must be exactly ".concat(e," characters long"),uri:(e,t,n)=>{let i;let r=t||"",{options:l}=e,{allowCredentials:a,relativeOnly:o}=l,s=l.allowRelative||o;try{i=s?new URL(r,h2):new URL(r)}catch(e){return n||"Not a valid URL"}if(o&&i.origin!==h2)return n||"Only relative URLs are allowed";if(!s&&i.origin===h2&&h3(r))return n||"Relative URLs are not allowed";if(!a&&(i.username||i.password))return n||"Username/password not allowed";let d=i.protocol.replace(/:$/,"");return!!l.scheme.some(e=>e.test(d))||n||"Does not match allowed protocols/schemes"},stringCasing:(e,t,n)=>{let i=t||"";return"uppercase"===e&&i!==i.toLocaleUpperCase()?n||"Must be all uppercase letters":"lowercase"!==e||i===i.toLocaleLowerCase()||n||"Must be all lowercase letters"},presence:(e,t,n)=>"required"!==e||!!t||n||"Required",regex:(e,t,n)=>{let{pattern:i,name:r,invert:l}=e,a=r||'"'.concat(i.toString(),'"');i.lastIndex=0;let o=i.test(t||"");return(!!l||!!o)&&(!l||!o)||n||(l?"Should not match ".concat(a,"-pattern"):"Does not match ".concat(a,"-pattern"))},email:(e,t,n)=>{let i="".concat(t||"").trim();return!!(!i||h4.test(i))||n||"Must be a valid email address"}},h6={...hJ,min:(e,t,n)=>!t||t.length>=e||n||"Must have at least ".concat(e," items"),max:(e,t,n)=>!t||t.length<=e||n||"Must have at most ".concat(e," items"),length:(e,t,n)=>!t||t.length===e||n||"Must have exactly ".concat(e," items"),presence:(e,t,n)=>"required"!==e||!!t||n||"Required",valid:(e,t,n)=>{if(void 0===t)return!0;let i=[];for(let n=0;n<t.length;n++){let r=t[n];if(e.some(e=>hG(e,r)))continue;let l=r&&r._key?{_key:r._key}:n;i.push([l])}return 0===i.length||new hU(n||"Value did not match any allowed values",{paths:i})},unique:(e,t,n)=>{let i=[];if(!t)return!0;for(let e=0;e<t.length;e++)for(let n=e+1;n<t.length;n++)hG(t[e],t[n])&&(-1===i.indexOf(e)&&i.push(e),-1===i.indexOf(n)&&i.push(n));let r=i.map(e=>{let n=t[e];return[n&&n._key?{_key:n._key}:e]});return!(i.length>0)||new hU(n||"Can't be a duplicate",{paths:r})}},h8=["_key","_type","_weak"],h9={...hJ,presence:(e,t,n)=>{if("required"!==e)return!0;let i=t&&Object.keys(t).filter(e=>!h8.includes(e));return void 0!==t&&(!i||0!==i.length)||n||"Required"},reference:async(e,t,n,i)=>{if(!t)return!0;if(!(0,lX.Yk)(t))return n||"Must be a reference to a document";let{type:r,getDocumentExists:l}=i;if(!r)throw Error("`type` was not provided in validation context");if("weak"in r&&r.weak)return!0;if(!l)throw Error("`getDocumentExists` was not provided in validation context");return!!await l({id:t._ref})||"This reference must be published"},assetRequired:(e,t,n)=>{if(!t||!t.asset||!t.asset._ref){let t=e.assetType||"Asset";return n||"".concat(t," required")}return!0}};function h7(e){return"object"==typeof e&&null!==e&&!Array.isArray(e)}let fe=/^(?:[-+]\d{2})?(?:\d{4}(?!\d{2}\b))(?:(-?)(?:(?:0[1-9]|1[0-2])(?:\1(?:[12]\d|0[1-9]|3[01]))?|W(?:[0-4]\d|5[0-2])(?:-?[1-7])?|(?:00[1-9]|0[1-9]\d|[12]\d{2}|3(?:[0-5]\d|6[1-6])))(?![T]$|[T][\d]+Z$)(?:[T\s](?:(?:(?:[01]\d|2[0-3])(?:(:?)[0-5]\d)?|24:?00)(?:[.,]\d+(?!:))?)(?:\2[0-5]\d(?:[.,]\d+)?)?(?:[Z]|(?:[+-])(?:[01]\d|2[0-3])(?::?[0-5]\d)?)?)?)?$/,ft=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0,i="yyyy-MM-dd";return n&&n.dateFormat&&(i=n.dateFormat),"date"===e||(n&&n.timeFormat?i+=" ".concat(n.timeFormat):i+=" HH:mm"),(0,oy.Z)(new Date(t),i)};function fn(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!e)return null;if("now"===e)return new Date;let n=new Date(e),i=isNaN(n.getTime());if(i&&t)throw Error('Unable to parse "'.concat(e,'" to a date'));return i?null:n}let fi={Boolean:hQ,Number:h1,String:h5,Array:h6,Object:h9,Date:{...hJ,type:(e,t,n)=>!!(!"".concat(t)||fe.test(t))||n||"Must be a valid ISO-8601 formatted date string",min:(e,t,n,i)=>{let r=fn(t);if(!r||!t||r>=fn(e,!0))return!0;if(!i.type)throw Error("`type` was not provided in validation context.");let l=h7(i.type.options)?i.type.options:{},a=ft(i.type.name,e,l);return n||"Must be at or after ".concat(a)},max:(e,t,n,i)=>{let r=fn(t);if(!r||!t||r<=fn(e,!0))return!0;if(!i.type)throw Error("`type` was not provided in validation context.");let l=h7(i.type.options)?i.type.options:{},a=ft(i.type.name,e,l);return n||"Must be at or before ".concat(a)}}},fr=e=>e&&e.type?fr(e.type):e,fl=e=>"object"==typeof e&&!!e&&e.type===fd.FIELD_REF,fa=[],fo=Symbol("FIELD_REF"),fs=["Array","Boolean","Date","Number","Object","String"],fd=((tv=class{constructor(e){this._type=void 0,this._level=void 0,this._required=void 0,this._typeDef=void 0,this._message=void 0,this._rules=[],this._fieldRules=void 0,this.valueOfField=tv.valueOfField.bind(tv),this._typeDef=e,this.reset()}_mergeRequired(e){return"required"===this._required||"required"===e._required?"required":"optional"===this._required||"optional"===e._required?"optional":void 0}error(e){let t=this.clone();return t._level="error",t._message=e||void 0,t}warning(e){let t=this.clone();return t._level="warning",t._message=e||void 0,t}info(e){let t=this.clone();return t._level="info",t._message=e||void 0,t}reset(){return this._type=this._type||void 0,this._rules=(this._rules||[]).filter(e=>"type"===e.flag),this._message=void 0,this._required=void 0,this._level="error",this._fieldRules=void 0,this}isRequired(){return"required"===this._required}clone(){let e=new tv;return e._type=this._type,e._message=this._message,e._required=this._required,e._rules=ox()(this._rules),e._level=this._level,e._fieldRules=this._fieldRules,e._typeDef=this._typeDef,e}cloneWithRules(e){let t=this.clone(),n=new Set;return e.forEach(e=>{"type"===e.flag&&(t._type=e.constraint),n.add(e.flag)}),t._rules=t._rules.filter(e=>{let t=["type","uri","email"].includes(e.flag),i=n.has(e.flag);return!(t&&i)}).concat(e),t}merge(e){if(this._type&&e._type&&this._type!==e._type)throw Error("merge() failed: conflicting types");let t=this.cloneWithRules(e._rules);return t._type=this._type||e._type,t._message=this._message||e._message,t._required=this._mergeRequired(e),t._level="error"===this._level?e._level:this._level,t}type(e){let t="".concat(e.slice(0,1).toUpperCase()).concat(e.slice(1));if(!fs.includes(t))throw Error('Unknown type "'.concat(e,'"'));let n=this.cloneWithRules([{flag:"type",constraint:t}]);return n._type=t,n}all(e){return this.cloneWithRules([{flag:"all",constraint:e}])}either(e){return this.cloneWithRules([{flag:"either",constraint:e}])}optional(){let e=this.cloneWithRules([{flag:"presence",constraint:"optional"}]);return e._required="optional",e}required(){let e=this.cloneWithRules([{flag:"presence",constraint:"required"}]);return e._required="required",e}custom(e){return this.cloneWithRules([{flag:"custom",constraint:e}])}min(e){return this.cloneWithRules([{flag:"min",constraint:e}])}max(e){return this.cloneWithRules([{flag:"max",constraint:e}])}length(e){return this.cloneWithRules([{flag:"length",constraint:e}])}valid(e){let t=Array.isArray(e)?e:[e];return this.cloneWithRules([{flag:"valid",constraint:t}])}integer(){return this.cloneWithRules([{flag:"integer"}])}precision(e){return this.cloneWithRules([{flag:"precision",constraint:e}])}positive(){return this.cloneWithRules([{flag:"min",constraint:0}])}negative(){return this.cloneWithRules([{flag:"lessThan",constraint:0}])}greaterThan(e){return this.cloneWithRules([{flag:"greaterThan",constraint:e}])}lessThan(e){return this.cloneWithRules([{flag:"lessThan",constraint:e}])}uppercase(){return this.cloneWithRules([{flag:"stringCasing",constraint:"uppercase"}])}lowercase(){return this.cloneWithRules([{flag:"stringCasing",constraint:"lowercase"}])}regex(e,t,n){var i,r;let l="string"==typeof t?t:null!=(i=null==t?void 0:t.name)?i:null==n?void 0:n.name,a="string"!=typeof t&&(null!=(r=null==t?void 0:t.invert)?r:null==n?void 0:n.invert);return this.cloneWithRules([{flag:"regex",constraint:{pattern:e,name:l,invert:a||!1}}])}email(){return this.cloneWithRules([{flag:"email"}])}uri(e){let t=(null==e?void 0:e.scheme)||["http","https"],n=Array.isArray(t)?t:[t];if(!n.length)throw Error("scheme must have at least 1 scheme specified");let i={options:{scheme:n.map(e=>{if(!(e instanceof RegExp)&&"string"!=typeof e)throw Error("scheme must be a RegExp or a String");return"string"==typeof e?new RegExp("^".concat(e.replace(/[\^\$\.\*\+\-\?\=\!\:\|\\\/\(\)\[\]\{\}\,]/g,"\\$&"),"$")):e}),allowRelative:(null==e?void 0:e.allowRelative)||!1,relativeOnly:(null==e?void 0:e.relativeOnly)||!1,allowCredentials:(null==e?void 0:e.allowCredentials)||!1}};return this.cloneWithRules([{flag:"uri",constraint:i}])}unique(){return this.cloneWithRules([{flag:"unique"}])}reference(){return this.cloneWithRules([{flag:"reference"}])}fields(e){if("Object"!==this._type)throw Error("fields() can only be called on an object type");let t=this.cloneWithRules([]);return t._fieldRules=e,t}assetRequired(){let e;let t=fr(this._typeDef);return e=t&&["image","file"].includes(t.name)?"image"===t.name?"Image":"File":"Asset",this.cloneWithRules([{flag:"assetRequired",constraint:{assetType:e}}])}async validate(e,t){if(!t)throw Error("missing context");let n=null==e;if(n&&"optional"===this._required)return fa;let i=void 0===this._required&&n?this._rules.filter(e=>"custom"===e.flag):this._rules,r=this._type&&fi[this._type]||hJ;return(await Promise.all(i.map(async n=>{let i;if(void 0===n.flag)throw Error('Invalid rule, did not contain "flag"-property');let l=r[n.flag];if(!l){let e=this._type?'type "'.concat(this._type,'"'):"rule without declared type";throw Error('Validator for flag "'.concat(n.flag,'" not found for ').concat(e))}let a="constraint"in n?n.constraint:null;fl(a)&&(a=ob()(t.parent,a.path));try{i=await l(a,e,this._message,t)}catch(e){return hH(new hU("".concat(hB(t.path),": Exception occurred while validating value: ").concat(e.message)),"error",t)}return hH(i,this._level,t)}))).flat()}}).FIELD_REF=fo,tv.array=e=>new tv(e).type("Array"),tv.object=e=>new tv(e).type("Object"),tv.string=e=>new tv(e).type("String"),tv.number=e=>new tv(e).type("Number"),tv.boolean=e=>new tv(e).type("Boolean"),tv.dateTime=e=>new tv(e).type("Date"),tv.valueOfField=e=>({type:fo,path:e}),tv),fc="undefined"==typeof window?void 0:window,fu=(null==fc?void 0:fc.requestIdleCallback)||function(e,t){let n=Date.now();return window.setTimeout(()=>{e({didTimeout:!1,timeRemaining:()=>Math.max(0,Date.now()-n)})},0)},fp=(null==fc?void 0:fc.cancelIdleCallback)||function(e){return window.clearTimeout(e)},fh=oo()(function(e){console.warn(["Slug field at path ".concat(e," is within an array and cannot be automatically checked for uniqueness"),'If you need to check for uniqueness, provide your own "isUnique" method',"To disable this message, set `disableArrayWarning: true` on the slug `options` field"].join("\n"))});function ff(e){return e.reduce((e,t,n)=>{let i="number"==typeof t,r=(0,lX.fU)(t),l=i||r?"[]":"".concat(0===n?"":".").concat(t);return"".concat(e).concat(l)},"")}let fm=(e,t)=>{let{getClient:n,document:i,path:r,type:l}=t,a=null==l?void 0:l.options;if(!i)throw Error("`document` was not provided in validation context.");if(!r)throw Error("`path` was not provided in validation context.");let o=(null==a?void 0:a.disableArrayWarning)||!1,{published:s,draft:d}=function(e){let t=0===e.indexOf("drafts.");return{published:t?e.slice(7):e,draft:t?e:"drafts.".concat(e)}}(i._id),c=i._type,u=ff(r.concat("current"));!o&&u.includes("[]")&&fh(ff(r));let p=["_type == $docType","!(_id in [$draft, $published])","".concat(u," == $slug")].join(" && ");return n({apiVersion:"2022-09-09"}).fetch("!defined(*[".concat(p,"][0]._id)"),{docType:c,draft:d,published:s,slug:e},{tag:"validation.slug-is-unique"})},fg=async(e,t)=>{var n;if(!e)return!0;if("object"!=typeof e)return"Slug must be an object";let i=e.current;if(!i)return"Slug must have a value";let r=null==(n=null==t?void 0:t.type)?void 0:n.options,l=(null==r?void 0:r.isUnique)||fm,a={...t,parent:t.parent,type:t.type,defaultIsUnique:fm};return!!await l(i,a)||"Slug is already in use"},fx={array:!0,boolean:!0,date:!0,number:!0,object:!0,string:!0},fv=e=>e in fx;function fb(e,t){let n=e;fv(t.jsonType)&&(n=n.type(t.jsonType));let i=(null==t?void 0:t.options)&&"object"==typeof t.options&&"list"in t.options&&t.options.list;return(Array.isArray(i)&&(n=n.valid(i.map(e=>"object"===t.jsonType&&function e(t){return!!t&&("fields"in t||!t.type?!!("fields"in t&&Array.isArray(t.fields))&&t.fields.some(e=>"value"===e.name):e(t.type))}(t)?e:void 0===e.value?e:e.value))),"datetime"===t.name||"date"===t.name)?n.type("Date"):"url"===t.name?n.uri():"slug"===t.name?n.custom(fg):"reference"===t.name?n.reference():"email"===t.name?n.email():n}function fy(e){if(!e)return[];let t=e.validation;if(Array.isArray(t))return t.flatMap(t=>fy({...e,validation:t}));if(t instanceof fd)return[t];let n=Object.values((function e(t,n){return!t||n.has(t)?[]:(n.add(t),[...t.type?e(t.type,n):[],t])})(e,new Set).reduce((e,t)=>(e[t.name]=t,e),{})).reduce(fb,new fd(e));return t?fy({...e,validation:t(n)}):[n]}let fj=e=>"object"==typeof e&&null!==e&&!Array.isArray(e),fw=e=>null!=e,fk=[],fC=e=>"error"===e.severity,f_=[{name:"sanity.assetSourceData",title:"Asset Source Data",type:"object",fields:[{name:"name",title:"Source name",description:"A canonical name for the source this asset is originating from",type:"string"},{name:"id",title:"Asset Source ID",description:"The unique ID for the asset within the originating source so you can programatically find back to it",type:"string"},{name:"url",title:"Asset information URL",description:"A URL to find more information about this asset in the originating source",type:"string"}]},{title:"Slug",name:"slug",type:"object",fields:[{name:"current",title:"Current slug",type:"string"},{name:"source",title:"Source field",type:"string",hidden:!0}]},{title:"Geographical Point",name:"geopoint",type:"object",fields:[{name:"lat",type:"number",title:"Latitude"},{name:"lng",type:"number",title:"Longitude"},{name:"alt",type:"number",title:"Altitude"}]},{name:"sanity.imageAsset",title:"Image",type:"document",fieldsets:[{name:"system",title:"System fields",description:"These fields are managed by the system and not editable"}],fields:[{name:"originalFilename",type:"string",title:"Original file name",readOnly:!0},{name:"label",type:"string",title:"Label"},{name:"title",type:"string",title:"Title"},{name:"description",type:"string",title:"Description"},{name:"altText",type:"string",title:"Alternative text"},{name:"sha1hash",type:"string",title:"SHA1 hash",readOnly:!0,fieldset:"system"},{name:"extension",type:"string",readOnly:!0,title:"File extension",fieldset:"system"},{name:"mimeType",type:"string",readOnly:!0,title:"Mime type",fieldset:"system"},{name:"size",type:"number",title:"File size in bytes",readOnly:!0,fieldset:"system"},{name:"assetId",type:"string",title:"Asset ID",readOnly:!0,fieldset:"system"},{name:"uploadId",type:"string",readOnly:!0,hidden:!0,fieldset:"system"},{name:"path",type:"string",title:"Path",readOnly:!0,fieldset:"system"},{name:"url",type:"string",title:"Url",readOnly:!0,fieldset:"system"},{name:"metadata",type:"sanity.imageMetadata",title:"Metadata"},{name:"source",type:"sanity.assetSourceData",title:"Source",readOnly:!0,fieldset:"system"}],preview:{select:{id:"_id",title:"originalFilename",mimeType:"mimeType",size:"size"},prepare:e=>({title:e.title||"string"==typeof e.path&&e.path.split("/").slice(-1)[0],media:{asset:{_ref:e.id}},subtitle:"".concat(e.mimeType," (").concat((Number(e.size)/1024/1024).toFixed(2)," MB)")})},orderings:[{title:"File size",name:"fileSizeDesc",by:[{field:"size",direction:"desc"}]}]},{name:"sanity.fileAsset",title:"File",type:"document",fieldsets:[{name:"system",title:"System fields",description:"These fields are managed by the system and not editable"}],fields:[{name:"originalFilename",type:"string",title:"Original file name",readOnly:!0},{name:"label",type:"string",title:"Label"},{name:"title",type:"string",title:"Title"},{name:"description",type:"string",title:"Description"},{name:"altText",type:"string",title:"Alternative text"},{name:"sha1hash",type:"string",title:"SHA1 hash",readOnly:!0,fieldset:"system"},{name:"extension",type:"string",title:"File extension",readOnly:!0,fieldset:"system"},{name:"mimeType",type:"string",title:"Mime type",readOnly:!0,fieldset:"system"},{name:"size",type:"number",title:"File size in bytes",readOnly:!0,fieldset:"system"},{name:"assetId",type:"string",title:"Asset ID",readOnly:!0,fieldset:"system"},{name:"path",type:"string",title:"Path",readOnly:!0,fieldset:"system"},{name:"url",type:"string",title:"Url",readOnly:!0,fieldset:"system"},{name:"source",type:"sanity.assetSourceData",title:"Source",readOnly:!0,fieldset:"system"}],preview:{select:{title:"originalFilename",path:"path",mimeType:"mimeType",size:"size"},prepare:e=>({title:e.title||e.path.split("/").slice(-1)[0],subtitle:"".concat(e.mimeType," (").concat((e.size/1024/1024).toFixed(2)," MB)")})},orderings:[{title:"File size",name:"fileSizeDesc",by:[{field:"size",direction:"desc"}]}]},{name:"sanity.imageCrop",title:"Image crop",type:"object",fields:[{name:"top",type:"number"},{name:"bottom",type:"number"},{name:"left",type:"number"},{name:"right",type:"number"}]},{name:"sanity.imageHotspot",title:"Image hotspot",type:"object",fields:[{name:"x",type:"number"},{name:"y",type:"number"},{name:"height",type:"number"},{name:"width",type:"number"}]},{name:"sanity.imageMetadata",title:"Image metadata",type:"object",fieldsets:[{name:"extra",title:"Extra metadata…",options:{collapsable:!0}}],fields:[{name:"location",type:"geopoint"},{name:"dimensions",title:"Dimensions",type:"sanity.imageDimensions",fieldset:"extra"},{name:"palette",type:"sanity.imagePalette",title:"Palette",fieldset:"extra"},{name:"lqip",title:"LQIP (Low-Quality Image Placeholder)",type:"string",readOnly:!0},{name:"blurHash",title:"BlurHash",type:"string",readOnly:!0},{name:"hasAlpha",title:"Has alpha channel",type:"boolean",readOnly:!0},{name:"isOpaque",title:"Is opaque",type:"boolean",readOnly:!0}]},{name:"sanity.imageDimensions",type:"object",title:"Image dimensions",fields:[{name:"height",type:"number",title:"Height",readOnly:!0},{name:"width",type:"number",title:"Width",readOnly:!0},{name:"aspectRatio",type:"number",title:"Aspect ratio",readOnly:!0}]},{name:"sanity.imagePalette",title:"Image palette",type:"object",fields:[{name:"darkMuted",type:"sanity.imagePaletteSwatch",title:"Dark Muted"},{name:"lightVibrant",type:"sanity.imagePaletteSwatch",title:"Light Vibrant"},{name:"darkVibrant",type:"sanity.imagePaletteSwatch",title:"Dark Vibrant"},{name:"vibrant",type:"sanity.imagePaletteSwatch",title:"Vibrant"},{name:"dominant",type:"sanity.imagePaletteSwatch",title:"Dominant"},{name:"lightMuted",type:"sanity.imagePaletteSwatch",title:"Light Muted"},{name:"muted",type:"sanity.imagePaletteSwatch",title:"Muted"}]},{name:"sanity.imagePaletteSwatch",title:"Image palette swatch",type:"object",fields:[{name:"background",type:"string",title:"Background",readOnly:!0},{name:"foreground",type:"string",title:"Foreground",readOnly:!0},{name:"population",type:"number",title:"Population",readOnly:!0},{name:"title",type:"string",title:"String",readOnly:!0}]}];function fS(e){return"string"==typeof e.title?e.title:e.type?fS(e.type):e.name||e.jsonType}let fT={apiVersion:"2022-09-09"};var fE=Object.freeze,fP=Object.defineProperty;let fA=(0,a0.ZP)(l4.mh)(tb||(tb=fE(fP(s=["\n  position: absolute;\n  width: 100%;\n  height: 100%;\n  top: 0;\n"],"raw",{value:fE(s.slice())}))));function fO(){return(0,lG.jsx)(fA,{children:(0,lG.jsx)(l4.kC,{height:"fill",align:"center",justify:"center",children:(0,lG.jsx)(l4.$j,{})})})}function fz(e){let{text:t}=e;return(0,lG.jsxs)(l4.kC,{direction:"row",justify:"center",align:"center",children:[(0,lG.jsx)(l4.$j,{}),(0,lG.jsx)(l4.xu,{marginLeft:2,children:(0,lG.jsx)(l4.xv,{children:t})})]})}let fM={referringDocuments:[],isLoading:!0},fI=()=>(0,lJ.createElement)(lJ.Fragment);function fR(e){let{options:t}=Ic().__internal,{defaultComponent:n,pick:i}=e;return(0,lJ.useMemo)(()=>{let e=[...Ry(t,[])];e.reverse();let r=e.map(e=>{let{config:t}=e;return i(t)}).filter(Boolean);return e=>{let t=e=>(0,lJ.createElement)(n,e);for(let e of r){let n=t;t=t=>(0,lJ.createElement)(e,{...t,renderDefault:n})}return t({...e,renderDefault:fI})}},[n,t,i])}function fF(e,t){return t.name===e||!!(t.type&&fF(e,t.type))}let fD={default:u5,media:function(e){let{media:t,mediaDimensions:n=pE,children:i,isPlaceholder:r,progress:l=-1,subtitle:a,title:o,withBorder:s=!0,withRadius:d=!0}=e,c=n.aspect||1,u=(0,lJ.useMemo)(()=>({paddingBottom:"".concat(100/c,"%")}),[c]),p=(0,lJ.useMemo)(()=>o&&a?(0,lG.jsxs)(pT,{children:[o&&(0,lG.jsx)(l4.xv,{align:"center",size:1,weight:"semibold",children:uY(o,"media")}),a&&(0,lG.jsx)(l4.xv,{align:"center",muted:!0,size:1,children:uY(a,"media")})]}):null,[a,o]);return(0,lG.jsxs)(pk,{"data-testid":"media-preview",overflow:"hidden",flex:1,children:[(0,lG.jsx)("div",{style:u}),(0,lG.jsx)(l4.u,{content:p,disabled:!p,placement:"top",portal:!0,children:(0,lG.jsxs)(pC,{children:[r?(0,lG.jsx)(p_,{}):(0,lG.jsx)(uG,{border:s,dimensions:n,layout:"media",media:t,radius:d?1:0,responsive:!0}),"number"==typeof l&&l>-1&&(0,lG.jsx)(pS,{children:(0,lG.jsx)(ph,{value:l})})]})}),i]})},detail:function(e){let{title:t,subtitle:n,description:i,mediaDimensions:r=pa,media:l,status:a,children:o,isPlaceholder:s}=e,d=a&&(0,lG.jsx)(pe,{marginLeft:3,paddingRight:1,children:uY(a,"detail")});return s?(0,lG.jsxs)(u7,{"data-testid":"detail-preview",children:[!1!==l&&(0,lG.jsx)(pt,{"data-testid":"detail-preview__media"}),(0,lG.jsxs)(l4.xu,{flex:1,paddingLeft:!1===l?1:2,children:[(0,lG.jsxs)(l4.kC,{align:"center","data-testid":"detail-preview__header",children:[(0,lG.jsxs)(l4.Kq,{flex:1,space:2,children:[(0,lG.jsx)(pn,{}),(0,lG.jsx)(pi,{})]}),d]}),i&&(0,lG.jsx)(l4.xu,{marginTop:3,children:(0,lG.jsx)(pr,{})})]})]}):(0,lG.jsxs)(u7,{"data-testid":"detail-preview",children:[!1!==l&&(0,lG.jsx)(uG,{dimensions:r,layout:"detail",media:l}),(0,lG.jsxs)(l4.xu,{flex:1,paddingLeft:!1===l?1:2,children:[(0,lG.jsxs)(l4.kC,{align:"center","data-testid":"detail-preview__header",children:[(0,lG.jsxs)(l4.Kq,{flex:1,space:2,children:[(0,lG.jsxs)(l4.xv,{textOverflow:"ellipsis",style:{color:"inherit"},children:[t&&uY(t,"detail"),!t&&(0,lG.jsx)(lG.Fragment,{children:"Untitled"})]}),n&&(0,lG.jsx)(l4.xv,{muted:!0,size:1,textOverflow:"ellipsis",children:uY(n,"detail")})]}),d]}),i&&(0,lG.jsx)(l4.xu,{marginTop:3,children:(0,lG.jsx)(pl,{muted:!0,size:1,children:uY(i,"detail")})})]}),o]})},inline:function(e){let{title:t,fallbackTitle:n="Untitled",media:i,mediaDimensions:r=pW}=e;return(0,lG.jsxs)(pB,{"data-testid":"inline-preview",children:[i&&(0,lG.jsxs)(pK,{"data-testid":"inline-preview-media",children:[(0,oi.isValidElementType)(i)?(0,lJ.createElement)(i,{layout:"inline",dimensions:r}):"string"==typeof i?(0,lG.jsx)("div",{children:i}):i,(0,lG.jsx)("span",{})]}),(0,lG.jsx)(pH,{"data-testid":"inline-preview-title",size:1,children:uY(t,"inline",n)})]})},block:function(e){let{actions:t,title:n,subtitle:i,description:r,mediaDimensions:l=pL,media:a,status:o,children:s}=e;return(0,lG.jsxs)(l4.Kq,{"data-testid":"block-preview",space:1,children:[(0,lG.jsxs)(pq,{"data-testid":"block-preview__header",children:[a&&(0,lG.jsx)(uG,{dimensions:l,layout:"block",media:a}),(0,lG.jsxs)(l4.xu,{flex:1,paddingLeft:a?2:1,children:[(0,lG.jsx)(l4.xv,{size:1,textOverflow:"ellipsis",weight:"semibold",children:n?uY(n,"block"):"Untitled"}),i&&(0,lG.jsx)(l4.xu,{marginTop:2,children:(0,lG.jsx)(l4.xv,{muted:!0,size:1,textOverflow:"ellipsis",children:uY(i,"block")})}),r&&(0,lG.jsx)(l4.xu,{marginTop:3,children:(0,lG.jsx)(l4.xv,{muted:!0,size:1,textOverflow:"ellipsis",children:uY(r,"block")})})]}),(0,lG.jsxs)(l4.kC,{gap:1,paddingLeft:1,children:[o&&(0,lG.jsx)(l4.xu,{paddingX:2,paddingY:3,children:uY(o,"block")}),t]})]}),s&&(0,lG.jsx)("div",{"data-testid":"block-preview__children",children:s})]})},blockImage:function(e){let{actions:t,title:n,subtitle:i,description:r,fallbackTitle:l="Untitled",mediaDimensions:a=pR,media:o,children:s,status:d}=e;return(0,lG.jsxs)(pI,{children:[(0,lG.jsxs)(l4.Kq,{children:[(0,lG.jsxs)(pz,{paddingLeft:2,paddingRight:1,paddingY:1,children:[(0,lG.jsxs)(l4.Kq,{flex:1,space:2,children:[(n||l)&&(0,lG.jsx)(l4.xv,{size:1,textOverflow:"ellipsis",weight:"semibold",children:n?uY(n,"block"):l}),i&&(0,lG.jsx)(l4.xv,{muted:!0,size:1,textOverflow:"ellipsis",children:uY(i,"block")})]}),(0,lG.jsxs)(l4.kC,{gap:1,paddingLeft:1,children:[d&&(0,lG.jsx)(l4.xu,{paddingX:2,paddingY:3,children:uY(d,"block")}),t]})]}),(0,lG.jsx)(pM,{$ratio:pF(a),__unstable_checkered:!0,display:"flex",sizing:"border",tone:"inherit",children:(0,lG.jsx)(uG,{border:!1,dimensions:a,layout:"blockImage",media:o,radius:0,responsive:!0})})]}),r&&(0,lG.jsx)(l4.xu,{paddingX:2,paddingY:3,children:(0,lG.jsx)(l4.xv,{muted:!0,size:1,children:uY(r,"block")})}),s&&(0,lG.jsx)("div",{children:s})]})}};function fZ(){return(0,lG.jsx)(a8.$lS,{className:"sanity-studio__preview-fallback-icon"})}function fL(e){let{icon:t,layout:n,media:i,imageUrl:r,title:l,...a}=e,o=qJ(fT),s=(0,lJ.useMemo)(()=>o9()(o),[o]),d=(0,lJ.useCallback)(e=>{let{dimensions:t}=e;return(0,lG.jsx)("img",{alt:cx(l)?l:void 0,referrerPolicy:"strict-origin-when-cross-origin",src:s.image(i).width(t.width||100).height(t.height||100).fit(t.fit).dpr(t.dpr||1).url()||""})},[s,i,l]),c=(0,lJ.useCallback)(()=>(0,lJ.createElement)(t||fZ),[t]),u=(0,lJ.useMemo)(()=>!1!==t&&((0,oi.isValidElementType)(i)||(0,lJ.isValidElement)(i)?i:(0,o7.JZ)(i)?d:cx(r)?(0,lG.jsx)("img",{src:r,alt:cx(l)?l:void 0,referrerPolicy:"strict-origin-when-cross-origin"}):c),[t,r,i,c,d,l]),p=(0,lJ.useMemo)(()=>({...a,media:u,title:l}),[u,a,l]),h=fD[n||"default"];return(0,lJ.createElement)(h,p)}let fq="undefined"==typeof window?aa.E:(0,l9.R)(window,"resize").pipe((0,aw.d)(1)),fN="undefined"==typeof window?aa.E:(0,l9.R)(window,"scroll",{passive:!0,capture:!0}).pipe((0,aw.d)(1)),fV="undefined"==typeof window?aa.E:(0,l9.R)(window,"orientationchange").pipe((0,aw.d)(1)),fU="undefined"!=typeof window&&"IntersectionObserver"in window&&"IntersectionObserverEntry"in window&&"intersectionRatio"in IntersectionObserverEntry.prototype&&("isIntersecting"in IntersectionObserverEntry.prototype||Object.defineProperty(IntersectionObserverEntry.prototype,"isIntersecting",{get(){return this.intersectionRatio>0}}),1)?function(){let e=new l7.x,t=new IntersectionObserver(t=>{t.forEach(t=>{e.next(t)})},{threshold:0,rootMargin:"".concat(150,"px")});return function(n){return new al.y(e=>(t.observe(n),e.next(),()=>t.unobserve(n))).pipe((0,aT.z)(()=>e.asObservable()),(0,aj.h)(e=>e.target===n),(0,ag.U)(e=>({isIntersecting:e.isIntersecting})))}}():function(e){let t=()=>{var t,n;return t=e.getBoundingClientRect(),n={left:0,right:window.innerWidth,top:0,bottom:window.innerHeight},t.left<=n.right+150&&t.right>=n.left-150&&t.top<=n.bottom+150&&t.bottom>=n.top-150};return(0,ae.T)((0,l6.of)(t()),fq,fN,fV).pipe((0,ag.U)(t),(0,ag.U)(e=>({isIntersecting:e})))},fB="undefined"==typeof window?aa.E:(0,l9.R)(document,"visibilitychange").pipe((0,aw.d)(1)),fK={isLoading:!0},fH={isLoading:!1};function fW(e){let{enabled:t=!0,ordering:n,schemaType:i,value:r}=e||{},{observeForPreview:l}=Uj();return(0,l5.m2)(()=>t&&r&&i?l(r,i,{ordering:n}).pipe((0,ag.U)(e=>({isLoading:!1,value:e.snapshot||void 0})),(0,av.K)(e=>(0,l6.of)({isLoading:!1,error:e}))):(0,l6.of)(fH),[t,l,n,i,r],fK)}function f$(e){return cx(e)?e:void 0}function fX(e){let{layout:t,value:n,component:i,style:r,schemaType:l,skipVisibilityCheck:a,...o}=e,[s,d]=(0,lJ.useState)(null),c=function(e){let{element:t,hideDelay:n=0}=e,[i,r]=(0,lJ.useState)(!1);return(0,lJ.useEffect)(()=>{if(!t)return;let e=(0,l8.z)((0,l6.of)(!document.hidden),fB.pipe((0,ag.U)(e=>{var t;return e.target instanceof Document&&!(null==(t=null==e?void 0:e.target)?void 0:t.hidden)}))).pipe((0,ax.x)()),i=fU(t).pipe((0,ag.U)(e=>e.isIntersecting)),l=e.pipe((0,ab.w)(e=>e?i:(0,l6.of)(!1)),(0,ab.w)(e=>e?(0,l6.of)(!0):(0,l6.of)(!1).pipe((0,aA.g)(n))),(0,ax.x)()).subscribe(r);return()=>l.unsubscribe()},[t,n]),i}({element:a?null:s,hideDelay:2e3}),u=fW({enabled:a||c,schemaType:l,value:n}),p=(0,lJ.useMemo)(()=>({...r,minWidth:(null==r?void 0:r.minWidth)||1,minHeight:(null==r?void 0:r.minHeight)||1}),[r]),h=(0,lJ.useMemo)(()=>(function(e){var t,n;if(!cg(e))return;let i="number"==typeof e.progress?e.progress:0,r=f$(e.initiated||e.createdAt),l=f$(e.updated||e.updatedAt),a=f$(null==(t=null==e?void 0:e.file)?void 0:t.name),o=f$(null==(n=null==e?void 0:e.file)?void 0:n.type),s=f$(e.previewImage);if(r&&l&&a&&o)return{progress:i,createdAt:r,updatedAt:l,file:{name:a,type:o},previewImage:s}})(null==n?void 0:n._upload),[n]),f=(0,lJ.useMemo)(()=>{var e,t;return(null==h?void 0:h.previewImage)?(0,lG.jsx)("img",{alt:"The image currently being uploaded",src:h.previewImage}):(null==(e=null==u?void 0:u.value)?void 0:e.media)?null==(t=null==u?void 0:u.value)?void 0:t.media:l.icon},[u,l,h]);return(0,lG.jsx)("div",{ref:d,style:p,children:(0,lJ.createElement)(i,{...o,...(null==u?void 0:u.value)||{},media:f,error:null==u?void 0:u.error,isPlaceholder:null==u?void 0:u.isLoading,layout:t,schemaType:l})})}function fG(e){let t=null==e?void 0:e.select;if(t)return Object.values(t).map(e=>String(e).split("."))}let fY=e=>!0===e.liveEdit;function fJ(e,t,n,i){let r=fY(t)?(0,l6.of)({snapshot:null}):e.observeForPreview({_type:"reference",_ref:cs(n)},t),l=e.observeForPreview({_type:"reference",_ref:cd(n)},t);return(0,ao.a)([r,l]).pipe((0,ag.U)(e=>{let[t,n]=e;return{draft:t.snapshot?{title:i,...t.snapshot||{}}:null,isLoading:!1,published:n.snapshot?{title:i,...n.snapshot||{}}:null}}),(0,ak.O)({draft:null,isLoading:!0,published:null}))}let fQ=e=>({title:(0,lG.jsx)("em",{children:e.title?String(e.title):"Missing document"}),subtitle:(0,lG.jsx)("em",{children:e.title?"Missing document ID: ".concat(e._id):"Document ID: ".concat(e._id)}),media:()=>(0,lG.jsx)(a8.foC,{})}),f0=e=>{let{value:t,draft:n,published:i}=e,r=n||i;return r?s7()({},r,t,(e,t)=>void 0===t?e:t):fQ(t)},f1=["_id","_rev","_type"],f2=[...f1,"_key"],f3={available:!0,reason:"READABLE"},f4={available:!1,reason:"PERMISSION_DENIED"},f5={available:!1,reason:"NOT_FOUND"},f6={title:"Invalid preview config",subtitle:"Check the error log in the console",media:(0,lG.jsx)(a8.foC,{})};function f8(e){return Object.keys(e)}let f9=["_id","_type","_upload","_createdAt","_updatedAt"],f7=[],me=(r={},{add:(e,t,n)=>{r[e.name]||(r[e.name]=[]),r[e.name].push({error:n,type:e,value:t})},getAll:()=>r,clear(){r={}}}),mt=l2()(()=>{let e=me.getAll(),t=ow()(Object.keys(e).map(t=>{let n=e[t];return oC()(n,e=>e.error.message)})).length;0!==t&&(console.groupCollapsed("%cHeads up! Got ".concat(1===t?"error":"".concat(t," errors")," while preparing data for preview. Click for details."),"color: #ff7e7c"),Object.keys(e).forEach(t=>{let n=e[t],i=n[0];console.group('Check the preview config for schema type "'.concat(t,'": %o'),i.type.preview),oC()(n,e=>e.error.message).forEach(e=>{var t;if("returnValueError"===e.error.type){let n="function"==typeof(null==(t=e.type.preview)?void 0:t.prepare),{value:i,error:r}=e;console.log("Encountered an invalid ".concat(n?"return value when calling prepare(%o)":"value targeted by preview.select",":"),i),console.error(r)}if("prepareError"===e.error.type){let{value:t,error:n}=e;console.log("Encountered an error when calling prepare(%o):",t),console.error(n)}}),console.groupEnd()}),console.groupEnd(),me.clear())},1e3),mn=e=>t=>{let n=typeof t;return null===t||"undefined"===n||"string"===n||"number"===n||"boolean"===n?f7:[ml("returnValueError",Error('The "'.concat(e,'" field should be a string, number, boolean, undefined or null, instead saw ').concat(mr(t))))]},mi={media:()=>f7,title:mn("title"),subtitle:mn("subtitle"),description:mn("description"),imageUrl:mn("imageUrl"),date:mn("date")};function mr(e){let t=!(arguments.length>1)||void 0===arguments[1]||arguments[1];if(cg(e)){let n=Object.keys(e),i=n.length>3?"...":"";return"".concat(t?"object with keys ":"","{").concat(n.slice(0,3).join(", ")).concat(i,"}")}if(Array.isArray(e)){let n=e.length>3?"...":"";return"".concat(t?"array with ":"","[").concat(e.map(e=>mr(e,!1))).concat(n,"]")}return"the ".concat(typeof e," ").concat(e)}function ml(e,t){return Object.assign(t,{type:e})}function ma(e,t){var n;let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=null==(n=e.preview)?void 0:n.prepare;try{return{returnValue:r?r(t,i):f8(t).reduce((e,n)=>{let i=t[n];return{...e,[n]:Array.isArray(i)&&(0===i.length||i.some(lX.DG))?function(e){let t=Array.isArray(e)&&e.find(lX.DG);return t&&t.children?t.children.filter(lX.NG).map(e=>e.text).join(""):""}(i):i}},{}),errors:f7}}catch(e){return{returnValue:null,errors:[ml("prepareError",e)]}}}function mo(e,t,n){return e.errors.forEach(e=>me.add(t,n,e)),mt(),f6}function ms(e,t){var n,i,r,l;let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o="function"==typeof(null==(n=t.preview)?void 0:n.prepare),s=(null==(i=t.preview)?void 0:i.select)||{},d=Object.keys(s).reduce((n,i)=>{var r;let l="fields"in t?t:null,a=s[i],d=null==(r=null==l?void 0:l.fields)?void 0:r.find(e=>e.name===a),c=d&&function(e){if(function(e){let t=!!e.options&&"object"==typeof e.options&&e.options;return!!t&&"list"in t&&Array.isArray(t.list)}(e))return e.options.list.map(e=>(0,lX.n4)(e)?e:{title:e,value:e})}(d.type);if(!o&&c){let t=c&&c.find(t=>t.value===ob()(e,s[i]));n[i]=t?t.value:ob()(e,s[i])}else n[i]=ob()(e,s[i]);return n},{}),c=ma(t,d,a);if(c.errors.length>0)return mo(c,t,d);let u={...r=ma(t,d,a),errors:[...r.errors||[],...(l=r.returnValue,sU()(l)&&null!==l?Object.entries(l).reduce((e,t)=>{let[n,i]=t;return[...e,...function(e,t){if(void 0===t)return f7;let n=mi[e];return n&&n(t)||f7}(n,i)]},f7):[ml("returnValueError",Error("Invalid return value. Expected a plain object with at least a 'title' field, instead saw ".concat(mr(l))))])]};return u.errors.length>0?mo(u,t,d):{...s8()(e,f9),...c.returnValue}}function md(e,t){let n;let i={},r=0;return function(){for(var e=arguments.length,a=Array(e),o=0;o<e;o++)a[o]=arguments[o];return new al.y(e=>{clearTimeout(n),n=setTimeout(l,t);let o={args:a,observer:e,completed:!1};return i[r++]=o,()=>{o.completed=!0}})};function l(){let t=i;i={};let n=Object.keys(t).filter(e=>{let n=t[e];return n&&!n.completed});0!==n.length&&e(n.map(e=>{let n=t[e];return n&&n.args}).filter(cr)).subscribe({next(e){e.forEach((i,r)=>{let l=t[n[r]];l&&!l.completed&&l.observer.next(e[r])})},complete(){n.forEach(e=>{let n=t[e];n&&!n.completed&&n.observer.complete()})},error(e){n.forEach(n=>{let i=t[n];i&&!i.completed&&i.observer.error(e)})}})}}function mc(e,t){return e.push(...t),e}function mu(e,t){function n(e){return t({_ref:e},[["_rev"]]).pipe((0,ag.U)(e=>cg(e)&&!!("_rev"in e&&(null==e?void 0:e._rev))),(0,ax.x)(),(0,ab.w)(t=>t?(0,l6.of)(f3):i(e)))}let i=md(function(e){let t=[...new Set(ow()(e))];return(0,as.D)(function(e){let t=[],n=0,i=[];for(let r of e)n+r.length+1>=11164&&(i.push(t),t=[],n=0),n+=r.length+1,t.push(r);return i.includes(t)||i.push(t),i}(t)).pipe((0,aT.z)(r,10),(0,aO.u)(mc,[]),(0,ag.U)(n=>e.map(e=>{let[i]=e;return n[t.indexOf(i)]})))},1);function r(t){return(0,at.P)(()=>{let n={uri:e.getDataUrl("doc",t.join(",")),json:!0,query:{excludeContent:"true"},tag:"preview.documents-availability"};return e.observable.request(n).pipe((0,ag.U)(e=>{let n=sl()(e.omitted||[],e=>e.id);return t.map(e=>{let t=n[e];if(!t)return f3;if("existence"===t.reason)return f5;if("permission"===t.reason)return f4;throw Error('Unexpected reason for omission: "'.concat(t.reason,'"'))})}))})}return{observeDocumentPairAvailability:function(e){let t=cs(e),i=cd(e);return(0,ao.a)([n(t),n(i)]).pipe((0,ax.x)(a6()),(0,ag.U)(e=>{let[t,n]=e;return{draft:t,published:n}}))}}}function mp(e){return JSON.stringify(e)}let mh=e=>cC(e)?'"'.concat(e,'": @').concat(c_(e)):e;function mf(e){let{ids:t,fields:n}=e,i=[...f1,...n];return"*[_id in [".concat(t.map(mp).join(","),"]][0...").concat(t.length,"]{").concat(i.map(mh).join(","),"}")}let mm=e=>e,mg=e=>!!(e.type&&"document"===e.type.name),mx=e=>e.name.startsWith("sanity."),mv=e=>e.getTypeNames().map(t=>e.get(t)).filter(cr).filter(e=>mg(e)).filter(e=>!mx(e)),mb=(e,t)=>{let{phrases:n,words:i}=function(e){let t=sh()(e.map(sd())),[n,i]=so()(t,e=>/^".*"$/.test(e));return{phrases:sh()(n).map(sd()).map(mj),words:sh()(i.map(sd()))}}(e),[r,l]=function(e,t){let n=t.toLowerCase().trim(),i=0,r=0;return e.forEach(e=>{n.includes(e)&&(i+=e.length/n.length,r+=e.length)}),1===i?[1,"[Phrase] Exact match"]:[i/2,"[Phrase] Matched ".concat(r," of ").concat(n.length," characters")]}(n,t),[a,o]=function(e,t){let n=sh()(st()(sm()(sd()(t)))),i=si()(e,n),r=su()(n,e),l=i.length/r.length;return 1===l?[1,"[Word] Exact match"]:[l/2,"[Word] Matched ".concat(i.length," of ").concat(r.length," terms: [").concat(i.join(", "),"]")]}(i,t);return[r+a,[o,l].join(", ")]},my=e=>"string"==typeof e?e:JSON.stringify(e);function mj(e){return e.replace(/^"(.*)"$/,"$1")}let mw=/([^!@#$%^&*(),\\/?";:{}|[\]+<>\s-])+/g,mk=/(^[.]+)|([.]+$)/,mC=sx()([ow(),su(),st()]);function m_(e,t){let n=!1;return{specs:e.map(e=>({typeName:e.name,paths:e.__experimental_search.map(e=>{let i=e.path.map(e=>"number"==typeof e&&(n=!0,t)?[]:e);return{weight:e.weight,path:cE(i),mapWith:e.mapWith}})})),hasIndexedPaths:n}}let mS=e=>{let{mapWith:t,path:n}=e;return t?"".concat(t,"(").concat(n,")"):n};function mT(e){var t,n;let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{filter:r,params:l,tag:a}=i,{specs:o,hasIndexedPaths:s}=m_(e.types,!1),d=function(e){let t=[],n=e.replace(/("[^"]*")/g,e=>sm()(e).length>1?(t.push(e),""):e);return[...t.map(e=>sb()(sd()(e))),...sh()(st()((sd()(n).match(mw)||[]).map(e=>e.replace(mk,""))))]}(e.query),c=s?m_(e.types,!0).specs:o,u=["_type in $__types",!1===i.includeDrafts&&"!(_id in path('drafts.**'))",...function(e,t){let n=mC(t.map(e=>(e.paths||[]).map(e=>mS(e))));return e.map((e,t)=>n.map(e=>"".concat(e," match $t").concat(t))).filter(e=>e.length>0).map(e=>"(".concat(e.join(" || "),")"))}(d,c),r?"(".concat(r,")"):"",e.filter?"(".concat(e.filter,")"):""].filter(Boolean),p=o.map(e=>{let t='_type == "'.concat(e.typeName,'" => '),n="{ ".concat(e.paths.map((e,t)=>'"w'.concat(t,'": ').concat(mS(e)))," }");return"".concat(t).concat(n)}),h=((null==i?void 0:i.sort)||[{field:"_id",direction:"asc"}]).map(e=>[e.mapWith?"".concat(e.mapWith,"(").concat(e.field,")"):e.field,(e.direction||"").toLowerCase()].map(e=>e.trim()).filter(Boolean).join(" ")).join(","),f=["_type","_id"],m=p.length>0?"...select(".concat(p.join(",\n"),")"):"",g=f.join(", ")+(m?", ".concat(m):""),x="*[".concat(u.join(" && "),"]")+"| order(".concat(h,")")+"[$__offset...$__limit]"+"{".concat(g,"}");if(null==i?void 0:i.__unstable_extendedProjection){let e=null==i?void 0:i.__unstable_extendedProjection,t=f.concat(e).join(", ");x=["*[".concat(u.join(" && "),"]{").concat(t,"}"),"order(".concat(h,")[$__offset...$__limit]{").concat(g,"}")].join("|")}let v=["findability-mvi:".concat(4)].concat((null==i?void 0:i.comments)||[]).map(e=>"// ".concat(e)).join("\n"),b=v?"".concat(v,"\n").concat(x):x,y=null!=(t=null==i?void 0:i.offset)?t:0,j=(null!=(n=null==i?void 0:i.limit)?n:1e3)+y;return{query:b,params:{...mE(d),__types:o.map(e=>e.typeName),__limit:j,__offset:y,...l||{}},options:{tag:a},searchSpec:o,terms:d}}let mE=e=>e.reduce((e,t,n)=>(e["t".concat(n)]="".concat(t,"*"),e),{});function mP(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return function(i){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{query:l,params:a,options:o,searchSpec:s,terms:d}=mT("string"==typeof i?{query:i,types:e}:i.types.length?i:{...i,types:e},{...n,...r});return t.observable.fetch(l,a,o).pipe(n.unique?(0,ag.U)(cu):(0,am.b)(),(0,ag.U)(e=>(function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],i=sl()(e,e=>e.typeName);return t.map((e,r)=>{var l;let a=null==(l=i[e._type].paths||[])?void 0:l.map((t,i)=>{let r=my(e["w".concat(i)]);if(!r)return{path:t.path,score:0,why:"No match"};let[l,a]=mb(n,r);return{path:t.path,score:l*t.weight,why:"".concat(a," (*").concat(t.weight,")")}}),o=a.reduce((e,t)=>e+t.score,0);return{hit:e,resultIndex:t.length-r,score:o,stories:a}})})(s,e,d)),(null==r?void 0:r.skipSortByScore)?(0,am.b)():(0,ag.U)(e=>a2()(e,e=>-e.score)))}}let mA={available:!0,reason:"READABLE"},mO={available:!1,reason:"PERMISSION_DENIED"},mz={available:!1,reason:"NOT_FOUND"};function mM(e,t,n){let{publishedId:i,draftId:r}=co(t);return e.unstable_observeDocumentPairAvailability(t).pipe((0,ab.w)(l=>{if(!l.draft.available&&!l.published.available){let e="PERMISSION_DENIED"===l.draft.reason||"PERMISSION_DENIED"===l.published.reason?mO:mz;return(0,l6.of)({id:t,type:void 0,availability:e,preview:{draft:void 0,published:void 0}})}let a={_type:"reference",_ref:r},o={_type:"reference",_ref:i};return(0,ao.a)([e.observeDocumentTypeFromId(r),e.observeDocumentTypeFromId(i)]).pipe((0,ag.U)(e=>{let[t,n]=e;return t||n})).pipe((0,ab.w)(s=>{if(!s)return(0,l6.of)({id:t,type:void 0,availability:{available:!0,reason:"READABLE"},preview:{draft:void 0,published:void 0}});let d=n.to.find(e=>e.name===s);if(!d)return(0,l6.of)({id:t,type:s,availability:{available:!0,reason:"READABLE"},preview:{draft:void 0,published:void 0}});let c=[...fG(null==d?void 0:d.preview)||[],["_updatedAt"],["_createdAt"]],u=e.observePaths(a,c).pipe((0,ag.U)(e=>e?{_id:r,...ms(e,d)}:void 0),(0,ak.O)(void 0)),p=e.observePaths(o,c).pipe((0,ag.U)(e=>e?{_id:i,...ms(e,d)}:void 0),(0,ak.O)(void 0));return(0,ao.a)([u,p]).pipe((0,ag.U)(e=>{let[t,n]=e;return{draft:t,published:n}})).pipe((0,ag.U)(e=>({type:s,id:i,availability:l.draft.available||l.published.available?mA:"PERMISSION_DENIED"===l.draft.reason||"PERMISSION_DENIED"===l.published.reason?mO:mz,preview:{draft:cg(e.draft)?e.draft:void 0,published:cg(e.published)?e.published:void 0}})))}))}))}function mI(e,t,n,i){return mP(n.to,e,i)(t,{includeDrafts:!0}).pipe((0,ag.U)(e=>e.map(e=>e.hit)),(0,ag.U)(cc),(0,ag.U)(e=>e.slice(0,100)),(0,aT.z)(t=>{var n;return(0===(n=t.filter(e=>!e.draft||!e.published).map(e=>e.draft?e.id:cs(e.id))).length?(0,l6.of)([]):e.observable.fetch("*[_id in $ids]._id",{ids:n},{tag:"get-counterpart-ids"})).pipe((0,ag.U)(e=>t.map(t=>{let n=cs(t.id);return{id:t.id,type:t.type,draft:t.draft||e.includes(n)?{_id:n,_type:t.type}:void 0,published:t.published||e.includes(t.id)?{_id:t.id,_type:t.type}:void 0}})))}))}function mR(){let e=[];return{publish(t){for(let n of e)n(t)},subscribe:t=>(e.push(t),()=>{let n=e.indexOf(t);n>-1&&e.splice(n,1)})}}let mF=Symbol.for("sanity.patch");function mD(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return{patchType:mF,type:"setIfMissing",path:t,value:e}}function mZ(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];return{patchType:mF,type:"insert",path:n,position:t,items:e}}function mL(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return{patchType:mF,type:"set",path:t,value:e}}function mq(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return{patchType:mF,type:"unset",path:e}}class mN{static from(e){return e instanceof mN?e:new mN(Array.isArray(e)?ow()(e):[e])}constructor(e){this.patches=e}prepend(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return mN.from([...ow()(t),...this.patches])}append(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return mN.from([...this.patches,...ow()(t)])}prefixAll(e){return mN.from(this.patches.map(t=>({...t,path:[e,...t.path]})))}}var mV=Object.freeze,mU=Object.defineProperty;let mB={warning:"caution",error:"critical"},mK=(0,a0.ZP)(l4.xu)(ty||(ty=mV(mU(d=["\n  border-top: 1px solid var(--card-border-color);\n"],"raw",{value:mV(d.slice())}))));function mH(e){let{children:t,status:n="warning",suffix:i,title:r,...l}=e;return(0,lG.jsxs)(l4.Zb,{radius:2,tone:mB[n],...l,"data-ui":"Alert",children:[(0,lG.jsxs)(l4.kC,{padding:4,children:[(0,lG.jsx)(l4.xu,{children:(0,lG.jsxs)(l4.xv,{size:1,children:["warning"===n&&(0,lG.jsx)(a8.foC,{}),"error"===n&&(0,lG.jsx)(a8.uIy,{})]})}),(0,lG.jsxs)(l4.xu,{flex:1,marginLeft:3,children:[(0,lG.jsx)(l4.xv,{size:1,weight:"semibold",children:r}),t&&(0,lG.jsx)(l4.xu,{marginTop:3,children:t})]})]}),i&&(0,lG.jsx)(mK,{children:i})]})}function mW(e,t){let n=(0,lJ.useRef)(t||null);return(0,lJ.useEffect)(()=>{n.current=e},[e]),n.current}function m$(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:a6(),i=mW(e);(0,lJ.useEffect)(()=>{n(i,e)||t(i,e)},[t,e,i,n])}function mX(e,t){(0,lJ.useEffect)(()=>{let n=n=>{let i=n.target;if(i instanceof HTMLElement){if(e.some(e=>{var t;return null==(t=e.current)?void 0:t.contains(i)}))return;t(n)}};return document.addEventListener("mousedown",n),document.addEventListener("touchstart",n),()=>{document.removeEventListener("mousedown",n),document.removeEventListener("touchstart",n)}},[e,t])}let mG=(0,lJ.createContext)(null);function mY(){let e=(0,lJ.useContext)(mG);if(!e)throw Error("FormBuilder: missing context value");return e}let mJ={constrainSize:!0,portal:!0,fallbackPlacements:["top","bottom"]};function mQ(e){let{schemaType:t,readOnly:n,children:i,onValueCreate:r,onItemAppend:l}=e,a=(0,lJ.useId)(),o=(0,lJ.useCallback)(e=>{l(r(e))},[r,l]),s=lJ.useCallback(()=>{o(t.of[0])},[t,o]);return n?(0,lG.jsx)(l4.u,{portal:!0,content:(0,lG.jsx)(l4.xu,{padding:2,sizing:"border",children:(0,lG.jsx)(l4.xv,{size:1,children:"This field is read-only"})}),children:(0,lG.jsx)(l4.rj,{children:(0,lG.jsx)(l4.zx,{icon:a8.dtP,mode:"ghost",disabled:!0,text:1===t.of.length?"Add item":"Add item..."})})}):(0,lG.jsxs)(l4.rj,{gap:1,style:{gridTemplateColumns:"repeat(auto-fit, minmax(100px, 1fr))"},children:[1===t.of.length?(0,lG.jsx)(l4.zx,{icon:a8.dtP,mode:"ghost",onClick:s,text:"Add item"}):(0,lG.jsx)(l4.j2,{button:(0,lG.jsx)(l4.zx,{icon:a8.dtP,mode:"ghost",text:"Add item…"}),id:a||"",menu:(0,lG.jsx)(l4.v2,{children:t.of.map((e,t)=>{var n,i;let r=(0,lX.dD)(e)&&1===(e.to||[]).length&&e.to[0].icon,l=e.icon||(null==(n=e.type)?void 0:n.icon)||r;return(0,lG.jsx)(l4.sN,{text:e.title||(null==(i=e.type)?void 0:i.name),onClick:()=>o(e),icon:l},t)})}),popover:mJ}),i]})}var m0=Object.freeze,m1=Object.defineProperty,m2=(e,t)=>m0(m1(e,"raw",{value:m0(t||e.slice())}));let m3=e=>"error"===e?(0,lG.jsx)(a8.uIy,{}):"warning"===e?(0,lG.jsx)(a8.foC,{}):(0,lG.jsx)(a8.hQ6,{}),m4=(0,a0.ZP)(l4.xv)(e=>{let{theme:t}=e;return(0,a0.iv)(tj||(tj=m2(["\n    &[data-info] {\n      color: ",";\n    }\n\n    &[data-warning] {\n      color: ",";\n    }\n\n    &[data-error] {\n      color: ",";\n    }\n  "])),t.sanity.color.muted.primary.enabled.fg,t.sanity.color.muted.caution.enabled.fg,t.sanity.color.muted.critical.enabled.fg)});function m5(e){let{markers:t,validation:n,renderCustomMarkers:i}=e,{CustomMarkers:r}=mY().__internal.components;return 0===t.length&&0===n.length?null:(0,lG.jsxs)(l4.Kq,{space:1,children:[n.length>0&&n.map((e,t)=>{let{message:i,level:r}=e;return(0,lG.jsxs)(l4.kC,{children:[(0,lG.jsx)(l4.xu,{marginRight:2,marginBottom:t+1===n.length?0:2,children:(0,lG.jsx)(m4,{size:1,"data-error":"error"===r?"":void 0,"data-warning":"warning"===r?"":void 0,"data-info":"info"===r?"":void 0,children:m3(r)})}),(0,lG.jsx)(l4.xu,{children:(0,lG.jsx)(l4.xv,{size:1,children:i||"Error"})})]},"validationItem-".concat(t))}),t.length>0&&(0,lG.jsxs)(l4.xu,{marginTop:n.length>0?3:0,children:[i&&i(t),!i&&(0,lG.jsx)(r,{markers:t})]})]})}function m6(){return(0,lG.jsxs)(l4.xv,{size:1,children:["This is a example custom marker, please implement ",(0,lG.jsx)("code",{children:"renderCustomMarkers"})," function."]})}let m8=lJ.createContext(null),m9=(0,lJ.memo)(function(e){let t=(0,lJ.useRef)(e);t.current=e;let n=(0,lJ.useCallback)(e=>{var n,i,r;return null!=(r=null==(i=null==(n=t.current)?void 0:n.transformPatches)?void 0:i.call(n,e))?r:[]},[t]),i=(0,lJ.useCallback)(e=>{t.current.onChange(e)},[]),r=(0,lJ.useCallback)(e=>{t.current.onPathFocus(e)},[]),l=(0,lJ.useCallback)(e=>{t.current.onPathBlur(e)},[]),a=(0,lJ.useCallback)(e=>{t.current.onPathOpen(e)},[]),o=(0,lJ.useCallback)((e,n)=>{t.current.onSetPathCollapsed(e,n)},[]),s=(0,lJ.useCallback)((e,n)=>{t.current.onSetFieldSetCollapsed(e,n)},[]),d=(0,lJ.useCallback)((e,n)=>{t.current.onFieldGroupSelect(e,n)},[]),c=(0,lJ.useMemo)(()=>({transformPatches:n,onChange:i,onPathFocus:r,onPathBlur:l,onPathOpen:a,onSetPathCollapsed:o,onSetFieldSetCollapsed:s,onFieldGroupSelect:d}),[i,d,l,r,a,s,o,n]);return(0,lG.jsx)(m8.Provider,{value:c,children:e.children})});function m7(){let e=(0,lJ.useContext)(m8);if(!e)throw Error("Form context not provided");return e}function ge(e,t){return function e(t,n,i){if(t===n)return t;if(i.has(n)||null==t||null==n||typeof t!=typeof n)return n;if(Array.isArray(n)){i.add(n);let r=t.length===n.length,l=[];for(let a=0;a<n.length;a++){let o=e(t[a],n[a],i);o!==t[a]&&(r=!1),l[a]=o}return r?t:l}if("object"==typeof n){i.add(n);let r=Object.keys(n),l=Object.keys(t).length===r.length,a={};for(let o of r){let r=e(t[o],n[o],i);r!==t[o]&&(l=!1),a[o]=r}return l?t:a}return n}(e,t,new WeakSet)}let gt=(0,lJ.createContext)([]);function gn(e){return(0,lG.jsx)(gt.Provider,{value:e.presence,children:e.children})}function gi(e,t){let n=function(){let e=(0,lJ.useContext)(gt);if(!e)throw Error("Form context not provided");return e}(),i=(0,lJ.useRef)(n),r=ge(i.current,n.filter(n=>(0,lY.Ny)(e,n.path)&&(t||!(0,lY.Xy)(e,n.path))));return i.current=r,r}let gr=(0,lJ.createContext)([]);function gl(e){return(0,lG.jsx)(gr.Provider,{value:e.validation,children:e.children})}function ga(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=function(){let e=(0,lJ.useContext)(gr);if(!e)throw Error("Form context not provided");return e}();return(0,lJ.useMemo)(()=>n.filter(n=>(0,lY.Ny)(e,n.path)&&(t||!(0,lY.Xy)(e,n.path))).map(e=>({message:e.item.message,level:e.level,path:e.path})),[t,e,n])}function go(e){let{action:t}=e,n=(0,lJ.useCallback)(()=>{t.onAction()},[t]),i="object"==typeof t.disabled&&(0,lG.jsx)(l4.xv,{size:1,children:t.disabled.reason});return(0,lG.jsx)(p8,{content:i,placement:"left",children:(0,lG.jsx)(l4.sN,{disabled:!!t.disabled,fontSize:1,icon:t.icon,iconRight:t.iconRight||(t.selected?a8.KML:void 0),onClick:n,padding:3,pressed:t.selected,space:3,text:t.title,tone:t.tone})})}let gs={placement:"right",fallbackPlacements:["top","bottom"]};function gd(e){let{group:t}=e;return t.expanded?(0,lG.jsxs)(lG.Fragment,{children:[(0,lG.jsx)(l4.xu,{padding:2,paddingBottom:1,children:(0,lG.jsx)(l4.__,{muted:!0,size:0,children:t.title})}),t.children.map((e,n)=>{var i;return(0,lG.jsx)(gc,{action:e,isFirst:0===n,prevIsGroup:(null==(i=t.children[n-1])?void 0:i.type)==="group"},n)})]}):(0,lG.jsx)(l4.kS,{fontSize:1,icon:t.icon,padding:3,popover:gs,space:3,text:t.title,tone:t.tone,children:t.children.map((e,n)=>{var i;return(0,lG.jsx)(gc,{action:e,isFirst:0===n,prevIsGroup:(null==(i=t.children[n-1])?void 0:i.type)==="group"},n)})})}function gc(e){let{action:t,isFirst:n,prevIsGroup:i}=e;return"divider"===t.type?(0,lG.jsx)(l4.R,{}):"group"===t.type?(0,lG.jsxs)(lG.Fragment,{children:[!n&&(0,lG.jsx)(l4.R,{}),(0,lG.jsx)(gd,{group:t})]}):(0,lG.jsxs)(lG.Fragment,{children:[i&&(0,lG.jsx)(l4.R,{}),(0,lG.jsx)(go,{action:t})]})}let gu={placement:"top"};function gp(e){return"renderAsButton"in e&&e.renderAsButton}let gh=(0,lJ.memo)(function(e){let{nodes:t,onMenuOpenChange:n}=e,[i,r]=(0,lJ.useState)(!1),l=(0,lJ.useCallback)(()=>{n(!0),r(!0)},[n]),a=(0,lJ.useCallback)(()=>{n(!1),r(!1)},[n]),o=(0,lJ.useMemo)(()=>t.filter(gp),[t]),s=(0,lJ.useMemo)(()=>t.filter(e=>!gp(e)),[t]),d=(0,lJ.useMemo)(()=>{let e=s.length;if(0===e||e>1)return s;let t=s[0];return"group"===t.type?[{...t,expanded:!0}]:s},[s]),c=(0,lJ.useMemo)(()=>[...d.length?[{type:"group",children:d,icon:a8.zGg,title:"Field actions"}]:[],...o],[o,d]);return(0,lG.jsx)(lG.Fragment,{children:c.map((e,t)=>(0,lG.jsx)(gf,{node:e,onOpen:l,onClose:a,open:i},t))})}),gf=(0,lJ.memo)(function(e){let{node:t,onOpen:n,onClose:i,open:r}=e;return"divider"===t.type?(0,lG.jsx)(l4.Zb,{borderLeft:!0,flex:"none"}):"action"===t.type?(0,lG.jsx)(p1,{fontSize:1,icon:t.icon,label:r?void 0:t.title,mode:"bleed",onClick:t.onAction,padding:2,tooltip:gu}):(0,lG.jsx)(gg,{node:t,onOpen:n,onClose:i,open:r})}),gm={constrainSize:!0,placement:"right",portal:!0,fallbackPlacements:["top","bottom"]};function gg(e){let{node:t,onOpen:n,onClose:i,open:r}=e;return(0,lG.jsx)(l4.j2,{button:(0,lG.jsx)(p1,{fontSize:1,icon:t.icon,label:r?void 0:t.title,mode:"bleed",padding:2,tooltip:gu}),id:(0,lJ.useId)(),menu:(0,lG.jsx)(l4.v2,{children:t.children.map((e,n)=>{var i;return(0,lG.jsx)(gc,{action:e,isFirst:0===n,prevIsGroup:(null==(i=t.children[n-1])?void 0:i.type)==="group"},n)})}),onOpen:n,onClose:i,popover:gm})}let gx=(0,lJ.memo)(function(e){let{actions:t,documentId:n,documentType:i,onActions:r,path:l,schemaType:a}=e,o=t.length,s=(0,lJ.useRef)(o),[d,c]=(0,lJ.useState)(()=>Array.from(Array(o))),u=(0,lJ.useRef)(d),p=(0,lJ.useCallback)((e,t)=>{c(n=>{let i=[...n];return i[e]=t,i})},[]);return(0,lJ.useEffect)(()=>{u.current!==d&&(u.current=d,r(function e(t){return t.filter(Boolean).filter(e=>!("hidden"in e)||!0!==e.hidden).map(t=>"group"===t.type?{...t,children:e(t.children)}:t)}(d)))},[d,r]),(0,lJ.useEffect)(()=>{if(s.current!==o){let e=Array.from(Array(o));for(let t=0;t<o;t++)e[t]=u.current[t];s.current=o,c(e),u.current=e}},[o]),(0,lG.jsx)(lG.Fragment,{children:t.map((e,t)=>(0,lG.jsx)(gv,{action:e,index:t,documentId:n,documentType:i,path:l,schemaType:a,setFieldAction:p},t))})}),gv=(0,lJ.memo)(function(e){let{action:t,documentId:n,documentType:i,index:r,path:l,schemaType:a,setFieldAction:o}=e,s=cn(t.useAction({documentId:n,documentType:i,path:l,schemaType:a}));return(0,lJ.useEffect)(()=>{o(r,s)},[r,s,o]),null}),gb=(0,lJ.createContext)(null);function gy(){let e=(0,lJ.useContext)(gb);if(!e)throw Error("UserColorManager: missing context value");return e}let gj=["green","red","gray"],gw=or.mE.filter(e=>!gj.includes(e)),gk=e=>{let t="dark"===e;return{background:t?"900":"100",border:t?"700":"300",text:t?"200":"700"}},gC=e=>{let{background:t,border:n,text:i}=gk(e);return gw.reduce((e,r)=>(e[r]={name:r,background:or.VG[r][t].hex,border:or.VG[r][n].hex,text:or.VG[r][i].hex,tints:or.VG[r]},e),{})},g_=e=>{let{background:t,border:n,text:i}=gk(e);return{name:"gray",background:or.VG.gray[t].hex,border:or.VG.gray[n].hex,text:or.VG.gray[i].hex,tints:or.VG.gray}};function gS(e){let{children:t,manager:n}=e,{scheme:i}=R8(),r=(0,lJ.useMemo)(()=>n||function(e){let t;let{anonymousColor:n,colors:i,currentUserColor:r,scheme:l}=e,a=i||gC(l),o=n||g_(l),s=r||"purple";if(!a.hasOwnProperty(s))throw Error("'colors' must contain 'currentUserColor' (".concat(s,")"));let d=Object.keys(a),c=new Map,u=new Map,p=d.reduce((e,t)=>(e[t]=0,e),{}),h=new Map;return(null==e?void 0:e.userStore)&&e.userStore.me.subscribe(e=>{var n;t=n=e?e.id:null,p[s]+=n?1:-1}),{get:function(e){return e?a[f(e)]:o},listen:function(e){let t=c.get(e);if(t)return t;let n=f(e);return t=new al.y(t=>{let i=a[n];return t.next(i),()=>{c.delete(e),h.delete(e),p[n]--}}).pipe((0,aw.d)({refCount:!0})),c.set(e,t),t}};function f(e){let n,i;if(e===t)return s;let r=h.get(e);if(r)return r;let l=u.get(e);if(l&&(0===p[l]||!d.find(e=>0===p[e])))return m(e,l);let a=function(e){let t=0;for(let n=0;n<e.length;n++)t=(t<<5)-t+e.charCodeAt(n)|0;return d[Math.abs(t)%d.length]}(e);return 0===p[a]?m(e,a):m(e,(n=1/0,i=[],d.forEach(e=>{let t=p[e];t===n?i.push(e):t<n&&(n=t,i=[e])}),l&&i.includes(l)?l:i[0]))}function m(e,t){return h.set(e,t),u.set(e,t),p[t]++,t}}({scheme:i}),[n,i]);return(0,lG.jsx)(gb.Provider,{value:r,children:t})}let gT=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,gE=/_key\s*==\s*['"](.*)['"]/;function gP(e){if(!Array.isArray(e))throw Error("Path is not an array");return e.reduce((e,t,n)=>{let i=typeof t;if("number"===i)return"".concat(e,"[").concat(t,"]");if("string"===i)return"".concat(e).concat(0===n?"":".").concat(t);if((0,lX.Fd)(t)&&t._key)return"".concat(e,'[_key=="').concat(t._key,'"]');if(Array.isArray(t)){let[n,i]=t;return"".concat(e,"[").concat(n,":").concat(i,"]")}throw Error("Unsupported path segment `".concat(JSON.stringify(t),"`"))},"")}function gA(e,t){let n=t[0];if(!n)return e;let i=t.slice(1);if((0,lX.dw)(n))return gA(Array.isArray(e)?e[n]:void 0,i);if((0,lX.Fd)(n))return gA(Array.isArray(e)?e.find(e=>e._key===n._key):void 0,i);if("string"==typeof n)return gA(cg(e)?e[n]:void 0,i);throw Error("Unknown segment type ".concat(JSON.stringify(n)))}function gO(e){return(0,lX.dw)(e)?Number(e.replace(/[^\d]/g,"")):(0,lX.Fd)(e)?function(e){let t=e.match(gE);if(!t)throw Error("Invalid key segment");return{_key:t[1]}}(e):(0,lX.lo)(e)?function(e){let[t,n]=e.split(":").map(e=>""===e?e:Number(e));return[t,n]}(e):e}function gz(e,t){return e.length===t.length&&e.every((e,n)=>{let i=t[n];return(0,lX.Fd)(e)&&(0,lX.Fd)(i)?e._key===i._key:(0,lX.dw)(e)?Number(e)===Number(i):(0,lX.lo)(e)&&(0,lX.lo)(i)?e[0]===i[0]&&e[1]===i[1]:e===i})}function gM(e){return(0,lX.fU)(e)?e._key:void 0}function gI(e){let t=gM(e);return t?{_key:t}:void 0}function gR(e,t){return e.get((null==t?void 0:t.author)||null)}function gF(e,t){return function(e,t){let n=function e(t,n){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];if(0===n.length)return t;let r=n[0],l=n.slice(1);if((0,lX.lo)(r))throw Error("Index tuples are not supported in diff paths");if((0,lX.dw)(r)||(0,lX.Fd)(r)){let n=(0,lX.dw)(r)?"at index ".concat(r):"with key ".concat(r._key);if("array"!==t.type){"Failed to get item ".concat(n," at path ").concat(gP(i)," (not an array)");return}let a=t.items.find((0,lX.dw)(r)?e=>e.toIndex===r:e=>(function(e,t){let n=e.diff;return"object"===n.type&&!!n.toValue&&n.toValue._key===t})(e,r));if(!a){"Failed to get item ".concat(n," at path ").concat(gP(i)," (item missing)");return}return e(a.diff,l,i.concat(r))}if("object"!==t.type){"Failed to get property ".concat(r," at path ").concat(gP(i)," (not an object)");return}let a=t.fields[r];if(void 0===a){"Failed to get property ".concat(r," at path ").concat(gP(i)," (field did not exist)");return}return e(a,l,i.concat(r))}(e,t);if(n&&"unchanged"!==n.action)return n.annotation||void 0}(e,Array.isArray(t)?t:function(e){let t=e.match(gT);if(!t)throw Error("Invalid path string");return t.map(gO)}(t))}function gD(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=gy(),i=(0,lJ.useMemo)(()=>gF(e,t),[e,t]);return(0,lJ.useMemo)(()=>gR(n,i),[i,n])}function gZ(e){if("diff"in e){let{diff:t,path:n=[],...i}=e,r=gF(t,n);return(0,lG.jsx)(gL,{...i,annotations:r?[r]:[]})}return(0,lG.jsx)(gL,{...e})}function gL(e){let{annotations:t,children:n,description:i="Changed",...r}=e;if(!t)return n;let l=(0,lG.jsxs)(l4.Kq,{padding:3,space:2,children:[(0,lG.jsx)(l4.__,{size:1,style:{textTransform:"uppercase"},children:i}),(0,lG.jsx)(l4.Kq,{space:2,children:t.map((e,t)=>(0,lG.jsx)(gq,{annotation:e},t))})]});return(0,lG.jsx)(ht,{zOffset:"paneFooter",children:(0,lG.jsx)(l4.u,{content:l,portal:!0,...r,children:n})})}function gq(e){let{annotation:t}=e,{author:n,timestamp:i}=t,[r]=No(n),l=gR(gy(),t),a=Nt(i,{minimal:!0});return(0,lG.jsxs)(l4.gF,{space:2,children:[(0,lG.jsxs)(l4.kC,{align:"center",paddingRight:3,style:{backgroundColor:l.background,color:l.text,borderRadius:"calc(23px / 2)"},children:[(0,lG.jsx)(UP,{user:n}),(0,lG.jsx)(l4.gF,{paddingLeft:2,children:(0,lG.jsx)(l4.xv,{muted:!0,size:1,style:{color:l.text},children:r?r.displayName:"Loading…"})})]}),(0,lG.jsx)(l4.xv,{as:"time",muted:!0,size:1,dateTime:i,children:a})]})}var gN=Object.freeze,gV=Object.defineProperty;let gU=(0,a0.ZP)(l4.Zb)(tw||(tw=gN(gV(c=["\n  --diff-card-radius: ",";\n  --diff-card-bg-color: ",";\n\n  max-width: 100%;\n  position: relative;\n  border-radius: var(--diff-card-radius);\n\n  &:not(del) {\n    text-decoration: none;\n  }\n\n  &[data-hover] {\n    &::after {\n      content: '';\n      display: block;\n      position: absolute;\n      left: 0;\n      right: 0;\n      bottom: 0;\n    }\n\n    &:hover {\n      border-bottom-left-radius: 0;\n      border-bottom-right-radius: 0;\n\n      &::after {\n        bottom: -3px;\n        border-top: 1px solid var(---diff-card-bg-color);\n        border-bottom: 2px solid currentColor;\n        border-bottom-left-radius: var(--diff-card-radius);\n        border-bottom-right-radius: var(--diff-card-radius);\n      }\n    }\n\n    [data-from-to-layout]:hover & {\n      border-bottom-left-radius: 0;\n      border-bottom-right-radius: 0;\n\n      &::after {\n        bottom: -3px;\n        border-top: 1px solid var(---diff-card-bg-color);\n        border-bottom: 2px solid currentColor;\n        border-bottom-left-radius: var(--diff-card-radius);\n        border-bottom-right-radius: var(--diff-card-radius);\n      }\n    }\n  }\n"],"raw",{value:gN(c.slice())}))),e=>{let{theme:t}=e;return(0,l4.hO)(t.sanity.radius[2])},e=>{let{theme:t}=e;return t.sanity.color.card.enabled.bg}),gB=[],gK=(0,lJ.forwardRef)(function(e,t){let{annotation:n,as:i="div",children:r,className:l,diff:a,disableHoverEffect:o,path:s=gB,style:d={},tooltip:c,...u}=e,p=(0,lJ.useMemo)(()=>n||gF(a,s),[n,a,s]),h=gR(gy(),p),f=(0,lG.jsx)(gU,{...u,as:i,className:l,"data-hover":o||!p?void 0:"",ref:t,radius:1,style:{...d,backgroundColor:h.background,color:h.text},children:r});return c&&p?(0,lG.jsx)(gZ,{annotations:[p],description:c&&"object"==typeof c&&c.description,children:f}):f});var gH=Object.freeze,gW=Object.defineProperty,g$=(e,t)=>gH(gW(e,"raw",{value:gH(t||e.slice())}));let gX=a0.ZP.div(tk||(tk=g$(["\n  border-radius: ",";\n  padding: ",";\n"])),e=>{let{theme:t}=e;return(0,l4.hO)(t.sanity.radius[2])},e=>{let{theme:t}=e;return(0,l4.hO)(t.sanity.space[1])}),gG=(0,a0.ZP)(l4.xv)(tC||(tC=g$(["\n  &:not([hidden]) {\n    color: inherit;\n  }\n"])));function gY(e){let{change:t,segment:n}=e;if("string"==typeof n)return(0,lG.jsx)(l4.xu,{children:(0,lG.jsx)(l4.xv,{title:n,size:1,weight:"semibold",textOverflow:"ellipsis",children:n})});let{hasMoved:i,fromIndex:r,toIndex:l,annotation:a}=n,o=void 0===l;if(void 0===r)return(0,lG.jsx)(gJ,{annotation:a,change:t,toIndex:l});if(o)return(0,lG.jsx)(gQ,{annotation:a,fromIndex:r});if(i&&void 0!==l&&void 0!==r)return(0,lG.jsx)(g0,{annotation:a,fromIndex:r,toIndex:l});let s=(l||0)+1;return(0,lG.jsx)(l4.xu,{padding:1,children:(0,lG.jsxs)(l4.xv,{size:1,weight:"semibold",children:["#",s]})})}function gJ(e){let{annotation:t,change:n,toIndex:i=0}=e,r=i+1,l="Added in position ".concat(r),a=(0,lG.jsxs)(lG.Fragment,{children:["#",r]}),o=((null==n?void 0:n.diff)?gF(n.diff,[]):void 0)||t;return o?(0,lG.jsx)(gK,{annotation:o,tooltip:{description:l},as:gX,children:(0,lG.jsx)(gG,{size:1,weight:"semibold",forwardedAs:"ins",style:{textDecoration:"none"},children:a})}):(0,lG.jsx)(l4.xv,{size:1,weight:"semibold",children:a})}function gQ(e){let{annotation:t,fromIndex:n=0}=e,i=n+1,r="Removed from position ".concat(i);return(0,lG.jsx)(gK,{annotation:t||null,as:gX,tooltip:{description:r},children:(0,lG.jsxs)(gG,{size:1,weight:"semibold",forwardedAs:"del",children:["#",i]})})}function g0(e){let{annotation:t,fromIndex:n,toIndex:i}=e,r=i-n,l=Math.abs(r),a="Moved ".concat(l," position").concat(1===l?"":"s"," ").concat(r<0?"up":"down");return(0,lG.jsxs)(lG.Fragment,{children:[(0,lG.jsx)(l4.xu,{padding:1,children:(0,lG.jsxs)(gG,{size:1,weight:"semibold",children:["#",i+1]})}),(0,lG.jsx)(gK,{annotation:t,as:gX,tooltip:{description:a},children:(0,lG.jsxs)(gG,{size:1,weight:"semibold",children:[r<0?"↑":"↓",Math.abs(r)]})})]})}function g1(e){let{change:t,titlePath:n}=e;return(0,lG.jsx)(l4.Oo,{maxLength:4,separator:(0,lG.jsx)(l4.xv,{muted:!0,size:1,children:(0,lG.jsx)(a8.XCv,{})}),children:n.map((e,n)=>"string"==typeof e||!t||t.showIndex?(0,lG.jsx)(gY,{change:t,segment:e},n):null)})}let g2=e=>{let{checkProperty:t=!1,checkPropertyKey:n,document:i,parent:r,value:l}=e,a=cn(l);return function(e,t,n){let{currentUser:i,document:r,parent:l,value:a}=n,o=(0,lJ.useRef)(!1);return(0,lJ.useMemo)(()=>{var n;let s=!1;if("boolean"==typeof e||void 0===e)return e||!1;try{s=e({document:r,parent:l,value:a,currentUser:i})}catch(e){return console.error("An error occurred while running the callback from `".concat(t,"`: ").concat(e.message)),!1}return cg(n=s)&&"function"==typeof(null==n?void 0:n.then)&&!o.current?(console.warn("The `".concat(t,"` option is either a promise or a promise returning function. Async callbacks for `").concat(t,"` option is not currently supported.")),!1):(void 0===s&&console.warn("The `".concat(t,"` option is or returned `undefined`. `").concat(t,"` should return a boolean.")),s)},[e,r,l,a,i,t])}(t,n,{currentUser:Ns(),document:i,parent:r,value:a})},g3=(0,lJ.createContext)({path:[]});function g4(e,t){let{jsonType:n}=t,i=Array.isArray(e)?"array":typeof e;if(null!==e&&"undefined"!==i){var r;if(i!==n)return{message:"Value is ".concat(i,", expected ").concat(n),value:e};if("object"===t.jsonType&&null!==(r=e)&&!Array.isArray(r)&&"object"==typeof r)for(let n of t.fields){let t=g4(e[n.name],n.type);if(t)return t}}}function g5(e,t){let n=(0,lX.ay)(t)?t._type:Array.isArray(t)?"array":null===t?"null":typeof t;return e.of.find(e=>e.name===n)||(1===e.of.length?e.of[0]:void 0)}let g6=[["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""]],g8=[["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""]],g9=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],g7=g8.map(e=>e[0]).concat(g6.map(e=>e[0])),xe=g8.map(e=>e[1]).concat(g6.map(e=>e[1])),xt=g7.concat(xe).concat(g9).concat("").concat("⁠"),xn=RegExp("".concat(xt.join("|")),"g"),xi=RegExp("".concat(xt.join("|"),"|\n"),"g");function xr(e){return"object"===e.jsonType&&"block"===e.name}function xl(e,t){return e.fields.children.items.filter(e=>e.diff.isChanged&&(e.diff.toValue===t||e.diff.fromValue===t)).map(e=>e.diff).map(e=>e)[0]}function xa(e,t){let n=e.find(e=>"children"===e.name);return n&&n.type&&"array"===n.type.jsonType&&n.type.of.find(e=>e.name===t._type)||void 0}function xo(e){return e.decorators?sC()(e.decorators,["value"],["asc"]):[]}function xs(e,t){return xo(t).some(t=>t.value===e)}function xd(e,t,n,i,r){return t?t.children.map(t=>{var l;let a=(0,lX.NG)(t)?null==(l=t.text)?void 0:l.replace(xn,""):"";if((0,lX.NG)(t)){let r=xu(e,t),l=null==r?void 0:r.fields.text;l&&l.toValue===t.text&&"string"===l.type&&"unchanged"!==l.action&&(a=l.segments.filter(e=>"removed"!==e.action).map(e=>e.text.replace(xn,"")).join("⁠")),t.marks&&t.marks.forEach(e=>{n[e]?a="".concat(n[e][0]).concat(a).concat(n[e][1]):i[e]&&(a="".concat(i[e][0]).concat(a).concat(i[e][1]))})}else a=r[t._key];return"".concat("").concat(a)}).join(""):""}function xc(e){let t=[...e.toValue?e.toValue.children.filter(e=>"span"!==e._type):[]];return(e.fromValue?e.fromValue.children.filter(e=>"span"!==e._type):[]).forEach(e=>{t.some(t=>e._key===t._key)||t.push(e)}),sC()(t,["_key"],["asc"])}function xu(e,t){let n=e.fields.children&&"unchanged"!==e.fields.children.action&&"array"===e.fields.children.type&&e.fields.children.items.find(e=>e.diff&&"object"===e.diff.type&&("removed"===e.diff.action?e.diff.fromValue&&e.diff.fromValue._key===t._key:(e.diff.toValue&&e.diff.toValue._key)===t._key));if(n)return n.diff}function xp(e){return e&&aG()(Object.keys(e),["_key","_type"])||!1}function xh(e){let t=[...e.toValue&&e.toValue.markDefs?e.toValue.markDefs:[]];return(e.fromValue&&e.fromValue.markDefs?e.fromValue.markDefs:[]).forEach(e=>{t.some(t=>e._key===t._key)||t.push(e)}),sC()(t,["_key"],["asc"])}let xf=[];function xm(e){let{checked:t,color:n}=e;return(0,lG.jsxs)("svg",{width:"17",height:"17",viewBox:"0 0 17 17",xmlns:"http://www.w3.org/2000/svg",fill:null==n?void 0:n.background,children:[(0,lG.jsx)("rect",{x:"0",y:"0",width:"17",height:"17",rx:"2.5"}),void 0===t&&(0,lG.jsx)("path",{d:"M4.07996 8.5H12.92",stroke:null==n?void 0:n.text,strokeWidth:"2"}),t&&(0,lG.jsx)("path",{d:"M3.5 8L7 11.5L13.5 5",stroke:null==n?void 0:n.text,strokeWidth:"2"})]})}function xg(e){let{checked:t,color:n}=e;return(0,lG.jsxs)("svg",{width:"38",height:"22",viewBox:"0 0 38 22",xmlns:"http://www.w3.org/2000/svg",children:[(0,lG.jsx)("rect",{width:"38",height:"22",rx:"11",fill:t?null==n?void 0:n.border:null==n?void 0:n.background}),void 0===t&&(0,lG.jsx)("rect",{x:"11",y:"3",width:"16",height:"16",rx:"8",fill:"white"}),t&&(0,lG.jsx)("rect",{x:"18",y:"3",width:"16",height:"16",rx:"8",fill:"white"}),"boolean"==typeof t&&!t&&(0,lG.jsx)("rect",{x:"4",y:"3",width:"16",height:"16",rx:"8",fill:"white"})]})}var xx=Object.freeze,xv=Object.defineProperty;let xb=a0.ZP.div(t_||(t_=xx(xv(u=["\n  display: inline-block;\n  word-wrap: break-word;\n"],"raw",{value:xx(u.slice())})))),xy=function(e){let{value:t,schemaType:n}=e;return(0,lG.jsx)(l4.xu,{as:xb,paddingX:2,paddingY:1,children:function(e,t){let{options:n,name:i}=t,r=(null==n?void 0:n.dateFormat)||"YYYY-MM-DD",l=(null==n?void 0:n.timeFormat)||"HH:mm";return sS.W(new Date(e),"date"===i?r:"".concat(r," ").concat(l))}(t,n)})},xj=e=>{let{diff:t,schemaType:n}=e;return(0,lG.jsx)(bh,{align:"center",diff:t,layout:"grid",previewComponent:xy,schemaType:n})},xw=(0,lJ.createContext)(null);function xk(){let e=(0,lJ.useContext)(xw);if(!e)throw Error("DocumentChange: missing context value");return e}function xC(e){let[t,n]=(0,lJ.useState)(void 0),i=qJ(fT);return(0,lJ.useEffect)(()=>{if(!e)return;let t=i.observable.getDocument(e).subscribe(n);return()=>{t.unsubscribe()}},[i,e]),e?t:void 0}var x_=Object.freeze,xS=Object.defineProperty;let xT=a0.ZP.div(tS||(tS=x_(xS(p=["\n  ","\n  &:not([hidden]) {\n    display: inline-block;\n  }\n\n  [data-number='positive'] {\n    color: var(--size-diff-positive);\n  }\n\n  [data-number='negative'] {\n    color: var(--size-diff-negative);\n  }\n"],"raw",{value:x_(p.slice())}))),e=>{let{theme:t}=e;return"\n    --size-diff-positive: ".concat(t.sanity.color.solid.positive.enabled.bg,";\n    --size-diff-negative: ").concat(t.sanity.color.solid.critical.enabled.bg,";\n  ")});function xE(e,t){let n=(/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e)||[]).slice(1).map(e=>parseInt(e,16)).concat(t);return"rgba(".concat(n.join(", "),")")}function xP(e){let{crop:t,diff:n,hash:i,hotspot:r,width:l=100,height:a=100,...o}=e,s=gD(n,"crop"),d=gD(n,"hotspot");return(0,lG.jsxs)("svg",{...o,fill:"none",width:l,height:a,viewBox:"0 0 ".concat(l," ").concat(a),children:[(0,lG.jsx)("defs",{children:t&&r&&(0,lG.jsxs)("mask",{id:"mask-hotspot-".concat(i),children:[(0,lG.jsx)("rect",{x:0,y:0,width:l,height:a,fill:"#fff"}),(0,lG.jsx)(xO,{hotspot:r,fill:"#000",offset:1,width:l,height:a,stroke:"#000",strokeWidth:3})]})}),t&&(0,lG.jsx)(gZ,{diff:n,path:"crop",description:"Crop changed",children:(0,lG.jsx)("g",{children:(0,lG.jsx)(xA,{crop:t,fill:xE(s.border,.25),mask:r?"url(#mask-hotspot-".concat(i,")"):void 0,stroke:s.border,strokeWidth:1,width:l,height:a})})}),r&&(0,lG.jsx)(gZ,{diff:n,path:"hotspot",description:"Hotspot changed",children:(0,lG.jsx)("g",{children:(0,lG.jsx)(xO,{hotspot:r,fill:xE(d.border,.25),stroke:d.border,strokeWidth:1,width:l,height:a})})})]})}function xA(e){let{crop:t,width:n,height:i,...r}=e,l={x:t.left*n,y:t.top*i,width:(1-t.right-t.left)*n,height:(1-t.bottom-t.top)*i};return(0,lG.jsx)("rect",{...r,...l,style:{vectorEffect:"non-scaling-stroke"}})}function xO(e){let{hotspot:t,offset:n=0,width:i,height:r,...l}=e,a={cx:t.x*i,cy:t.y*r,rx:t.width/2*i+n,ry:t.height/2*r+n};return(0,lG.jsx)("ellipse",{...l,...a,style:{vectorEffect:"non-scaling-stroke"}})}var xz=Object.freeze,xM=Object.defineProperty,xI=(e,t)=>xz(xM(e,"raw",{value:xz(t||e.slice())}));let xR=["originalFilename"],xF=()=>(0,lG.jsx)(l4.Zb,{flex:1,tone:"transparent",padding:4,radius:2,height:"stretch",children:(0,lG.jsx)(l4.kC,{align:"center",justify:"center",height:"fill",children:(0,lG.jsx)(l4.xv,{size:1,muted:!0,children:"(no image)"})})}),xD=a0.ZP.div(tT||(tT=xI(["\n  height: 100%;\n  max-height: 190px;\n  position: relative;\n\n  /* Ideally the checkerboard component currently in the form builder should be made available and used here */\n  background-color: ",";\n  background-image: linear-gradient(45deg, "," 25%, transparent 25%),\n    linear-gradient(-45deg, "," 25%, transparent 25%),\n    linear-gradient(45deg, transparent 75%, "," 75%),\n    linear-gradient(-45deg, transparent 75%, "," 75%);\n  background-size: 16px 16px;\n  background-position:\n    0 0,\n    0 8px,\n    8px -8px,\n    -8px 0;\n\n  &::after {\n    content: '';\n    display: block;\n    position: absolute;\n    top: 0;\n    left: 0;\n    right: 0;\n    bottom: 0;\n    box-shadow: inset 0 0 0 1px var(--card-border-color);\n    pointer-events: none;\n  }\n\n  &[data-changed] {\n    opacity: 0.45;\n  }\n"])),or.VG.gray[100].hex,or.VG.gray[50].hex,or.VG.gray[50].hex,or.VG.gray[50].hex,or.VG.gray[50].hex),xZ=a0.ZP.img(tE||(tE=xI(["\n  display: block;\n  flex: 1;\n  min-height: 0;\n  object-fit: contain;\n  width: 100%;\n  height: 100%;\n\n  &[data-action='removed'] {\n    opacity: 0.45;\n  }\n"]))),xL=a0.ZP.div(tP||(tP=xI(["\n  svg {\n    display: block;\n    position: absolute;\n    top: 0;\n    left: 0;\n    width: 100%;\n    height: 100%;\n  }\n"])));function xq(e){var t,n,i,r;let{id:l,action:a,diff:o,hotspot:s,crop:d,is:c}=e,u=qJ(fT),[p,h]=lJ.useState(),{value:f}=function(e,t){let n=Uj();return cO((0,lJ.useMemo)(()=>e?n.observePaths({_type:"reference",_ref:e},t):(0,l6.of)(void 0),[e,n,t]))}(l,xR),m=(0,o7.pz)(l),g=(0,lJ.useMemo)(()=>o9()(u),[u]),x=null===f,v=f&&f.originalFilename||"Untitled",b=g.image(l).height(190).dpr(Math.min(3,Math.max(1,Math.ceil(window.devicePixelRatio||1)))).fit("max"),y=(null==(n=null==(t=o.fromValue)?void 0:t.asset)?void 0:n._ref)!==(null==(r=null==(i=o.toValue)?void 0:i.asset)?void 0:r._ref),j="changed"===a?void 0:a;return(0,lG.jsxs)(l4.kC,{direction:"column",height:"fill",flex:1,children:[(0,lG.jsx)(l4.xu,{flex:1,padding:2,paddingBottom:0,children:(0,lG.jsxs)(l4.kC,{as:xD,direction:"column","data-changed":"from"===c&&y?"":void 0,"data-error":p?"":void 0,children:[!x&&!p&&(0,lG.jsx)(xZ,{src:b.toString()||"",alt:v,"data-action":j,onError:h,width:m.width,height:m.height}),(x||p)&&(0,lG.jsx)(l4.xu,{paddingY:5,children:(0,lG.jsx)(l4.xv,{size:1,muted:!0,align:"center",children:x?"Image is deleted":"Error loading image"})}),(0,lG.jsx)(xL,{children:(0,lG.jsx)(xP,{crop:d&&!(0,o7.aM)(d)?d:void 0,diff:o,hash:function(e){let t=0;if(0==e.length)return t.toString();for(let n=0;n<e.length;n++)t=(t<<5)-t+e.charCodeAt(n),t&=t;return t.toString()}("".concat(b.toString()||"","-").concat(c)),hotspot:s&&!(0,o7.Rq)(s)?s:void 0,width:m.width,height:m.height})})]})}),(0,lG.jsx)(bQ,{title:v,icon:a8.XBm,markRemoved:y&&"from"===c,children:j?(0,lG.jsx)("div",{children:j}):(0,lG.jsxs)("div",{children:[m.width," \xd7 ",m.height]})})]})}let xN=["asset","crop","hotspot"],xV={flex:1};var xU=Object.freeze,xB=Object.defineProperty;let xK=a0.ZP.div(tA||(tA=xU(xB(h=["\n  display: inline-block;\n  word-break: break-all;\n"],"raw",{value:xU(h.slice())})))),xH=e=>{let{value:t}=e;return(0,lG.jsx)(l4.xu,{as:xK,paddingX:2,paddingY:1,children:t})};var xW=Object.freeze,x$=Object.defineProperty;let xX=a0.ZP.blockquote(tO||(tO=xW(x$(f=["\n  margin: 0;\n"],"raw",{value:xW(f.slice())}))));function xG(e){let{children:t}=e;return(0,lG.jsx)("div",{children:(0,lG.jsx)(xX,{children:t})})}var xY=Object.freeze,xJ=Object.defineProperty;let xQ={h1:2,h2:1,h3:0,h4:0,h5:0,h6:0},x0=(0,a0.ZP)(l4.X6)(tz||(tz=xY(xJ(m=["\n  &:not([hidden]) {\n    display: inline;\n    text-transform: none;\n    margin: 0;\n\n    &::before,\n    &::after {\n      content: unset;\n    }\n  }\n"],"raw",{value:xY(m.slice())}))));function x1(e){let{style:t,children:n}=e;return(0,lG.jsx)(x0,{size:xQ[t],children:n})}var x2=Object.freeze,x3=Object.defineProperty;let x4=a0.ZP.div(tM||(tM=x2(x3(g=["\n  text-transform: none;\n  white-space: wrap;\n  overflow-wrap: break-word;\n  margin: 0;\n"],"raw",{value:x2(g.slice())}))));function x5(e){let{children:t}=e;return(0,lG.jsx)(x4,{children:t})}let x6=[];function x8(e){var t,n,i;let r;let{diff:l,block:a,children:o}=e,s=gD(l,x6),{path:d}=(0,lJ.useContext)(g3),{onSetFocus:c}=(0,lJ.useContext)(ce),u="removed"===l.action,p=o,h=(0,lJ.useCallback)(e=>{e.stopPropagation(),u||c(d)},[d,u,c]);if(p="blockquote"===a.style?(0,lG.jsx)(xG,{children:p}):a.style&&(0,lX.DG)(a)&&a.style&&["h1","h2","h3","h4","h5","h6"].includes(a.style)?(0,lG.jsx)(x1,{style:a.style,children:p}):(0,lG.jsx)(x5,{children:p}),"changed"===l.origin.action&&l.origin.fields.style&&"changed"===l.origin.fields.style.action&&l.origin.fields.style.annotation){r=null==(n=null==(t=null==l?void 0:l.origin)?void 0:t.fromValue)?void 0:n.style;let e=s?{background:s.background,color:s.text}:{};p=(0,lG.jsx)(l4.Zb,{padding:3,border:!0,radius:2,style:{borderStyle:"dotted"},"diff-block-action":l.action,"data-block-note":"changed_from_style_".concat(r||"undefined"),children:(0,lG.jsxs)(l4.Kq,{space:2,children:[(0,lG.jsx)(gZ,{annotations:[null==(i=l.origin.fields.style)?void 0:i.annotation],diff:l.origin.fields.style,children:(0,lG.jsxs)(l4.xv,{size:0,children:["Changed block style from '",r,"' to '",a.style,"'"]})}),(0,lG.jsx)(l4.xu,{style:e,children:p})]})})}return(0,lG.jsx)("div",{onClick:h,"data-diff-block-action":l.action,"data-block-note":"changed_from_style_".concat(r||"undefined"),children:p})}var x9=Object.freeze,x7=Object.defineProperty,ve=(e,t)=>x9(x7(e,"raw",{value:x9(t||e.slice())}));let vt=(0,a0.ZP)(l4.xu)(tI||(tI=ve(["\n  &:not([hidden]) {\n    display: inline;\n    align-items: center;\n\n    &[data-changed] {\n      cursor: pointer;\n    }\n  }\n"]))),vn=(0,a0.ZP)(l4.xv)(tR||(tR=ve(["\n  &:not([hidden]) {\n    display: inline;\n    color: inherit;\n  }\n"]))),vi=(0,a0.ZP)(l4.xu)(tF||(tF=ve(["\n  &:not([hidden]) {\n    display: inline-flex;\n    align-items: center;\n\n    ",' [data-ui="Text"] {\n      opacity: 0.5;\n    }\n  }\n'])),vt),vr=(0,a0.ZP)(l4.xu)(tD||(tD=ve(["\n  min-width: 160px;\n  max-height: 40vh;\n  overflow-y: auto;\n"])));var vl=Object.freeze,va=Object.defineProperty;let vo=a0.ZP.div(tZ||(tZ=vl(va(x=["\n  text-decoration: none;\n  display: inline;\n  position: relative;\n  border: 0;\n  padding: 0;\n  border-bottom: 2px dotted currentColor;\n  box-shadow: inset 0 0 0 1px var(--card-border-color);\n  white-space: nowrap;\n  align-items: center;\n  background-color: color(var(--card-fg-color) a(10%));\n\n  &[data-changed] {\n    cursor: pointer;\n  }\n\n  &[data-removed] {\n    text-decoration: line-through;\n  }\n\n  &:hover "," {\n    opacity: 1;\n  }\n"],"raw",{value:vl(x.slice())}))),vi);function vs(e){let{children:t,diff:n,object:i,schemaType:r,path:l,...a}=e;return r?n&&"unchanged"!==n.action?(0,lG.jsx)(vd,{...a,diff:n,object:i,schemaType:r,path:l,children:t}):(0,lG.jsx)(vo,{children:t}):(0,lG.jsx)(vo,{...a,children:"Unknown schema type"})}function vd(e){let{diff:t,children:n,object:i,schemaType:r,path:l,...a}=e,{onSetFocus:o}=(0,lJ.useContext)(ce),{path:s}=(0,lJ.useContext)(g3),[d,c]=(0,lJ.useState)(null),u=gD(t,[]),p=(0,lJ.useMemo)(()=>u?{background:u.background,color:u.text}:{},[u]),h="removed"===t.action,[f,m]=(0,lJ.useState)(!1),g=i&&xp(i),x=(0,lJ.useMemo)(()=>[l[0]].concat(["markDefs",{_key:i._key}]),[i._key,l]),v=(0,lJ.useMemo)(()=>s.slice(0,s.findIndex(e=>(0,lX.Fd)(e)&&e._key===i._key)),[s,i._key]),b=(0,lJ.useMemo)(()=>v.concat(l),[l,v]),y=(0,lJ.useMemo)(()=>v.concat(x),[x,v]),j="field-".concat((0,lY.BB)(y)),w=d9(),k=(0,lJ.useMemo)(()=>w.filter(e=>{let[t]=e;return t.startsWith(j)}).length>0,[j,w]);(0,lJ.useEffect)(()=>{!f&&k&&(m(!0),o(y))},[k,y,o,f]);let C=(0,lJ.useCallback)(e=>{e.stopPropagation(),m(!0),h||(e.preventDefault(),o(b),setTimeout(()=>o(y),10))},[b,h,y,o]),_=(0,lJ.useCallback)(()=>{k||m(!1)},[k]);(0,l4.O8)(_,[d]);let S="unchanged"!==t.action&&t.annotation||null,T=(0,lJ.useMemo)(()=>S?[S]:[],[S]),E=(0,lG.jsx)(g3.Provider,{value:{path:y},children:(0,lG.jsx)(vr,{padding:3,children:(0,lG.jsxs)("div",{children:[g&&(0,lG.jsxs)(l4.__,{size:1,muted:!0,children:["Empty ",r.title]}),!g&&(0,lG.jsx)(bV,{diff:t,schemaType:r})]})})});return(0,lG.jsx)(vo,{...a,onClick:C,style:p,"data-changed":"","data-removed":"removed"===t.action?"":void 0,children:(0,lG.jsx)(l4.J2,{content:E,open:f,ref:c,portal:!0,children:(0,lG.jsx)(vi,{paddingLeft:1,children:(0,lG.jsx)(gZ,{annotations:T,description:"".concat(t.action," annotation"),children:(0,lG.jsxs)(vt,{style:{display:"inline-flex"},children:[(0,lG.jsx)("span",{children:n}),(0,lG.jsx)(l4.kC,{align:"center",paddingX:1,children:(0,lG.jsx)(vn,{size:0,children:(0,lG.jsx)(a8.v4q,{})})})]})})})})})}var vc=Object.freeze,vu=Object.defineProperty;let vp=a0.ZP.span(tL||(tL=vc(vu(v=["\n  display: inline;\n  ","\n"],"raw",{value:vc(v.slice())}))),e=>{let{theme:t,decoration:n}=e;switch(n){case"strong":return"font-weight: bold;";case"em":return"font-style: italic;";case"underline":return"text-decoration: underline;";case"overline":return"text-decoration: overline;";case"strike-through":return"text-decoration: line-through;";case"code":return"\n          font-family: ".concat(t.sanity.fonts.code.family,";\n          background: ").concat(t.sanity.color.muted.default.enabled.bg,";\n        ");default:return""}});function vh(e){let{mark:t,children:n}=e;return(0,lG.jsx)(vp,{decoration:t,children:n})}var vf=Object.freeze,vm=Object.defineProperty;let vg=(0,a0.ZP)(l4.Zb)(tq||(tq=vf(vm(b=["\n  &:not([hidden]) {\n    display: inline;\n    cursor: pointer;\n    white-space: nowrap;\n    align-items: center;\n\n    &[data-removed] {\n      text-decoration: line-through;\n    }\n\n    "," {\n      display: inline-flex;\n    }\n  }\n"],"raw",{value:vf(b.slice())}))),vt);function vx(e){let{diff:t,object:n,schemaType:i,...r}=e;return i?t?(0,lG.jsx)(vv,{...r,diff:t,object:n,schemaType:i}):(0,lG.jsx)(vg,{children:(0,lG.jsx)(zM,{schemaType:i,value:n,layout:"inline"})}):(0,lG.jsxs)(vg,{...r,border:!0,radius:1,children:["Unknown schema type: ",n._type]})}function vv(e){let{diff:t,object:n,path:i,schemaType:r,...l}=e,{path:a}=(0,lJ.useContext)(g3),{onSetFocus:o}=(0,lJ.useContext)(ce),s=gD(t,[]),d=(0,lJ.useMemo)(()=>s?{background:s.background,color:s.text}:{},[s]),[c,u]=(0,lJ.useState)(!1),p=n&&xp(n),h="removed"===t.action,f=a.slice(0,a.findIndex(e=>(0,lX.Fd)(e)&&e._key===n._key)).concat(i),m="field-".concat((0,lY.BB)(f)),g=d9().filter(e=>{let[t]=e;return t.startsWith(m)}).length>0,x=a.slice(0,-1).concat(i).concat([lY.Zg]);(0,lJ.useEffect)(()=>{g&&(u(!0),o(x))},[x,g,o]);let v=(0,lJ.useCallback)(e=>{if(e.stopPropagation(),u(!0),!h){o(x);return}e.preventDefault()},[x,h,o]),b=(0,lJ.useCallback)(()=>{u(!1)},[]),y=(0,lG.jsx)(g3.Provider,{value:{path:f},children:(0,lG.jsx)(vb,{diff:t,emptyObject:p,onClose:b,schemaType:r})}),j="unchanged"!==t.action&&t.annotation||null;return(0,lG.jsx)(vg,{...l,onClick:v,style:d,"data-removed":"removed"===t.action?"":void 0,border:!0,radius:2,children:(0,lG.jsx)(l4.J2,{content:y,open:c,portal:!0,children:(0,lG.jsx)(vi,{children:(0,lG.jsx)(gZ,{annotations:j?[j]:[],description:"".concat(t.action," inline object"),children:(0,lG.jsxs)(vt,{children:[(0,lG.jsx)(zM,{schemaType:r,value:n,layout:"inline"}),(0,lG.jsx)(l4.kC,{align:"center",paddingX:1,children:(0,lG.jsx)(vn,{size:0,children:(0,lG.jsx)(a8.v4q,{})})})]})})})})})}function vb(e){let{diff:t,emptyObject:n,onClose:i,schemaType:r}=e,[l,a]=(0,lJ.useState)(null),o=(0,lJ.useCallback)(()=>{i()},[i]);return(0,l4.O8)(o,[l]),(0,lG.jsxs)(vr,{ref:a,padding:3,children:[n&&(0,lG.jsxs)(l4.__,{size:1,muted:!0,children:["Empty ",r.title]}),!n&&(0,lG.jsx)(bV,{diff:t,schemaType:r})]})}function vy(e){let{diff:t,childDiff:n,children:i,path:r,segment:l,...a}=e,o=t||n;return o&&"unchanged"!==o.action&&"unchanged"!==l.action?(0,lG.jsx)(vj,{...a,childDiff:n,diff:t,segment:l,path:r,children:i}):(0,lG.jsx)(vt,{children:i})}function vj(e){let{diff:t,childDiff:n,children:i,path:r,segment:l,...a}=e,{onSetFocus:o}=lJ.useContext(ce),{path:s}=lJ.useContext(g3),d=(0,lJ.useMemo)(()=>r.slice(-2,1)[0],[r]),c=t&&"removed"===t.action,u=s.slice(0,s.findIndex(e=>(0,lX.Fd)(e)&&(0,lX.Fd)(d)&&e._key===d._key)).concat(r),p=(0,lJ.useCallback)(e=>{e.stopPropagation(),c||(e.preventDefault(),o(u))},[u,c,o]),h=t&&t.segments.find(e=>e.text===l.text)||t||n,f=h&&"unchanged"!==h.action&&h.annotation||null,m=f&&"unchanged"!==l.action?(0,lG.jsx)(gK,{annotation:f,as:"removed"===l.action?"del":"ins",tooltip:{description:"".concat(op()(l.action)," text")},children:i}):null;return(0,lG.jsx)(vt,{...a,onClick:p,"data-changed":"",children:(0,lG.jsx)("span",{children:(0,lG.jsx)(lG.Fragment,{children:m||i})})})}let vw=g8.map(e=>e[0]),vk=g8.map(e=>e[1]),vC=g6.map(e=>e[0]),v_=g6.map(e=>e[1]),vS=vw.concat(vC),vT=vk.concat(v_),vE=vw.concat(vk),vP=RegExp("".concat(vE.concat(vT).join("|")),"g");function vA(e){let{diff:t,schemaType:n}=e,i=t.origin.toValue||t.origin.fromValue,r=(0,lJ.useMemo)(()=>t.origin.toValue?xc(t.origin):[],[t.origin]),l=(0,lJ.useCallback)(e=>{let l=xa(n.fields,e),a=[];if(l){let e;a=xo(l);let o=t.fields.children,s=o.items[0].diff&&"object"===o.items[0].diff.type&&"string"===o.items[0].diff.fields.text.type&&o.items[0].diff.fields.text.segments||[],d=[],c={};if(1===i.children.length&&"span"===i.children[0]._type&&"string"==typeof i.children[0].text&&""===i.children[0].text&&"unchanged"!==t.origin.action&&("added"===t.origin.action||"removed"===t.origin.action)){let e=xl(t.origin,i.children[0])||t.origin;if(e&&"unchanged"!==e.action)return(0,lG.jsx)(gK,{annotation:e.annotation,as:"removed"===e.action?"del":"ins",tooltip:{description:"".concat(op()(e.action)," empty text")},children:(0,lG.jsx)("span",{children:"↲"})},"empty-block-".concat(i._key))}let u=-1,p=-1,h=[],f=xh(t.origin);return s.forEach(o=>{var s,m,g,x,v,b,y;p++;let j=g9.includes(o.text),w=vS.includes(o.text),k=vT.includes(o.text),C=""===o.text,_="removed"===o.action;if(C)!_&&u++;else if(w||k){if(w&&vC.includes(o.text)){let e=f[vC.indexOf(o.text)];e&&h.push({mark:e._key,symbols:[o.text,v_[vC.indexOf(o.text)]],object:e})}k&&v_.includes(o.text)&&(e=h.pop())}else if(j){let e=g9.findIndex(e=>e===o.text),l=null==(s=r[e])?void 0:s._key,a=r[e];if(l){let e=xa(n.fields,a),r=xl(t.origin,a);d.push((0,lG.jsx)(vx,{object:a,path:[{_key:i._key},"children",{_key:a._key}],diff:r,schemaType:e},"inline-object-".concat(a._key)))}}else if(o.text){let n=i.children[u]||(null==(x=t.origin.fromValue)?void 0:x.children.find(e=>e.text&&e.text.match(o.text.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")))),r=n&&xu(t.origin,n);if(!n)throw Error("Could not find child");let s=(null==(m=null==r?void 0:r.fields)?void 0:m.text)?null==(g=null==r?void 0:r.fields)?void 0:g.text:void 0,f=(0,lG.jsx)(vy,{diff:s,path:[{_key:i._key},"children",{_key:n._key}],childDiff:r,segment:o,children:function(e){let{diff:t,child:n,decoratorTypes:i,seg:r,segIndex:l,spanSchemaType:a}=e;if("\n"===r.text)return(0,lG.jsx)("br",{});let o=(0,lG.jsx)("span",{children:r.text.replace(/ /g," ")},"text-".concat(l)),s=n&&xu(t.origin,n),d=(0,lX.NG)(n)&&n.marks||[];return s&&(o=function(e){var t;let{activeMarks:n,decoratorTypes:i,diff:r,children:l,seg:a,segIndex:o,spanDiff:s,spanSchemaType:d}=e,c=(0,lG.jsx)("span",{children:l},"text-segment-".concat(o)),u=r.origin.fromValue&&r.fromValue&&r.fromValue.children[0].text||"",p=s&&"unchanged"!==s.action&&s.annotation||void 0,h=null==(t=null==s?void 0:s.fields)?void 0:t.marks,f=h&&"unchanged"!==h.action&&h.annotation||p,m=[],g=u.split("").filter(e=>!!e).join(""),x=g.substring(0,g.indexOf(a.text)+a.text.length),v=x.substring(0,x.indexOf(a.text)),b=[];return[...v.matchAll(vP)].forEach(e=>{var t;let n=e[0],r=g8.concat(g6).find(e=>e.indexOf(n)>-1);if(r){let e=(null==(t=i[n===r[0]?vw.indexOf(n):vk.indexOf(n)])?void 0:t.value)||n;v.lastIndexOf(n)>v.lastIndexOf(r[1])&&b.push(e)}}),m=sO()(n,sh()(b)),f&&m.length>0&&m.some(e=>xs(e,d))&&(c=(0,lG.jsx)(gK,{annotation:f,as:"ins",tooltip:{description:"Changed formatting"},children:c},"diffcard-annotation-".concat(o,"-").concat(m.join("-")))),c}({activeMarks:d,decoratorTypes:i,diff:t,children:o,seg:r,segIndex:l,spanDiff:s,spanSchemaType:a})),d&&d.length>0&&d.forEach(e=>{xs(e,a)&&(o=(0,lG.jsx)(vh,{mark:e,children:o},"decorator-".concat(e,"-").concat(n._key,"-").concat(l)))}),o}({diff:t,child:n,decoratorTypes:a,seg:o,segIndex:p,spanSchemaType:l})},"text-".concat(n._key,"-").concat(p));if(h.length>0&&h.forEach(e=>{c[e.mark]=c[e.mark]||[],c[e.mark].push(f)}),e){let r="annotation-".concat(e.object._key),a=d[d.length-1];if(a&&a.key!==r){let a=(v=t.origin,b=e.mark,v.fields.markDefs&&v.fields.markDefs.isChanged&&"array"===v.fields.markDefs.type&&(null==(y=v.fields.markDefs.items.find(e=>e.diff&&"object"===e.diff.type&&(e.diff.toValue&&e.diff.toValue._key&&e.diff.toValue._key===b||e.diff.fromValue&&e.diff.fromValue._key&&e.diff.fromValue._key===b)))?void 0:y.diff)||void 0),o=e&&l.annotations&&l.annotations.find(t=>e&&e.object&&t.name===e.object._type);d.push((0,lG.jsx)(vs,{object:e.object,diff:a,path:[{_key:i._key},"children",{_key:n._key}],schemaType:o,children:(0,lG.jsx)(lG.Fragment,{children:c[e.mark]})},r))}e=void 0}0===h.length&&d.push(f)}}),lJ.createElement("div",{key:i._key},...d)}throw Error("'span' schemaType not found")},[i,t,r,n]);return(0,lG.jsx)(x8,{block:t.displayValue,diff:t,children:(0,lG.jsx)(lG.Fragment,{children:(t.displayValue.children||[]).map(e=>l(e))})})}var vO=Object.freeze,vz=Object.defineProperty;let vM=a0.ZP.div(tN||(tN=vO(vz(y=["\n  word-wrap: break-word;\n"],"raw",{value:vO(y.slice())})))),vI=e=>{let{value:t,schemaType:n}=e;return(0,lG.jsx)(l4.xu,{as:vM,padding:2,children:(0,lG.jsx)(zM,{schemaType:n,value:t,layout:"default"})})};var vR=Object.freeze,vF=Object.defineProperty;let vD=a0.ZP.div(tV||(tV=vR(vF(j=["\n  display: inline-block;\n  word-break: break-all;\n  white-space: pre-wrap;\n"],"raw",{value:vR(j.slice())})))),vZ=e=>{let{value:t}=e;return(0,lG.jsx)(l4.xu,{as:vD,paddingX:2,paddingY:1,children:t})};var vL=Object.freeze,vq=Object.defineProperty;let vN=a0.ZP.div(tU||(tU=vL(vq(w=["\n  white-space: pre-wrap;\n  word-wrap: break-word;\n"],"raw",{value:vL(w.slice())})))),vV={block:e=>{let{diff:t,schemaType:n}=e,i=(0,lJ.useMemo)(()=>(function(e,t){let n="removed"===e.action?e.fromValue:e.toValue,i={...e,origin:e,displayValue:n};if(n){let r={},l={},a={},o=xa(t.fields,{_key:"bogus",_type:"span"});o&&xo(o).forEach((e,t)=>{l[e.value]=g8[t]}),xh(i.origin).forEach((e,t)=>{r[e._key]=g6[t]}),xc(i.origin).forEach((e,t)=>{a[e._key]=g9[t]});let s=xd(i.origin,i.fromValue,l,r,a),d=xd(i.origin,i.toValue,l,r,a),c={...n,children:[{_type:"span",_key:"pseudoSpanKey",text:d,marks:[]}]},u={displayValue:n,children:[{_type:"span",_key:"pseudoSpanKey",text:s,marks:[]}]};return{origin:e,action:"changed",type:"object",displayValue:c,fromValue:u,toValue:c,isChanged:!0,fields:{children:{action:"changed",type:"array",isChanged:!0,items:[{diff:{action:"changed",type:"object",isChanged:!0,fields:{text:{type:"string",action:"changed",isChanged:!0,fromValue:s,toValue:d,segments:(function(e,t){let n=[],i=(0,s_.Hy)((0,s_.$T)(e,t)),r=0,l=0;for(let[a,o]of i)switch(a){case s_.JZ:n.push({type:"stringSegment",action:"unchanged",text:o}),r+=o.length,l+=o.length;break;case s_.NL:n.push({type:"stringSegment",action:"removed",text:e.substring(r,r+o.length),annotation:null}),r+=o.length;break;case s_.D$:n.push({type:"stringSegment",action:"added",text:t.substring(l,l+o.length),annotation:null}),l+=o.length}return ow()(n.map(e=>{let t=[];if(e.text.length>1){let n=[...e.text.matchAll(xi)],i=-1;n.forEach(r=>{let l=r.index||0;l>i&&(t.push({...e,text:e.text.substring(i+1,l)}),t.push({...e,text:r[0]})),r===n[n.length-1]&&t.push({...e,text:e.text.substring(l+1)}),i=l}),0===n.length&&t.push(e)}else t.push(e);return t}))})(s,d).map(e=>({...e,..."unchanged"!==i.action&&i.annotation?{annotation:i.annotation}:{}}))}},fromValue:u.children[0],toValue:c.children[0]},annotation:null,fromIndex:0,toIndex:0,hasMoved:!1}],fromValue:u.children,toValue:c.children}}}}throw Error("Can not display this diff")})(t,n),[t,n]);return(0,lG.jsx)("div",{"data-diff-action":t.action,children:(0,lG.jsx)(vA,{diff:i,schemaType:n})})},boolean:{component:e=>{let{diff:t,schemaType:n}=e,{fromValue:i,toValue:r}=t,{title:l,options:a}=n,o=(null==a?void 0:a.layout)==="checkbox"?xm:xg,s=gD(t,[]),d=null!=r;return(0,lG.jsxs)(l4.kC,{align:"center",children:[(0,lG.jsx)(gZ,{diff:t,children:(0,lG.jsxs)(l4.kC,{align:"center",children:[(0,lG.jsx)(o,{checked:i,color:s}),d&&(0,lG.jsxs)(lG.Fragment,{children:[(0,lG.jsx)(l4.xu,{marginX:2,children:(0,lG.jsx)(v9,{})}),(0,lG.jsx)(o,{checked:r,color:s})]})]})}),d&&l&&(0,lG.jsx)(l4.xu,{marginLeft:2,children:(0,lG.jsx)(l4.xv,{size:1,weight:"semibold",children:l})})]})},showHeader:!1},date:xj,datetime:xj,file:e=>{let{diff:t,schemaType:n}=e,{fromValue:i,toValue:r,fields:l}=t,a=null==i?void 0:i.asset,o=null==r?void 0:r.asset,s=xC(null==a?void 0:a._ref),d=xC(null==o?void 0:o._ref),c=Object.entries(l).filter(e=>{let[t,n]=e;return n.isChanged&&"_type"!==t}).map(e=>{let[t]=e;return t}),u=c.includes("asset"),p=n.fields.filter(e=>"asset"!==e.name&&c.includes(e.name)).map(e=>e.name),h=(null==s?void 0:s.size)&&s.size/1e3/1e3,f=(null==d?void 0:d.size)&&d.size/1e3/1e3,m=h&&f?Math.round((f-h)/h*100):0,g=h?h.toFixed(2):void 0,x=f?f.toFixed(2):void 0,v=(0,lJ.useMemo)(()=>({display:"block",flex:1}),[]),b=s&&(0,lG.jsx)(gK,{as:"del",diff:t,path:"asset._ref",style:v,children:(0,lG.jsx)(bQ,{title:s.originalFilename||"Untitled",icon:a8.$lS,children:(0,lG.jsx)(l4.xv,{size:0,style:{color:"inherit"},children:"".concat(g,"MB")})})}),y=d&&(0,lG.jsx)(gK,{as:"ins",diff:t,path:"asset._ref",style:v,children:(0,lG.jsx)(bQ,{title:d.originalFilename||"Untitled",icon:a8.$lS,children:(0,lG.jsxs)(l4.kC,{align:"center",children:[(0,lG.jsx)(l4.xv,{size:0,style:{color:"inherit"},children:"".concat(x,"MB")}),0!==m&&(0,lG.jsx)(l4.Zb,{radius:2,padding:1,as:xT,marginLeft:2,children:(0,lG.jsxs)(l4.xv,{size:0,"data-number":m>0?"positive":"negative",children:[m>0&&"+",m,"%"]})})]})})}),j=(0,lG.jsxs)(lG.Fragment,{children:[b&&!y&&(0,lG.jsx)(gZ,{diff:t,path:"asset._ref",description:"Removed",children:b}),b&&y&&(0,lG.jsx)(gZ,{diff:t,path:"asset._ref",children:(0,lG.jsx)(bu,{from:b,layout:"grid",to:y})}),!b&&y&&(0,lG.jsx)(gZ,{diff:t,path:"asset._ref",description:"Added",children:y})]});return(0,lG.jsxs)(lG.Fragment,{children:[u&&j,p.length>0&&(0,lG.jsx)(l4.xu,{marginTop:u?4:3,children:(0,lG.jsx)(bV,{diff:t,schemaType:n,fields:p})})]})},image:e=>{var t,n;let{diff:i,schemaType:r}=e,{fromValue:l,toValue:a,fields:o,isChanged:s}=i,d=null==(t=null==l?void 0:l.asset)?void 0:t._ref,c=null==(n=null==a?void 0:a.asset)?void 0:n._ref,u=gF(i,["asset","_ref"]),p=Object.keys(o).filter(e=>o[e].isChanged&&"_type"!==e),h=r.fields.filter(e=>!xN.includes(e.name)&&p.includes(e.name)).map(e=>e.name),f="changed";!d&&c?f="added":!c&&d&&(f="removed");let m=p.includes("asset"),g=p.includes("crop"),x=p.includes("hotspot"),v=g||x,b=m||v,y=v&&!m,j=l&&d?(0,lG.jsx)(gK,{annotation:u,style:xV,children:(0,lG.jsx)(xq,{is:"from",id:d,diff:i,action:f,hotspot:y&&x?l.hotspot:void 0,crop:y&&g?l.crop:void 0})}):(0,lG.jsx)(xF,{}),w=a&&c?(0,lG.jsx)(gK,{annotation:u,style:xV,children:(0,lG.jsx)(xq,{is:"to",id:c,diff:i,hotspot:y&&x?a.hotspot:void 0,crop:y&&g?a.crop:void 0})}):(0,lG.jsx)(xF,{});if(!j&&!w)return(0,lG.jsx)(l4.Zb,{padding:4,radius:2,tone:"transparent",children:(0,lG.jsx)(l4.xv,{muted:!0,size:1,align:"center",children:"Image not set"})});if(!s)return c?(0,lG.jsx)(gK,{annotation:u,style:xV,children:(0,lG.jsx)(xq,{id:c,is:"to",diff:i})}):null;let k=(0,lG.jsx)(bu,{align:"center",from:j,layout:"grid",to:w});return(0,lG.jsxs)(lG.Fragment,{children:[b&&(m?(0,lG.jsx)(gZ,{annotations:u?[u]:[],description:"".concat(f[0].toUpperCase()).concat(f.slice(1)),children:k}):k),h.length>0&&(0,lG.jsx)(l4.xu,{marginTop:b?4:3,children:(0,lG.jsx)(bV,{diff:i,schemaType:r,fields:h})})]})},number:e=>{let{diff:t,schemaType:n}=e;return(0,lG.jsx)(bh,{diff:t,schemaType:n,previewComponent:xH,layout:"inline"})},reference:e=>{let{diff:t,schemaType:n}=e;return(0,lG.jsx)(bh,{align:"center",diff:t,layout:"grid",path:"_ref",previewComponent:vI,schemaType:n})},string:e=>{let{diff:t,schemaType:n}=e,{options:i}=n;return(null==i?void 0:i.list)?(0,lG.jsx)(bh,{diff:t,previewComponent:vZ,schemaType:n}):(0,lG.jsx)(vN,{children:(0,lG.jsx)(bX,{diff:t})})}};function vU(e,t){var n;let i=e;for(;i;){let e=(null==(n=null==i?void 0:i.components)?void 0:n.diff)||function(e,t){let n;for(let i of xf){if("function"!=typeof i){console.error("Diff component resolver is not a function: ",i);continue}if(n=i({schemaType:e,parentSchemaType:t}))return n}}(i,t)||vV[i.name];if(e)return e;i=i.type}return vV[["date","datetime"].includes(e.name)?e.name:e.jsonType]}function vB(e){return"field"===e.type}function vK(e){return null!=e&&""!==e}function vH(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};if(!vU(e,r.parentSchema)){if("object"===e.jsonType&&"object"===t.type)return vW(e,t,n,i,r);if("array"===e.jsonType&&"array"===t.type)return function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],r=t.items.filter(e=>e.hasMoved&&e.fromIndex!==e.toIndex||"unchanged"!==e.diff.action);if(0===r.length)return[];let l=e.of.some(xr),a=r.reduce((r,a)=>{var o;let s="added"===(o=a.diff).action?{toType:g5(e,o.toValue)}:"changed"===o.action?{fromType:g5(e,o.fromValue),toType:g5(e,o.toValue)}:"removed"===o.action?{fromType:g5(e,o.fromValue)}:{toType:g5(e,o.toValue)},d=s.toType||s.fromType;if(!d)return console.warn("Could not determine schema type for item at %s",gP(n)),r;let c=gI(a.diff.fromValue)||gI(a.diff.toValue)||t.items.indexOf(a),u=n.concat(c),p={itemDiff:a,parentDiff:t,parentSchema:e},h=i.concat({hasMoved:a.hasMoved,toIndex:a.toIndex,fromIndex:a.fromIndex,annotation:"unchanged"===a.diff.action?a.annotation:a.diff.annotation}),f=vH(d,a.diff,u,h,p).map(e=>("field"===e.type&&gz(u,e.path)&&(e.itemDiff=a),e));return l&&f.filter(vB).forEach((e,t,n)=>{e.showHeader=1===n.length,e.showIndex=a.fromIndex!==a.toIndex&&a.hasMoved}),0===f.length?r.push(...v$(d,a.diff,u,h,p)):r.push(...f),r},[]);return a.length>1?[{type:"group",key:gP(n)||"root",path:n,titlePath:i,changes:vX(a,i.length),schemaType:e}]:a}(e,t,n,i)}return v$(e,t,n,i,r)}function vW(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},l=[],a={...r,parentSchema:e};for(let r of e.fieldsets||e.fields.map(e=>({single:!0,field:e})))r.single?l.push(...function(e,t,n,i){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},{fieldFilter:l,...a}=r,o=t.fields[e.name];if(!o||!o.isChanged||l&&!l.includes(e.name))return[];let s=n.concat([e.name]),d=i.concat([e.type.title||e.name]);return vH(e.type,o,s,d,a)}(r.field,t,n,i,a)):l.push(...function(e,t,n,i){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},{fields:l,name:a,title:o,readOnly:s,hidden:d}=e,{fieldFilter:c,...u}=r,p=i.concat([o||a]),h=[];for(let e of l){let i=t.fields[e.name];if(!i||!i.isChanged||c&&!c.includes(e.name))continue;let r=n.concat([e.name]),l=p.concat([e.type.title||e.name]);h.push(...vH({readOnly:s,hidden:d,...e.type},i,r,l,u))}return h.length<2?h:[{type:"group",key:gP(n)||"root",fieldsetName:a,path:n,titlePath:p,changes:vX(h,p.length),readOnly:s,hidden:d}]}(r,t,n,i,a));return l.length<2?l:[{type:"group",key:gP(n)||"root",path:n,titlePath:i,changes:vX(l,i.length),schemaType:e}]}function v$(e,t,n,i){let r,l,{itemDiff:a,parentDiff:o,parentSchema:s}=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},{fromValue:d,toValue:c,type:u}=t;if("array"===u&&vG(d)&&vG(c))return[];void 0!==d&&(r=g4(d,e)),r||void 0===c||(r=g4(c,e));let p=!0,h=vU(e,s);return h&&"function"==typeof h?l=h:h&&(l=h.component,p=void 0===h.showHeader?p:h.showHeader),[{type:"field",diff:t,path:n,error:r,itemDiff:a,parentDiff:o,titlePath:i,schemaType:e,showHeader:p,showIndex:!0,key:gP(n)||"root",diffComponent:r?void 0:l,parentSchema:s}]}function vX(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return e.map(e=>(e.titlePath=e.titlePath.slice(t),e))}function vG(e){return Array.isArray(e)&&0===e.length||null==e}let vY=e=>"field"===e.type&&"added"===e.diff.action,vJ=e=>{if("group"!==e.type)return[e];let t=[];return e.changes.forEach(e=>{t.push(...vJ(e))}),t},vQ=(e,t)=>{if(t.length>=e.length)return!1;for(let n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0},v0=(e,t)=>{let n=gM(e[t]);return n?{_key:n}:Array.isArray(e)?parseInt(t,10):t},v1={diffMatchPatch:{enabled:!1,lengthThresholdAbsolute:30,lengthThresholdRelative:1.2}};function v2(e,t,n){if(!t)return;let i=[];if("group"===e.type){let r=vJ(e),l=r.filter(vY);r.filter(e=>!vY(e)).forEach(e=>v2(e,t,n)),i.push(...v3(t,l.map(e=>e.path).reverse()))}else"added"===e.diff.action?i.push(...v3(t,[e.path])):"field"===e.type&&e.itemDiff&&e.parentDiff&&"array"===e.parentDiff.type&&e.itemDiff.hasMoved?i.push(...function(e,t,n){let i;let r=n.slice(0,-1),{parentValue:l,fromIndex:a,fromValue:o}=function(e,t){if(e.fromValue&&"number"==typeof t.fromIndex){let n=e.fromValue[t.fromIndex];return{parentValue:e.fromValue,fromIndex:t.fromIndex,fromValue:n}}throw Error("Failed to find item at index ".concat(t.fromIndex))}(t,e);if(0===a)i={before:gP([...r,0])};else{let e=a-1;i={after:gP([...r,gI(l[e])||e])}}return[{unset:[gP(n)]},{insert:{...i,items:[o]}}]}(e.itemDiff,e.parentDiff,e.path)):i.push(...function(e,t,n){let i=(0,sz.C)(e.toValue,e.fromValue,v1,n),r=i.filter(e=>"insert"===e.op).map(e=>{let{after:t,items:n}=e;return{insert:{after:gP(t),items:n}}}),l=i.filter(e=>"unset"===e.op).reduce((e,t)=>e.concat(gP(t.path)),[]),a=new Set,o=[],s=!1,d=i.filter(e=>"set"===e.op).reduce((e,n)=>(s=!0,o.push(...function(e,t,n){let i=t.fromValue,r=t.toValue,l=[];for(let t=1;t<=e.length;t++){let a=e.slice(0,t),o=gP(a);if(n.has(o))continue;let s=e[t],d=(0,lX.Fd)(s)||(0,lX.dw)(s),c=gA(i,a),u=v4(c);if(d&&Array.isArray(c)&&!gA(r,e.slice(0,t+1))){let e=function(e,t){return"number"==typeof t||(0,lX.Fd)(t)?"number"==typeof t?t:e.findIndex(e=>(0,lX.fU)(e)&&e._key===t._key):-1}(c,s),n=c[e-1],r=gA(i,a.concat(s)),d=(0,lX.fU)(n)?{_key:n._key}:e-1,u=gP(a.concat(e<1?0:d));l.push({setIfMissing:{[o]:[]}}),l.push({insert:{after:u,items:[v4(r)]}}),t++;continue}void 0!==u&&(n.add(o),l.push({setIfMissing:{[o]:u}}))}return l}(n.path,t,a)),e[gP(n.path)]=n.value,e),{});return[...o,...r,...l.length>0?[{unset:l}]:[],...s?[{set:d}]:[]]}(e.diff,t,e.path));n.patch.execute(i)}function v3(e,t){let n=[];for(let r=0;r<t.length;r++){var i;n.some(e=>vQ(t[r],e))||n.push((i=t[r],function e(t,n){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3?arguments[3]:void 0;if(n.length<=0){if(!r)throw Error("Root has no ancestor");return r}let l=n.slice(0,-1),a=gA(t,l),o=[l,...i.filter(e=>!vQ(e,l))];return!function e(t,n,i){let r=null==i?void 0:i.some(e=>gP(e)===gP(n)),l=Array.isArray(t)&&t.length<=0;return r||null==t||l||"object"==typeof t&&null!==t&&Object.keys(t).length<=0||function(t,n,i){if(!cg(t)||!Array.isArray(t))return!1;for(let r in t){if(!Object.prototype.hasOwnProperty.call(t,r)||"_type"===r||"_key"===r)continue;let l=[...n,v0(t,r)];if(!e(t[r],l,i))return!1}return!0}(t,n,i)}(a,l,i)?n:e(t,l,o,r)}(e.toValue,i,t)))}return[{unset:[...new Set(n.map(gP))]}]}function v4(e){if(Array.isArray(e))return[];if("object"!=typeof e||null===e)return;let t={};return(0,lX.fU)(e)&&(t._key=e._key),(0,lX.ay)(e)&&(t._type=e._type),t}let v5=!1;class v6 extends lJ.Component{constructor(){super(...arguments),this.state={}}static getDerivedStateFromError(e){return{error:e}}componentDidCatch(e){console.error("Error rendering diff component: "),console.error(e)}render(){let{error:e}=this.state;return e?(0,lG.jsx)(l4.Zb,{padding:3,radius:2,tone:"critical",children:(0,lG.jsxs)(l4.kC,{children:[(0,lG.jsx)(l4.xv,{size:1,children:(0,lG.jsx)(a8.uIy,{})}),(0,lG.jsxs)(l4.xu,{paddingLeft:3,children:[(0,lG.jsx)(l4.xv,{as:"h3",size:1,weight:"medium",children:"Rendering the changes to this field caused an error"}),v5&&(0,lG.jsx)(l4.xu,{marginTop:2,children:(0,lG.jsx)(l4.xv,{as:"p",size:1,children:"Check the developer console for more information"})})]})]})}):this.props.children}}let v8={down:a8.veu,right:a8.LZ3};function v9(e){let{direction:t="right",...n}=e,i=v8[t];return(0,lG.jsx)(l4.xv,{muted:!0,size:1,...n,children:(0,lJ.createElement)(i)})}var v7=Object.freeze,be=Object.defineProperty,bt=(e,t)=>v7(be(e,"raw",{value:v7(t||e.slice())}));let bn=a0.ZP.pre(tB||(tB=bt(["\n  overflow-x: auto;\n  position: relative;\n"]))),bi=a0.ZP.div(tK||(tK=bt(["\n  position: absolute;\n  top: 0;\n  right: 0;\n"])));function br(e){let{children:t,as:n,change:i,...r}=e,l=(0,lJ.useRef)(!1),[a,o]=(0,lJ.useState)(!1),s=(0,lJ.useCallback)(()=>o(e=>!e),[o]),d=(0,lJ.useCallback)(()=>l.current=!0,[]),c=(0,lJ.useCallback)(()=>l.current=!1,[l]);return(0,lJ.useEffect)(()=>{function e(e){let{metaKey:t,key:n}=e;t&&"i"===n&&l.current&&s()}return window.addEventListener("keydown",e,!1),()=>window.removeEventListener("keydown",e,!1)},[s]),(0,lG.jsx)(l4.xu,{as:n,onMouseEnter:d,onMouseLeave:c,...r,children:a?(0,lG.jsx)(ba,{change:i}):t})}let bl=e=>{let{title:t}=e;return(0,lG.jsx)(l4.xu,{padding:3,display:"inline-block",as:bi,children:(0,lG.jsx)(l4.__,{size:1,muted:!0,children:t})})};function ba(e){var t,n,i;let{change:r}=e;return(0,lG.jsxs)(l4.Kq,{space:3,children:[(0,lG.jsxs)(l4.Zb,{padding:3,tone:"transparent",as:bn,radius:1,children:[(0,lG.jsx)(bl,{title:"meta"}),(0,lG.jsx)(l4.EK,{language:"json",size:1,children:function(e){let t=[];return Object.entries(e).forEach(e=>{let[n,i]=e;null!=i&&t.push("".concat(n,": ").concat(i))}),t.join("\n")}({path:gP(r.path),fromIndex:null==(t=r.itemDiff)?void 0:t.fromIndex,toIndex:null==(n=r.itemDiff)?void 0:n.toIndex,hasMoved:null==(i=r.itemDiff)?void 0:i.hasMoved,action:r.diff.action,isChanged:r.diff.isChanged})})]}),(0,lG.jsxs)(l4.Zb,{as:bn,tone:"critical",padding:3,radius:1,children:[(0,lG.jsx)(bl,{title:"from"}),(0,lG.jsx)(l4.EK,{language:"json",size:1,children:bo(r.diff.fromValue)})]}),(0,lG.jsx)(l4.Zb,{children:(0,lG.jsx)(v9,{direction:"down",align:"center"})}),(0,lG.jsxs)(l4.Zb,{as:bn,tone:"positive",padding:3,radius:1,children:[(0,lG.jsx)(bl,{title:"to"}),(0,lG.jsx)(l4.EK,{language:"json",size:1,children:bo(r.diff.toValue)})]})]})}function bo(e){return void 0===e?"undefined":JSON.stringify(e,null,2)}let bs={flexShrink:0},bd={alignItems:"stretch"},bc={top:"flex-start",center:"center",bottom:"flex-end",default:"flex-start"},bu=(0,lJ.forwardRef)(function(e,t){let{align:n="top",layout:i="inline",from:r,to:l,style:a,...o}=e,s=(0,l4.Fg)(),d="inline"===i?l4.kC:l4.rj,c=(0,lJ.useMemo)(()=>({...a,..."inline"===i?{maxWidth:"100%",display:"inline-flex"}:{gridTemplateColumns:"minmax(0, 1fr) ".concat((0,l4.hO)(s.sanity.space[5])," minmax(0, 1fr)")}}),[i,a,s]),u="inline"===i?bs:bd;return(0,lG.jsxs)(d,{...o,ref:t,style:c,"data-from-to-layout":!0,children:[r&&(0,lG.jsxs)(lG.Fragment,{children:[(0,lG.jsx)(l4.kC,{align:bc[n],style:u,children:r}),(0,lG.jsx)(l4.kC,{align:"center",justify:"center",padding:2,children:(0,lG.jsx)(v9,{})})]}),(0,lG.jsx)(l4.kC,{align:bc[n],style:u,children:l})]})}),bp={flex:1,minWidth:0,display:"block",whiteSpace:"break-spaces"};function bh(e){let{align:t,cardClassName:n,diff:i,layout:r,path:l,previewComponent:a,schemaType:o}=e,{action:s}=i,d=function(e){let t=vK(e.fromValue),n=vK(e.toValue);return!t&&n?"Added":!n&&t?"Removed":"Changed"}(i);if("unchanged"===s)return(0,lG.jsx)(gK,{className:n,style:bp,children:(0,lJ.createElement)(a,{schemaType:o,value:i.toValue})});let c=void 0!==i.fromValue&&null!==i.fromValue&&(0,lG.jsx)(gK,{as:"del",className:n,diff:i,path:l,style:bp,children:(0,lJ.createElement)(a,{schemaType:o,value:i.fromValue})}),u=void 0!==i.toValue&&null!==i.toValue&&(0,lG.jsx)(gK,{as:"ins",className:n,diff:i,path:l,style:bp,children:(0,lJ.createElement)(a,{schemaType:o,value:i.toValue})});return c&&!u?(0,lG.jsx)(gZ,{description:d,diff:i,path:l,children:c}):!c&&u?(0,lG.jsx)(gZ,{description:d,diff:i,path:l,children:u}):(0,lG.jsx)(gZ,{description:d,diff:i,path:l,children:(0,lG.jsx)(bu,{align:t,from:c,layout:r,to:u})})}let bf=e=>{let{value:t,schemaType:n}=e;return(0,lG.jsx)(l4.xu,{padding:2,children:(0,lG.jsx)(zM,{schemaType:n,value:t,layout:"default"})})},bm=e=>{let{diff:t,schemaType:n}=e;return(0,lG.jsx)(bh,{diff:t,schemaType:n,previewComponent:bf,layout:"grid"})};var bg=Object.freeze,bx=Object.defineProperty;let bv=(0,a0.ZP)(l4.zx)(tH||(tH=bg(bx(k=["\n  [data-ui='Text'] {\n    font-weight: normal;\n  }\n\n  div[data-ui='Box'] {\n    display: none;\n  }\n\n  &:not([data-disabled='true']):hover,\n  &:not([data-disabled='true']):focus {\n    --card-fg-color: ",";\n    --card-bg-color: transparent;\n    --card-border-color: transparent;\n\n    div[data-ui='Box'] {\n      display: block;\n    }\n  }\n"],"raw",{value:bg(k.slice())}))),e=>{let{theme:t}=e;return t.sanity.color.solid.critical.enabled.bg}),bb=(0,lJ.forwardRef)(function(e,t){let{selected:n,...i}=e;return(0,lG.jsx)(bv,{icon:a8.V13,selected:n,text:"Revert changes",mode:"bleed",padding:1,fontSize:1,space:2,ref:t,...i})});function by(e){let{error:t}=e;return(0,lG.jsx)(l4.Zb,{tone:"critical",padding:3,children:(0,lG.jsxs)(l4.kC,{align:"flex-start",children:[(0,lG.jsx)(l4.xu,{children:(0,lG.jsx)(l4.xv,{children:(0,lG.jsx)(a8.uIy,{})})}),(0,lG.jsx)(l4.xu,{flex:1,paddingLeft:3,children:(0,lG.jsxs)(l4.xv,{size:1,as:"p",children:["Value error: ",t.message]})})]})})}var bj=Object.freeze,bw=Object.defineProperty,bk=(e,t)=>bj(bw(e,"raw",{value:bj(t||e.slice())}));let bC=a0.ZP.div(tW||(tW=bk(["\n  --field-change-error: ",";\n  &[data-revert-all-changes-hover] [data-revert-all-hover]::before {\n    border-left: 2px solid var(--field-change-error);\n  }\n"])),e=>{let{theme:t}=e;return t.sanity.color.solid.critical.enabled.bg}),b_=a0.ZP.div(t$||(t$=bk(["\n  --field-change-error: ",";\n  --diff-inspect-padding-xsmall: ",";\n  --diff-inspect-padding-small: ",";\n\n  position: relative;\n  padding: var(--diff-inspect-padding-xsmall) 0 var(--diff-inspect-padding-xsmall)\n    var(--diff-inspect-padding-small);\n\n  &::before {\n    content: '';\n    display: block;\n    position: absolute;\n    top: 0;\n    left: 0;\n    bottom: 0;\n    border-left: 1px solid var(--card-border-color);\n  }\n\n  &[data-error]:hover::before,\n  &[data-revert-field-hover]:hover::before {\n    border-left: 2px solid var(--field-change-error);\n  }\n"])),e=>{let{theme:t}=e;return t.sanity.color.solid.critical.enabled.bg},e=>{let{theme:t}=e;return(0,l4.hO)(t.sanity.space[1])},e=>{let{theme:t}=e;return(0,l4.hO)(t.sanity.space[2])}),bS=(0,a0.ZP)(l4.J2)(tX||(tX=bk(["\n  /* hides the popover when the target of it has left the visible part of the window.\n   without it, the popover will be on top of the headers (document title & changes)\n   and footers (changed notifications, publish button etc)*/\n  &[data-popper-reference-hidden='true'] {\n    display: none;\n  }\n"])));function bT(e){var t;let{change:n,hidden:i,readOnly:r}=e,l=n.diffComponent||bm,{documentId:a,schemaType:o,rootDiff:s,isComparingCurrent:d,FieldWrapper:c=lJ.Fragment}=xk(),u=q2(a,o.name),[p,h]=(0,lJ.useState)(!1),[f,m]=(0,lJ.useState)(!1),[g,x]=(0,lJ.useState)(null),[v,b]=Vv({id:a,type:o.name,permission:"update"}),y=(0,lJ.useCallback)(()=>{v2(n,s,u)},[n,s,u]),j=(0,lJ.useCallback)(()=>{h(!0)},[]),w=lJ.useCallback(()=>{h(!1)},[]),k=(0,lJ.useCallback)(()=>{m(!0)},[]),C=(0,lJ.useCallback)(()=>{m(!1)},[]),_=(0,lJ.useCallback)(()=>h(!1),[]);(0,l4.O8)(_,[g]);let S=(null==(t=n.parentSchema)?void 0:t.jsonType)==="array"?n.path.slice(0,-1):n.path;return(0,lJ.useMemo)(()=>i?null:(0,lG.jsxs)(l4.Kq,{space:1,as:bC,children:[n.showHeader&&(0,lG.jsx)(g1,{change:n,titlePath:n.titlePath}),(0,lG.jsx)(c,{path:S,hasHover:f,children:(0,lG.jsxs)(br,{change:n,as:b_,"data-revert-field-hover":f?"":void 0,"data-error":n.error?"":void 0,"data-revert-all-hover":!0,children:[n.error?(0,lG.jsx)(by,{error:n.error}):(0,lG.jsx)(v6,{children:(0,lG.jsx)(g3.Provider,{value:{path:n.path},children:(0,lG.jsx)(l,{diff:n.diff,schemaType:n.schemaType})})}),d&&!b&&(null==v?void 0:v.granted)&&(0,lG.jsx)(bS,{content:(0,lG.jsxs)(l4.xu,{padding:3,sizing:"border",children:["Are you sure you want to revert the changes?",(0,lG.jsxs)(l4.rj,{columns:2,gap:2,marginTop:2,children:[(0,lG.jsx)(l4.zx,{mode:"ghost",onClick:w,children:(0,lG.jsx)(l4.xv,{align:"center",children:"Cancel"})}),(0,lG.jsx)(l4.zx,{tone:"critical",onClick:y,children:(0,lG.jsx)(l4.xv,{align:"center",children:"Revert change"})})]})]}),open:p,portal:!0,placement:"left",ref:x,children:(0,lG.jsx)(l4.xu,{flex:1,children:(0,lG.jsx)(bb,{onClick:j,onMouseEnter:k,onMouseLeave:C,selected:p,disabled:r,"data-testid":"single-change-revert-button-".concat(null==n?void 0:n.key)})})})]})})]}),[n,w,r,p,l,c,i,k,C,y,j,d,b,v,f,S])}var bE=Object.freeze,bP=Object.defineProperty,bA=(e,t)=>bE(bP(e,"raw",{value:bE(t||e.slice())}));let bO=a0.ZP.div(tG||(tG=bA(["\n  display: grid;\n  grid-template-columns: minmax(0, 1fr);\n"]))),bz=a0.ZP.div(tY||(tY=bA(["\n  --field-change-error: ",";\n  --diff-inspect-padding-xsmall: ",";\n  --diff-inspect-padding-small: ",";\n\n  position: relative;\n  padding: var(--diff-inspect-padding-xsmall) var(--diff-inspect-padding-small);\n\n  &::before {\n    content: '';\n    display: block;\n    position: absolute;\n    top: 0;\n    left: 0;\n    bottom: 0;\n    border-left: 1px solid var(--card-border-color);\n  }\n\n  &[data-error]:hover::before,\n  &[data-revert-group-hover]:hover::before,\n  &[data-revert-all-groups-hover]::before {\n    border-left: 2px solid var(--field-change-error);\n  }\n"])),e=>{let{theme:t}=e;return t.sanity.color.solid.critical.enabled.bg},e=>{let{theme:t}=e;return(0,l4.hO)(t.sanity.space[1])},e=>{let{theme:t}=e;return(0,l4.hO)(t.sanity.space[2])}),bM=(0,a0.ZP)(l4.J2)(tJ||(tJ=bA(["\n  /* hides the popover when the target of it has left the visible part of the window.\n   without it, the popover will be on top of the headers (document title & changes)\n   and footers (changed notifications, publish button etc)*/\n  &[data-popper-reference-hidden='true'] {\n    display: none;\n  }\n"])));function bI(e){let{change:t,readOnly:n,hidden:i,...r}=e,{titlePath:l,changes:a,path:o}=t,{path:s}=(0,lJ.useContext)(g3),{documentId:d,schemaType:c,FieldWrapper:u,rootDiff:p,isComparingCurrent:h}=xk(),f=a.every(e=>vB(e)&&xr(e.schemaType)),m=gz(s,o),[g,x]=function(){let e=(0,lJ.useRef)(null),[t,n]=(0,lJ.useState)(!1);return(0,lJ.useEffect)(()=>{let t=e.current;if(!t)return()=>void 0;let i=()=>n(!0),r=()=>n(!1);return t.addEventListener("mouseover",i),t.addEventListener("mouseout",r),()=>{t.removeEventListener("mouseover",i),t.removeEventListener("mouseout",r)}},[]),[e,t]}(),v=q2(d,c.name),[b,y]=(0,lJ.useState)(!1),[j,w]=(0,lJ.useState)(null),[k,C]=Vv({id:d,type:c.name,permission:"update"}),_=(0,lJ.useCallback)(()=>v2(t,p,v),[t,p,v]),S=(0,lJ.useCallback)(()=>{y(!0)},[]),T=(0,lJ.useCallback)(()=>{y(!1)},[]);(0,l4.O8)(()=>y(!1),[j]);let E=(0,lJ.useMemo)(()=>i?null:(0,lG.jsxs)(l4.Kq,{space:1,as:bz,"data-revert-group-hover":x?"":void 0,"data-portable-text":f?"":void 0,children:[(0,lG.jsx)(l4.Kq,{as:bO,space:5,children:a.map(e=>(0,lG.jsx)(bR,{change:e,readOnly:n,hidden:i},e.key))}),h&&!C&&(null==k?void 0:k.granted)&&(0,lG.jsx)(bM,{content:(0,lG.jsxs)(l4.xu,{children:["Are you sure you want to revert the changes?",(0,lG.jsxs)(l4.rj,{columns:2,gap:2,marginTop:2,children:[(0,lG.jsx)(l4.zx,{mode:"ghost",onClick:T,children:(0,lG.jsx)(l4.xv,{align:"center",children:"Cancel"})}),(0,lG.jsx)(l4.zx,{tone:"critical",onClick:_,children:(0,lG.jsx)(l4.xv,{align:"center",children:"Revert change"})})]})]}),portal:!0,padding:4,placement:"left",open:b,ref:w,children:(0,lG.jsx)(l4.xu,{children:(0,lG.jsx)(bb,{onClick:S,ref:g,selected:b,disabled:n,"data-testid":"group-change-revert-button-".concat(t.fieldsetName)})})})]}),[a,T,b,n,t.fieldsetName,_,S,i,h,x,C,f,k,g]);return i?null:(0,lG.jsxs)(l4.Kq,{space:1,...r,children:[(0,lG.jsx)(g1,{titlePath:l}),m||!u?E:(0,lG.jsx)(u,{hasHover:x,path:t.path,children:E})]})}function bR(e){var t,n;let{change:i,hidden:r,readOnly:l}=e,{value:a}=xk(),o=g2({document:a,checkProperty:r||(null==(t=i.schemaType)?void 0:t.hidden),checkPropertyKey:"hidden",value:"field"===i.type?i.diff.toValue:void 0}),s=g2({document:a,checkProperty:l||(null==(n=i.schemaType)?void 0:n.readOnly),checkPropertyKey:"readOnly",value:"field"===i.type?i.diff.toValue:void 0});return o?null:"field"===i.type?(0,lG.jsx)(bT,{change:i,readOnly:s}):"group"===i.type?(0,lG.jsx)(bI,{change:i,"data-testid":"group-change-".concat(i.fieldsetName),readOnly:s}):(0,lG.jsxs)(l4.xv,{children:["Unknown change type: ",(0,lG.jsx)("code",{children:i.type||"undefined"})]})}function bF(){return(0,lG.jsxs)(l4.Kq,{space:3,children:[(0,lG.jsx)(l4.xv,{size:1,weight:"semibold",as:"h3",children:"There are no changes"}),(0,lG.jsx)(l4.xv,{as:"p",size:1,muted:!0,children:"Edit the document or select an older version in the timeline to see a list of changes appear in this panel."})]})}var bD=Object.freeze,bZ=Object.defineProperty,bL=(e,t)=>bD(bZ(e,"raw",{value:bD(t||e.slice())}));let bq=a0.ZP.div(tQ||(tQ=bL(["\n  display: grid;\n  grid-template-columns: minmax(0, 1fr);\n"]))),bN=(0,a0.ZP)(l4.J2)(t0||(t0=bL(["\n  /* hides the popover when the target of it has left the visible part of the window.\n   without it, the popover will be on top of the headers (document title & changes)\n   and footers (changed notifications, publish button etc)*/\n  &[data-popper-reference-hidden='true'] {\n    display: none;\n  }\n"])));function bV(e){let{diff:t,fields:n,schemaType:i}=e,{documentId:r,isComparingCurrent:l,value:a}=xk(),o=q2(r,i.name),{path:s}=(0,lJ.useContext)(g3),d=0===s.length,[c,u]=(0,lJ.useState)(!1),[p,h]=(0,lJ.useState)(!1),f=g2({document:a,value:void 0,checkProperty:i.readOnly,checkPropertyKey:"readOnly"});if("object"!==i.jsonType)throw Error("Only object schema types are allowed in ChangeList");let[m,g]=Vv({id:r,type:i.name,permission:"update"}),x=(0,lJ.useMemo)(()=>vW(i,t,s,[],{fieldFilter:n}),[i,n,s,t]),v=(0,lJ.useMemo)(()=>n&&0===n.length?[]:1===x.length&&"group"===x[0].type&&0===x[0].path.length?x[0].changes:x,[x,n]),b=x[0],y=(0,lJ.useCallback)(()=>{v2(b,t,o),u(!1)},[b,t,o]),j=(0,lJ.useCallback)(()=>{u(!0)},[]),w=(0,lJ.useCallback)(()=>{h(!0)},[]),k=(0,lJ.useCallback)(()=>{h(!1)},[]),C=(0,lJ.useCallback)(()=>{u(!1)},[]),[_,S]=(0,lJ.useState)(null),T=(0,lJ.useCallback)(()=>u(!1),[]);if((0,l4.O8)(T,[_]),0===v.length)return d?(0,lG.jsx)(bF,{}):null;let E=d&&v.length>1;return(0,lG.jsx)(l4.Zb,{children:(0,lG.jsxs)(l4.Kq,{space:5,children:[(0,lG.jsx)(l4.Kq,{as:bq,space:5,children:v.map(e=>(0,lG.jsx)("div",{children:(0,lG.jsx)(bR,{change:e,"data-revert-all-changes-hover":p?"":void 0,readOnly:f||(null==e?void 0:e.readOnly),hidden:null==e?void 0:e.hidden},e.key)},e.key))}),E&&l&&!g&&(null==m?void 0:m.granted)&&(0,lG.jsx)(bN,{content:(0,lG.jsxs)(l4.xu,{children:["Are you sure you want to revert all ",v.length," changes?",(0,lG.jsxs)(l4.rj,{columns:2,gap:2,marginTop:2,children:[(0,lG.jsx)(l4.zx,{mode:"ghost",text:"Cancel",onClick:C}),(0,lG.jsx)(l4.zx,{tone:"critical",text:"Revert all",onClick:y})]})]}),open:c,padding:4,placement:"left",portal:!0,ref:S,children:(0,lG.jsx)(l4.Kq,{children:(0,lG.jsx)(l4.zx,{tone:"critical",mode:"ghost",text:"Revert all changes",icon:a8.V13,onClick:j,onMouseEnter:w,onMouseLeave:k,disabled:f})})})]})})}var bU=Object.freeze,bB=Object.defineProperty,bK=(e,t)=>bU(bB(e,"raw",{value:bU(t||e.slice())}));let bH=a0.ZP.span(t1||(t1=bK(["\n  border-radius: ",";\n"])),e=>{let{theme:t}=e;return(0,l4.hO)(t.sanity.radius[1])}),bW=(0,a0.ZP)(l4.xv)(t2||(t2=bK(["\n  &:not([hidden]) {\n    display: inline;\n    line-height: calc(1.25em + 2px);\n  }\n\n  &:hover {\n    background-color: none !important;\n    background-image: linear-gradient(\n      to bottom,\n      var(--card-bg-color) 0,\n      var(--card-bg-color) 33.333%,\n      currentColor 33.333%,\n      currentColor 100%\n    );\n    background-size: 1px 3px;\n    background-repeat: repeat-x;\n    background-position-y: bottom;\n    padding-bottom: 3px;\n    box-shadow: 0 0 0 1px var(--card-bg-color);\n    z-index: 1;\n  }\n"])));function b$(e){let{segment:t}=e,{text:n}=t;return"added"===t.action?(0,lG.jsx)(gK,{annotation:t.annotation,disableHoverEffect:!0,tooltip:{description:"Added"},as:bH,children:(0,lG.jsx)(bW,{as:"ins",style:{textDecoration:"none"},children:n})}):"removed"===t.action?(0,lG.jsx)(gK,{annotation:t.annotation,as:bH,disableHoverEffect:!0,tooltip:{description:"Removed"},children:(0,lG.jsx)(bW,{as:"del",children:n})}):(0,lG.jsx)(l4.Zb,{as:"span",radius:2,style:{display:"inline"},children:n})}function bX(e){let{diff:t}=e;return(0,lG.jsx)(lG.Fragment,{children:(t.segments||[]).map((e,t)=>(0,lG.jsx)(b$,{segment:e},t))})}var bG=Object.freeze,bY=Object.defineProperty;let bJ=(0,a0.ZP)(l4.xv)(t3||(t3=bG(bY(C=["\n  color: inherit;\n"],"raw",{value:bG(C.slice())}))));function bQ(e){let{title:t,action:n,icon:i,children:r,markRemoved:l}=e;return(0,lG.jsxs)(l4.kC,{padding:2,align:"center",children:[i&&(0,lG.jsx)(l4.xu,{padding:2,children:(0,lG.jsx)(bJ,{size:4,forwardedAs:l?"del":"div",children:(0,lJ.createElement)(i)})}),(0,lG.jsxs)(l4.Kq,{space:2,paddingLeft:2,children:[(0,lG.jsx)(bJ,{size:1,weight:"semibold",forwardedAs:l?"del":"h3",textOverflow:"ellipsis",children:t}),n&&(0,lG.jsx)("div",{children:n}),(0,lG.jsx)(bJ,{size:0,textOverflow:"ellipsis",children:r})]})]})}var b0=Object.freeze,b1=Object.defineProperty;a0.ZP.div(t4||(t4=b0(b1(_=["\n  display: inline-block;\n  word-break: break-all;\n  white-space: pre-wrap;\n"],"raw",{value:b0(_.slice())}))));let b2=(0,lJ.createContext)({hoveredStack:[],onMouseEnter:()=>void 0,onMouseLeave:()=>void 0});function b3(){return(0,lJ.useContext)(b2)}let b4=(0,lJ.createContext)({actions:[],focused:!1,hovered:!1,onMouseEnter:()=>void 0,onMouseLeave:()=>void 0});function b5(e){let{actions:t,children:n,path:i,focused:r}=e,{onMouseEnter:l,onMouseLeave:a}=b3(),o=b3().hoveredStack[0],s=cP||!!o&&gP(i)===o,d=(0,lJ.useCallback)(()=>{l(i)},[l,i]),c=(0,lJ.useCallback)(()=>{a(i)},[a,i]),u=(0,lJ.useMemo)(()=>({actions:t,focused:r,hovered:s,onMouseEnter:d,onMouseLeave:c}),[t,r,d,c,s]);return(0,lG.jsx)(b4.Provider,{value:u,children:n})}function b6(){return(0,lJ.useContext)(b4)}function b8(e){let{children:t}=e,[n,i]=(0,lJ.useState)([]),r=(0,lJ.useCallback)(e=>{let t=gP(e);i(e=>e.includes(t)?e:[t,...e])},[]),l=(0,lJ.useCallback)(e=>{let t=gP(e);i(e=>e.includes(t)?e.filter(e=>e!==t):e)},[]),a=(0,lJ.useMemo)(()=>({hoveredStack:n,onMouseEnter:r,onMouseLeave:l}),[r,l,n]);return(0,lG.jsx)(b2.Provider,{value:a,children:t})}let b9={publish:()=>void 0,subscribe:()=>(console.warn("No patch channel provided to form-builder. If you need input based patch updates, please provide one"),()=>void 0)};function b7(e){let{__internal_fieldActions:t=ch,__internal_patchChannel:n=b9,autoFocus:i,changesOpen:r,children:l,collapsedFieldSets:a,collapsedPaths:o,file:s,filterField:d,focusPath:c,focused:u,groups:p,id:h,image:f,members:m,onChange:g,onFieldGroupSelect:x,onPathBlur:v,onPathFocus:b,onPathOpen:y,onSetFieldSetCollapsed:j,onSetPathCollapsed:w,presence:k,readOnly:C,renderAnnotation:_,renderBlock:S,renderField:T,renderInlineBlock:E,renderInput:P,renderItem:A,renderPreview:O,schemaType:z,unstable:M,validation:I,value:R}=e,F=(0,lJ.useRef)(R);(0,lJ.useEffect)(()=>{F.current=R},[R]);let D=(0,lJ.useMemo)(()=>({patchChannel:n,components:{ArrayFunctions:mQ,CustomMarkers:(null==M?void 0:M.CustomMarkers)||m6,Markers:(null==M?void 0:M.Markers)||m5},field:{actions:t},file:{assetSources:s.assetSources,directUploads:(null==s?void 0:s.directUploads)!==!1},filterField:d||(()=>!0),image:{assetSources:f.assetSources,directUploads:(null==f?void 0:f.directUploads)!==!1},getDocument:()=>F.current,onChange:g}),[t,s.assetSources,null==s?void 0:s.directUploads,d,f.assetSources,null==f?void 0:f.directUploads,g,n,null==M?void 0:M.CustomMarkers,null==M?void 0:M.Markers]),Z=(0,lJ.useMemo)(()=>({__internal:D,autoFocus:i,changesOpen:r,collapsedFieldSets:a,collapsedPaths:o,focusPath:c,focused:u,groups:p,id:h,members:m,readOnly:C,renderAnnotation:_,renderBlock:S,renderField:T,renderInlineBlock:E,renderInput:P,renderItem:A,renderPreview:O,schemaType:z,value:R}),[D,i,r,a,o,R,c,u,p,h,m,C,_,S,T,E,P,A,O,z]);return(0,lG.jsx)(mG.Provider,{value:Z,children:(0,lG.jsx)(m9,{onChange:g,onFieldGroupSelect:x,onPathBlur:v,onPathFocus:b,onPathOpen:y,onSetPathCollapsed:w,onSetFieldSetCollapsed:j,children:(0,lG.jsx)(gn,{presence:k,children:(0,lG.jsx)(gl,{validation:I,children:(0,lG.jsx)(b8,{children:l})})})})})}function ye(e){let{__internal_fieldActions:t,__internal_patchChannel:n,autoFocus:i,changesOpen:r,children:l,collapsedFieldSets:a,collapsedPaths:o,focusPath:s,focused:d,groups:c,id:u,members:p,onChange:h,onPathBlur:f,onPathFocus:m,onPathOpen:g,onFieldGroupSelect:x,onSetPathCollapsed:v,onSetFieldSetCollapsed:b,presence:y,readOnly:j,schemaType:w,validation:k,value:C}=e,{file:_,image:S}=Ic().form,T=fR({defaultComponent:zv,pick:z_}),E=fR({defaultComponent:zb,pick:zS}),P=zz(),A=fR({defaultComponent:zy,pick:zE}),O=fR({defaultComponent:zw,pick:zP}),z=fR({defaultComponent:zk,pick:zA}),M=fR({defaultComponent:zC,pick:zO}),I=(0,lJ.useCallback)(e=>(0,lG.jsx)(T,{...e}),[T]),R=(0,lJ.useCallback)(e=>(0,lG.jsx)(E,{...e}),[E]),F=(0,lJ.useCallback)(e=>(0,lG.jsx)(A,{...e}),[A]),D=(0,lJ.useCallback)(e=>(0,lG.jsx)(fX,{component:P,...e}),[P]),Z=(0,lJ.useCallback)(e=>(0,lG.jsx)(O,{...e}),[O]),L=(0,lJ.useCallback)(e=>(0,lG.jsx)(z,{...e}),[z]),q=(0,lJ.useCallback)(e=>(0,lG.jsx)(M,{...e}),[M]);return(0,lG.jsx)(b7,{__internal_fieldActions:t,__internal_patchChannel:n,autoFocus:i,changesOpen:r,collapsedFieldSets:a,collapsedPaths:o,file:_,focusPath:s,focused:d,groups:c,id:u,image:S,members:p,onChange:h,onPathBlur:f,onPathFocus:m,onPathOpen:g,onFieldGroupSelect:x,onSetPathCollapsed:v,onSetFieldSetCollapsed:b,presence:y,readOnly:j,renderAnnotation:q,renderBlock:Z,renderField:R,renderInlineBlock:L,renderInput:I,renderItem:F,renderPreview:D,schemaType:w,validation:k,value:C,children:l})}function yt(e){let{__internal_fieldActions:t,__internal_patchChannel:n,autoFocus:i,changesOpen:r,collapsedFieldSets:l,collapsedPaths:a,focusPath:o,focused:s,groups:d,id:c,members:u,onChange:p,onPathBlur:h,onPathFocus:f,onPathOpen:m,onFieldGroupSelect:g,onSetFieldSetCollapsed:x,onSetPathCollapsed:v,presence:b,readOnly:y,schemaType:j,validation:w,value:k}=e;return(0,lG.jsx)(ye,{__internal_fieldActions:t,__internal_patchChannel:n,autoFocus:i,changesOpen:r,collapsedFieldSets:l,collapsedPaths:a,focusPath:o,focused:s,groups:d,id:c,members:u,onChange:p,onPathBlur:h,onPathFocus:f,onPathOpen:m,onFieldGroupSelect:g,onSetPathCollapsed:v,onSetFieldSetCollapsed:x,presence:b,validation:w,readOnly:y,schemaType:j,value:k,children:(0,lG.jsx)(yn,{})})}function yn(){let{focusPath:e,focused:t,groups:n,id:i,members:r,readOnly:l,renderAnnotation:a,renderBlock:o,renderField:s,renderInlineBlock:d,renderInput:c,renderItem:u,renderPreview:p,schemaType:h,value:f}=mY(),{onChange:m,onFieldGroupSelect:g,onPathBlur:x,onPathFocus:v,onPathOpen:b,onSetFieldSetCollapsed:y,onSetPathCollapsed:j}=m7(),w=(0,lJ.useCallback)(e=>j([e],!0),[j]),k=(0,lJ.useCallback)(e=>j([e],!1),[j]),C=(0,lJ.useCallback)(()=>x(ch),[x]),_=(0,lJ.useCallback)(()=>v(ch),[v]),S=(0,lJ.useCallback)(e=>m(mN.from(e)),[m]),T=(0,lJ.useRef)(null),E=(0,lJ.useCallback)(e=>g(ch,e),[g]),P=(0,lJ.useCallback)(e=>b([e]),[b]),A=(0,lJ.useCallback)(()=>b([]),[b]),O=(0,lJ.useCallback)(e=>y([e],!0),[y]),z=(0,lJ.useCallback)(e=>y([e],!1),[y]),M={focusPath:e,elementProps:{ref:T,id:i,onBlur:C,onFocus:_,"aria-describedby":void 0},changed:r.some(e=>"field"===e.kind&&e.field.changed),focused:t,groups:n,id:i,level:0,members:r,onChange:S,onFieldClose:A,onFieldCollapse:w,onFieldSetCollapse:O,onFieldExpand:k,onFieldSetExpand:z,onPathFocus:v,onFieldOpen:P,onFieldGroupSelect:E,path:ch,presence:ch,readOnly:l,renderAnnotation:a,renderBlock:o,renderField:s,renderInlineBlock:d,renderInput:c,renderItem:u,renderPreview:p,schemaType:h,validation:ch,value:f};return(0,lG.jsx)(lG.Fragment,{children:c(M)})}let yi=(0,lJ.createContext)({});function yr(){return(0,lJ.useContext)(yi)}function yl(e){let{children:t,activePath:n,EditReferenceLinkComponent:i,onEditReference:r,initialValueTemplateItems:l}=e,a=(0,lJ.useMemo)(()=>({activePath:n,EditReferenceLinkComponent:i,onEditReference:r,initialValueTemplateItems:l}),[n,i,r,l]);return(0,lG.jsx)(yi.Provider,{value:a,children:t})}function ya(e,t){return m$(t,(0,lJ.useCallback)((t,n)=>{e.current&&!t&&n&&(0,sF.Z)(e.current,{scrollMode:"always"})},[e]))}(0,lJ.createContext)(null);let yo=()=>{if(l)return l;l=[];for(let e=0;e<256;++e)l[e]=(e+256).toString(16).substring(1);return l};function ys(e){let t=yo();return(function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:16,t=new Uint8Array(e);return(0,sP.Z)(t),t})(e).reduce((e,n)=>e+t[n],"").slice(0,e)}var yd=Object.freeze,yc=Object.defineProperty,yu=(e,t)=>yd(yc(e,"raw",{value:yd(t||e.slice())}));let yp={portal:!0},yh=(0,a0.ZP)(l4.Zb)(e=>{var t;let{theme:n,$selected:i}=e,{color:r}=n.sanity;return(0,a0.iv)(t5||(t5=yu(["\n    --card-bg-color: inherit;\n    --card-fg-color: inherit;\n    --card-hairline-hard-color: ",";\n  "])),i?null==(t=r.selectable)?void 0:t.default.pressed.border:void 0)}),yf=(0,a0.ZP)(l4.xu)(t6||(t6=yu(["\n  max-width: 150px;\n"]))),ym=e=>1===e.length?"".concat(e[0].user.displayName," is editing this document"):e.length>1?"".concat(e.length," people are editing this document right now"):void 0;function yg(e){let{presence:t}=e,{color:n}=(0,a0.Fg)().sanity,i=n.dark?"light":"dark",{selected:r}=function(){let e=(0,lJ.useContext)(uV);if(!e)throw Error("PreviewCard: missing context value");return e}(),l=(0,lJ.useMemo)(()=>Array.from(new Set(t.map(e=>e.user.id))).map(e=>t.find(t=>t.user.id===e)).filter(cr),[t]),a=(0,lJ.useMemo)(()=>(0,lG.jsx)(yf,{padding:2,children:(0,lG.jsx)(l4.xv,{align:"center",size:1,children:ym(l)})}),[l]);return(0,lG.jsx)(l4.u,{content:a,...yp,children:(0,lG.jsx)(yh,{scheme:r?i:void 0,$selected:r,children:(0,lG.jsx)(l4.Jh,{maxLength:2,"aria-label":ym(l),children:l.map(e=>(0,lG.jsx)(UP,{user:e.user},e.user.id))})})})}let yx=[0,.25,.75,1],yv=(e,t)=>{let n=e.length>t?t-1:t,i=Math.max(0,e.length-n);return[e.slice(0,i),e.slice(i)]};var yb=Object.freeze,yy=Object.defineProperty,yj=(e,t)=>yb(yy(e,"raw",{value:yb(t||e.slice())}));let yw=(0,a0.ZP)(l4.kC)(t8||(t8=yj(["\n  & > div:first-child {\n    flex: 1;\n    min-width: 0;\n  }\n"]))),yk=(0,a0.ZP)(l4.kC)(t9||(t9=yj(["\n  height: 23px;\n  min-width: 23px;\n  vertical-align: top;\n"]))),yC=lJ.createContext([]);function y_(e){let{children:t,items:n}=e,i=(0,lJ.useMemo)(()=>(0,lG.jsx)(l4.Kq,{padding:1,sizing:"border",children:n.map(e=>(0,lG.jsxs)(l4.kC,{align:"center",gap:2,padding:1,children:[(0,lG.jsx)("div",{children:(0,lG.jsx)(UP,{user:e.user,status:"online"})}),(0,lG.jsx)(l4.xv,{size:1,children:e.user.displayName})]},e.user.id))}),[n]);return(0,lG.jsx)(l4.u,{content:i,placement:"top",portal:"documentScrollElement",children:t})}let{Tracker:yS,useReporter:yT,useReportedValues:yE}=d5(),yP=(0,lJ.memo)(function(e){let{presence:t,position:n="inside",animateArrowFrom:i="inside",maxAvatars:r=3,stack:l=!0}=e,a=oC()(t||[],e=>e.user.id),o=a2()(a,e=>e.lastActiveAt),[s,d]=l?yv(o,r):[[],o],c=[...d.reverse().map(e=>({key:e.user.id,element:(0,lG.jsx)(UP,{animateArrowFrom:i,position:n,status:"online",user:e.user})})),s.length>=2?{key:"counter",element:(0,lG.jsx)(l4.p2,{count:s.length})}:null].filter(Boolean);return(0,lG.jsxs)(yw,{children:[(0,lG.jsx)("div",{}),(0,lG.jsx)(yk,{direction:"row-reverse",children:c.map((e,t)=>e&&(0,lG.jsx)("div",{style:{position:"absolute",transform:"translate3d(".concat(-(19*t),"px, 0px, 0px)"),transitionProperty:"transform",transitionDuration:"200ms",transitionTimingFunction:"cubic-bezier(0.85, 0, 0.15, 1)",zIndex:100-t},children:e.element},e.key))})]})}),yA=function(e){let t=(0,lJ.useContext)(yC),{presence:n=t,maxAvatars:i=3}=e,r=(0,lJ.useRef)(null);yT((0,lJ.useId)(),()=>({presence:n,element:r.current,maxAvatars:i}));let l=(0,lJ.useMemo)(()=>oC()(n||[],e=>e.user.id),[n]);return(0,lG.jsx)(y_,{items:l,children:(0,lG.jsx)(yw,{ref:r,style:{minHeight:23,minWidth:23}})})},yO=e=>{let t=new l7.x,n=new IntersectionObserver(e=>{e.forEach(e=>{t.next(e)})},e);return{observe:e=>new al.y(i=>{let r=t.pipe((0,aj.h)(t=>t.target===e)).subscribe(i);return n.observe(e),()=>{r.unsubscribe(),n.unobserve(e)}})}},yz=e=>{let{onIntersection:t,io:n,id:i,...r}=e,l=lJ.useRef(null);return lJ.useEffect(()=>{let e=l.current;if(!e)return;let r=n.observe(e).pipe((0,am.b)(e=>t(i,e))).subscribe();return()=>r.unsubscribe()},[n,i,t]),(0,lG.jsx)("div",{ref:l,...r})};var yM=Object.freeze,yI=Object.defineProperty,yR=(e,t)=>yM(yI(e,"raw",{value:yM(t||e.slice())}));let yF=a0.ZP.div(t7||(t7=yR(["\n  position: relative;\n"]))),yD=a0.ZP.div(ne||(ne=yR(["\n  position: absolute;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  pointer-events: none;\n  z-index: 13;\n"]))),yZ=(0,a0.iv)(nt||(nt=yR(["\n  overflow: hidden;\n  overflow: clip;\n  pointer-events: none;\n  position: absolute;\n"]))),yL=(0,a0.ZP)(yz)(e=>{let{$debug:t,margins:n}=e;return(0,a0.iv)(nn||(nn=yR(["\n    ","\n\n    z-index: 100;\n    position: sticky;\n    height: 1px;\n    top: ",";\n    background-color: ",";\n  "])),yZ,n?"".concat(n[0]-1,"px"):void 0,t?"red":"none")}),yq=(0,a0.ZP)(yz)(e=>{let{$debug:t}=e;return(0,a0.iv)(nr||(nr=yR(["\n    ","\n\n    visibility: none;\n\n    ","\n  "])),yZ,t&&(0,a0.iv)(ni||(ni=yR(["\n      background: rgba(255, 0, 0, 0.25);\n      outline: 1px solid #00b;\n      visibility: visible;\n    "]))))}),yN=(0,a0.ZP)(yz)(e=>{let{$debug:t}=e;return(0,a0.iv)(nl||(nl=yR(["\n    ","\n\n    position: sticky;\n    bottom: -1px;\n    height: 1px;\n    background-color: ",";\n  "])),yZ,t?"blue":"transparent")}),yV=e=>"".concat(e,"px"),yU=e=>0-e,yB=(0,lJ.forwardRef)(function(e,t){let{regions:n,render:i,children:r,margins:l}=e,a=(0,lJ.useRef)(null),o=(0,lJ.useMemo)(()=>l,[JSON.stringify(l)]),s=(0,lJ.useMemo)(()=>yO({rootMargin:o.map(yU).map(yV).join(" "),threshold:yx}),[o]),[d,c]=(0,lJ.useState)({}),u=(0,lJ.useCallback)((e,t)=>{c(n=>({...n,[e]:t}))},[]),p=d["::top"],h=d["::bottom"],f=(0,lJ.useMemo)(()=>p&&h?n.filter(e=>{var t;return(null==(t=e.presence)?void 0:t.length)>0}).map(e=>{let t=d[e.id];if(!t)return null;let{bottom:n,top:i}=t.boundingClientRect,r=t.boundingClientRect.top<p.boundingClientRect.bottom,l=t.boundingClientRect.top<h.boundingClientRect.top,a=t.isIntersecting?i-(t.intersectionRect.top-23):r?-p.boundingClientRect.bottom:h.boundingClientRect.top,o=t.isIntersecting?-(n-(t.intersectionRect.bottom+23)):l?h.boundingClientRect.top:-p.boundingClientRect.bottom;return{distanceTop:a,distanceBottom:o,region:e,position:a<=8?"top":o<=8?"bottom":"inside"}}).filter(Boolean):[],[h,d,n,p]);return(0,lG.jsxs)(yF,{ref:t,children:[(0,lG.jsx)(yL,{$debug:!1,io:s,id:"::top",onIntersection:u,margins:o}),(0,lG.jsx)("div",{children:r}),(0,lG.jsx)(yD,{ref:a,children:a.current&&i(f,a.current.offsetWidth)}),n.map(e=>{let t=0===e.rect.width;return(0,lG.jsx)(yq,{$debug:!1,io:s,onIntersection:u,id:e.id,style:{width:t?1:e.rect.width,left:e.rect.left-(t?1:0),top:e.rect.top-23,height:e.rect.height+46}},e.id)}),(0,lG.jsx)(yN,{$debug:!1,id:"::bottom",io:s,onIntersection:u})]})}),yK={transitionProperty:"transform",transitionDuration:"200ms",transitionTimingFunction:"cubic-bezier(0.85, 0, 0.15, 1)"},yH=e=>e.top+e.height,yW=e=>sC()(e,e=>e.region.rect.top),y$=(e,t)=>e+t,yX=e=>e.reduce(y$,0),yG=e=>{let{height:t,...n}=e;return(0,lG.jsx)("div",{style:{height:Math.max(0,t),...null==n?void 0:n.style}})},yY=[0,0,0,0],yJ=(e,t)=>{let n=e,i=-n.scrollTop,r=0;for(;n&&n!==t;)i+=n.offsetTop-n.scrollTop,r+=n.offsetLeft,n=n.offsetParent instanceof HTMLElement?n.offsetParent:null;return{top:i,left:r}};function yQ(e){let{children:t,margins:n=yY}=e,i=yE(),r=lJ.useRef(null),l=lJ.useMemo(()=>{var e;return r.current?(e=r.current,i.map(t=>{var n;let[i,r]=t;return{...r,id:i,rect:{...yJ(n=r.element,e),width:n.offsetWidth,height:n.offsetHeight}}})):y0},[i]),a=lJ.useCallback((e,t)=>{let i=function(e){let t=yW(e).map((e,t,n)=>{var i;let r=null==(i=n[t-1])?void 0:i.region.rect,l=r?yH(r):0;return{...e,spacerHeight:e.region.rect.top-l}}),n={top:[],inside:[],bottom:[],...sI()(t,e=>e.position)};return{top:yW(n.top).map((e,t,n)=>({...e,indent:n.slice(t+1).reduce((e,t)=>e+t.region.rect.width,0)})),inside:yW(n.inside).map(e=>({...e,indent:0})),bottom:yW(n.bottom).map((e,t,n)=>({...e,indent:n.slice(0,t).reduce((e,t)=>e+t.region.rect.width,0)}))}}(e.filter(e=>e.region.presence.length>0)),r=yX(i.top.map(e=>e.region.rect.height+e.spacerHeight)),l=yX([...i.inside,...i.bottom].map(e=>e.region.rect.height+e.spacerHeight)),a=i.inside.reduce((e,t)=>{let{distanceTop:n,distanceBottom:i}=t;return{nearTop:e.nearTop+(n<=20?t.region.presence.length:0),nearBottom:e.nearBottom+(i<=20?t.region.presence.length:0)}},{nearTop:0,nearBottom:0});return(0,lG.jsxs)(lG.Fragment,{children:[(0,lG.jsx)(y1,{closeCount:a.nearTop,margins:n,position:"top",regionsWithIntersectionDetails:i.top}),(0,lG.jsx)(yG,{height:r}),(0,lG.jsx)(y2,{containerWidth:t,regionsWithIntersectionDetails:i.inside}),(0,lG.jsx)(yG,{height:l}),(0,lG.jsx)(y1,{closeCount:a.nearBottom,margins:n,position:"bottom",regionsWithIntersectionDetails:i.bottom})]})},[n]);return(0,lG.jsx)(yB,{ref:r,margins:n,regions:l,render:a,children:t})}let y0=[],y1=(0,lJ.memo)(function(e){let{closeCount:t,margins:n,position:i,regionsWithIntersectionDetails:r}=e,l="top"===i?1:-1,a=(0,lJ.useMemo)(()=>r.length?ow()(a2()(r,e=>e.region.rect.top*l).map(e=>e.region.presence||y0)):y0,[l,r]),[o,s,d,c]=n,u=(c||0)+(a.length>0?-(19*t):0)-s,p="top"===i?o:d,h=(0,lJ.useMemo)(()=>({zIndex:2,position:"sticky",display:"flex",flexDirection:"column",alignItems:"flex-end",...yK,transform:"translate3d(".concat(u,"px, 0px, 0px)"),top:5+p,bottom:5+p}),[u,p]);return(0,lG.jsx)("div",{"data-dock":i,style:h,children:(0,lG.jsx)(yP,{position:i,maxAvatars:3,presence:a})},"sticky-".concat(i))});function y2(e){let{regionsWithIntersectionDetails:t,containerWidth:n}=e;return(0,lG.jsx)(lG.Fragment,{children:t.map(e=>{let t=e.region.rect.left,{distanceTop:i,distanceBottom:r}=e,l=i<=20,a=r<=20,o=n-t-e.region.rect.width,{presence:s,maxAvatars:d}=e.region;return(0,lG.jsx)(lJ.Fragment,{children:(0,lG.jsx)("div",{style:{zIndex:2,position:"absolute",...yK,left:t,transform:"translate3d(".concat(l||a?o:0,"px, 0px, 0px)"),height:e.region.rect.height,top:e.region.rect.top},children:(0,lG.jsx)(y3,{value:()=>"⤒".concat(i," | ").concat(r,"⤓"),children:(0,lG.jsx)(yP,{stack:!l&&!a,position:l?"top":a?"bottom":"inside",maxAvatars:d,presence:s})})})},e.region.id)})})}let y3=e=>e.children,y4=[0,0,0,0],y5=function(e){let{children:t,margins:n}=e;return(0,lG.jsx)(yS,{children:(0,lG.jsx)(yQ,{margins:n||y4,children:t})})};var y6=Object.freeze,y8=Object.defineProperty,y9=(e,t)=>y6(y8(e,"raw",{value:y6(t||e.slice())}));let y7={open:500},je=(0,a0.ZP)(l4.kC)(na||(na=y9(["\n  /* Prevent buttons from taking up extra vertical space */\n  line-height: 1;\n  /* For floating actions menu */\n  position: relative;\n"]))),jt=(0,a0.ZP)(l4.xu)(e=>{let{theme:t,$right:n}=e,{space:i}=t.sanity;return(0,a0.iv)(no||(no=y9(["\n    position: absolute;\n    bottom: 0;\n    right: ","px;\n  "])),n+i[1])}),jn=(0,a0.ZP)(l4.xu)(e=>{let{theme:t,$presenceMaxWidth:n}=e,{space:i}=t.sanity;return(0,a0.iv)(ns||(ns=y9(["\n    max-width: calc(100% - ","px);\n    min-width: 75%;\n  "])),n+i[1])}),ji=(0,a0.ZP)(l4.xu)(e=>{let{theme:t,$right:n,$fieldActionsVisible:i}=e,{space:r}=t.sanity,l=i?n+r[1]:n;return(0,a0.iv)(nd||(nd=y9(["\n    position: absolute;\n    bottom: 0;\n    right: ","px;\n  "])),l)}),jr=(0,a0.ZP)(l4.Zb)(e=>{let{theme:t}=e,n=t.sanity.space[1]/2;return(0,a0.iv)(nc||(nc=y9(["\n    align-items: center;\n    bottom: 0;\n    gap: ","px;\n    padding: ","px;\n    position: absolute;\n    right: 0;\n\n    @media (hover: hover) {\n      // If hover is supported, we hide the floating card by default\n      // and only show it when it has focus within or when the field is hovered or focused.\n      opacity: 0;\n      pointer-events: none;\n\n      [data-ui='FieldActionsFlex'] {\n        opacity: 0;\n        width: 0;\n      }\n\n      &[data-actions-visible='false']:not(:focus-within) {\n        // Remove the shadow when the field actions are not visible\n        box-shadow: none;\n\n        // Since the field actions always will be present in the DOM (to make them focusable) –\n        // they will always affect the width of the floating card, even when they are not visible.\n        // Therefore, we remove the background of the floating card when the field actions are not visible.\n        background: transparent;\n      }\n\n      // Remove the shadow when the field has comments but no actions\n      &[data-has-comments='true']:not([data-has-actions='true']) {\n        box-shadow: none;\n      }\n\n      // Show the floating card when it has focus within (ie when field actions are focused).\n      &:focus-within {\n        opacity: 1;\n        pointer-events: auto;\n        width: max-content;\n\n        [data-ui='FieldActionsFlex'] {\n          opacity: 1;\n          pointer-events: auto;\n          width: max-content;\n        }\n      }\n    }\n\n    &[data-visible='true'] {\n      opacity: 1;\n      pointer-events: auto;\n      width: max-content;\n    }\n\n    &[data-actions-visible='true'] {\n      [data-ui='FieldActionsFlex'] {\n        opacity: 1;\n        pointer-events: auto;\n        width: max-content;\n      }\n    }\n  "])),n,n)}),jl=(0,a0.ZP)(l4.kC)(nu||(nu=y9(["\n  gap: inherit;\n"])));function ja(e){let{__internal_comments:t,__internal_slot:n,actions:i,content:r,fieldFocused:l,fieldHovered:a,presence:o}=e,[s,d]=(0,lJ.useState)(!1),[c,u]=(0,lJ.useState)(null),[p,h]=(0,lJ.useState)(0),[f,m]=(0,lJ.useState)(null),[g,x]=(0,lJ.useState)(0),{hasComments:v=!1,button:b=null,isAddingComment:y=!1}=t||{},j=i&&i.length>0,w=l||a||s||y,k=(null==t?void 0:t.button)||j,C=w||v,_=(0,lJ.useCallback)(()=>{if(c){let{width:e}=c.getBoundingClientRect();h(e||0)}},[c]),S=(0,lJ.useCallback)(_,[_]),T=(0,lJ.useCallback)(_,[_]);(0,lJ.useEffect)(()=>{_()},[_,w]),(0,lJ.useEffect)(()=>{if(f){let{width:e}=f.getBoundingClientRect();x(e||0)}},[f]);let E=(0,lJ.useMemo)(()=>n?(0,lG.jsx)(ji,{$fieldActionsVisible:!!w,$right:p,ref:m,children:n}):null,[p,w,n]);return(0,lG.jsxs)(je,{align:"flex-end",children:[(0,lG.jsx)(jn,{flex:1,paddingY:2,$presenceMaxWidth:80,children:r}),o&&o.length>0&&(0,lG.jsx)(jt,{flex:"none",paddingBottom:1,$right:p+g,children:(0,lG.jsx)(yA,{maxAvatars:4,presence:o})}),E,(k||v)&&(0,lG.jsx)(l4.uE,{delay:y7,children:(0,lG.jsxs)(jr,{"data-actions-visible":w?"true":"false","data-has-actions":j?"true":"false","data-has-comments":v?"true":"false","data-visible":C?"true":"false",display:"flex",onBlurCapture:T,onFocusCapture:S,radius:2,ref:u,shadow:2,sizing:"border",children:[j&&(0,lG.jsx)(jl,{align:"center","data-ui":"FieldActionsFlex",children:(0,lG.jsx)(gh,{nodes:i,onMenuOpenChange:d})}),b]})})]})}function jo(e,t){if(t&&e)return"desc_".concat(e)}var js=Object.freeze,jd=Object.defineProperty;let jc=[],ju={error:or.VG.red[500].hex,warning:or.VG.yellow[500].hex,info:or.VG.blue[500].hex},jp={error:(0,lG.jsx)(a8.uIy,{"data-testid":"input-validation-icon-error","aria-label":"Has error","aria-hidden":!0,role:"presentation"}),warning:(0,lG.jsx)(a8.foC,{"data-testid":"input-validation-icon-warning","aria-label":"Has warning","aria-hidden":!0,role:"presentation"}),info:(0,lG.jsx)(a8.hQ6,{"data-testid":"input-validation-icon-info","aria-label":"Has information","aria-hidden":!0,role:"presentation"})},jh=(0,a0.ZP)(l4.Kq)(np||(np=js(jd(S=["\n  max-width: 200px;\n"],"raw",{value:js(S.slice())}))));function jf(e){let{validation:t=jc,__unstable_showSummary:n,fontSize:i,placement:r="top"}=e,l=t.filter(e=>"error"===e.level),a=t.filter(e=>"warning"===e.level),o=t.filter(e=>"info"===e.level),s=l.length>0,d=a.length>0,c=o.length>0,u=(0,lJ.useMemo)(()=>s?jp.error:d?jp.warning:c?jp.info:void 0,[s,c,d]),p=(0,lJ.useMemo)(()=>s?ju.error:d?ju.warning:c?ju.info:void 0,[s,c,d]);return(0,lG.jsx)(l4.u,{content:(0,lG.jsxs)(jh,{padding:3,space:3,children:[n&&(0,lG.jsx)(jg,{validation:t}),!n&&(0,lG.jsx)(lG.Fragment,{children:t.map((e,t)=>(0,lG.jsx)(jm,{validation:e},t))})]}),portal:!0,placement:r,fallbackPlacements:["bottom","right","left"],children:(0,lG.jsx)("div",{children:(0,lG.jsx)(l4.xv,{muted:!0,size:i,weight:"semibold",style:{color:p},children:u})})})}function jm(e){let{validation:t}=e,n=(0,lJ.useMemo)(()=>"error"===t.level?jp.error:"warning"===t.level?jp.warning:"info"===t.level?jp.info:void 0,[t]),i=(0,lJ.useMemo)(()=>"error"===t.level?ju.error:"warning"===t.level?ju.warning:"info"===t.level?ju.info:void 0,[t]);return(0,lG.jsxs)(l4.kC,{children:[(0,lG.jsx)(l4.xu,{marginRight:2,children:(0,lG.jsx)(l4.xv,{size:1,style:{color:i},children:n})}),(0,lG.jsx)(l4.xu,{flex:1,children:(0,lG.jsx)(l4.xv,{size:1,children:t.message})})]})}function jg(e){let{validation:t}=e,n=t.filter(e=>"error"===e.level),i=t.filter(e=>"warning"===e.level),r=n.length,l=i.length,a=r&&"".concat(r," ").concat("error".concat(1===r?"":"s")),o=l&&"".concat(l," ").concat("warning".concat(1===l?"":"s"));return(0,lG.jsxs)(l4.xv,{size:1,children:[a||"",r>0&&l>0&&(0,lG.jsx)(lG.Fragment,{children:" and "}),o||""]})}let jx=[],jv=(0,lJ.memo)(function(e){let{description:t,inputId:n,title:i,validation:r=jx}=e,l=r.length>0;return(0,lG.jsxs)(l4.Kq,{space:2,children:[(0,lG.jsxs)(l4.kC,{children:[(0,lG.jsx)(l4.xv,{as:"label",htmlFor:n,weight:"semibold",size:1,children:i||(0,lG.jsx)("span",{style:{color:"var(--card-muted-fg-color)"},children:"Untitled"})}),l&&(0,lG.jsx)(l4.xu,{marginLeft:2,children:(0,lG.jsx)(jf,{fontSize:1,validation:r})})]}),t&&(0,lG.jsx)(l4.xv,{muted:!0,size:1,id:jo(n,t),children:t})]})}),jb=[],jy=(0,lJ.memo)(function(e){let{__unstable_headerActions:t=jb,__unstable_presence:n=jb,__internal_slot:i=null,__internal_comments:r,children:l,description:a,inputId:o,level:s,title:d,validation:c,...u}=e,{focused:p,hovered:h,onMouseEnter:f,onMouseLeave:m}=b6();return(0,lG.jsxs)(l4.Kq,{...u,"data-level":s,onMouseEnter:f,onMouseLeave:m,space:1,children:[d&&(0,lG.jsx)(ja,{__internal_comments:r,__internal_slot:i,actions:t,fieldFocused:!!p,fieldHovered:h,presence:n,content:(0,lG.jsx)(jv,{description:a,inputId:o,title:d,validation:c})}),(0,lG.jsx)("div",{children:l})]})});var jj=Object.freeze,jw=Object.defineProperty,jk=(e,t)=>jj(jw(e,"raw",{value:jj(t||e.slice())}));let jC=a0.ZP.legend(nh||(nh=jk(["\n  /* See: https://thatemil.com/blog/2015/01/03/reset-your-fieldset/ */\n  padding: 0;\n  display: table;\n"]))),j_=(0,a0.ZP)(l4.kC).attrs({forwardedAs:"button"})(e=>{let{theme:t}=e,{focusRing:n,radius:i}=t.sanity,{base:r}=t.sanity.color;return(0,a0.iv)(nf||(nf=jk(["\n    appearance: none;\n    border: 0;\n    background: none;\n    color: inherit;\n    -webkit-font-smoothing: inherit;\n    font: inherit;\n    outline: none;\n    border-radius: ",";\n    position: relative;\n\n    &:not([hidden]) {\n      display: flex;\n    }\n\n    &:focus {\n      box-shadow: ",";\n    }\n\n    &:focus:not(:focus-visible) {\n      box-shadow: none;\n    }\n\n    /* Added to increase the hit area of the collapsible fieldset */\n    &::after {\n      content: '';\n      position: absolute;\n      top: -10px;\n      right: -10px;\n      bottom: -10px;\n      left: -10px;\n    }\n  "])),(0,l4.hO)(i[1]),uo({base:r,focusRing:n}))}),jS=(0,a0.ZP)(l4.xu)(nm||(nm=jk(["\n  width: 9px;\n  height: 9px;\n  margin-right: 3px;\n\n  & svg {\n    transition: transform 100ms;\n  }\n"]))),jT=(0,lJ.memo)(function(e){let{collapsed:t,collapsible:n,onClick:i,title:r}=e,l=(0,lG.jsx)(l4.xv,{weight:"semibold",size:1,children:r||(0,lG.jsx)("span",{style:{color:"var(--card-muted-fg-color)"},children:"Untitled"})});return n?(0,lG.jsx)(jC,{children:(0,lG.jsxs)(j_,{type:"button",onClick:i,children:[(0,lG.jsx)(jS,{children:(0,lG.jsx)(l4.xv,{muted:!0,size:1,children:(0,lG.jsx)(a8.tgp,{style:{transform:"rotate(".concat(t?"0":"90deg",") translate3d(0, 0, 0)")}})})}),l]})}):(0,lG.jsx)(jC,{children:l})});var jE=Object.freeze,jP=Object.defineProperty,jA=(e,t)=>jE(jP(e,"raw",{value:jE(t||e.slice())}));let jO=(0,a0.ZP)(l4.xu).attrs({forwardedAs:"fieldset"})(ng||(ng=jA(["\n  border: none;\n\n  /* See: https://thatemil.com/blog/2015/01/03/reset-your-fieldset/ */\n  body:not(:-moz-handler-blocked) & {\n    display: table-cell;\n  }\n"]))),jz=(0,a0.ZP)(l4.xu)(e=>{let{$borderLeft:t,theme:n}=e,{focusRing:i,radius:r}=n.sanity,{base:l}=n.sanity.color;return(0,a0.iv)(nx||(nx=jA(["\n    outline: none;\n    border-left: ",";\n    border-radius: ",";\n\n    &:focus {\n      box-shadow: ",";\n    }\n\n    &:focus:not(:focus-visible) {\n      box-shadow: none;\n    }\n  "])),t?"1px solid var(--card-border-color)":void 0,(0,l4.hO)(r[1]),uo({base:l,focusRing:{...i,offset:2}}))}),jM=[],jI=(0,lJ.forwardRef)(function(e,t){let{__internal_comments:n,__internal_slot:i=null,__unstable_headerActions:r=jM,__unstable_presence:l=jM,children:a,collapsed:o,collapsible:s,columns:d,description:c,level:u=0,onCollapse:p,onExpand:h,onFocus:f,tabIndex:m,title:g,validation:x=jM,inputId:v,...b}=e,{focused:y,hovered:j,onMouseEnter:w,onMouseLeave:k}=b6(),C=x.length>0,_=(0,l4.ts)(t),S=(0,lJ.useCallback)(e=>{_.current===e.target&&f&&f(e)},[_,f]),T=(0,lJ.useCallback)(()=>o?null==h?void 0:h():null==p?void 0:p(),[o,p,h]),E=(0,lJ.useMemo)(()=>o?null:(0,lG.jsx)(l4.rj,{columns:d,gapX:4,gapY:5,children:"function"==typeof a?a():a}),[a,o,d]);return(0,lG.jsxs)(jO,{"data-level":u,...b,onMouseEnter:w,onMouseLeave:k,children:[(0,lG.jsx)(ja,{__internal_comments:n,__internal_slot:i,actions:r,fieldFocused:!!y,fieldHovered:j,presence:l,content:(0,lG.jsxs)(l4.Kq,{space:2,children:[(0,lG.jsxs)(l4.kC,{children:[(0,lG.jsx)(jT,{collapsed:!!o,collapsible:s,onClick:s?T:void 0,title:g}),C&&(0,lG.jsx)(l4.xu,{marginLeft:2,children:(0,lG.jsx)(jf,{fontSize:1,validation:x})})]}),c&&(0,lG.jsx)(l4.xv,{muted:!0,size:1,id:jo(v,c),children:c})]})}),(0,lG.jsx)(jz,{$borderLeft:u>0,hidden:o,marginTop:1,paddingLeft:0===u?0:3,onFocus:"number"==typeof m&&m>-1?S:void 0,ref:_,tabIndex:m,children:!o&&E})]})});var jR=Object.freeze,jF=Object.defineProperty;let jD=a0.ZP.div(nv||(nv=jR(jF(T=["\n  display: flex;\n  justify-content: flex-end;\n  box-sizing: border-box;\n  min-height: var(--avatar-height);\n  width: 77px;\n  margin-left: var(--small-padding);\n\n  &[data-max-avatars='1'] {\n    max-width: 23px;\n  }\n\n  &[data-position='top'] {\n    align-self: flex-start;\n  }\n\n  &[data-position='bottom'] {\n    align-self: flex-end;\n  }\n"],"raw",{value:jR(T.slice())}))));function jZ(e){let{children:t,maxAvatars:n,position:i="bottom"}=e;return(0,lG.jsx)(jD,{"data-max-avatars":n,"data-position":i,children:t})}var jL=Object.freeze,jq=Object.defineProperty;let jN=(0,a0.ZP)(l4.zx)(nb||(nb=jL(jq(E=["\n  cursor: ",";\n"],"raw",{value:jL(E.slice())}))),e=>e.grid?"move":"ns-resize"),jV=lJ.createContext(null),jU=function(e){let t=(0,lJ.useContext)(jV),{listeners:n,attributes:i}=(0,sD.nB)({id:t});return(0,lG.jsx)(jN,{icon:a8.VVU,mode:"bleed","data-ui":"DragHandleButton",...i,...e,...n})},jB=e=>t=>{let{containerNodeRect:n,draggingNodeRect:i,transform:r}=t;return i&&n?function(e,t,n,i){let r={...e},l=i.y||0,a=i.x||0;return t.top+r.y<=n.top+l?r.y=n.top-t.top+l:t.bottom+r.y>=n.top+n.height-l&&(r.y=n.top+n.height-t.bottom-l),t.left+r.x<=n.left-a?r.x=n.left-t.left+a:t.right+r.x>=n.left+n.width+a&&(r.x=n.left+n.width-t.right+a),r}(r,i,n,e):r};var jK=Object.freeze,jH=Object.defineProperty,jW=(e,t)=>jK(jH(e,"raw",{value:jK(t||e.slice())}));let j$="moving",jX=(0,a0.ZP)(l4.xu)(nj||(nj=jW(["\n  ","\n"])),e=>e.$moving&&(0,a0.iv)(ny||(ny=jW(["\n      z-index: 10000;\n      /* prevents hover-effects etc on the dragged element  */\n      pointer-events: none;\n    "])))),jG={threshold:{x:0,y:.02}},jY={coordinateGetter:sD.is},jJ={duration:200,easing:"ease"},jQ=(0,lJ.memo)(function(e){let{items:t,axis:n,onItemMove:i,onItemMoveStart:r,onItemMoveEnd:l,children:a,...o}=e,s=(0,sZ.Dy)((0,sZ.VT)(sZ.we),(0,sZ.VT)(sZ.Lg,jY)),d=(0,lJ.useCallback)(e=>{var t,n,r,a;let{active:o,over:s}=e;o.id!==(null==s?void 0:s.id)&&(null==i||i({fromIndex:null==(n=null==(t=o.data.current)?void 0:t.sortable)?void 0:n.index,toIndex:null==(a=null==(r=null==s?void 0:s.data.current)?void 0:r.sortable)?void 0:a.index})),null==l||l()},[i,l]),c=(0,lJ.useMemo)(()=>[jB({y:4}),...n?["x"===n?sq.K7:sq.DL]:[]],[n]);return(0,lG.jsx)(sZ.LB,{sensors:s,autoScroll:jG,modifiers:c,collisionDetection:sZ.pE,onDragEnd:d,onDragStart:r,children:(0,lG.jsx)(sD.Fo,{items:t,strategy:n?"x"===n?sD.PG:sD.qw:void 0,children:(0,lG.jsx)(l4.rj,{...o,children:a})})})}),j0=(0,lJ.forwardRef)(function(e,t){let{id:n,children:i,disableTransition:r}=e,{setNodeRef:l,transform:a,transition:o,active:s}=(0,sD.nB)({id:n,transition:r?null:jJ}),d=n===(null==s?void 0:s.id),c=(0,lJ.useMemo)(()=>({transform:sL.ux.Translate.toString(a),transition:o,pointerEvents:s?"none":void 0}),[a,o,s]),u=(0,lJ.useCallback)(e=>{l(e),"function"==typeof t?t(e):t&&(t.current=e)},[t,l]);return(0,lG.jsx)(jX,{ref:u,style:c,$moving:d,className:d?j$:"","data-index":e["data-index"],children:i})});function j1(e){let{onItemMove:t,onItemMoveEnd:n,onItemMoveStart:i,sortable:r,...l}=e,a=(0,lJ.useCallback)(e=>{null==t||t(e)},[t]);return r?(0,lG.jsx)(jQ,{onItemMove:a,onItemMoveStart:i,onItemMoveEnd:n,...l}):(0,lG.jsx)(l4.rj,{...l})}let j2=(0,lJ.forwardRef)(function(e,t){let{sortable:n,...i}=e;return(0,lG.jsx)(jV.Provider,{value:e.id,children:n?(0,lG.jsx)(j0,{ref:t,...i}):(0,lG.jsx)(jX,{ref:t,...i})})});var j3=Object.freeze,j4=Object.defineProperty;let j5=(0,a0.ZP)(l4.Zb)(nw||(nw=j3(j4(P=["\n  position: relative;\n  border: 1px solid transparent;\n  transition: border-color 250ms;\n\n  ."," & {\n    border-color: var(--card-shadow-umbra-color);\n    box-shadow:\n      0 0 0 0,\n      0 8px 17px 2px var(--card-shadow-umbra-color),\n      0 3px 14px 2px var(--card-shadow-penumbra-color),\n      0 5px 5px -3px var(--card-shadow-ambient-color);\n  }\n\n  &:hover {\n    border-color: var(--card-shadow-umbra-color);\n  }\n\n  &[aria-selected='true'] {\n    border-color: var(--card-focus-ring-color);\n  }\n"],"raw",{value:j3(P.slice())}))),j$);function j6(e){let{validation:t,selected:n,tone:i,presence:r,focused:l,children:a,dragHandle:o,menu:s,footer:d}=e,c=(0,lJ.useRef)(null);return m$(l,(e,t)=>{var n;!e&&t&&(null==(n=c.current)||n.focus())}),(0,lG.jsx)(j5,{ref:c,selected:n,"aria-selected":n,radius:2,padding:1,tone:i,children:(0,lG.jsxs)(l4.Kq,{space:1,children:[(0,lG.jsxs)(l4.kC,{align:"center",children:[o&&(0,lG.jsx)(l4.xu,{marginRight:1,paddingY:1,children:(0,lG.jsx)(jU,{paddingX:1,paddingY:3})}),(0,lG.jsx)(l4.xu,{flex:1,children:a}),(r||t||s)&&(0,lG.jsxs)(l4.kC,{align:"center",marginLeft:1,children:[r&&(0,lG.jsx)(l4.xu,{marginLeft:1,children:r}),t&&(0,lG.jsx)(l4.xu,{marginLeft:1,children:t}),s]})]}),d]})})}var j8=Object.freeze,j9=Object.defineProperty,j7=(e,t)=>j8(j9(e,"raw",{value:j8(t||e.slice())}));let we=a0.ZP.button(nk||(nk=j7(["\n  display: block;\n  -webkit-font-smoothing: inherit;\n  appearance: none;\n  font: inherit;\n  background: none;\n  width: 100%;\n  text-align: left;\n  border: 0;\n  margin: 0;\n  padding: 0;\n  outline: none;\n"]))),wt=(0,a0.ZP)(a8.tgp)(nC||(nC=j7(["\n  transform: ",";\n"])),e=>e.open?"rotate(90deg)":""),wn=(0,a0.ZP)(l4.kC)(n_||(n_=j7(["\n  cursor: default;\n"]))),wi=(0,a0.ZP)(l4.xu)(nS||(nS=j7(["\n  & > div > svg {\n    transform: rotate(0);\n    transition: transform 100ms;\n  }\n\n  &[data-open] > div > svg {\n    transform: rotate(90deg);\n  }\n"])));function wr(e){let{children:t,open:n,icon:i,title:r="Details",...l}=e,[a,o]=(0,lJ.useState)(n||!1),s=(0,lJ.useCallback)(()=>o(e=>!e),[]);return(0,lJ.useEffect)(()=>o(n||!1),[n]),(0,lG.jsxs)(l4.xu,{...l,children:[(0,lG.jsx)(we,{type:"button",onClick:s,children:(0,lG.jsx)(wn,{align:"center",children:(0,lG.jsxs)(l4.gF,{children:[(0,lG.jsx)(wi,{"data-open":a?"":void 0,children:(0,lG.jsx)(l4.xv,{size:1,children:(0,lG.jsx)(wt,{open:a})})}),i&&(0,lG.jsx)(l4.xu,{marginLeft:1,children:i}),(0,lG.jsx)(l4.xu,{flex:1,marginLeft:1,children:(0,lG.jsx)(l4.xv,{size:1,weight:"medium",children:r})})]})})}),(0,lG.jsx)(l4.xu,{hidden:!a,marginTop:3,children:t})]})}let wl={warning:"caution",error:"critical",info:"positive"},wa={warning:(0,lG.jsx)(a8.foC,{}),error:(0,lG.jsx)(a8.uIy,{}),info:(0,lG.jsx)(a8.hQ6,{})};function wo(e){let{children:t,status:n="warning",title:i,...r}=e;return(0,lG.jsx)(l4.Zb,{radius:2,tone:wl[n],...r,"data-ui":"Alert",children:(0,lG.jsx)(l4.kC,{padding:1,children:t&&(0,lG.jsx)(l4.xu,{flex:1,children:(0,lG.jsx)(wr,{icon:wa[n],title:i,children:(0,lG.jsx)(l4.xu,{marginLeft:3,marginTop:3,children:t})})})})})}function ws(e){return(0,lX.m$)(e)?"object"===e.name?{}:{_type:e.name}:(0,lX.jB)(e)?[]:"string"===e.jsonType?"":"number"===e.jsonType?0:"boolean"!==e.jsonType&&void 0}function wd(e){if(!(0,lX.m$)(e))throw Error('Invalid item type: "'.concat(e.type,'". Default array input can only contain objects (for now)'));return{...ws(e),_key:(0,sT.E2)(12)}}let wc={portal:!0,tone:"default",placement:"left",constrainSize:!0},wu=(0,lJ.memo)(function(e){let{types:t,onInsert:n}=e;return(0,lG.jsxs)(lG.Fragment,{children:[(0,lG.jsx)(wp,{pos:"before",types:t,onInsert:n,text:"Add item before",icon:a8.ySV}),(0,lG.jsx)(wp,{pos:"after",types:t,onInsert:n,text:"Add item after",icon:a8.oty})]})});function wp(e){let{types:t,onInsert:n,pos:i,text:r,icon:l}=e;return(null==t?void 0:t.length)===1?(0,lG.jsx)(l4.sN,{text:r,icon:l,onClick:()=>n(i,t[0])},i):(0,lG.jsx)(l4.kS,{text:r,popover:wc,children:null==t?void 0:t.map(e=>(0,lG.jsx)(l4.sN,{icon:e.icon,text:e.title,onClick:()=>n(i,e)},e.name))},i)}let wh=()=>void 0,wf={isLoading:!0,result:void 0,error:void 0,retry:wh},wm={isLoading:!1,result:void 0,error:void 0,retry:wh};function wg(e,t){let n=(0,lJ.useMemo)(()=>new l7.x,[]),i=(0,lJ.useMemo)(()=>n.asObservable(),[n]),r=(0,lJ.useCallback)(()=>{n.next({type:"retry"})},[n]),l=(0,l5.m2)(()=>(0,l8.z)((0,l6.of)(null),i).pipe((0,ag.U)(()=>e),(0,aM.b)(e=>e?t(e).pipe((0,ag.U)(e=>({isLoading:!1,result:e,error:void 0,retry:r})),(0,ak.O)(wf),(0,av.K)(e=>(console.error(e),(0,l6.of)({isLoading:!1,result:void 0,error:e,retry:r})))):(0,l6.of)(wm))),[t,e,i,r],wf),a=mW(e,e);return e&&a!==e?wf:l}function wx(e){var t,n,i,r,l,a;let{id:o,layout:s,preview:d,refType:c,renderPreview:u,showTypeLabel:p}=e,h=(0,l4.Ur)(),f=Uu(o),m=(null==(t=d.draft)?void 0:t._id)||(null==(n=d.published)?void 0:n._id)||o,g=(0,lJ.useMemo)(()=>({_id:m,_type:c.name}),[m,c.name]),x=(0,lJ.useMemo)(()=>({layout:s,schemaType:c,value:g}),[s,g,c]),v=Nt((null==(i=d.published)?void 0:i._updatedAt)||"",{minimal:!0,agoSuffix:!0}),b=Nt((null==(r=d.draft)?void 0:r._updatedAt)||"",{minimal:!0,agoSuffix:!0});return(0,lG.jsxs)(l4.kC,{align:"center",children:[(0,lG.jsx)(l4.xu,{flex:1,children:u(x)}),(0,lG.jsx)(l4.xu,{paddingLeft:3,children:(0,lG.jsxs)(l4.gF,{space:3,children:[p&&(0,lG.jsx)(l4.__,{size:1,muted:!0,children:c.title}),f&&f.length>0&&(0,lG.jsx)(yg,{presence:f}),(0,lG.jsxs)(l4.gF,{space:4,children:[(0,lG.jsx)(l4.xu,{children:(0,lG.jsx)(l4.u,{portal:!0,content:(0,lG.jsx)(l4.xu,{padding:2,children:(0,lG.jsx)(l4.xv,{size:1,children:(null==(l=d.published)?void 0:l._updatedAt)?"Published ".concat(v):"Not published"})}),children:(0,lG.jsx)(p6,{tone:"default"===h.tone?"positive":"default",size:1,dimmed:!d.published,muted:!d.published,children:(0,lG.jsx)(a8.EI4,{"aria-label":d.published?"Published":"Not published"})})})}),(0,lG.jsx)(l4.xu,{children:(0,lG.jsx)(l4.u,{portal:!0,content:(0,lG.jsx)(l4.xu,{padding:2,children:(0,lG.jsx)(l4.xv,{size:1,children:(null==(a=d.draft)?void 0:a._updatedAt)?"Edited ".concat(b):"No unpublished edits"})}),children:(0,lG.jsx)(p6,{tone:"default"===h.tone?"caution":"default",size:1,dimmed:!d.draft,muted:!d.draft,children:(0,lG.jsx)(a8.dY8,{"aria-label":d.draft?"Edited":"No unpublished edits"})})})})]})]})})]})}function wv(e){var t,n,i,r,l,a;let{referenceInfo:o,renderPreview:s,type:d,value:c,showTypeLabel:u}=e;if(o.isLoading||o.error)return(0,lG.jsx)(fL,{isPlaceholder:!0});if((null==(t=o.result)?void 0:t.availability.reason)==="NOT_FOUND"&&c._strengthenOnPublish){let e=d.to.find(e=>{var t;return e.name===(null==(t=null==c?void 0:c._strengthenOnPublish)?void 0:t.type)});if(!e)return(0,lG.jsx)(wy,{documentId:c._ref,actualType:null==(n=c._strengthenOnPublish)?void 0:n.type,declaredTypes:d.to.map(e=>e.name)});let t=(null==(i=c._strengthenOnPublish)?void 0:i.type)?{_id:c._ref,_type:null==(r=c._strengthenOnPublish)?void 0:r.type}:c;return(0,lG.jsxs)(l4.kC,{align:"center",children:[(0,lG.jsx)(l4.xu,{flex:1,children:s({layout:"default",schemaType:e,value:t,skipVisibilityCheck:!0})}),(0,lG.jsx)(l4.xu,{children:(0,lG.jsx)(l4.gF,{space:4,children:u&&(0,lG.jsx)(l4.__,{size:1,muted:!0,children:e.title})})})]})}let p=o.result.availability,h="NOT_FOUND"===p.reason,f="PERMISSION_DENIED"===p.reason;if(f||h)return(0,lG.jsxs)(l4.gF,{space:2,children:[(0,lG.jsx)(l4.xu,{padding:1,children:(0,lG.jsx)(l4.kC,{align:"center",children:(0,lG.jsx)(l4.xu,{flex:1,paddingY:2,children:(0,lG.jsx)(l4.xv,{muted:!0,children:"Document unavailable"})})})}),f||h?(0,lG.jsx)(l4.xu,{children:(0,lG.jsx)(l4.u,{portal:!0,content:h?(0,lG.jsxs)(wb,{title:"Not found",icon:a8.BHU,children:["The referenced document does not exist",(0,lG.jsx)("br",{}),"(id: ",(0,lG.jsx)("code",{children:c._ref}),")"]}):(0,lG.jsx)(wb,{title:"Insufficient permissions",icon:a8.vaB,children:"The referenced document could not be accessed due to insufficient permissions"}),children:(0,lG.jsx)(p6,{tone:"default",children:(0,lG.jsx)(a8.BHU,{})})})}):null]});let m=null==(l=o.result)?void 0:l.type,g=d.to.find(e=>e.name===m);return g?(0,lG.jsx)(wx,{id:c._ref,layout:"default",preview:null==(a=o.result)?void 0:a.preview,refType:g,renderPreview:s,showTypeLabel:u}):(0,lG.jsx)(wy,{documentId:c._ref,actualType:m||"<unknown>",declaredTypes:d.to.map(e=>e.name)})}function wb(e){let t=e.icon;return(0,lG.jsxs)(l4.kC,{padding:3,children:[(0,lG.jsx)(l4.xu,{children:(0,lG.jsx)(l4.xv,{size:1,children:(0,lG.jsx)(t,{})})}),(0,lG.jsxs)(l4.xu,{flex:1,marginLeft:3,children:[(0,lG.jsx)(l4.xv,{size:1,weight:"semibold",children:e.title}),(0,lG.jsx)(l4.xu,{marginTop:3,children:(0,lG.jsx)(l4.xv,{as:"p",muted:!0,size:1,children:e.children})})]})]})}function wy(e){return(0,lG.jsxs)(l4.kC,{align:"center",justify:"flex-start",children:[(0,lG.jsx)(l4.xu,{padding:1,children:(0,lG.jsx)(l4.kC,{align:"center",children:(0,lG.jsx)(l4.xu,{flex:1,paddingY:2,children:(0,lG.jsx)(l4.xv,{muted:!0,children:"Document of invalid type"})})})}),(0,lG.jsx)(l4.xu,{children:(0,lG.jsx)(l4.u,{portal:!0,content:(0,lG.jsxs)(l4.Kq,{space:3,padding:3,children:[(0,lG.jsxs)(l4.xv,{size:1,children:["Referenced document (",(0,lG.jsx)("code",{children:e.documentId}),") is of type"," ",(0,lG.jsx)("code",{children:e.actualType}),"."]}),(0,lG.jsxs)(l4.xv,{size:1,children:["According to the schema, referenced documents can only be of type"," ",wj(e.declaredTypes.map(e=>(0,lG.jsx)("code",{children:e},e)),"or"),"."]})]}),children:(0,lG.jsx)(l4.xu,{padding:2,children:(0,lG.jsx)(p6,{tone:"default",children:(0,lG.jsx)(a8.BHU,{})})})})})]})}let wj=(e,t)=>1===e.length?e[0]:2===e.length?[e[0],(0,lG.jsxs)(lJ.Fragment,{children:[" ",t," "]},"comma"),e[1]]:[...e.slice(0,-1).map((e,t)=>(0,lG.jsxs)(lJ.Fragment,{children:[e,", "]},t)),(0,lG.jsxs)(lJ.Fragment,{children:[t," ",e[e.length-1]]},"last")];var ww=Object.freeze,wk=Object.defineProperty;let wC=(0,a0.ZP)(l4.Zb)(nT||(nT=ww(wk(A=["\n  /* this is a hack to avoid layout jumps while previews are loading\n     there's probably better ways of solving this */\n  min-height: 35px;\n  position: relative;\n\n  /* TextWithTone uses its own logic to set color, and we therefore need */\n  /* to override this logic in order to set the correct color in different states */\n  &[data-selected],\n  &[data-pressed],\n  &:active {\n    [data-ui='TextWithTone'] {\n      color: inherit;\n    }\n  }\n"],"raw",{value:ww(A.slice())})))),w_=(0,lJ.forwardRef)(function(e,t){let{as:n,documentId:i,documentType:r,...l}=e;return(0,lG.jsx)(wC,{...l,...i&&r&&{"data-as":"a",forwardedAs:n,documentId:i,documentType:r},ref:t})}),wS=(0,lJ.createContext)(null);function wT(e){let{menuRef:t,containerRef:n}=e;return(0,lG.jsx)(wS.Provider,{value:{menuRef:t,containerRef:n},children:e.children})}let wE={portal:!0,tone:"default"},wP={position:"absolute",top:0,left:0,width:"100%",height:"100%",opacity:.6};function wA(e){var t,n,i,r,l,a,o,s,d,c,u;let{schemaType:p,parentSchemaType:h,path:f,readOnly:m,onRemove:g,value:x,open:v,onInsert:b,presence:y,validation:j,inputId:w,changed:k,focused:C,children:_,inputProps:{onChange:S,focusPath:T,onPathFocus:E,renderPreview:P,elementProps:A}}=e,O=!m&&(null==(t=h.options)?void 0:t.sortable)!==!1,z=h.of,M=(0,lJ.useRef)(null),I=(0,lJ.useRef)(null),R=(0,lJ.useRef)(null),{EditReferenceLink:F,getReferenceInfo:D,selectedState:Z,isCurrentDocumentLiveEdit:L}=Ek({path:f,schemaType:p,value:x});ya(M,v),m$(C,(e,t)=>{var n;!e&&t&&M.current&&(null==(n=M.current)||n.focus())});let q=e.validation.some(e=>"error"===e.level),N=e.validation.some(e=>"warning"===e.level),V=x._resolvingInitialValue,U=(0,lJ.useCallback)(()=>{b({items:[{...x,_key:ys()}],position:"after"})},[b,x]),B=(0,lJ.useCallback)((e,t)=>{b({items:[{...wd(t),_key:ys()}],position:e})},[b]),K=wg(null==x?void 0:x._ref,D),H=x._ref,W=(null==(n=K.result)?void 0:n.type)||(null==(i=null==x?void 0:x._strengthenOnPublish)?void 0:i.type),$=H&&(null==(a=null==(l=null==(r=K.result)?void 0:r.preview)?void 0:l.published)?void 0:a._id),X=(0,lJ.useCallback)(()=>{S([!0===p.weak?mL(!0,["_weak"]):mq(["_weak"]),mq(["_strengthenOnPublish"])])},[S,p.weak]),G=W?p.to.find(e=>e.name===W):void 0,Y="pressed"===Z,J="selected"===Z,Q=function(e){let{readOnly:t,hasErrors:n,hasWarnings:i}=e;return t?"transparent":n?"critical":i?"caution":"default"}({readOnly:m,hasErrors:q,hasWarnings:N}),ee=!H||"_ref"===T[0],et=(0,lJ.useMemo)(()=>(0,lJ.forwardRef)(function(e,t){return(0,lG.jsx)(a9.nR,{...e,intent:"edit",params:{id:null==x?void 0:x._ref,type:null==G?void 0:G.name},target:"_blank",rel:"noopener noreferrer",ref:t})}),[null==G?void 0:G.name,null==x?void 0:x._ref]),en=(0,lJ.useCallback)(()=>{H&&ee?E([]):E(["_ref"])},[H,ee,E]),ei=(0,lJ.useMemo)(()=>m?null:(0,lG.jsx)(l4.xu,{marginLeft:1,children:(0,lG.jsx)(l4.j2,{button:(0,lG.jsx)(l4.zx,{paddingY:3,paddingX:2,mode:"bleed",icon:a8.zGg}),id:"".concat(w,"-menuButton"),menu:(0,lG.jsxs)(l4.v2,{ref:I,children:[!m&&(0,lG.jsxs)(lG.Fragment,{children:[(0,lG.jsx)(l4.sN,{text:"Remove",tone:"critical",icon:a8.XHJ,onClick:g}),(0,lG.jsx)(l4.sN,{text:H&&ee?"Cancel replace":"Replace",icon:H&&ee?a8.Two:a8.bnu,onClick:en}),(0,lG.jsx)(l4.sN,{text:"Duplicate",icon:a8.TIy,onClick:U}),(0,lG.jsx)(wu,{onInsert:B,types:z})]}),!m&&!ee&&H&&(0,lG.jsx)(l4.R,{}),!ee&&H&&(0,lG.jsx)(l4.sN,{as:et,"data-as":"a",text:"Open in new tab",icon:a8.buG})]}),popover:wE})}),[m,w,g,H,ee,en,U,B,z,et]),er=(0,lJ.useCallback)(()=>{S(!0===p.weak?mL(!0,["_weak"]):mq(["_weak"]))},[S,p]),el=(null==x?void 0:x._weak)?"weak":"strong",ea=!0===p.weak?"weak":"strong",eo=H&&!K.isLoading&&(null==x?void 0:x._strengthenOnPublish),es=!K.isLoading&&(null==(o=K.result)?void 0:o.availability.available)&&H&&el!==ea&&!eo,ed=(null==(s=K.result)?void 0:s.preview.draft)||(null==(d=K.result)?void 0:d.preview.published),ec=(0,lG.jsxs)(lG.Fragment,{children:[L&&$&&x._strengthenOnPublish&&(0,lG.jsx)(wo,{padding:1,title:p.weak?"Finalize reference":"Convert to strong reference",status:"info","data-testid":"alert-reference-published",children:(0,lG.jsxs)(l4.Kq,{space:3,children:[(0,lG.jsxs)(l4.xv,{as:"p",muted:!0,size:1,children:[(0,lG.jsx)("strong",{children:null==(u=null==(c=K.result)?void 0:c.preview.published)?void 0:u.title})," is published and this reference should now be"," ",p.weak?(0,lG.jsx)(lG.Fragment,{children:"finalized"}):(0,lG.jsx)(lG.Fragment,{children:"converted to a strong reference"}),"."]}),(0,lG.jsx)(l4.zx,{onClick:X,text:(0,lG.jsx)(lG.Fragment,{children:"Convert to strong reference"}),tone:"positive"})]})}),es&&(0,lG.jsx)(wo,{padding:1,title:"Reference strength mismatch",status:"warning","data-testid":"alert-reference-strength-mismatch",children:(0,lG.jsxs)(l4.Kq,{space:3,children:[(0,lG.jsxs)(l4.xv,{as:"p",muted:!0,size:1,children:["This reference is ",(0,lG.jsx)("em",{children:el}),", but according to the current schema it should be"," ",(0,lG.jsxs)("em",{children:[ea,"."]})]}),(0,lG.jsx)(l4.xv,{as:"p",muted:!0,size:1,children:p.weak?(0,lG.jsxs)(lG.Fragment,{children:["It will not be possible to delete the"," ",(null==ed?void 0:ed.title)?(0,lG.jsxs)(lG.Fragment,{children:['"',null==ed?void 0:ed.title,'"-document']}):(0,lG.jsx)(lG.Fragment,{children:"referenced document"})," ","without first removing this reference."]}):(0,lG.jsxs)(lG.Fragment,{children:["This makes it possible to delete the"," ",(null==ed?void 0:ed.title)?(0,lG.jsxs)(lG.Fragment,{children:['"',null==ed?void 0:ed.title,'"-document']}):(0,lG.jsx)(lG.Fragment,{children:"referenced document"})," ","without first deleting this reference, leaving this field referencing a nonexisting document."]})}),(0,lG.jsx)(l4.zx,{onClick:er,text:(0,lG.jsxs)(lG.Fragment,{children:["Convert to ",ea," reference"]}),tone:"caution"})]})}),K.error&&(0,lG.jsx)(wo,{padding:1,title:"Unable to load reference metadata",status:"warning","data-testid":"alert-reference-info-failed",children:(0,lG.jsxs)(l4.Kq,{space:3,children:[(0,lG.jsxs)(l4.xv,{as:"p",muted:!0,size:1,children:["Error: ",K.error.message]}),(0,lG.jsx)(l4.zx,{onClick:K.retry,text:(0,lG.jsx)(lG.Fragment,{children:"Retry"}),tone:"primary"})]})})]}),eu=(0,lG.jsx)(wT,{menuRef:I,containerRef:R,children:(0,lG.jsx)(j6,{dragHandle:O,presence:!ee&&y.length>0&&(0,lG.jsx)(yA,{presence:y,maxAvatars:1}),validation:!ee&&j.length>0&&(0,lG.jsx)(jf,{validation:j}),menu:ei,footer:ee?void 0:ec,tone:ee?void 0:Q,focused:C,children:ee?(0,lG.jsx)(l4.xu,{padding:1,ref:R,children:(0,lG.jsx)(jI,{title:p.title,description:p.description,__unstable_presence:y,validation:j,inputId:w,children:_})}):(0,lG.jsxs)(w_,{as:F,tone:"inherit",radius:2,documentId:null==x?void 0:x._ref,documentType:null==G?void 0:G.name,disabled:V,paddingX:2,paddingY:1,__unstable_focusRing:!0,selected:J,pressed:Y,"data-selected":!!J||void 0,"data-pressed":!!Y||void 0,...A,children:[(0,lG.jsx)(wv,{value:x,referenceInfo:K,renderPreview:P,type:p}),V&&(0,lG.jsx)(l4.Zb,{style:wP,tone:"transparent",radius:2,as:l4.kC,justify:"center",children:(0,lG.jsxs)(l4.kC,{align:"center",justify:"center",padding:3,children:[(0,lG.jsx)(l4.xu,{marginX:3,children:(0,lG.jsx)(l4.$j,{muted:!0})}),(0,lG.jsx)(l4.xv,{children:"Resolving initial value…"})]})})]})})});return(0,lG.jsx)(cU,{path:f,isChanged:k,hasFocus:!!C,children:(0,lG.jsx)(l4.xu,{paddingX:1,children:eu})})}function wO(e){return(0,lX.m$)(e.schemaType)}function wz(e){return(0,lX.jB)(e.schemaType)}function wM(e){return void 0!==e._key?e:{...e,_key:ys(12)}}function wI(e,t){let n=e.indexOf(t);return n>-1&&e.splice(n,1),e}let wR=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4,n=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:4,t=[],n=[],i=new l7.x;return function r(l){return new al.y(a=>{if(t.length>=e)return(n.push(l),i.asObservable().pipe((0,aI.P)(e=>e===l))).pipe((0,aT.z)(r)).subscribe(a);let o=l.subscribe(a);return t.push(o),()=>{wI(t,o),wI(n,l),o.unsubscribe(),function(){for(;n.length>0&&t.length<e;)i.next(n.shift())}()}})}}(t);return function(){return(0,as.D)(n(e(...arguments)))}}(function(e,t,n){var i;let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},l=r.metadata,a=r.storeOriginalFilename,{label:o,title:s,description:d,creditLine:c,source:u}=r;return(i=n,window.crypto&&window.crypto.subtle&&window.FileReader?new al.y(e=>{let t=new FileReader;return t.onload=()=>{e.next(t.result),e.complete()},t.onerror=t=>{e.error(t)},t.readAsArrayBuffer(i),()=>{t.abort()}}).pipe((0,aT.z)(e=>crypto.subtle.digest("SHA-1",e)),(0,ag.U)(wL)):(0,l6.of)(null)).pipe((0,av.K)(()=>(0,l6.of)(null)),(0,aT.z)(n=>n?e.observable.fetch("*[_type == $documentType && sha1hash == $hash][0]",{documentType:"sanity.".concat(t,"Asset"),hash:n},{tag:"asset.find-duplicate"}):(0,l6.of)(null)),(0,aT.z)(i=>i?(0,l6.of)({type:"complete",id:i._id,asset:i}):e.observable.assets.upload(t,n,{tag:"asset.upload",extract:l,preserveFilename:a,label:o,title:s,description:d,creditLine:c,source:u}).pipe((0,ag.U)(e=>"response"===e.type?{type:"complete",id:e.body.document._id,asset:e.body.document}:e))))},4),wF=(e,t,n)=>wR(e,"image",t,n),wD=(e,t,n)=>wR(e,"file",t,n);function wZ(e,t){return e.observePaths({_type:"reference",_ref:t},["originalFilename","url","metadata","label","title","description","creditLine","source","size"])}function wL(e){return Array.prototype.map.call(new Uint8Array(e),e=>"00".concat(e.toString(16)).slice(-2)).join("")}let wq=/(invalid image format)|(No exif data)/i;function wN(e){return[5,6,7,8].indexOf(e)>-1}function wV(e,t,n){let i=e.getContext("2d");null==i||i.translate(t?e.width:0,n?e.height:0),null==i||i.scale(t?-1:1,n?-1:1)}let wU=[{op:"none",degrees:0},{op:"flip-x",degrees:0},{op:"none",degrees:180},{op:"flip-y",degrees:0},{op:"flip-x",degrees:90},{op:"none",degrees:90},{op:"flip-x",degrees:-90},{op:"none",degrees:-90}],wB=["top-left","top-right","bottom-right","bottom-left","left-top","right-top","right-bottom","left-bottom"],wK="_upload";function wH(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return{type:"uploadProgress",patches:e}}let wW=wH([mq([wK])]);function w$(e){let t=new Date().toISOString();return wH([mL({progress:2,createdAt:t,updatedAt:t,file:{name:e.name,type:e.type}},[wK])])}function wX(e,t,n){let i=wD(e,t,n).pipe((0,ag.U)(e=>"complete"===e.type?wH([mL({_type:"reference",_ref:e.asset._id},["asset"]),mL(100,[wK,"progress"]),mL(new Date().toISOString(),[wK,"updated"])]):wH([mL(e.percent,[wK,"progress"]),mL(new Date().toISOString(),[wK,"updated"])])));return(0,l8.z)((0,l6.of)(w$(t)),i,(0,l6.of)(wW))}let wG=[{type:"image",accepts:"image/*",upload:(e,t,n,i)=>(function(e,t,n){let i=wF(e,t,n).pipe((0,aj.h)(e=>"download"!==e.stage),(0,ag.U)(e=>({...e,progress:2+e.percent/100*98})),(0,ag.U)(e=>"complete"===e.type?wH([mL({_type:"reference",_ref:e.asset._id},["asset"]),mL(100,[wK,"progress"]),mL(new Date().toISOString(),[wK,"updatedAt"])]):wH([mL(e.percent,[wK,"progress"]),mL(new Date().toISOString(),[wK,"updatedAt"])]))),r=(0,as.D)(new al.y(e=>{let n=new window.FileReader;return n.onerror=t=>e.error(t),n.onload=()=>{e.next(n.result),e.complete()},n.readAsArrayBuffer(t.slice(0,128e3)),()=>n.abort()})).pipe((0,ag.U)(e=>sW()(e)),(0,av.K)(e=>(wq.test(e.message)||console.warn("Exif read failed, continuing anyway: ".concat(e.message)),(0,l6.of)({})))).pipe((0,aT.z)(e=>{var n,i;return n=e.orientation||"top-left",(i=window.URL.createObjectURL(t),new al.y(e=>{let t=new window.Image;return t.onerror=()=>{e.error(Error('Could not load image from url "'.concat(i,'". Image may be of an unsupported format')))},t.onload=()=>{e.next(t),e.complete()},t.src=i,()=>{}})).pipe((0,aT.z)(e=>new al.y(t=>{let i=function(e,t){let n=wU[t-1],i=e.height/e.width;e.width=120/i,e.height=e.width*i;let r=document.createElement("canvas"),l=r.getContext("2d");if(wN(t)?(r.height=e.width,r.width=e.height):(r.width=e.width,r.height=e.height),"flip-x"===n.op&&wV(r,!0,!1),"flip-y"===n.op&&wV(r,!1,!0),n.degrees&&(function(e,t){let n=t.x,i=t.y,r=(t.degrees||0)*(Math.PI/180);null==e||e.translate(n,i),null==e||e.rotate(r),null==e||e.translate(-n,-i)}(l,{degrees:n.degrees,x:r.width/2,y:r.height/2}),wN(t))){let e=r.width-r.height;null==l||l.translate(e/2,-e/2)}return null==l||l.drawImage(e,0,0,e.width,e.height),r}(e,wB.indexOf(n)+1);t.next(i.toDataURL("image/jpeg",.1)),t.complete()})))}),(0,av.K)(e=>(console.warn('Image preprocessing failed for "%s" with the error: %s',t.name,e.message),(0,l6.of)(null))),(0,aj.h)(Boolean),(0,ag.U)(e=>wH([mL(e,[wK,"previewImage"])])));return(0,l8.z)((0,l6.of)(w$(t)),(0,ae.T)(i,r),(0,l6.of)(wW))})(e,t,i)},{type:"string",accepts:"text/*",upload:(e,t,n,i)=>wX(e,t,i).pipe((0,ag.U)(e=>({type:"uploadProgress",patches:[mL(e)]})))},{type:"file",accepts:"",upload:(e,t,n,i)=>wX(e,t,i)}].map((e,t)=>({...e,priority:t}));function wY(e,t){if(!e||!t)return!0;let n=Array.isArray(t)?t:t.split(","),i=e.name||"",r=(e.type||"").toLowerCase(),l=r.replace(/\/.*$/,"");return n.some(e=>{let t=e.trim().toLowerCase();return"."===t.charAt(0)?i.toLowerCase().endsWith(t):t.endsWith("/*")?l===t.replace(/\/.*$/,""):r===t})}function wJ(e,t){return wG.find(n=>{var i;return fF(n.type,e)&&wY(t,n.accepts)&&wY(t,(null==(i=e.options)?void 0:i.accept)||"")})||null}let wQ=["_key","_type","_weak"];function w0(e){return Object.keys(e).every(e=>wQ.includes(e))}let w1=(e,t)=>{let n=(0,sT.wq)(t);return e.of.find(e=>e.name===n)};function w2(e,t,n){return(0,as.D)(e).pipe((0,aT.z)(e=>{let i={_key:e._key};return(0,l6.of)(w1(t,e)).pipe((0,aT.z)(e=>e?(0,l6.of)(e):aa.E),(0,aT.z)(t=>w0(e)&&n?(0,l8.z)((0,l6.of)({type:"patch",patches:[mL(!0,[i,"_resolvingInitialValue"])]}),(0,at.P)(()=>n(t,e)).pipe((0,aj.h)(cr),(0,ag.U)(e=>{var t;return{type:"patch",patches:(t=[i],Object.entries(e).map(e=>{let[n,i]=e;return mL(i,[...t,n])}))}}),(0,av.K)(n=>(0,l6.of)({type:"error",error:n,item:e,schemaType:t}))),(0,l6.of)({type:"patch",patches:[mq([i,"_resolvingInitialValue"])]})):aa.E))}))}let w3="before",w4="after";function w5(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.reduce((e,t)=>e.concat(t),[])}let w6=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),w8={replace:(e,t)=>t,set:(e,t)=>t,setIfMissing:(e,t)=>void 0===e?t:e,unset(e,t){},inc:(e,t)=>e+t,dec:(e,t)=>e-t},w9=Object.keys(w8),w7={replace:(e,t)=>t,set:(e,t)=>t,setIfMissing:(e,t)=>void 0===e?t:e,unset(e,t){},diffMatchPatch(e,t){let[n]=(0,s_.QE)((0,s_.G8)(t),e,{allowExceedingIndices:!0});return n}},ke=Object.keys(w7);function kt(e,t){return t.reduce(function e(t,n){return Array.isArray(t)?function(t,n){let i=t.slice();if(0===n.path.length){if("setIfMissing"===n.type){if(!Array.isArray(n.value))throw Error("Cannot set value of an array to a non-array");return void 0===t?n.value:t}if("set"===n.type){if(!Array.isArray(n.value))throw Error("Cannot set value of an array to a non-array");return n.value}if("unset"===n.type)return;if("move"===n.type){if(!n.value||!w6(n.value,"from")||!w6(n.value,"to"))throw Error('Invalid value of \'move\' patch. Expected a value with "from" and "to" indexes, instead got: '.concat(JSON.stringify(n.value)));return function(e,t,n){let i=e.slice(),r=i[t];return i.splice(t,1),i.splice(n,0,r),i}(i,n.value.from,n.value.to)}throw Error("Invalid array operation: ".concat(n.type))}let[r,...l]=n.path,a=function(e,t){if("number"==typeof t)return t;let n=dX()(e,t);return -1!==n&&n}(t,r);if(!1===a)return i;if(0===l.length){if("insert"===n.type){let{position:e,items:i}=n;return function(e,t,n){if(t!==w3&&t!==w4)throw Error('Invalid position "'.concat(t,'", must be either ').concat(w3," or ").concat(w4));for(var i=arguments.length,r=Array(i>3?i-3:0),l=3;l<i;l++)r[l-3]=arguments[l];let a=w5(...r);if(0===e.length)return a;let o=e.length,s=Math.abs((o+n)%o)%o,d=e.slice();return d.splice("after"===t?s+1:s,0,...w5(a)),d}(t,e,a,i)}if("unset"===n.type){if("number"!=typeof a)throw Error('Expected array index to be a number, instead got "'.concat(a,'"'));return i.splice(a,1),i}}return i[a]=e(i[a],{...n,path:l}),i}(t,n):oc()(t)?function(e,t){if(!ke.includes(t.type))throw Error('Received patch of unsupported type: "'.concat(JSON.stringify(t.type),'" for string. This is most likely a bug.'));if(t.path.length>0)throw Error('Cannot apply deep operations on string values. Received patch with type "'.concat(t.type,'" and path "').concat(t.path.join("."),' that targeted the value "').concat(JSON.stringify(e),'"'));return w7[t.type](e,t.value)}(t,n):dW()(t)?function(t,n){let i=dY()(t);if(0===n.path.length){if("set"===n.type){if(!dW()(n.value))throw Error("Cannot set value of an object to a non-object");return n.value}if("unset"===n.type)return;if("setIfMissing"===n.type)return void 0===t?n.value:t;throw Error("Invalid object operation: ".concat(n.type))}let[r,...l]=n.path;if("string"!=typeof r)throw Error("Expected field name to be a string, instad got: ".concat(r));return 0===l.length&&"unset"===n.type?sw()(i,r):(i[r]=e(i[r],{...n,path:l}),i)}(t,n):function(e,t){if(!w9.includes(t.type))throw Error('Received patch of unsupported type "'.concat(t.type,'" for primitives. This is most likely a bug.'));if(t.path.length>0)throw Error('Cannot apply deep operations on primitive values. Received patch with type "'.concat(t.type,'" and path "').concat(t.path.map(e=>JSON.stringify(e)).join("."),' that targeted the value "').concat(JSON.stringify(e),'"'));return w8[t.type](e,t.value)}(t,n)},e)}function kn(e){let{onPathBlur:t,onPathFocus:n,onChange:i,onSetPathCollapsed:r,onSetFieldSetCollapsed:l,onPathOpen:a,onFieldGroupSelect:o}=m7(),{member:s,renderAnnotation:d,renderBlock:c,renderField:u,renderInlineBlock:p,renderInput:h,renderItem:f,renderPreview:m}=e,{field:{actions:g}}=mY().__internal,x=(0,lJ.useRef)(),v=(0,lJ.useRef)({});m$(s.field.focused,(e,t)=>{var n;!e&&t&&(null==(n=x.current)||n.focus())});let b=(0,lJ.useCallback)(e=>{e.currentTarget===e.target&&e.currentTarget===x.current&&n(s.field.path)},[s.field.path,n]),y=(0,lJ.useCallback)(e=>{e.currentTarget===e.target&&e.currentTarget===x.current&&t(s.field.path)},[s.field.path,t]),j=(0,lJ.useRef)(s.field.value);(0,lJ.useEffect)(()=>{j.current=s.field.value},[s.field.value]);let w=(0,lJ.useCallback)(e=>{let t=mN.from(e).patches;if(t.some(e=>"unset"===e.type&&1===e.path.length)&&(j.current=kt(j.current||[],t),Array.isArray(j.current)&&!j.current.length)){i(mN.from(mq([s.name])));return}i(mN.from(e).prepend(mD([])).prefixAll(s.name))},[i,s.name,j]),k=Vg(),C=(0,l4.pm)(),_=(0,lJ.useCallback)(()=>{r(s.field.path,!0)},[r,s.field.path]),S=(0,lJ.useCallback)(()=>{r(s.field.path,!1)},[r,s.field.path]),T=(0,lJ.useCallback)(e=>{r(s.field.path.concat({_key:e}),!0)},[r,s.field.path]),E=(0,lJ.useCallback)(e=>{r(s.field.path.concat({_key:e}),!1)},[r,s.field.path]),P=(0,lJ.useCallback)(e=>{a(e),r(e,!1)},[a,r]),A=(0,lJ.useCallback)(()=>{a(s.field.path),r(s.field.path,!0)},[a,s.field.path,r]),O=(0,lJ.useCallback)(e=>{if(0===e.items.length)throw Error("Insert event should include at least one item");let t=e.items.map(e=>wM(e));w(mN.from([mZ(t,e.position,[e.referenceItem])]));let i=t[0]._key,r=[...s.field.path,{_key:i}];n(r);let l=!1!==e.open;e.skipInitialValue?l&&P(r):w2(t,s.field.schemaType,k).pipe((0,am.b)(e=>{"patch"===e.type?w(e.patches):C.push({title:"Could not resolve initial value",description:"Unable to resolve initial value for type: ".concat(e.schemaType.title,": ").concat(e.error.message,"."),status:"error"})})).subscribe({complete:()=>{l&&P(r)}})},[w,P,s.field.path,s.field.schemaType,n,k,C]),z=(0,lJ.useCallback)(e=>{let t=s.field.value,n=null==t?void 0:t[e.fromIndex],i=null==t?void 0:t[e.toIndex];if(e.fromIndex!==e.toIndex){if(!(null==n?void 0:n._key)||!(null==i?void 0:i._key)){console.error("Neither the item you are moving nor the item you are moving to have a key. Cannot continue.");return}w([mq([{_key:n._key}]),mZ([n],e.fromIndex>e.toIndex?"before":"after",[{_key:i._key}])])}},[w,s.field.value]),M=(0,lJ.useCallback)(e=>{w([mD([]),mZ([wM(e)],"before",[0])])},[w]),I=(0,lJ.useCallback)(e=>{w([mD([]),mZ([wM(e)],"after",[-1])])},[w]),R=(0,lJ.useCallback)(e=>{v.current[e]&&(v.current[e].unsubscribe(),delete v.current[e]),w([mq([{_key:e}])])},[w]),F=(0,lJ.useCallback)(e=>{n(s.field.path.concat(e))},[s.field.path,n]),D=(0,lJ.useMemo)(()=>({onBlur:y,onFocus:b,id:s.field.id,ref:x,"aria-describedby":jo(s.field.id,s.field.schemaType.description)}),[y,b,s.field.id,s.field.schemaType.description]),Z=qJ(fT),L=mY(),q=L.__internal.image.directUploads,N=L.__internal.file.directUploads,V=(0,lJ.useCallback)((e,t)=>fF("image",e)&&!q||fF("file",e)&&!N?null:wJ(e,t),[N,q]),U=(0,lJ.useCallback)(e=>{let{file:t,schemaType:n,uploader:i}=e,r=wd(n),l=r._key;O({items:[r],position:"after",referenceItem:-1,open:!1});let a=i.upload(Z,t,n).pipe((0,ag.U)(e=>mN.from(e.patches||[]).prefixAll({_key:l})),(0,am.b)(e=>w(e.patches)));v.current={...v.current,[l]:a.subscribe()}},[Z,w,O]),B=(0,lJ.useMemo)(()=>({level:s.field.level,members:s.field.members,value:s.field.value,readOnly:s.field.readOnly,schemaType:s.field.schemaType,changed:s.field.changed,id:s.field.id,onItemExpand:E,onItemCollapse:T,onItemClose:A,onItemOpen:P,focusPath:s.field.focusPath,focused:s.field.focused,path:s.field.path,onChange:w,onInsert:O,onItemMove:z,onItemRemove:R,onItemAppend:I,onItemPrepend:M,onPathFocus:F,resolveInitialValue:k,onUpload:U,resolveUploader:V,validation:s.field.validation,presence:s.field.presence,renderAnnotation:d,renderBlock:c,renderInlineBlock:p,renderInput:h,renderField:u,renderItem:f,renderPreview:m,elementProps:D}),[s.field.level,s.field.members,s.field.value,s.field.readOnly,s.field.schemaType,s.field.changed,s.field.id,s.field.focusPath,s.field.focused,s.field.path,s.field.validation,s.field.presence,E,T,A,P,w,O,z,R,I,M,F,k,U,V,d,c,p,h,u,f,m,D]),K=(0,lJ.useMemo)(()=>h(B),[B,h]),H=(0,lJ.useMemo)(()=>({actions:g,name:s.name,index:s.index,level:s.field.level,value:s.field.value,title:s.field.schemaType.title,description:s.field.schemaType.description,collapsible:s.collapsible,collapsed:s.collapsed,changed:s.field.changed,onCollapse:_,onExpand:S,schemaType:s.field.schemaType,inputId:s.field.id,path:s.field.path,presence:s.field.presence,validation:s.field.validation,children:K,inputProps:B}),[g,s.name,s.index,s.field.level,s.field.value,s.field.schemaType,s.field.changed,s.field.id,s.field.path,s.field.presence,s.field.validation,s.collapsible,s.collapsed,_,S,K,B]);return(0,lG.jsx)(m9,{onFieldGroupSelect:o,onChange:w,onSetFieldSetCollapsed:l,onSetPathCollapsed:r,onPathOpen:a,onPathBlur:t,onPathFocus:n,children:(0,lJ.useMemo)(()=>u(H),[H,u])})}function ki(e,t,n){return(0,lX.J1)(e)&&"string"==typeof n&&Number(n)===t?n:String(null!=t?t:"")}function kr(e){let{member:t,renderInput:n,renderField:i}=e,{field:{actions:r}}=mY().__internal,l=(0,lJ.useRef)(),[a,o]=(0,lJ.useState)(),{onPathBlur:s,onPathFocus:d,onChange:c}=m7();(0,lJ.useEffect)(()=>{var e;t.field.focused&&(null==(e=l.current)||e.focus())},[t.field.focused]);let u=(0,lJ.useCallback)(()=>{s(t.field.path)},[t.field.path,s]),p=(0,lJ.useCallback)(()=>{d(t.field.path)},[t.field.path,d]),h=(0,lJ.useCallback)(e=>{c(mN.from(e).prefixAll(t.name))},[c,t.name]),f=(0,lJ.useCallback)(e=>{let n=e.currentTarget.value;if((0,lX.J1)(t.field.schemaType)){if((n=e.currentTarget.valueAsNumber)>Number.MAX_SAFE_INTEGER||n<Number.MIN_SAFE_INTEGER)return}else(0,lX.EG)(t.field.schemaType)&&(n=e.currentTarget.checked);let i=""===n||"number"==typeof n&&isNaN(n);(0,lX.J1)(t.field.schemaType)&&o(i?void 0:e.currentTarget.value),c(mN.from(i?mq():mL(n)).prefixAll(t.name))},[t.name,t.field.schemaType,c]),m=(0,lJ.useMemo)(()=>t.field.validation.filter(e=>"error"===e.level).map(e=>e.message).join("\n"),[t.field.validation])||void 0,g=(0,lJ.useMemo)(()=>({onBlur:u,onFocus:p,id:t.field.id,ref:l,onChange:f,value:ki(t.field.schemaType,t.field.value,a),readOnly:!!t.field.readOnly,placeholder:t.field.schemaType.placeholder,"aria-describedby":jo(t.field.id,t.field.schemaType.description)}),[u,p,f,t.field.id,t.field.readOnly,t.field.schemaType,t.field.value,a]),x=(0,lJ.useMemo)(()=>({value:t.field.value,readOnly:t.field.readOnly,schemaType:t.field.schemaType,changed:t.field.changed,id:t.field.id,path:t.field.path,focused:t.field.focused,level:t.field.level,onChange:h,validation:t.field.validation,presence:t.field.presence,validationError:m,elementProps:g}),[t.field.value,t.field.readOnly,t.field.schemaType,t.field.changed,t.field.id,t.field.path,t.field.focused,t.field.level,t.field.validation,t.field.presence,h,m,g]),v=(0,lJ.useMemo)(()=>n(x),[x,n]),b=(0,lJ.useMemo)(()=>({actions:r,changed:t.field.changed,children:v,description:t.field.schemaType.description,index:t.index,inputId:t.field.id,inputProps:x,level:t.field.level,name:t.name,path:t.field.path,presence:t.field.presence,schemaType:t.field.schemaType,title:t.field.schemaType.title,validation:t.field.validation,value:t.field.value}),[r,t.field.level,t.field.value,t.field.schemaType,t.field.id,t.field.path,t.field.validation,t.field.presence,t.field.changed,t.name,t.index,v,x]);return(0,lG.jsx)(lG.Fragment,{children:i(b)})}let kl=function(e){let{onPathBlur:t,onPathFocus:n,onChange:i,onPathOpen:r,onSetPathCollapsed:l,onSetFieldSetCollapsed:a,onFieldGroupSelect:o}=m7(),{member:s,renderAnnotation:d,renderBlock:c,renderField:u,renderInlineBlock:p,renderInput:h,renderItem:f,renderPreview:m}=e,{field:{actions:g}}=mY().__internal,x=(0,lJ.useRef)(),v=(0,lJ.useRef)(s.field.value);(0,lJ.useEffect)(()=>{v.current=s.field.value},[s.field.value]),m$(s.field.focused,(e,t)=>{var n;!e&&t&&(null==(n=x.current)||n.focus())});let b=(0,lJ.useCallback)(()=>{t(s.field.path)},[s.field.path,t]),y=(0,lJ.useCallback)(()=>{n(s.field.path)},[s.field.path,n]),j=(0,lJ.useCallback)(e=>{n(s.field.path.concat(e))},[s.field.path,n]),w=(0,lJ.useCallback)(e=>{if(0!==s.field.path.length){let t=mN.from(e).patches;if(v.current=kt(v.current||{},t),v.current&&(0,sT.Sm)(v.current)){i(mN.from(mq([s.name])));return}}i(mN.from(e).prepend(mD(ws(s.field.schemaType))).prefixAll(s.name))},[i,s,v]),k=(0,lJ.useCallback)(()=>{l(s.field.path,!0)},[l,s.field.path]),C=(0,lJ.useCallback)(()=>{l(s.field.path,!1)},[l,s.field.path]),_=(0,lJ.useCallback)(e=>{l(s.field.path.concat(e),!0)},[l,s.field.path]),S=(0,lJ.useCallback)(e=>{l(s.field.path.concat(e),!1)},[l,s.field.path]),T=(0,lJ.useCallback)(e=>{r(s.field.path.concat(e))},[r,s.field.path]),E=(0,lJ.useCallback)(()=>{r(s.field.path)},[r,s.field.path]),P=(0,lJ.useCallback)(e=>{a(s.field.path.concat(e),!1)},[a,s.field.path]),A=(0,lJ.useCallback)(e=>{a(s.field.path.concat(e),!0)},[a,s.field.path]),O=(0,lJ.useCallback)(()=>{r(s.field.path)},[r,s.field.path]),z=(0,lJ.useCallback)(()=>{r(s.field.path.slice(0,-1))},[r,s.field.path]),M=(0,lJ.useCallback)(e=>{o(s.field.path,e)},[o,s.field.path]),I=(0,lJ.useMemo)(()=>({onBlur:b,onFocus:y,id:s.field.id,ref:x,"aria-describedby":jo(s.field.id,s.field.schemaType.description)}),[b,y,s.field.id,s.field.schemaType.description]),R=(0,lJ.useMemo)(()=>({elementProps:I,level:s.field.level,members:s.field.members,value:s.field.value,readOnly:s.field.readOnly,validation:s.field.validation,presence:s.field.presence,schemaType:s.field.schemaType,changed:s.field.changed,id:s.field.id,onFieldGroupSelect:M,onFieldOpen:T,onFieldClose:E,onFieldCollapse:_,onFieldExpand:S,onFieldSetExpand:P,onFieldSetCollapse:A,onPathFocus:j,path:s.field.path,focusPath:s.field.focusPath,focused:s.field.focused,groups:s.field.groups,onChange:w,renderAnnotation:d,renderBlock:c,renderField:u,renderInlineBlock:p,renderInput:h,renderItem:f,renderPreview:m}),[I,s.field.level,s.field.members,s.field.value,s.field.readOnly,s.field.validation,s.field.presence,s.field.schemaType,s.field.changed,s.field.id,s.field.path,s.field.focusPath,s.field.focused,s.field.groups,M,T,E,_,S,P,A,j,w,d,c,u,p,h,f,m]),F=(0,lJ.useMemo)(()=>h(R),[R,h]),D=(0,lJ.useMemo)(()=>({actions:g,name:s.name,index:s.index,level:s.field.level,value:s.field.value,validation:s.field.validation,presence:s.field.presence,title:s.field.schemaType.title,description:s.field.schemaType.description,collapsible:s.collapsible,collapsed:s.collapsed,onCollapse:k,onExpand:C,open:s.open,changed:s.field.changed,onOpen:O,onClose:z,schemaType:s.field.schemaType,inputId:s.field.id,path:s.field.path,children:F,inputProps:R}),[g,s.name,s.index,s.field.level,s.field.value,s.field.validation,s.field.presence,s.field.schemaType,s.field.changed,s.field.id,s.field.path,s.collapsible,s.collapsed,s.open,k,C,O,z,F,R]);return(0,lG.jsx)(m9,{onFieldGroupSelect:o,onChange:w,onSetFieldSetCollapsed:a,onPathOpen:r,onSetPathCollapsed:l,onPathBlur:t,onPathFocus:n,children:(0,lJ.useMemo)(()=>u(D),[D,u])})};function ka(e){let{onPathBlur:t,onPathFocus:n,onChange:i,onPathOpen:r,onSetPathCollapsed:l,onSetFieldSetCollapsed:a,onFieldGroupSelect:o}=m7(),{member:s,renderAnnotation:d,renderBlock:c,renderField:u,renderInlineBlock:p,renderInput:h,renderItem:f,renderPreview:m}=e,{field:{actions:g}}=mY().__internal,x=(0,lJ.useRef)(),v=(0,lJ.useRef)(),b=qJ(fT);m$(s.field.focused,(e,t)=>{var n;!e&&t&&(null==(n=x.current)||n.focus())});let y=(0,lJ.useCallback)(e=>{e.currentTarget===e.target&&e.currentTarget===x.current&&n(s.field.path)},[s.field.path,n]),j=(0,lJ.useCallback)(e=>{e.currentTarget===e.target&&e.currentTarget===x.current&&t(s.field.path)},[s.field.path,t]),w=(0,lJ.useCallback)(e=>{let t=mN.from(e).patches;if(t.some(e=>"unset"===e.type&&1===e.path.length)){let e=kt(s.field.value||[],t);if(Array.isArray(e)&&!e.length){i(mN.from(mq([s.name])));return}}i(mN.from(e).prepend(mD([])).prefixAll(s.name))},[i,s.name,s.field.value]),k=(0,lJ.useCallback)(e=>{l(s.field.path,e)},[l,s.field.path]),C=(0,lJ.useCallback)(()=>{l(s.field.path,!0)},[l,s.field.path]),_=(0,lJ.useCallback)(()=>{l(s.field.path,!1)},[l,s.field.path]),S=(0,lJ.useCallback)(e=>{w(0===e.length?mq():mL(e))},[w]),T=(0,lJ.useCallback)(e=>{let{value:t=[]}=s.field;e.fromIndex!==e.toIndex&&S(function(e,t,n){let i=e.slice(),r=i[t];return i.splice(t,1),i.splice(n,0,r),i}(t,e.fromIndex,e.toIndex))},[s.field,S]),E=(0,lJ.useCallback)(e=>{let{value:t=[]}=s.field;S(t.concat(e))},[s.field,S]),P=(0,lJ.useCallback)(e=>{let{value:t=[]}=s.field;S([e].concat(t||[]))},[s.field,S]),A=(0,lJ.useCallback)(e=>{let{value:t=[]}=s.field;S(function(e,t,n){let i=t.slice();return i.splice(e+1,0,...n),i}(e.referenceIndex+("before"===e.position?-1:0),t,e.items))},[s.field,S]),O=(0,lJ.useCallback)(e=>{w(mq([e]))},[w]),z=(0,lJ.useCallback)(e=>{n(s.field.path.concat([e]))},[s.field.path,n]),M=(0,lJ.useMemo)(()=>({onBlur:j,onFocus:y,id:s.field.id,ref:x,"aria-describedby":jo(s.field.id,s.field.schemaType.description)}),[j,y,s.field.id,s.field.schemaType.description]),I=(0,lJ.useMemo)(()=>{var e;return e=s.field.schemaType.of,{priority:0,accepts:"text/*",type:"string",upload:(t,n)=>new al.y(e=>{let t=new FileReader;return t.onerror=t=>e.error(t),t.onload=()=>{e.next(t.result),e.complete()},t.readAsText(n,"utf-8"),()=>{t.abort()}}).pipe((0,ag.U)(t=>null==t?void 0:t.split(/[\n\r]/).map(t=>{var n;let i,r,l;return n=t,i=!1,r=!1,l=!1,(e.forEach(e=>{(0,lX.EG)(e)&&(i=!0),(0,lX.aj)(e)&&(l=!0),(0,lX.J1)(e)&&(r=!0)}),i&&("true"===n||"false"===n))?"true"===n:r&&/^\d+$/.test(n)?Number(n):l?n:void 0}).filter(e=>void 0!==e)),(0,aj.h)(e=>Array.isArray(e)),(0,ag.U)(e=>({type:"uploadProgress",patches:[mZ(e,"after",[-1])]})))}},[s.field.schemaType.of]),R=(0,lJ.useCallback)((e,t)=>wY(t,"text/*")?I:null,[I]),F=(0,lJ.useCallback)(e=>{let{file:t,schemaType:n,uploader:i}=e,r=i.upload(b,t,n).pipe((0,ag.U)(e=>mN.from(e.patches||[])),(0,am.b)(e=>w(e.patches)));v.current&&v.current.unsubscribe(),v.current=r.subscribe()},[b,w]),D=(0,lJ.useMemo)(()=>({level:s.field.level,members:s.field.members,value:s.field.value,readOnly:s.field.readOnly,onSetCollapsed:k,schemaType:s.field.schemaType,changed:s.field.changed,id:s.field.id,elementProps:M,path:s.field.path,focusPath:s.field.focusPath,focused:s.field.focused,onChange:w,onInsert:A,onMoveItem:T,onItemRemove:O,onItemAppend:E,onItemPrepend:P,validation:s.field.validation,presence:s.field.presence,resolveUploader:R,onUpload:F,renderAnnotation:d,renderBlock:c,renderInlineBlock:p,renderInput:h,renderItem:f,onIndexFocus:z,renderPreview:m}),[s.field.level,s.field.members,s.field.value,s.field.readOnly,s.field.schemaType,s.field.changed,s.field.id,s.field.path,s.field.focusPath,s.field.focused,s.field.validation,s.field.presence,k,M,w,A,T,O,E,P,R,F,d,c,p,h,f,z,m]),Z=(0,lJ.useMemo)(()=>h(D),[D,h]),L=(0,lJ.useMemo)(()=>({actions:g,name:s.name,index:s.index,level:s.field.level,value:s.field.value,title:s.field.schemaType.title,description:s.field.schemaType.description,collapsible:s.collapsible,collapsed:s.collapsed,onExpand:_,changed:s.field.changed,onCollapse:C,schemaType:s.field.schemaType,inputId:s.field.id,path:s.field.path,presence:s.field.presence,validation:s.field.validation,children:Z,inputProps:D}),[g,s.name,s.index,s.field.level,s.field.value,s.field.schemaType,s.field.changed,s.field.id,s.field.path,s.field.presence,s.field.validation,s.collapsible,s.collapsed,_,C,Z,D]);return(0,lG.jsx)(m9,{onFieldGroupSelect:o,onChange:w,onPathOpen:r,onSetFieldSetCollapsed:a,onSetPathCollapsed:l,onPathBlur:t,onPathFocus:n,children:(0,lJ.useMemo)(()=>u(L),[L,u])})}function ko(e){return(0,lX.m$)(e.field.schemaType)}function ks(e){return(0,lX.jB)(e.field.schemaType)&&e.field.schemaType.of.every(e=>(0,lX.m$)(e))}let kd=(0,lJ.memo)(function(e){let{member:t,renderAnnotation:n,renderBlock:i,renderField:r,renderInlineBlock:l,renderInput:a,renderItem:o,renderPreview:s}=e;return ko(t)?(0,lG.jsx)(kl,{member:t,renderAnnotation:n,renderBlock:i,renderField:r,renderInlineBlock:l,renderInput:a,renderItem:o,renderPreview:s}):(0,lX.jB)(t.field.schemaType)&&t.field.schemaType.of.every(e=>(0,lX.jp)(e))?(0,lG.jsx)(ka,{member:t,renderAnnotation:n,renderBlock:i,renderField:r,renderInput:a,renderInlineBlock:l,renderItem:o,renderPreview:s}):ks(t)?(0,lG.jsx)(kn,{member:t,renderAnnotation:n,renderBlock:i,renderField:r,renderInlineBlock:l,renderInput:a,renderItem:o,renderPreview:s}):(0,lG.jsx)(kr,{member:t,renderField:r,renderInput:a})}),kc=["yes","true","1"],ku=["false","no","false","0","null"],kp=kc.concat(ku),kh=()=>!0,kf={string:{number:{test:Number,convert:Number},boolean:{test:e=>kp.includes(e.toLowerCase()),convert:e=>kc.includes(e.toLowerCase())||!ku.includes(e.toLowerCase())},richDate:{test:e=>(0,oV.Z)(e),convert:e=>({_type:"richDate",local:(function(e){let t=new Date(e.getTime()+6e4*e.getTimezoneOffset()),n=e.getTimezoneOffset()/60,i=e.getHours();return t.setHours(i-n),t})(new Date(e)).toJSON(),utc:new Date(e).toJSON(),timezone:function(){try{return Intl.DateTimeFormat().resolvedOptions().timeZone}catch(e){}return null}(),offset:new Date().getTimezoneOffset()})}},date:{richDate:{test:e=>"date"===(e&&e._type),convert:e=>Object.assign({},e,{_type:"richDate"})}},richDate:{datetime:{test:e=>e&&e.utc,convert:e=>e.utc}},number:{string:{test:kh,convert:String},boolean:{test:kh,convert:Number}},boolean:{string:{test:kh,convert:e=>e?"Yes":"No"},number:{test:kh,convert:Number}}};function km(e){let{value:t,targetType:n,onChange:i}=e,r=(0,lJ.useMemo)(()=>({...t,_type:n}),[n,t]),l=(0,lJ.useCallback)(()=>i(mN.from(mD(n,["_type"])),r),[r,i,n]);return(0,lG.jsx)(l4.zx,{onClick:l,text:(0,lG.jsxs)(lG.Fragment,{children:["Convert to ",(0,lG.jsx)("code",{children:n})]})})}function kg(e){let{value:t,onChange:n,validTypes:i}=e,r=(0,lJ.useMemo)(()=>({...t,_type:i[0]}),[i,t]),l=(0,lJ.useCallback)(()=>n(mN.from(mq()),r),[r,n]);return(0,lG.jsx)(l4.zx,{onClick:l,tone:"critical",text:"Unset value"})}function kx(e){let{validTypes:t,value:n,onChange:i}=e,r=q6(),l=1===t.length,a=r.has(t[0]);return(0,lG.jsx)(mH,{status:"warning",title:(0,lG.jsxs)(lG.Fragment,{children:["Property value missing ",(0,lG.jsx)("code",{children:"_type"})]}),children:(0,lG.jsx)(wr,{open:v5,title:(0,lG.jsx)(lG.Fragment,{children:"Developer info"}),children:(0,lG.jsxs)(l4.Kq,{space:3,children:[(0,lG.jsxs)(l4.xv,{as:"p",muted:!0,size:1,children:["Encountered an object value without a ",(0,lG.jsx)("code",{children:"_type"})," property."]}),l&&!a&&(0,lG.jsxs)(l4.xv,{as:"p",muted:!0,size:1,children:["Either remove the ",(0,lG.jsx)("code",{children:"name"})," property of the object declaration, or set"," ",(0,lG.jsx)("code",{children:"_type"})," property on items."]}),!l&&(0,lG.jsx)(l4.xv,{as:"p",muted:!0,size:1,children:"The following types are valid here according to schema:"}),!l&&(0,lG.jsx)(l4.Kq,{as:"ul",space:2,children:t.map(e=>(0,lG.jsx)(l4.xv,{as:"li",muted:!0,size:1,children:(0,lG.jsx)("code",{children:e})},e))}),(0,lG.jsxs)(l4.Kq,{space:2,children:[(0,lG.jsxs)(l4.xv,{as:"h4",weight:"semibold",size:1,children:["Current value (",(0,lG.jsx)("code",{children:"object"}),"):"]}),(0,lG.jsx)(l4.Zb,{border:!0,overflow:"auto",padding:2,radius:2,tone:"inherit",children:(0,lG.jsx)(l4.EK,{language:"json",children:JSON.stringify(n,null,2)})})]}),(0,lG.jsxs)(l4.rj,{columns:[1,2,2],gap:1,children:[l&&(0,lG.jsx)(km,{onChange:i,targetType:t[0],value:n}),(0,lG.jsx)(kg,{onChange:i,validTypes:t,value:n})]})]})})})}let kv=(0,lJ.forwardRef)((e,t)=>{let{value:n,actualType:i,validTypes:r,onChange:l}=e;(0,lJ.useImperativeHandle)(t,()=>({focus:()=>void 0}));let a=(0,lJ.useCallback)(()=>{l(mN.from(mq()))},[l]),o=(0,lJ.useCallback)(e=>{l(mN.from(mL(e)))},[l]),s=(0,lJ.useMemo)(()=>i in kf?Object.keys(kf[i]).filter(e=>r.includes(e)).map(e=>({from:i,to:e,...kf[i][e]})).filter(e=>e.test(n)):[],[n,i,r]);if(sU()(n)&&!("_type"in n))return(0,lG.jsx)(kx,{value:n,validTypes:r,onChange:l});let d=(0,lG.jsx)(l4.Kq,{padding:2,children:(0,lG.jsx)(l4.zx,{onClick:a,tone:"critical",text:"Reset value"})});return(0,lG.jsxs)(mH,{status:"error",suffix:d,title:(0,lG.jsx)(lG.Fragment,{children:"Invalid property value"}),children:[(0,lG.jsx)(l4.xv,{as:"p",muted:!0,size:1,children:"The property value is stored as a value type that does not match the expected type."}),(0,lG.jsx)(wr,{marginTop:4,open:v5,title:(0,lG.jsx)(lG.Fragment,{children:"Developer info"}),children:(0,lG.jsxs)(l4.Kq,{space:3,children:[1===r.length&&(0,lG.jsxs)(l4.xv,{as:"p",muted:!0,size:1,children:["The value of this property must be of type ",(0,lG.jsx)("code",{children:r[0]})," according to the schema."]}),1===r.length&&(0,lG.jsx)(l4.xv,{as:"p",muted:!0,size:1,children:"Mismatching value types typically occur when the schema has recently been changed."}),1!==r.length&&(0,lG.jsx)(l4.xv,{as:"p",muted:!0,size:1,children:"Only the following types are valid here according to schema:"}),1!==r.length&&(0,lG.jsx)(l4.Kq,{as:"ul",space:2,children:r.map(e=>(0,lG.jsx)(l4.xv,{as:"li",children:(0,lG.jsx)("code",{children:e})},e))}),(0,lG.jsxs)(l4.Kq,{marginTop:2,space:2,children:[(0,lG.jsxs)(l4.xv,{size:1,weight:"semibold",children:["The current value (",(0,lG.jsx)("code",{children:i}),")"]}),(0,lG.jsx)(l4.Zb,{border:!0,padding:2,radius:2,tone:"inherit",children:(0,lG.jsx)(l4.EK,{language:"json",size:1,children:JSON.stringify(n,null,2)})})]}),s.length>0&&(0,lG.jsx)(l4.Kq,{space:1,children:s.map(e=>(0,lG.jsx)(kb,{converter:e,onConvert:o,value:n},"".concat(e.from,"-").concat(e.to)))})]})})]})});function kb(e){let{converter:t,onConvert:n,value:i}=e,r=(0,lJ.useCallback)(()=>n(t.convert(i)),[t,n,i]);return(0,lG.jsx)(l4.zx,{onClick:r,text:(0,lG.jsxs)(lG.Fragment,{children:["Convert to ",(0,lG.jsx)("code",{children:t.to})]})})}function ky(e){let{error:t,onChange:n}=e,i=(0,lJ.useCallback)(()=>{n(mN.from((t.value||[]).map((e,t)=>mD((0,sT.E2)(),[t,"_key"]))))},[t.value,n]);return(0,lG.jsx)(jy,{title:t.schemaType.title,description:t.schemaType.description,children:(0,lG.jsxs)(mH,{status:"warning",suffix:(0,lG.jsx)(l4.Kq,{padding:2,children:(0,lG.jsx)(l4.zx,{onClick:i,text:"Add missing keys",tone:"caution"})}),title:(0,lG.jsx)(lG.Fragment,{children:"Missing keys"}),children:[(0,lG.jsx)(l4.xv,{as:"p",muted:!0,size:1,children:"Some items in the list are missing their keys. This must be fixed in order to edit the list."}),(0,lG.jsx)(wr,{marginTop:4,open:v5,title:(0,lG.jsx)(lG.Fragment,{children:"Developer info"}),children:(0,lG.jsxs)(l4.Kq,{space:3,children:[(0,lG.jsxs)(l4.xv,{as:"p",muted:!0,size:1,children:["This usually happens when items are created using an API client, and the"," ",(0,lG.jsx)("code",{children:"_key"})," property has not been included."]}),(0,lG.jsxs)(l4.xv,{as:"p",muted:!0,size:1,children:["The value of the ",(0,lG.jsx)("code",{children:"_key"})," property must be a unique string."]})]})})]})})}function kj(e){let{error:t,onChange:n}=e,i=(0,lJ.useCallback)(()=>{n(mN.from((t.duplicates||[]).map(e=>{let[t,n]=e;return mL("".concat(n,"_deduped_").concat(t),[t,"_key"])})))},[t.duplicates,n]);return(0,lG.jsx)(jy,{title:t.schemaType.title,description:t.schemaType.description,children:(0,lG.jsxs)(mH,{status:"warning",suffix:(0,lG.jsx)(l4.Kq,{padding:2,children:(0,lG.jsx)(l4.zx,{onClick:i,text:"Generate unique keys",tone:"caution"})}),title:(0,lG.jsx)(lG.Fragment,{children:"Non-unique keys"}),children:[(0,lG.jsx)(l4.xv,{as:"p",muted:!0,size:1,children:"Several items in this list share the same identifier (key). Every item must have an unique identifier."}),(0,lG.jsx)(wr,{marginTop:4,open:v5,title:(0,lG.jsx)(lG.Fragment,{children:"Developer info"}),children:(0,lG.jsxs)(l4.Kq,{space:3,children:[(0,lG.jsxs)(l4.xv,{as:"p",muted:!0,size:1,children:["This usually happens when items are created using an API client, and the"," ",(0,lG.jsx)("code",{children:"_key"})," property of each elements has been generated non-uniquely."]}),(0,lG.jsxs)(l4.xv,{as:"p",muted:!0,size:1,children:["The value of the ",(0,lG.jsx)("code",{children:"_key"})," property must be a unique string."]})]})})]})})}function kw(e){let{error:t,onChange:n}=e;return(0,lG.jsx)(jy,{title:t.schemaType.title,description:t.schemaType.description,children:(0,lG.jsxs)(mH,{status:"error",suffix:(0,lG.jsx)(l4.Kq,{padding:2,children:(0,lG.jsx)(l4.zx,{onClick:()=>{let e=(t.value||[]).flatMap((e,t)=>sU()(e)?[]:[t]).reverse().map(e=>mq([e]));n(mN.from(e))},text:"Remove non-object values",tone:"critical"})}),title:(0,lG.jsx)(lG.Fragment,{children:"Invalid list values"}),children:[(0,lG.jsx)(l4.xv,{as:"p",muted:!0,size:1,children:"Some items in this list are not objects. This must be fixed in order to edit the list."}),(0,lG.jsx)(wr,{marginTop:4,open:v5,title:(0,lG.jsx)(lG.Fragment,{children:"Developer info"}),children:(0,lG.jsx)(l4.Kq,{space:3,children:(0,lG.jsx)(l4.xv,{as:"p",muted:!0,size:1,children:"This usually happens when items are created using an API client, or when a custom input component has added invalid data to the list."})})})]})})}function kk(e){let{member:t}=e,{onChange:n}=m7(),i=(0,lJ.useCallback)(e=>{n(mN.from(e).prefixAll(t.fieldName))},[n,t.fieldName]);return"INCOMPATIBLE_TYPE"===t.error.type?(0,lG.jsx)(kv,{value:t.error.value,onChange:i,actualType:t.error.resolvedValueType,validTypes:[t.error.expectedSchemaType.name]}):"MISSING_KEYS"===t.error.type?(0,lG.jsx)(ky,{error:t.error,onChange:i}):"DUPLICATE_KEYS"===t.error.type?(0,lG.jsx)(kj,{error:t.error,onChange:i}):"MIXED_ARRAY"===t.error.type?(0,lG.jsx)(kw,{onChange:i,error:t.error}):(0,lG.jsxs)(l4.xu,{children:["Unexpected error: ",e.member.error.type]})}kv.displayName="InvalidValueInput";let kC=(0,lJ.memo)(function(e){var t;let{member:n,renderAnnotation:i,renderBlock:r,renderField:l,renderInlineBlock:a,renderInput:o,renderItem:s,renderPreview:d}=e,{onSetFieldSetCollapsed:c}=m7(),u=(0,lJ.useCallback)(()=>{c(n.fieldSet.path,!0)},[n.fieldSet.path,c]),p=(0,lJ.useCallback)(()=>{c(n.fieldSet.path,!1)},[n.fieldSet.path,c]);return(0,lG.jsx)(jI,{title:n.fieldSet.title||sK()(n.fieldSet.name),description:n.fieldSet.description,level:n.fieldSet.level,collapsible:n.fieldSet.collapsible,collapsed:n.fieldSet.collapsed,onCollapse:u,onExpand:p,columns:null==(t=null==n?void 0:n.fieldSet)?void 0:t.columns,"data-testid":"fieldset-".concat(n.fieldSet.name),inputId:n.fieldSet.name,children:n.fieldSet.members.map(e=>"error"===e.kind?(0,lG.jsx)(kk,{member:e},n.key):(0,lG.jsx)(kd,{member:e,renderAnnotation:i,renderBlock:r,renderField:l,renderInlineBlock:a,renderInput:o,renderItem:s,renderPreview:d},e.key))})});function k_(e){let t=(0,lJ.useRef)(),{member:n,renderAnnotation:i,renderBlock:r,renderField:l,renderInlineBlock:a,renderInput:o,renderItem:s,renderPreview:d}=e,{onPathBlur:c,onPathFocus:u,onChange:p,onPathOpen:h,onSetPathCollapsed:f,onSetFieldSetCollapsed:m,onFieldGroupSelect:g}=m7(),x=Vg();m$(n.item.focused,(e,n)=>{var i;!e&&n&&(null==(i=t.current)||i.focus())});let v=(0,lJ.useCallback)(()=>{p(mN.from([mq([{_key:n.key}])]))},[n.key,p]),b=(0,lJ.useCallback)(e=>{h(e),f(e,!1)},[h,f]),y=(0,l4.pm)(),j=(0,lJ.useCallback)(e=>{if(0===e.items.length)throw Error("Insert event should include at least one item");let t=e.items.map(e=>wM(e));p(mN.from([mZ(t,e.position,[{_key:n.key}])]));let i=t[0]._key,r=[...n.item.path.slice(0,-1),{_key:i}];u(r);let l=!1!==e.open;e.skipInitialValue?l&&b(r):w2(t,n.parentSchemaType,x).pipe((0,am.b)(e=>{"patch"===e.type?p(mN.from(e.patches)):y.push({title:"Could not resolve initial value",description:"Unable to resolve initial value for type: ".concat(e.schemaType.title,": ").concat(e.error.message,"."),status:"error"})})).subscribe({complete:()=>{l&&b(r)}})},[b,n.item.path,n.key,n.parentSchemaType,p,u,x,y]),w=(0,lJ.useCallback)(()=>{c(n.item.path)},[n.item.path,c]),k=(0,lJ.useCallback)(()=>{u(n.item.path)},[n.item.path,u]),C=(0,lJ.useCallback)(e=>{u(n.item.path.concat(e))},[n.item.path,u]),_=(0,lJ.useCallback)(e=>{p(mN.from(e).prepend(mD(ws(n.item.schemaType))).prefixAll({_key:n.key}))},[p,n.item.schemaType,n.key]),S=(0,lJ.useCallback)(()=>{f(n.item.path,!0)},[f,n.item.path]),T=(0,lJ.useCallback)(()=>{f(n.item.path,!1)},[f,n.item.path]),E=(0,lJ.useCallback)(e=>{f(n.item.path.concat(e),!0)},[f,n.item.path]),P=(0,lJ.useCallback)(e=>{f(n.item.path.concat(e),!1)},[f,n.item.path]),A=(0,lJ.useCallback)(()=>{h(n.item.path)},[h,n.item.path]),O=(0,lJ.useCallback)(e=>{h(n.item.path.concat(e))},[h,n.item.path]),z=(0,lJ.useCallback)(e=>{m(n.item.path.concat(e),!1)},[m,n.item.path]),M=(0,lJ.useCallback)(e=>{m(n.item.path.concat(e),!0)},[m,n.item.path]),I=(0,lJ.useCallback)(()=>{h(n.item.path)},[h,n.item.path]),R=!n.item.value||w0(n.item.value),F=(0,lJ.useCallback)(()=>{R&&v();let e=n.item.path.slice(0,-1);h(e),u(e)},[R,h,n.item.path,u,v]),D=(0,lJ.useCallback)(e=>{g(n.item.path,e)},[g,n.item.path]),Z=(0,lJ.useMemo)(()=>({onBlur:w,onFocus:k,id:n.item.id,ref:t,"aria-describedby":jo(n.item.id,n.item.schemaType.description)}),[w,k,n.item.id,n.item.schemaType.description]),L=(0,lJ.useMemo)(()=>({changed:n.item.changed,focusPath:n.item.focusPath,focused:n.item.focused,groups:n.item.groups,id:n.item.id,level:n.item.level,members:n.item.members,onChange:_,onFieldClose:A,onFieldCollapse:E,onFieldSetCollapse:M,onFieldExpand:P,onFieldSetExpand:z,onFieldGroupSelect:D,onPathFocus:C,onFieldOpen:O,path:n.item.path,presence:n.item.presence,readOnly:n.item.readOnly,renderAnnotation:i,renderBlock:r,renderField:l,renderInlineBlock:a,renderInput:o,renderItem:s,renderPreview:d,schemaType:n.item.schemaType,validation:n.item.validation,value:n.item.value,elementProps:Z}),[Z,_,A,E,M,P,z,C,O,D,n.item.changed,n.item.focusPath,n.item.focused,n.item.groups,n.item.id,n.item.level,n.item.members,n.item.path,n.item.presence,n.item.readOnly,n.item.schemaType,n.item.validation,n.item.value,i,r,l,a,o,s,d]),q=(0,lJ.useMemo)(()=>o(L),[L,o]),N=(0,lJ.useMemo)(()=>({key:n.key,index:n.index,level:n.item.level,value:n.item.value,title:n.item.schemaType.title,description:n.item.schemaType.description,collapsible:n.collapsible,collapsed:n.collapsed,schemaType:n.item.schemaType,parentSchemaType:n.parentSchemaType,onInsert:j,onRemove:v,presence:n.item.presence,validation:n.item.validation,open:n.open,onOpen:I,onClose:F,onExpand:T,onCollapse:S,readOnly:n.item.readOnly,focused:n.item.focused,onFocus:k,onBlur:w,inputId:n.item.id,path:n.item.path,children:q,changed:n.item.changed,inputProps:L}),[n.key,n.index,n.item.level,n.item.value,n.item.schemaType,n.parentSchemaType,n.item.presence,n.item.validation,n.item.readOnly,n.item.focused,n.item.id,n.item.path,n.item.changed,n.collapsible,n.collapsed,n.open,j,v,I,F,T,S,k,w,q,L]);return(0,lG.jsx)(m9,{onFieldGroupSelect:g,onChange:_,onPathOpen:h,onSetFieldSetCollapsed:m,onSetPathCollapsed:f,onPathBlur:c,onPathFocus:u,children:(0,lJ.useMemo)(()=>s(N),[N,s])})}function kS(e){switch(e.jsonType){case"string":return"";case"number":return -0;case"boolean":return!1;default:throw Error('Unable to create value from type "'.concat(e.jsonType,'"'))}}function kT(e){let t=(0,lJ.useRef)(),{member:n,renderItem:i,renderInput:r}=e,[l,a]=(0,lJ.useState)(),{onPathBlur:o,onPathFocus:s,onChange:d}=m7();m$(n.item.focused,(e,n)=>{var i;!e&&n&&(null==(i=t.current)||i.focus())});let c=(0,lJ.useCallback)(e=>{o(n.item.path)},[n.item.path,o]),u=(0,lJ.useCallback)(e=>{s(n.item.path)},[n.item.path,s]),p=(0,lJ.useCallback)(e=>{d(mN.from(e).prefixAll(n.index))},[d,n.index]),h=(0,lJ.useCallback)(e=>{let t=e.currentTarget.value;if((0,lX.J1)(n.item.schemaType)){if((t=e.currentTarget.valueAsNumber)>Number.MAX_SAFE_INTEGER||t<Number.MIN_SAFE_INTEGER)return}else(0,lX.EG)(n.item.schemaType)&&(t=e.currentTarget.checked);let i=""===t||"number"==typeof t&&isNaN(t);(0,lX.J1)(n.item.schemaType)&&a(i?void 0:e.currentTarget.value),p(mL(i?kS(n.item.schemaType):t))},[p,n.item.schemaType]),f=(0,lJ.useMemo)(()=>{var e,i;return{onBlur:c,onFocus:u,id:n.item.id,ref:t,onChange:h,value:(e=n.item.schemaType,Object.is(i=n.item.value,-0)?"":ki(e,i,l)),readOnly:!!n.item.readOnly,placeholder:n.item.schemaType.placeholder,"aria-describedby":jo(n.item.id,n.item.schemaType.description)}},[c,u,h,n.item.id,n.item.readOnly,n.item.schemaType,n.item.value,l]),m=(0,lJ.useMemo)(()=>({changed:n.item.changed,level:n.item.level,value:n.item.value,readOnly:n.item.readOnly,schemaType:n.item.schemaType,id:n.item.id,path:n.item.path,focused:n.item.focused,onChange:p,validation:n.item.validation,presence:n.item.presence,elementProps:f}),[n.item.changed,n.item.level,n.item.value,n.item.readOnly,n.item.schemaType,n.item.id,n.item.path,n.item.focused,n.item.validation,n.item.presence,p,f]),g=(0,lJ.useMemo)(()=>r(m),[m,r]),x=(0,lJ.useCallback)(()=>{d(mN.from([mq([n.index])]))},[n.index,d]),v=(0,lJ.useCallback)(e=>{d(mN.from([mZ(e.items,e.position,[n.index])]))},[n.index,d]),b=(0,lJ.useMemo)(()=>({key:n.key,index:n.index,level:n.item.level,value:n.item.value,title:n.item.schemaType.title,description:n.item.schemaType.description,schemaType:n.item.schemaType,parentSchemaType:n.parentSchemaType,onInsert:v,onRemove:x,presence:n.item.presence,validation:n.item.validation,readOnly:n.item.readOnly,focused:n.item.focused,onFocus:u,onBlur:c,inputId:n.item.id,path:n.item.path,children:g}),[n.key,n.index,n.item.level,n.item.value,n.item.schemaType,n.item.presence,n.item.validation,n.item.readOnly,n.item.focused,n.item.id,n.item.path,n.parentSchemaType,v,x,u,c,g]);return(0,lG.jsx)(lG.Fragment,{children:(0,lJ.useMemo)(()=>i(b),[b,i])})}var kE=Object.freeze,kP=Object.defineProperty;let kA=(0,a0.ZP)(l4.Zb)(nE||(nE=kE(kP(O=["\n  max-width: ","px;\n"],"raw",{value:kE(O.slice())}))),e=>{let{theme:t}=e;return t.sanity.container[1]});function kO(e){let{value:t,onFocus:n,vertical:i,...r}=e,[l,a]=lJ.useState(!1),[o,s]=lJ.useState(null);(0,l4.O8)(()=>a(!1),[o]);let d=lJ.useCallback(e=>{("Escape"===e.key||"Tab"===e.key)&&a(!1)},[]),c=(0,lJ.useCallback)(()=>{a(e=>!e)},[]),u=(0,sT.wq)(t);return(0,lG.jsx)(l4.J2,{open:l,ref:s,onKeyDown:d,portal:!0,constrainSize:!0,tone:"default",content:(0,lG.jsx)(kA,{margin:1,padding:3,onKeyDown:d,tabIndex:0,overflow:"auto",children:(0,lG.jsxs)(l4.Kq,{space:4,children:[(0,lG.jsxs)(l4.xv,{weight:"semibold",children:["Item of type ",(0,lG.jsx)("code",{children:u})," not valid for this list"]}),(0,lG.jsx)(l4.xv,{size:1,weight:"semibold",children:"Why is this happening?"}),(0,lG.jsxs)(l4.xv,{size:1,children:["The current schema does not declare items of type ",(0,lG.jsx)("code",{children:u})," as valid for this list. This could mean that the type has been removed as a valid item type, or that someone else has added it to their own local schema that is not yet deployed."]}),(0,lG.jsx)(l4.xu,{children:(0,lG.jsxs)(l4.xv,{size:1,children:[(0,lG.jsx)(a8.sLo,{})," You can still move or delete this item, but it cannot be edited since the schema definition for its type is nowhere to be found."]})}),(0,lG.jsxs)(l4.Kq,{space:2,children:[(0,lG.jsx)(l4.xv,{size:1,weight:"semibold",children:"JSON representation of this item:"}),(0,lG.jsx)(l4.Zb,{padding:2,overflow:"auto",border:!0,children:(0,lG.jsx)(l4.EK,{size:1,as:"pre",language:"json",children:JSON.stringify(t,null,2)})})]})]})}),children:(0,lG.jsx)(l4.Zb,{as:"button",type:"button",radius:2,tone:"inherit",paddingX:2,paddingY:3,flex:1,onFocus:n,onClick:c,onKeyDown:d,__unstable_focusRing:!0,...r,children:(0,lG.jsxs)(l4.kC,{align:"center",children:[(0,lG.jsx)(l4.xu,{marginRight:3,children:(0,lG.jsx)(l4.xv,{children:(0,lG.jsx)(a8.Tzq,{})})}),(0,lG.jsx)(l4.xu,{flex:1,children:(0,lG.jsxs)(l4.xv,{size:1,textOverflow:"ellipsis",children:["Item of type ",(0,lG.jsx)("code",{children:u})," not valid for this list"]})})]})})})}function kz(e){let{member:t}=e;return"INVALID_ITEM_TYPE"===t.error.type?(0,lG.jsx)(kO,{value:t.error.value}):(0,lG.jsxs)("div",{children:["Unexpected Error: ",t.error.type]})}let kM=(0,lJ.memo)(function(e){let{member:t,renderAnnotation:n,renderBlock:i,renderInput:r,renderInlineBlock:l,renderField:a,renderItem:o,renderPreview:s}=e;return"field"===t.kind?(0,lG.jsx)(kd,{member:t,renderAnnotation:n,renderBlock:i,renderInlineBlock:l,renderInput:r,renderField:a,renderItem:o,renderPreview:s},t.key):"error"===t.kind?(0,lG.jsx)(kk,{member:t},t.key):"fieldSet"===t.kind?(0,lG.jsx)(kC,{member:t,renderAnnotation:n,renderBlock:i,renderInlineBlock:l,renderInput:r,renderField:a,renderItem:o,renderPreview:s},t.key):(console.warn(Error("Unhandled member kind ".concat(t.kind))),null)});function kI(e){let{members:t,renderAnnotation:n,renderBlock:i,renderInput:r,renderInlineBlock:l,renderField:a,renderItem:o,renderPreview:s}=e,d=(0,lJ.useMemo)(()=>t.map(e=>(0,lG.jsx)(kM,{member:e,renderAnnotation:n,renderBlock:i,renderField:a,renderInlineBlock:l,renderInput:r,renderItem:o,renderPreview:s},e.key)),[t,n,i,a,l,r,o,s]);return(0,lG.jsx)(lG.Fragment,{children:d})}let kR=e=>{let{children:t}=e;return t},kF=(0,lJ.memo)(function(e){let t=(0,lJ.useMemo)(()=>"absolutePath"in e?e.absolutePath:e.path.concat(e.relativePath),[e]),n=(0,lJ.useCallback)(()=>(0,lG.jsx)(lG.Fragment,{children:"Missing destination render function"}),[]);return(0,lG.jsx)(kD,{...e,absolutePath:t,destinationRenderAnnotation:e.renderAnnotation||n,destinationRenderBlock:e.renderBlock||n,destinationRenderField:e.renderField,destinationRenderInlineBlock:e.renderInlineBlock||n,destinationRenderInput:e.renderInput,destinationRenderItem:e.renderItem,destinationRenderPreview:e.renderPreview})}),kD=(0,lJ.memo)(function e(t){let{absolutePath:n,destinationRenderAnnotation:i,destinationRenderBlock:r,destinationRenderField:l,destinationRenderInlineBlock:a,destinationRenderInput:o,destinationRenderItem:s,destinationRenderPreview:d}=t,c=(0,lJ.useCallback)(t=>{if((0,lY.Xy)(t.path,n)||(0,lY.Ny)(n,t.path))return o(t);if(!wO(t)&&!wz(t))throw Error("Expected either object input props or array input props for: ".concat(JSON.stringify(t.path)));return(0,lG.jsx)(e,{...t,absolutePath:n,destinationRenderAnnotation:i,destinationRenderBlock:r,destinationRenderInput:o,destinationRenderItem:s,destinationRenderField:l,destinationRenderInlineBlock:a,destinationRenderPreview:d})},[n,i,r,l,a,o,s,d]),u=(0,lJ.useCallback)(e=>(0,lY.Ny)(n,e.path)&&(t.includeField||!(0,lY.Xy)(n,e.path))?l(e):kR(e),[n,l,t.includeField]),p=(0,lJ.useCallback)(e=>(0,lY.Ny)(n,e.path)&&(t.includeItem||!(0,lY.Xy)(n,e.path))?s(e):kR(e),[n,s,t.includeItem]),h=(0,lJ.useCallback)(e=>(0,lY.Ny)(n,e.path)&&(t.includeItem||!(0,lY.Xy)(n,e.path))?r(e):kR(e),[n,r,t.includeItem]),f=(0,lJ.useCallback)(e=>(0,lY.Ny)(n,e.path)&&(t.includeItem||!(0,lY.Xy)(n,e.path))?a(e):kR(e),[n,a,t.includeItem]),m=(0,lJ.useCallback)(e=>(0,lY.Ny)(n,e.path)&&(t.includeItem||!(0,lY.Xy)(n,e.path))?i(e):kR(e),[n,i,t.includeItem]);if(wz(t)){let e=(0,lY.fi)(t.path,n),i=t.members.find(t=>"item"==t.kind&&(0,lX.Fd)(e[0])&&t.key===e[0]._key);if(!i){let e=(0,lY.fi)(t.path,n)[0]._key;return(0,lG.jsxs)("div",{children:["No array item with _key ",(0,lG.jsxs)("code",{children:['"',e,'"']})," found at path ",JSON.stringify(t.path)]})}return"error"===i.kind?(0,lG.jsx)(kz,{member:i}):(0,lG.jsx)(k_,{member:i,renderAnnotation:m,renderBlock:h,renderInput:c,renderField:u,renderInlineBlock:f,renderItem:p,renderPreview:d})}if(wO(t)){let e=(0,lY.fi)(t.path,n),i=t.members.find(t=>"field"==t.kind&&e[0]===t.name);if(!i){let t=e[0];return(0,lG.jsxs)("div",{children:["Field ",JSON.stringify(t)," not found among members – please verify that it's both defined in the schema and that it has not been conditionally hidden."]})}return(0,lG.jsx)(kd,{member:i,renderAnnotation:m,renderBlock:h,renderInput:c,renderInlineBlock:f,renderField:u,renderItem:p,renderPreview:d})}throw Error("FormInput can only be used with arrays or objects")}),kZ=(0,lJ.createContext)(null);function kL(e){let{scrollElement:t,containerElement:n}=e;return(0,lG.jsx)(kZ.Provider,{value:{scrollElement:t,containerElement:n},children:e.children})}let kq=[0,0,1,0];function kN(e){let{children:t,header:n,id:i,legacy_referenceElement:r,onClose:l,type:a,width:o,autofocus:s}=e,[d,c]=(0,lJ.useState)(null),u=(0,lJ.useRef)(null),p=(0,lG.jsx)(y5,{margins:kq,children:(0,lG.jsx)(l4.xu,{ref:u,padding:4,children:t})});return"dialog"===a?(0,lG.jsx)(kL,{scrollElement:d,containerElement:u,children:(0,lG.jsx)(l4.Vq,{header:n,id:i||"",onClickOutside:l,onClose:l,width:o,contentRef:c,__unstable_autoFocus:s,children:p})}):(0,lG.jsx)(uD,{header:n,onClose:l,referenceElement:r,width:o,containerRef:c,children:(0,lG.jsx)(kL,{scrollElement:d,containerElement:u,children:p})})}let kV={portal:!0,tone:"default"},kU={position:"absolute",top:0,left:0,bottom:0,right:0,opacity:.6},kB={position:"relative"};function kK(e){var t,n,i,r,l,a;let{schemaType:o,parentSchemaType:s,path:d,readOnly:c,onRemove:u,value:p,open:h,onInsert:f,onFocus:m,onOpen:g,onClose:x,changed:v,focused:b,children:y,inputProps:{renderPreview:j}}=e,w=!c&&(null==(t=s.options)?void 0:t.sortable)!==!1,k=s.of,C=(0,lJ.useRef)(null);ya(C,h),m$(b,(e,t)=>{var n;!e&&t&&C.current&&(null==(n=C.current)||n.focus())});let _=p._resolvingInitialValue,S=(0,lJ.useCallback)(()=>{f({items:[{...p,_key:ys()}],position:"after"})},[f,p]),T=(0,lJ.useCallback)((e,t)=>{f({items:[wd(t)],position:e})},[f]),E=gi(d,!0),P=(0,lJ.useMemo)(()=>0===E.length?null:(0,lG.jsx)(yA,{presence:E,maxAvatars:1}),[E]),A=ga(d,!0),O=(0,lJ.useMemo)(()=>0===A.length?null:(0,lG.jsx)(l4.xu,{marginLeft:1,paddingX:1,paddingY:3,children:(0,lG.jsx)(jf,{validation:A,__unstable_showSummary:!0})}),[A]),z=A.some(e=>"error"===e.level),M=A.some(e=>"warning"===e.level),I=(0,lJ.useMemo)(()=>c?null:(0,lG.jsx)(l4.j2,{button:(0,lG.jsx)(l4.zx,{padding:2,mode:"bleed",icon:a8.zGg}),id:"".concat(e.inputId,"-menuButton"),menu:(0,lG.jsxs)(l4.v2,{children:[(0,lG.jsx)(l4.sN,{text:"Remove",tone:"critical",icon:a8.XHJ,onClick:u}),(0,lG.jsx)(l4.sN,{text:"Duplicate",icon:a8.TIy,onClick:S}),(0,lG.jsx)(wu,{types:k,onInsert:T})]}),popover:kV}),[S,T,u,k,e.inputId,c]),R=function(e){let{readOnly:t,hasErrors:n,hasWarnings:i}=e;return t?"transparent":n?"critical":i?"caution":"default"}({readOnly:c,hasErrors:z,hasWarnings:M}),F=(0,lG.jsx)(j6,{menu:I,presence:P,validation:O,tone:R,focused:b,dragHandle:w,selected:h,children:(0,lG.jsxs)(l4.Zb,{as:"button",type:"button",tone:"inherit",radius:2,disabled:_,padding:1,onClick:g,ref:C,onFocus:m,__unstable_focusRing:!0,style:kB,children:[j({schemaType:e.schemaType,value:e.value,layout:"default",skipVisibilityCheck:!0}),_&&(0,lG.jsx)(l4.Zb,{style:kU,tone:"transparent",radius:2,as:l4.kC,justify:"center",children:(0,lG.jsxs)(l4.kC,{align:"center",justify:"center",padding:3,children:[(0,lG.jsx)(l4.xu,{marginX:3,children:(0,lG.jsx)(l4.$j,{muted:!0})}),(0,lG.jsx)(l4.xv,{size:1,muted:!0,children:"Resolving initial value…"})]})})]})}),D=fS(o);return(0,lG.jsxs)(lG.Fragment,{children:[(0,lG.jsx)(cU,{path:d,isChanged:v,hasFocus:!!b,children:(0,lG.jsx)(l4.xu,{paddingX:1,children:F})}),h&&(0,lG.jsx)(kN,{header:c?"View ".concat(D):"Edit ".concat(D),type:(null==(i=null==(n=null==s?void 0:s.options)?void 0:n.modal)?void 0:i.type)||"dialog",width:null!=(a=null==(l=null==(r=null==s?void 0:s.options)?void 0:r.modal)?void 0:l.width)?a:1,id:p._key,onClose:x,autofocus:b,legacy_referenceElement:C.current,children:y})]})}function kH(e){var t;return(null==(t=e.components)?void 0:t.item)?e.components.item:(0,lX.dD)(e)?wA:kK}function kW(e){let t=cn(e),{value:n}=mY();return gA(n,t)}function k$(){let e=kW(["_id"]);if("string"==typeof e)return cd(e)}let kX={portal:!0,tone:"default"};function kG(e){var t,n,i,r,l,a,o,s,d,c;let u=(0,lJ.useRef)(null),{schemaType:p,path:h,open:f,inputId:m,children:g,inputProps:x}=e,{readOnly:v,focused:b,renderPreview:y,onChange:j}=e.inputProps,[w,k]=(0,lJ.useState)([]),C=k$(),_=(0,lJ.useCallback)(()=>x.onChange(mq()),[x]),S=e.value,{EditReferenceLink:T,getReferenceInfo:E,selectedState:P,isCurrentDocumentLiveEdit:A}=Ek({path:h,schemaType:p,value:S});ya(u,f),m$(b,(e,t)=>{!e&&t&&u.current&&u.current.focus()});let O=e.validation.some(e=>"error"===e.level),z=e.validation.some(e=>"warning"===e.level),M=wg(null==S?void 0:S._ref,E),I=(null==(t=M.result)?void 0:t.type)||(null==(n=null==S?void 0:S._strengthenOnPublish)?void 0:n.type),R=I?p.to.find(e=>e.name===I):void 0,F="pressed"===P,D="selected"===P,Z=null==S?void 0:S._ref,L=Z&&(null==(l=null==(r=null==(i=M.result)?void 0:i.preview)?void 0:r.published)?void 0:l._id),q=(0,lJ.useCallback)(()=>{j([!0===p.weak?mL(!0,["_weak"]):mq(["_weak"]),mq(["_strengthenOnPublish"])])},[j,p.weak]),N=(0,lJ.useCallback)(()=>{j(!0===p.weak?mL(!0,["_weak"]):mq(["_weak"]))},[j,p]),V=(0,lJ.useCallback)(()=>{x.onPathFocus(["_ref"])},[x]),U=(null==S?void 0:S._weak)?"weak":"strong",B=!0===p.weak?"weak":"strong",K=Z&&!M.isLoading&&(null==S?void 0:S._strengthenOnPublish),H=!M.isLoading&&(null==(a=M.result)?void 0:a.availability.available)&&Z&&U!==B&&!K,W=function(e){let{readOnly:t,hasErrors:n,hasWarnings:i}=e;return t?"transparent":n?"critical":i?"caution":"default"}({readOnly:v,hasErrors:O,hasWarnings:z}),$=!(null==S?void 0:S._ref)||"_ref"===x.focusPath[0],X=(null==(o=M.result)?void 0:o.preview.draft)||(null==(s=M.result)?void 0:s.preview.published),G=(0,lG.jsxs)(lG.Fragment,{children:[A&&L&&S._strengthenOnPublish&&(0,lG.jsx)(wo,{padding:1,title:p.weak?"Finalize reference":"Convert to strong reference",status:"info","data-testid":"alert-reference-published",children:(0,lG.jsxs)(l4.Kq,{space:3,children:[(0,lG.jsxs)(l4.xv,{as:"p",muted:!0,size:1,children:[(0,lG.jsx)("strong",{children:null==(c=null==(d=M.result)?void 0:d.preview.published)?void 0:c.title})," is published and this reference should now be"," ",p.weak?(0,lG.jsx)(lG.Fragment,{children:"finalized"}):(0,lG.jsx)(lG.Fragment,{children:"converted to a strong reference"}),"."]}),(0,lG.jsx)(l4.zx,{onClick:q,text:(0,lG.jsx)(lG.Fragment,{children:"Convert to strong reference"}),tone:"positive"})]})}),H&&(0,lG.jsx)(wo,{padding:1,title:"Reference strength mismatch",status:"warning","data-testid":"alert-reference-strength-mismatch",children:(0,lG.jsxs)(l4.Kq,{space:3,children:[(0,lG.jsxs)(l4.xv,{as:"p",muted:!0,size:1,children:["This reference is ",(0,lG.jsx)("em",{children:U}),", but according to the current schema it should be"," ",(0,lG.jsxs)("em",{children:[B,"."]})]}),(0,lG.jsx)(l4.xv,{as:"p",muted:!0,size:1,children:p.weak?(0,lG.jsxs)(lG.Fragment,{children:["It will not be possible to delete the"," ",(null==X?void 0:X.title)?(0,lG.jsxs)(lG.Fragment,{children:['"',null==X?void 0:X.title,'"-document']}):(0,lG.jsx)(lG.Fragment,{children:"referenced document"})," ","without first removing this reference."]}):(0,lG.jsxs)(lG.Fragment,{children:["This makes it possible to delete the"," ",(null==X?void 0:X.title)?(0,lG.jsxs)(lG.Fragment,{children:['"',null==X?void 0:X.title,'"-document']}):(0,lG.jsx)(lG.Fragment,{children:"referenced document"})," ","without first deleting this reference, leaving this field referencing a nonexisting document."]})}),(0,lG.jsx)(l4.zx,{onClick:N,text:(0,lG.jsxs)(lG.Fragment,{children:["Convert to ",B," reference"]}),tone:"caution"})]})}),M.error&&(0,lG.jsx)(wo,{padding:1,title:"Unable to load reference metadata",status:"warning","data-testid":"alert-reference-info-failed",children:(0,lG.jsxs)(l4.Kq,{space:3,children:[(0,lG.jsxs)(l4.xv,{as:"p",muted:!0,size:1,children:["Error: ",M.error.message]}),(0,lG.jsx)(l4.zx,{onClick:M.retry,text:(0,lG.jsx)(lG.Fragment,{children:"Retry"}),tone:"primary"})]})})]}),Y=(0,lJ.useMemo)(()=>(0,lJ.forwardRef)(function(e,t){return(0,lG.jsx)(a9.nR,{...e,intent:"edit",params:{id:null==S?void 0:S._ref,type:null==R?void 0:R.name},target:"_blank",rel:"noopener noreferrer",ref:t})}),[null==R?void 0:R.name,null==S?void 0:S._ref]),J=(0,lJ.useMemo)(()=>v?null:(0,lG.jsx)(l4.xu,{marginLeft:1,children:(0,lG.jsx)(l4.j2,{button:(0,lG.jsx)(l4.zx,{paddingY:3,paddingX:2,mode:"bleed",icon:a8.zGg}),id:"".concat(m,"-menuButton"),menu:(0,lG.jsxs)(l4.v2,{children:[!v&&(0,lG.jsxs)(lG.Fragment,{children:[(0,lG.jsx)(l4.sN,{text:"Clear",tone:"critical",icon:a8.XHJ,onClick:_}),(0,lG.jsx)(l4.sN,{text:"Replace",icon:a8.bnu,onClick:V})]}),!v&&(null==S?void 0:S._ref)&&(0,lG.jsx)(l4.R,{}),(null==S?void 0:S._ref)&&(0,lG.jsx)(l4.sN,{as:Y,"data-as":"a",text:"Open in new tab",icon:a8.buG})]}),popover:kX})}),[_,V,m,Y,v,null==S?void 0:S._ref]);return(0,lG.jsxs)(lG.Fragment,{children:[C&&e.actions&&e.actions.length>0&&(0,lG.jsx)(gx,{actions:e.actions,documentId:C,documentType:p.name,onActions:k,path:h,schemaType:p}),(0,lG.jsx)(b5,{actions:w,focused:!!e.inputProps.focused,path:h,children:(0,lG.jsx)(jy,{__internal_comments:e.__internal_comments,__internal_slot:e.__internal_slot,__unstable_headerActions:w,__unstable_presence:e.presence,description:e.description,level:e.level,title:e.title,validation:e.validation,children:$?(0,lG.jsx)(l4.xu,{children:g}):(0,lG.jsx)(l4.Zb,{shadow:1,radius:1,padding:1,tone:W,children:(0,lG.jsxs)(l4.Kq,{space:1,children:[(0,lG.jsxs)(l4.kC,{gap:1,align:"center",children:[(0,lG.jsx)(w_,{__unstable_focusRing:!0,as:T,"data-pressed":!!F||void 0,"data-selected":!!D||void 0,documentId:null==S?void 0:S._ref,documentType:null==R?void 0:R.name,flex:1,paddingX:2,paddingY:1,pressed:F,radius:2,ref:u,selected:D,tone:"inherit",children:(0,lG.jsx)(wv,{value:S,referenceInfo:M,renderPreview:y,type:p})}),(0,lG.jsx)(l4.xu,{children:J})]}),G]})})})})]})}function kY(e,t){return ob()(e.options,t)}let kJ=["array","file","image","reference","slug"],kQ=["asset","crop","hotspot","_ref","_weak"],k0=["tags"],k1=["slug"];function k2(e,t){if(!e||t.has(e))return[];t.add(e);let n=e.type?k2(e.type,t):[];return[e,...n]}let k3=[];function k4(e){return(0,lG.jsx)(cU,{hasFocus:!!e.inputProps.focused,isChanged:e.inputProps.changed,path:e.path,children:e.children})}function k5(e){let[t,n]=(0,lJ.useState)(k3),i=k$(),r=!!e.inputProps.focused;return(0,lG.jsxs)(lG.Fragment,{children:[i&&e.actions&&e.actions.length>0&&(0,lG.jsx)(gx,{actions:e.actions,documentId:i,documentType:e.schemaType.name,onActions:n,path:e.path,schemaType:e.schemaType}),(0,lG.jsx)(b5,{actions:t,focused:r,path:e.path,children:(0,lG.jsx)(jy,{__internal_slot:e.__internal_slot,__internal_comments:e.__internal_comments,__unstable_headerActions:t,__unstable_presence:e.presence,"data-testid":"field-".concat(e.inputId),description:e.description,inputId:e.inputId,level:e.level,title:e.title,validation:e.validation,children:(0,lG.jsx)(cU,{hasFocus:r,isChanged:e.inputProps.changed,path:e.path,children:e.children})})})]})}function k6(e){let[t,n]=(0,lJ.useState)(k3),i=k$(),r=!!e.inputProps.focused;return(0,lG.jsxs)(lG.Fragment,{children:[i&&e.actions&&e.actions.length>0&&(0,lG.jsx)(gx,{actions:e.actions,documentId:i,documentType:e.schemaType.name,onActions:n,path:e.path,schemaType:e.schemaType}),(0,lG.jsx)(b5,{actions:t,focused:r,path:e.path,children:(0,lG.jsx)(jI,{__internal_comments:e.__internal_comments,__internal_slot:e.__internal_slot,__unstable_headerActions:t,__unstable_presence:e.presence,collapsed:e.collapsed,collapsible:e.collapsible,"data-testid":"field-".concat(e.inputId),description:e.description,level:e.level,onCollapse:e.onCollapse,onExpand:e.onExpand,title:e.title,validation:e.validation,inputId:e.inputId,children:e.children})})]})}function k8(e){let[t,n]=(0,lJ.useState)(k3),i=k$(),r=!!e.inputProps.focused,l=e.inputProps.members.find(e=>"field"===e.kind&&"hotspot"===e.name),a=(null==l?void 0:l.open)?e.presence:e.presence.concat((null==l?void 0:l.field.presence)||k3);return(0,lG.jsxs)(lG.Fragment,{children:[i&&e.actions&&e.actions.length>0&&(0,lG.jsx)(gx,{actions:e.actions,documentId:i,documentType:e.schemaType.name,onActions:n,path:e.path,schemaType:e.schemaType}),(0,lG.jsx)(b5,{actions:t,focused:r,path:e.path,children:(0,lG.jsx)(jI,{__internal_comments:e.__internal_comments,__internal_slot:e.__internal_slot,__unstable_headerActions:t,__unstable_presence:a,collapsed:e.collapsed,collapsible:e.collapsible,description:e.description,level:e.level,onCollapse:e.onCollapse,onExpand:e.onExpand,title:e.title,validation:e.validation,inputId:e.inputId,children:e.children})})]})}function k9(e){var t;if(null==(t=e.components)?void 0:t.field)return e.components.field;if((0,lX.EG)(e))return k4;let n=k2(e,new Set);return n.some(e=>"image"===e.name||"file"===e.name)?k8:n.some(e=>(0,lX.mz)(e))||n.some(e=>"slug"===e.name)?k5:n.some(e=>(0,lX.dD)(e))?kG:"object"!==e.jsonType&&"array"!==e.jsonType?k5:k6}var k7=Object.freeze,Ce=Object.defineProperty;let Ct=a0.ZP.div(nP||(nP=k7(Ce(z=["\n  display: flex;\n  pointer-events: all;\n"],"raw",{value:k7(z.slice())}))));function Cn(e){let t=(0,sE._F)(),{block:n,onChange:i,renderBlockActions:r}=e,l=(0,lJ.useMemo)(()=>t.schemaTypes.decorators.map(e=>e.value),[t]),a=(0,lJ.useMemo)(()=>{if(r)return r({block:n,value:sE.q$.getValue(t),set:function(e){let{allowedDecorators:t,block:n,onChange:i}=e;return e=>{let r=[mL((0,sR.nX)(e,{allowedDecorators:t}),[{_key:n._key}])];return i(mN.from(r))}}({allowedDecorators:l,block:n,onChange:i}),unset:function(e){let{block:t,onChange:n}=e;return()=>{let e=[mq([{_key:t._key}])];return n(mN.from(e))}}({block:n,onChange:i}),insert:function(e){let{allowedDecorators:t,block:n,onChange:i}=e;return e=>{let r=[mZ((Array.isArray(e)?e:[e]).map(e=>(0,sR.nX)(e,{allowedDecorators:t})),"after",[{_key:n._key}])];return i(mN.from(r))}}({allowedDecorators:l,block:n,onChange:i})})},[r,n,t,i,l]);return a?(0,lG.jsx)(Ct,{contentEditable:!1,children:a}):null}var Ci=Object.freeze,Cr=Object.defineProperty,Cl=(e,t)=>Ci(Cr(e,"raw",{value:Ci(t||e.slice())}));let Ca=a0.ZP.div(e=>{let{theme:t}=e,{radius:n,space:i,color:r}=t.sanity,l=(0,l4.m4)(r.spot.yellow,.2);return(0,a0.iv)(nA||(nA=Cl(["\n    position: absolute;\n    border-radius: ","px;\n    top: -","px;\n    bottom: -","px;\n    left: ","px;\n    right: 0;\n    background-color: ",";\n  "])),n[3],i[2],i[1]+i[1],i[4]+i[1],l)});var Co=Object.freeze,Cs=Object.defineProperty,Cd=(e,t)=>Co(Cs(e,"raw",{value:Co(t||e.slice())}));let Cc=(0,a0.ZP)(cU)(()=>(0,a0.iv)(nO||(nO=Cd(["\n    width: 1px;\n    height: 100%;\n\n    & > div {\n      height: 100%;\n    }\n  "]))));function Cu(e){return e.type?Cu(e.type):"block"===e.name}function Cp(e){return"field"===e.kind&&"array"===e.field.schemaType.jsonType}let Ch=["@@_NONEXISTENT_PATH_@@"];function Cf(e){let t=(0,lJ.useRef)(null),n=(null==e?void 0:e.validation)&&e.validation.length>0?e.validation:ch,i=ga((null==e?void 0:e.path)||Ch),r=(0,lJ.useMemo)(()=>(null==e?void 0:e.schemaType)&&Cu(null==e?void 0:e.schemaType)?n:n.concat(i),[i,e,n]),[l,a,o]=(0,lJ.useMemo)(()=>[r.filter(e=>"error"===e.level).length>0,r.filter(e=>"warning"===e.level).length>0,r.filter(e=>"info"===e.level).length>0],[r]),s=ge(t.current,r);return t.current=s,(0,lJ.useMemo)(()=>({validation:s,hasError:l,hasWarning:a,hasInfo:o}),[s,l,a,o])}let Cm=(0,lJ.createContext)([]);function Cg(e){return(0,lG.jsx)(Cm.Provider,{value:e.markers,children:e.children})}function Cx(e){let t=(0,lJ.useContext)(Cm);if(!t)throw Error("Form context not provided");return(0,lJ.useMemo)(()=>t.filter(t=>(0,lY.Xy)(t.path,e)),[t,e])}let Cv=(0,lJ.createContext)([]);function Cb(e){return(0,lG.jsx)(Cv.Provider,{value:e.memberItems,children:e.children})}function Cy(e){let t=(0,lJ.useContext)(Cv);if(!t)throw Error("Form context not provided");return t.find(t=>t.key===e)}function Cj(e){}var Cw=Object.freeze,Ck=Object.defineProperty,CC=(e,t)=>Cw(Ck(e,"raw",{value:Cw(t||e.slice())}));let C_=(0,a0.ZP)(l4.Zb)(e=>{var t;let{color:n,radius:i,space:r}=e.theme.sanity,l=(0,a0.iv)(nz||(nz=CC(["\n    pointer-events: none;\n    content: '';\n    position: absolute;\n    top: -","px;\n    bottom: -","px;\n    left: -","px;\n    right: -","px;\n    border-radius: ","px;\n    mix-blend-mode: ",";\n  "])),r[1],r[1],r[1],r[1],i[2],n.dark?"screen":"multiply");return(0,a0.iv)(nM||(nM=CC(["\n    box-shadow: 0 0 0 1px var(--card-border-color);\n    border-radius: ","px;\n    pointer-events: all;\n    position: relative;\n\n    &[data-focused] {\n      box-shadow: 0 0 0 1px ",";\n    }\n\n    &:not([data-focused]):not([data-selected]) {\n      @media (hover: hover) {\n        &:hover {\n          --card-border-color: ",";\n        }\n      }\n    }\n\n    &[data-markers] {\n      &:after {\n        ","\n        background-color: ",";\n      }\n    }\n\n    &[data-warning] {\n      &:after {\n        ","\n        background-color: ",";\n      }\n\n      @media (hover: hover) {\n        &:hover {\n          --card-border-color: ",";\n        }\n      }\n    }\n\n    &[data-invalid] {\n      &:after {\n        ","\n        background-color: ",";\n      }\n\n      @media (hover: hover) {\n        &:hover {\n          --card-border-color: ",";\n        }\n      }\n    }\n  "])),i[1],null==(t=n.selectable)?void 0:t.primary.selected.border,n.input.default.hovered.border,l,n.dark?or.VG.purple[950].hex:or.VG.purple[50].hex,l,n.muted.caution.hovered.bg,n.muted.caution.hovered.border,l,n.input.invalid.enabled.bg,n.input.invalid.hovered.border)}),CS=(0,a0.ZP)(l4.xu)(nI||(nI=CC(["\n  display: block;\n  width: 100%;\n  user-select: none;\n  pointer-events: all;\n"]))),CT=a0.ZP.div(e=>{let{theme:t,$hasChanges:n}=e,{space:i}=t.sanity;return(0,a0.iv)(nF||(nF=CC(["\n      position: absolute;\n      width: ","px;\n      right: 0;\n      top: 0;\n      bottom: 0;\n      padding-left: ","px;\n      user-select: none;\n\n      ","\n\n      [data-dragged] & {\n        visibility: hidden;\n      }\n    "])),i[2],i[1],!n&&(0,a0.iv)(nR||(nR=CC(["\n        display: none;\n      "]))))}),CE=(0,a0.ZP)(l4.kC)(nD||(nD=CC(["\n  position: relative;\n\n  [data-dragged] > & {\n    opacity: 0.5;\n  }\n"]))),CP=(0,a0.ZP)(l4.xu)(nZ||(nZ=CC(["\n  width: 25px;\n  position: relative;\n\n  [data-dragged] & {\n    visibility: hidden;\n  }\n"]))),CA=(0,a0.ZP)(l4.kC)(nL||(nL=CC(["\n  position: absolute;\n  right: 0;\n  [data-dragged] & {\n    visibility: hidden;\n  }\n"]))),CO=(0,a0.ZP)(l4.xu)(nq||(nq=CC(["\n  max-width: 250px;\n"]))),Cz={constrainSize:!0,placement:"bottom",portal:"default",tone:"default"};function CM(e){let{children:t,focused:n,isOpen:i,onOpen:r,onRemove:l,readOnly:a,value:o}=e,s=(0,lJ.useId)(),d=(0,lJ.useRef)(null),c=(0,lJ.useRef)(!1),u=(0,lJ.useMemo)(()=>(0,lX.Yk)(o)?(0,lJ.forwardRef)(function(e,t){return(0,lG.jsx)(a9.nR,{...e,intent:"edit",params:{id:o._ref},ref:t})}):void 0,[o]);(0,lJ.useEffect)(()=>{i&&(c.current=!1)},[i]),(0,l4.qh)((0,lJ.useCallback)(e=>{n&&("Tab"!==e.key||!d.current||c.current||i||(e.preventDefault(),e.stopPropagation(),d.current.focus(),c.current=!0))},[n,i]));let p=(0,lJ.useCallback)(e=>{e.preventDefault(),e.stopPropagation(),l()},[l]);return(0,lG.jsxs)(l4.kC,{children:[(0,lG.jsx)(l4.xu,{flex:1,children:t}),(0,lG.jsx)(l4.xu,{children:(0,lG.jsx)(l4.j2,{button:(0,lG.jsx)(l4.zx,{"aria-label":"Open menu",fontSize:1,iconRight:a8.zGg,mode:"bleed",paddingX:2,tabIndex:n?0:1}),ref:d,id:s,menu:(0,lG.jsx)(l4.v2,{children:(0,lG.jsxs)(lG.Fragment,{children:["_ref"in o&&o._ref&&(0,lG.jsx)(l4.sN,{as:u,"data-as":"a",icon:a8.xPt,text:"Open reference"}),a&&(0,lG.jsx)(l4.sN,{icon:a8.hsE,onClick:r,text:"View"}),!a&&(0,lG.jsx)(l4.sN,{icon:a8.dY8,onClick:r,text:"Edit"}),!a&&(0,lG.jsx)(l4.sN,{icon:a8.XHJ,onClick:p,text:"Delete",tone:"critical"})]})}),popover:Cz})})]})}let CI=e=>Array.isArray(e)?e.flatMap(CI):"number"==typeof e?[e]:"auto"===e?["auto"]:[],CR=e=>"dialog"===e||"popover"===e?e:void 0;function CF(e){let{onClose:t,children:n,title:i,width:r=1,autoFocus:l}=e,a=(0,lJ.useId)(),[o,s]=(0,lJ.useState)(null),d=(0,lJ.useRef)(null);return(0,lG.jsx)(l4.Vq,{header:i,id:a,onClickOutside:t,onClose:t,portal:"default",width:r,contentRef:s,"data-testid":"default-edit-object-dialog",__unstable_autoFocus:l,children:(0,lG.jsx)(y5,{margins:[0,0,1,0],children:(0,lG.jsx)(kL,{scrollElement:o,containerElement:d,children:(0,lG.jsx)(l4.xu,{padding:4,ref:d,children:n})})})})}var CD=Object.freeze,CZ=Object.defineProperty,CL=(e,t)=>CD(CZ(e,"raw",{value:CD(t||e.slice())}));let Cq=(0,a0.ZP)(l4.J2)(nN||(nN=CL(["\n  &[data-popper-reference-hidden='true'] {\n    visibility: hidden;\n    pointer-events: none;\n  }\n\n  & > div {\n    overflow: hidden;\n    overflow: clip;\n  }\n"]))),CN=(0,a0.ZP)(l4.xu)(nV||(nV=CL(["\n  /* Prevent overflow caused by change indicator */\n  overflow-x: hidden;\n  overflow-y: auto;\n"]))),CV=(0,a0.ZP)(l4.xu)(nU||(nU=CL(["\n  box-shadow: 0 1px 0 var(--card-shadow-outline-color);\n  position: relative;\n  z-index: 10;\n  min-height: auto;\n"]))),CU=["top","bottom"];function CB(e){let{floatingBoundary:t,referenceBoundary:n,referenceElement:i,width:r=0}=e,[l,a]=(0,lJ.useState)(!1);return(0,lJ.useEffect)(()=>{a(!0)},[]),(0,lG.jsx)(Cq,{content:(0,lG.jsx)(CK,{...e}),constrainSize:!0,"data-ui":"PopoverEditDialog",fallbackPlacements:CU,floatingBoundary:t,open:l,overflow:"auto",placement:"bottom",portal:"default",preventOverflow:!0,referenceBoundary:n,referenceElement:i,width:r})}function CK(e){let{onClose:t,referenceBoundary:n,referenceElement:i,title:r,autoFocus:l}=e;(0,l4.qh)((0,lJ.useCallback)(e=>{"Escape"===e.key&&t()},[t])),(0,l4.O8)(t,i?[i]:[],n);let[a,o]=(0,lJ.useState)(null),s=(0,lJ.useRef)(null);return(0,lG.jsx)(kL,{scrollElement:a,containerElement:s,children:(0,lG.jsxs)(l4.kC,{ref:s,direction:"column",height:"fill",children:[(0,lG.jsx)(CV,{flex:"none",padding:1,children:(0,lG.jsxs)(l4.kC,{align:"center",children:[(0,lG.jsx)(l4.xu,{flex:1,padding:2,children:(0,lG.jsx)(l4.xv,{weight:"semibold",children:r})}),(0,lG.jsx)(l4.zx,{autoFocus:!!l,icon:a8.Two,mode:"bleed",onClick:t,padding:2})]})}),(0,lG.jsx)(CN,{flex:1,children:(0,lG.jsx)(y5,{margins:[0,0,1,0],children:(0,lG.jsx)(l4.xu,{padding:3,ref:o,children:e.children})})})]})})}function CH(e){let{autoFocus:t,defaultType:n,floatingBoundary:i,onClose:r,referenceBoundary:l,referenceElement:a,schemaType:o}=e,s=(0,lJ.useMemo)(()=>(function(e){var t;let n=null==(t=e.options)?void 0:t.modal;return"object"==typeof n&&null!==n?{type:CR(n.type),width:CI(n.width)}:void 0})(o),[o]),d=(null==s?void 0:s.type)||n,c=(0,lG.jsxs)(lG.Fragment,{children:["Edit ",o.title]}),u=(0,lJ.useCallback)(()=>{r()},[r]),p=null==s?void 0:s.width;return"popover"===d?(0,lG.jsx)(CB,{autoFocus:t,floatingBoundary:i,onClose:u,referenceBoundary:l,referenceElement:a,title:c,width:p,children:e.children}):(0,lG.jsx)(CF,{onClose:u,title:c,width:p,autoFocus:t,children:e.children})}function CW(e){var t;let{floatingBoundary:n,focused:i,isFullscreen:r,onItemClose:l,onItemOpen:a,onPathFocus:o,path:s,readOnly:d,referenceBoundary:c,relativePath:u,renderAnnotation:p,renderBlock:h,renderBlockActions:f,renderCustomMarkers:m,renderField:g,renderInlineBlock:x,renderInput:v,renderItem:b,renderPreview:y,schemaType:j,selected:w,value:k}=e,{onChange:C}=m7(),{Markers:_}=mY().__internal.components,[S,T]=(0,lJ.useState)(!1),E=Cx(s),P=(0,sE._F)(),A=Cy(gP(s)),O=(0,lJ.useRef)(!1),z=(0,lJ.useMemo)(()=>({anchor:{path:u,offset:0},focus:{path:u,offset:0}}),[u]),M=(0,lJ.useCallback)(()=>T(!0),[]),I=(0,lJ.useCallback)(()=>T(!1),[]),R=(0,lJ.useCallback)(()=>{A&&(sE.q$.blur(P),a(A.node.path))},[P,A,a]),F=(0,lJ.useCallback)(()=>{l(),sE.q$.select(P,z),sE.q$.focus(P)},[l,P,z]),D=(0,lJ.useCallback)(()=>{if(!O.current)try{sE.q$.delete(P,z,{mode:"blocks"})}catch(e){console.error(e)}finally{O.current=!0}},[P,z]);(0,lJ.useEffect)(()=>()=>{O.current&&sE.q$.focus(P)},[P]);let Z=(0,lJ.useMemo)(()=>r&&!f?{paddingX:5}:r&&f?{paddingLeft:5,paddingRight:2}:f?{paddingLeft:3,paddingRight:2}:{paddingX:3},[r,f]),{validation:L,hasError:q,hasWarning:N,hasInfo:V}=Cf(null==A?void 0:A.node),U=P.schemaTypes.portableText,B=E.length>0,K=gi(s,!0),H=(0,lJ.useMemo)(()=>K.filter(e=>(0,lY.Xy)(e.path,s)),[s,K]),W=q||N||V||B,$=(0,lJ.useMemo)(()=>W&&(0,lG.jsx)(CO,{padding:2,children:(0,lG.jsx)(_,{markers:E,validation:L,renderCustomMarkers:m})})||null,[_,E,m,W,L]),X=!!(null==A?void 0:A.member.open),G=null==A?void 0:A.input,Y=(null==A?void 0:A.node.path)||ch,J=null==(t=null==A?void 0:A.elementRef)?void 0:t.current,Q=(0,lJ.useMemo)(()=>({__unstable_floatingBoundary:n,__unstable_referenceBoundary:c,__unstable_referenceElement:J||null,children:G,focused:i,markers:E,onClose:F,onOpen:R,onPathFocus:o,onRemove:D,open:X,parentSchemaType:U,path:Y,presence:H,readOnly:!!d,renderAnnotation:p,renderBlock:h,renderDefault:C$,renderField:g,renderInlineBlock:x,renderInput:v,renderItem:b,renderPreview:y,schemaType:j,selected:w,validation:L,value:k}),[n,J,G,i,E,F,R,o,D,X,U,Y,H,d,c,p,h,g,x,v,b,y,j,w,L,k]);return(0,lJ.useMemo)(()=>(0,lG.jsx)(l4.xu,{ref:null==A?void 0:A.elementRef,contentEditable:!1,children:(0,lG.jsx)(l4.kC,{paddingBottom:1,marginY:3,style:Cj(),children:(0,lG.jsxs)(CE,{flex:1,children:[(0,lG.jsx)(l4.u,{placement:"top",portal:"editor",disabled:!W,content:$,children:(0,lG.jsx)(CS,{...Z,children:h&&h(Q)})}),(0,lG.jsx)(CP,{marginRight:1,children:(0,lG.jsx)(CA,{children:f&&k&&i&&!d&&(0,lG.jsx)(Cn,{block:k,onChange:C,renderBlockActions:f})})}),r&&A&&(0,lG.jsx)(CT,{$hasChanges:A.member.item.changed,onMouseOut:I,onMouseOver:M,children:(0,lG.jsx)(Cc,{hasFocus:i,isChanged:A.member.item.changed,path:A.member.item.path,withHoverEffect:!1})}),S&&(0,lG.jsx)(Ca,{})]})})}),[Q,i,I,M,Z,r,A,C,d,h,f,S,$,W,k])}let C$=e=>{let{__unstable_floatingBoundary:t,__unstable_referenceBoundary:n,__unstable_referenceElement:i,children:r,focused:l,markers:a,onClose:o,onOpen:s,onRemove:d,open:c,readOnly:u,renderPreview:p,schemaType:h,selected:f,value:m,validation:g}=e,x=(0,lX.Or)(m),v=g.filter(e=>"error"===e.level).length>0,b=g.filter(e=>"warning"===e.level).length>0,y=a.length>0,j=f||l?"primary":"default",w=(0,lJ.useCallback)(e=>{e.preventDefault(),e.stopPropagation(),s()},[s]);return(0,lG.jsxs)(lG.Fragment,{children:[(0,lG.jsx)(C_,{"data-focused":l?"":void 0,"data-image-preview":x?"":void 0,"data-invalid":v?"":void 0,"data-markers":y?"":void 0,"data-read-only":u?"":void 0,"data-selected":f?"":void 0,"data-testid":"pte-block-object","data-warning":b?"":void 0,flex:1,onDoubleClick:w,padding:x?0:1,tone:j,children:p({actions:(0,lG.jsx)(CM,{isOpen:c,focused:l,onOpen:s,onRemove:d,readOnly:u,value:m}),layout:x?"blockImage":"block",schemaType:h,skipVisibilityCheck:!0,value:m})}),c&&(0,lG.jsx)(CH,{floatingBoundary:t,defaultType:"dialog",onClose:o,autoFocus:l,schemaType:h,referenceBoundary:n,referenceElement:i,children:r})]})},CX=[1,2,3,4,5,6,7,8,9],CG=["●","○","■"],CY=["number","lower-alpha","lower-roman"],CJ={em:"em","strike-through":"s",underline:"u",strong:"strong",code:"code"},CQ={h1:{paddingTop:5,paddingBottom:4},h2:{paddingTop:4,paddingBottom:4},h3:{paddingTop:4,paddingBottom:3},h4:{paddingTop:4,paddingBottom:3},h5:{paddingTop:4,paddingBottom:3},h6:{paddingTop:4,paddingBottom:2},normal:{paddingTop:2,paddingBottom:3},blockquote:{paddingTop:2,paddingBottom:3}};function C0(e){return"list-level-".concat(e)}var C1=Object.freeze,C2=Object.defineProperty,C3=(e,t)=>C1(C2(e,"raw",{value:C1(t||e.slice())}));let C4=a0.ZP.div(function(e){var t;let{$level:n,theme:i}=e,{color:r,fonts:l,radius:a,space:o}=i.sanity,s=CY[(n-1)%CY.length],d=CG[(n-1)%CG.length];return(0,a0.iv)(nB||(nB=C3(["\n    --marker-bg-color: transparent;\n\n    mix-blend-mode: ",";\n    position: relative;\n\n    & > [data-ui='TextBlock_inner'] {\n      position: relative;\n      flex: 1;\n    }\n\n    & > div:before {\n      content: '';\n      position: absolute;\n      top: -","px;\n      bottom: -","px;\n      left: -","px;\n      right: -","px;\n      border-radius: ","px;\n      background-color: var(--marker-bg-color);\n      // This is to make sure the marker is always behind the text\n      z-index: -1;\n    }\n\n    &[data-markers] {\n      --marker-bg-color: ",";\n    }\n\n    &[data-warning] {\n      --card-border-color: ",";\n      --marker-bg-color: ",";\n    }\n\n    &[data-error] {\n      --card-border-color: ",";\n      --marker-bg-color: ",";\n    }\n\n    & [data-list-prefix] {\n      position: absolute;\n      margin-left: -4.5rem;\n      width: 3.75rem;\n      text-align: right;\n      box-sizing: border-box;\n    }\n\n    &[data-list-item='number'] [data-list-prefix] {\n      font-variant-numeric: tabular-nums;\n\n      & > span:before {\n        content: counter(",") '.';\n        content: counter(",", ",") '.';\n      }\n    }\n\n    &[data-list-item='bullet'] [data-list-prefix] {\n      & > span {\n        position: relative;\n        top: -0.1875em;\n\n        &:before {\n          content: '","';\n          font-size: 0.46666em;\n        }\n      }\n    }\n\n    & [data-text] {\n      overflow-wrap: anywhere;\n      text-transform: none;\n      white-space: pre-wrap;\n      font-family: ",";\n      flex: 1;\n\n      *::selection {\n        background-color: ",";\n      }\n    }\n  "])),r.dark?"screen":"multiply",o[1],o[1],o[1],o[1],a[2],r.dark?or.VG.purple[950].hex:or.VG.purple[50].hex,r.muted.caution.enabled.border,r.muted.caution.hovered.bg,r.muted.critical.enabled.border,r.muted.critical.hovered.bg,C0(n),C0(n),s,d,l.text.family,null==(t=r.selectable)?void 0:t.primary.pressed.bg)}),C5=(0,a0.ZP)(l4.xu)(nK||(nK=C3(["\n  position: relative;\n  display: flex;\n"]))),C6=a0.ZP.div(nH||(nH=C3(["\n  user-select: none;\n  white-space: nowrap;\n"]))),C8=(0,a0.ZP)(l4.xu)(nW||(nW=C3(["\n  user-select: none;\n"]))),C9=(0,a0.ZP)(l4.xu)(n$||(n$=C3(["\n  line-height: 0;\n  width: 25px;\n  position: relative;\n"]))),C7=(0,a0.ZP)(l4.kC)(e=>{let{theme:t}=e,{fonts:n,space:i}=t.sanity,r=n.text.sizes[1],l=n.text.sizes[2],a=r.lineHeight-r.ascenderHeight-r.descenderHeight,o=l.lineHeight-l.ascenderHeight-l.descenderHeight,s=a+i[2]+i[2];return(0,a0.iv)(nX||(nX=C3(["\n    user-select: none;\n    position: absolute;\n    right: 0;\n    top: ","px;\n  "])),0-(s-o)/2)}),_e=(0,a0.ZP)(l4.xu)(nG||(nG=C3(["\n  max-width: 250px;\n"]))),_t=(0,a0.ZP)(l4.kC)(nY||(nY=C3(["\n  position: relative;\n  padding-left: ","px;\n"])),e=>{let{$level:t}=e;return t?32*t:0}),_n=a0.ZP.div(e=>{let{theme:t,$hasChanges:n}=e,{space:i}=t.sanity;return(0,a0.iv)(nQ||(nQ=C3(["\n      position: absolute;\n      width: ","px;\n      right: 0;\n      top: 0;\n      bottom: 0;\n      padding-left: ","px;\n      user-select: none;\n\n      ","\n    "])),i[2],i[1],!n&&(0,a0.iv)(nJ||(nJ=C3(["\n        display: none;\n      "]))))});var _i=Object.freeze,_r=Object.defineProperty,_l=(e,t)=>_i(_r(e,"raw",{value:_i(t||e.slice())}));let _a=a0.ZP.div(n0||(n0=_l(["\n  display: block;\n"]))),_o=e=>{let{children:t,...n}=e;return(0,lG.jsx)(l4.xv,{"data-testid":"text-style--normal",...n,children:(0,lG.jsx)(_a,{children:t})})},_s=e=>{let{children:t,...n}=e;return(0,lG.jsx)(l4.X6,{as:"h1","data-testid":"text-style--h1",size:5,...n,children:(0,lG.jsx)(_a,{children:t})})},_d=e=>{let{children:t,...n}=e;return(0,lG.jsx)(l4.X6,{as:"h2","data-testid":"text-style--h2",size:4,...n,children:(0,lG.jsx)(_a,{children:t})})},_c=e=>{let{children:t,...n}=e;return(0,lG.jsx)(l4.X6,{as:"h3","data-testid":"text-style--h3",size:3,...n,children:(0,lG.jsx)(_a,{children:t})})},_u=e=>{let{children:t,...n}=e;return(0,lG.jsx)(l4.X6,{as:"h4","data-testid":"text-style--h4",size:2,...n,children:(0,lG.jsx)(_a,{children:t})})},_p=e=>{let{children:t,...n}=e;return(0,lG.jsx)(l4.X6,{as:"h5","data-testid":"text-style--h5",size:1,...n,children:(0,lG.jsx)(_a,{children:t})})},_h=e=>{let{children:t,...n}=e;return(0,lG.jsx)(l4.X6,{as:"h6","data-testid":"text-style--h6",size:0,...n,children:(0,lG.jsx)(_a,{children:t})})},_f=a0.ZP.blockquote(n1||(n1=_l(["\n  position: relative;\n  display: block;\n  margin: 0;\n  padding-left: ","px;\n\n  &::before {\n    content: '';\n    position: absolute;\n    left: 0;\n    top: -4px;\n    bottom: -4px;\n    width: 3px;\n    background: var(--card-border-color);\n  }\n"])),e=>{let{theme:t}=e;return t.sanity.space[3]}),_m=e=>{let{children:t,...n}=e;return(0,lG.jsx)(_f,{"data-testid":"text-style--blockquote",...n,children:(0,lG.jsx)(l4.xv,{as:"p",children:t})})},_g={normal:_o,h1:_s,h2:_d,h3:_c,h4:_u,h5:_p,h6:_h,blockquote:_m};function _x(e){let{children:t,floatingBoundary:n,focused:i,isFullscreen:r,onItemClose:l,onItemOpen:a,onPathFocus:o,path:s,readOnly:d,referenceBoundary:c,renderBlock:u,renderAnnotation:p,renderBlockActions:h,renderCustomMarkers:f,renderField:m,renderInlineBlock:g,renderInput:x,renderItem:v,renderPreview:b,schemaType:y,selected:j,spellCheck:w,value:k}=e,{Markers:C}=mY().__internal.components,[_,S]=(0,lJ.useState)(!1),T=Cx(s),E=Cy(gP(s)),P=(0,sE._F)(),{onChange:A}=m7(),O=gi(s,!0),z=(0,lJ.useMemo)(()=>O.filter(e=>(0,lY.Xy)(e.path,s)||"children"===e.path.slice(-3)[1]&&e.path.length-s.length==2),[s,O]),M=(0,lJ.useCallback)(()=>S(!0),[]),I=(0,lJ.useCallback)(()=>S(!1),[]),{validation:R,hasError:F,hasWarning:D,hasInfo:Z}=Cf(null==E?void 0:E.node),L=!!f&&T.length>0,q=F||D||L||Z,N=(0,lJ.useCallback)(()=>{E&&a(E.node.path)},[a,E]),V=(0,lJ.useCallback)(()=>{let e={path:s.slice(-1),offset:0};sE.q$.delete(P,{focus:e,anchor:e},{mode:"blocks"}),sE.q$.focus(P)},[s,P]),U=(0,lJ.useMemo)(()=>(0,lG.jsxs)(_t,{align:"flex-start",$level:null==k?void 0:k.level,children:[k.listItem&&(0,lG.jsx)(C6,{contentEditable:!1,children:(0,lG.jsx)(l4.xv,{"data-list-prefix":"",children:(0,lG.jsx)(_a,{})})}),(0,lG.jsx)("div",{"data-text":"",style:Cj(),children:t})]}),[k.listItem,k.level,t]),B=(0,lJ.useMemo)(()=>r&&!h?{paddingX:5}:r&&h?{paddingLeft:5,paddingRight:2}:h?{paddingLeft:3,paddingRight:2}:{paddingX:3},[r,h]),K=(0,lJ.useMemo)(()=>k.listItem?{paddingY:2}:CQ[k.style||"normal"]||{paddingY:2},[k]),H=!!(null==E?void 0:E.member.open),W=P.schemaTypes.portableText,$=(0,lJ.useMemo)(()=>{var e;return{__unstable_floatingBoundary:n,__unstable_referenceBoundary:c,__unstable_referenceElement:(null==(e=null==E?void 0:E.elementRef)?void 0:e.current)||null,children:U,focused:i,markers:T,onClose:l,onOpen:N,onPathFocus:o,onRemove:V,open:H,parentSchemaType:W,path:(null==E?void 0:E.node.path)||ch,presence:z,readOnly:!!d,renderAnnotation:p,renderBlock:u,renderDefault:_v,renderField:m,renderInput:x,renderInlineBlock:g,renderItem:v,renderPreview:b,schemaType:y,selected:j,validation:R,value:k}},[n,i,H,T,null==E?void 0:E.elementRef,null==E?void 0:E.node.path,l,N,o,V,W,d,c,p,u,m,g,x,v,b,y,j,U,z,R,k]),X=(0,lJ.useMemo)(()=>q&&(0,lG.jsx)(_e,{padding:2,children:(0,lG.jsx)(C,{markers:T,renderCustomMarkers:f,validation:R})})||null,[C,T,f,q,R]);return(0,lJ.useMemo)(()=>(0,lG.jsx)(l4.xu,{"data-testid":"text-block",...K,style:Cj(),ref:null==E?void 0:E.elementRef,children:(0,lG.jsx)(C5,{"data-testid":"text-block__wrapper",children:(0,lG.jsxs)(l4.kC,{flex:1,...B,children:[(0,lG.jsx)(l4.xu,{flex:1,children:(0,lG.jsx)(l4.u,{content:X,disabled:!q,placement:"top",portal:"editor",children:(0,lG.jsx)(C4,{$level:k.level||1,"data-error":F?"":void 0,"data-list-item":k.listItem,"data-markers":L?"":void 0,"data-read-only":d,"data-testid":"text-block__text","data-warning":D?"":void 0,spellCheck:w,children:u&&u($)})})}),(0,lG.jsxs)(C8,{contentEditable:!1,children:[(0,lG.jsx)(C9,{marginRight:1,children:(0,lG.jsx)(C7,{children:h&&i&&!d&&(0,lG.jsx)(Cn,{onChange:A,block:k,renderBlockActions:h})})}),r&&E&&(0,lG.jsx)(_n,{$hasChanges:E.member.item.changed,onMouseEnter:M,onMouseLeave:I,children:(0,lG.jsx)(Cc,{hasFocus:i,isChanged:E.member.item.changed,path:E.member.item.path,withHoverEffect:!1})})]}),_&&(0,lG.jsx)(Ca,{})]})})}),[$,i,M,I,F,L,D,B,r,E,A,K,d,u,h,_,w,X,q,k])}let _v=e=>(0,lG.jsx)(lG.Fragment,{children:e.children});var _b=Object.freeze,_y=Object.defineProperty;let _j=(0,a0.ZP)(l4.J2)(n2||(n2=_b(_y(M=["\n  &[data-popper-reference-hidden='true'] {\n    display: none !important;\n  }\n"],"raw",{value:_b(M.slice())})))),_w=["top","bottom"];function _k(e){let{floatingBoundary:t,onClosePopover:n,onEdit:i,onDelete:r,referenceBoundary:l,referenceElement:a,title:o,open:s}=e,{sanity:d}=(0,l4.Fg)(),c=(0,lJ.useRef)(null),u=(0,lJ.useRef)(null),p=d.color.dark?"light":"dark";(0,l4.qh)((0,lJ.useCallback)(e=>{"Escape"===e.key&&(e.preventDefault(),e.stopPropagation(),n())},[n]));let h=(0,lJ.useCallback)(e=>{var t;if(null==(t=u.current)||!t.disabled){e.preventDefault(),e.stopPropagation();try{r(e)}catch(e){console.error(e)}finally{u.current&&(u.current.disabled=!0)}}},[r]),f=(0,lJ.useMemo)(()=>(0,lG.jsx)(l4.xu,{padding:1,children:(0,lG.jsxs)(l4.gF,{space:1,children:[(0,lG.jsx)(l4.xu,{padding:2,children:(0,lG.jsx)(l4.xv,{weight:"semibold",size:1,children:o})}),(0,lG.jsx)(l4.zx,{icon:a8.dY8,mode:"bleed",onClick:i,padding:2,ref:c,alt:"Edit object"}),(0,lG.jsx)(l4.zx,{ref:u,icon:a8.XHJ,mode:"bleed",padding:2,onClick:h,tone:"critical",alt:"Remove object"})]})}),[h,i,o]);return(0,lG.jsx)(_j,{constrainSize:!0,content:f,fallbackPlacements:_w,floatingBoundary:t,open:s,placement:"top",portal:!0,referenceBoundary:l,referenceElement:a,scheme:p})}var _C=Object.freeze,__=Object.defineProperty,_S=(e,t)=>_C(__(e,"raw",{value:_C(t||e.slice())}));let _T=(0,a0.ZP)(l4.Zb)(function(e){var t,n,i;let{theme:r}=e,{color:l,radius:a}=r.sanity;return(0,a0.iv)(n5||(n5=_S(["\n    line-height: 0;\n    border-radius: ","px;\n    padding: 2px;\n    box-shadow: inset 0 0 0 1px var(--card-border-color);\n    height: calc(1em - 1px);\n    margin-top: 0.0625em;\n    cursor: default;\n\n    &:not([hidden]) {\n      display: inline-flex;\n      align-items: center;\n      vertical-align: top;\n    }\n\n    &[data-ready-only] {\n      cursor: default;\n    }\n\n    &[data-focused] {\n      box-shadow: inset 0 0 0 1px ",";\n      color: ",";\n    }\n\n    &[data-selected] {\n      background-color: ",";\n    }\n\n    &:not([data-focused]):not([data-selected]) {\n      @media (hover: hover) {\n        &:hover {\n          --card-border-color: ",";\n        }\n      }\n    }\n\n    &[data-markers] {\n      --card-bg-color: ",";\n    }\n\n    &[data-warning] {\n      --card-bg-color: ",";\n\n      @media (hover: hover) {\n        &:hover {\n          --card-border-color: ",";\n        }\n      }\n    }\n\n    &[data-invalid] {\n      --card-bg-color: ",";\n      --card-border-color: ",";\n\n      @media (hover: hover) {\n        &:hover {\n          --card-border-color: ",";\n        }\n      }\n    }\n  "])),a[2],null==(t=l.selectable)?void 0:t.primary.selected.border,null==(n=l.selectable)?void 0:n.primary.pressed.fg,null==(i=l.selectable)?void 0:i.primary.pressed.bg,l.input.default.hovered.border,l.dark?or.VG.purple[950].hex:or.VG.purple[50].hex,l.muted.caution.hovered.bg,l.muted.caution.hovered.border,l.input.invalid.enabled.bg,l.input.invalid.enabled.border,l.input.invalid.hovered.border)}),_E=a0.ZP.span(n3||(n3=_S(["\n  display: block;\n  max-width: calc(5em + 80px);\n  position: relative;\n"]))),_P=(0,a0.ZP)(l4.xu)(n4||(n4=_S(["\n  max-width: 250px;\n"]))),_A=e=>{var t;let{floatingBoundary:n,focused:i,onItemClose:r,onItemOpen:l,onPathFocus:a,path:o,readOnly:s,referenceBoundary:d,relativePath:c,renderAnnotation:u,renderBlock:p,renderCustomMarkers:h,renderField:f,renderItem:m,renderInlineBlock:g,renderInput:x,renderPreview:v,schemaType:b,selected:y,value:j}=e,{Markers:w}=mY().__internal.components,k=(0,sE._F)(),C=Cx(o),_=Cy(gP(o)),{validation:S,hasError:T,hasInfo:E,hasWarning:P}=Cf(null==_?void 0:_.node),A=k.schemaTypes.block,O=C.length>0,z=(0,lJ.useMemo)(()=>({anchor:{path:c,offset:0},focus:{path:c,offset:0}}),[c]),M=(0,lJ.useCallback)(()=>{sE.q$.delete(k,z,{mode:"children"}),sE.q$.focus(k)},[z,k]),I=(0,lJ.useCallback)(()=>{_&&(sE.q$.blur(k),l(_.node.path))},[k,l,_]),R=(0,lJ.useCallback)(()=>{r(),sE.q$.select(k,z),sE.q$.focus(k)},[r,k,z]),F=!!(null==_?void 0:_.member.open),D=null==_?void 0:_.input,Z=(null==_?void 0:_.node.path)||ch,L=null==(t=null==_?void 0:_.elementRef)?void 0:t.current,q=gi(o,!0),N=(0,lJ.useMemo)(()=>q.filter(e=>(0,lY.Xy)(e.path,o)),[o,q]),V=(0,lJ.useMemo)(()=>({__unstable_floatingBoundary:n,__unstable_referenceBoundary:d,__unstable_referenceElement:L,children:D,focused:i,onClose:R,onOpen:I,onPathFocus:a,onRemove:M,open:F,markers:C,member:null==_?void 0:_.member,parentSchemaType:A,path:Z,presence:N,readOnly:!!s,renderAnnotation:u,renderBlock:p,renderDefault:_O,renderField:f,renderInlineBlock:g,renderInput:x,renderItem:m,renderPreview:v,schemaType:b,selected:y,value:j,validation:S}),[n,i,D,F,C,null==_?void 0:_.member,Z,R,I,a,M,A,s,d,L,u,p,f,g,x,m,v,N,b,y,S,j]),U=T||P||E||O,B=(0,lJ.useMemo)(()=>U&&(0,lG.jsx)(_P,{padding:2,children:(0,lG.jsx)(w,{markers:C,validation:S,renderCustomMarkers:h})})||null,[w,C,h,U,S]);return(0,lJ.useMemo)(()=>(0,lG.jsx)("span",{ref:null==_?void 0:_.elementRef,contentEditable:!1,children:(0,lG.jsx)(l4.u,{placement:"bottom",portal:"editor",disabled:!U,content:B,children:g&&(0,lG.jsx)("span",{style:{position:"relative"},children:g(V)})})}),[V,null==_?void 0:_.elementRef,g,B,U])},_O=e=>{let{__unstable_floatingBoundary:t,__unstable_referenceBoundary:n,__unstable_referenceElement:i,children:r,focused:l,markers:a,onClose:o,onOpen:s,onRemove:d,open:c,readOnly:u,renderPreview:p,schemaType:h,selected:f,validation:m,value:g}=e,x=a.length>0,[v,b]=(0,lJ.useState)(!1),y=(null==h?void 0:h.title)||h.name,j=m.filter(e=>"error"===e.level).length>0,w=m.filter(e=>"warning"===e.level).length>0,k=(0,lJ.useCallback)(()=>{b(!1),s()},[s]);(0,lJ.useEffect)(()=>{c?b(!1):l?b(!0):b(!1)},[l,c]);let C=(0,lJ.useMemo)(()=>j?"critical":w?"caution":f||l?"primary":void 0,[l,j,w,f]),_=(0,lJ.useCallback)(()=>{b(!1)},[]);return(0,lG.jsxs)(lG.Fragment,{children:[(0,lG.jsx)(_T,{"data-focused":l||void 0,"data-invalid":j||void 0,"data-markers":x||void 0,"data-read-only":u||void 0,"data-selected":f||void 0,"data-warning":w||void 0,forwardedAs:"span",onClick:u?k:void 0,onDoubleClick:k,tone:C,children:(0,lG.jsx)(_E,{children:p({layout:"inline",schemaType:h,skipVisibilityCheck:!0,value:g,fallbackTitle:"Click to edit"})})}),i&&(0,lG.jsx)(_k,{floatingBoundary:t,onClosePopover:_,onDelete:d,onEdit:k,open:v,referenceBoundary:n,referenceElement:i,title:y}),c&&(0,lG.jsx)(CH,{defaultType:"popover",onClose:o,autoFocus:l,floatingBoundary:t,referenceBoundary:n,referenceElement:i,schemaType:h,children:r})]})};var _z=Object.freeze,_M=Object.defineProperty;let _I=(0,a0.ZP)(l4.J2)(n6||(n6=_z(_M(I=["\n  &[data-popper-reference-hidden='true'] {\n    display: none !important;\n  }\n"],"raw",{value:_z(I.slice())})))),_R=["top","bottom"];function _F(e){let{annotationOpen:t,floatingBoundary:n,onOpen:i,onRemove:r,referenceBoundary:l,referenceElement:a,selected:o,title:s}=e,[d,c]=(0,lJ.useState)(!1),[u,p]=(0,lJ.useState)(null),h=(0,lJ.useRef)(null),{sanity:f}=(0,l4.Fg)(),m=(0,lJ.useRef)(null),g=f.color.dark?"light":"dark",x=(0,lJ.useMemo)(()=>u?{getBoundingClientRect:()=>u}:null,[u]);(0,l4.qh)((0,lJ.useCallback)(e=>{d&&"Escape"===e.key&&c(!1)},[d]));let v=(0,lJ.useCallback)(()=>{if(t){c(!1),p(null);return}let e=window.getSelection();if(!e||0===e.rangeCount)return;let n=e.getRangeAt(0);if(!(null==a?void 0:a.contains(n.commonAncestorContainer))){c(!1),p(null);return}let i=null==n?void 0:n.getBoundingClientRect();i&&(c(!0),p(i))},[t,a]);(0,lJ.useEffect)(()=>(document.addEventListener("selectionchange",v,{passive:!0}),()=>{document.removeEventListener("selectionchange",v)}),[v]);let b=(0,lJ.useCallback)(()=>{c(!1),i()},[i]);(0,lJ.useEffect)(()=>{!t&&o&&c(!0),t&&c(!1)},[t,o]);let y=(0,lJ.useCallback)(()=>{c(!1),r()},[r]),j=(0,lJ.useCallback)(()=>{h.current&&p(h.current.getBoundingClientRect())},[]);return((0,lJ.useEffect)(()=>{if(d)return null==l||l.addEventListener("scroll",j),()=>{null==l||l.removeEventListener("scroll",j)}},[d,l,j]),d)?(0,lG.jsx)(_I,{open:d,floatingBoundary:n,constrainSize:!0,content:(0,lG.jsx)(l4.xu,{padding:1,"data-testid":"annotation-toolbar-popover",children:(0,lG.jsxs)(l4.gF,{space:1,children:[(0,lG.jsx)(l4.xu,{padding:2,children:(0,lG.jsx)(l4.xv,{weight:"semibold",size:1,children:s})}),(0,lG.jsx)(l4.zx,{icon:a8.dY8,mode:"bleed",onClick:b,padding:2,alt:"Edit annotation",tabIndex:0}),(0,lG.jsx)(l4.zx,{icon:a8.XHJ,mode:"bleed",padding:2,onClick:y,tone:"critical",alt:"Remove annotation",tabIndex:0})]})}),fallbackPlacements:_R,placement:"top",portal:!0,preventOverflow:!0,ref:m,referenceBoundary:l,referenceElement:x,scheme:g}):null}var _D=Object.freeze,_Z=Object.defineProperty,_L=(e,t)=>_D(_Z(e,"raw",{value:_D(t||e.slice())}));let _q=a0.ZP.span(e=>{var t,n,i,r;let{$toneKey:l="default",theme:a}=e;return(0,a0.iv)(n8||(n8=_L(["\n      text-decoration: none;\n      display: inline;\n      background-color: ",";\n      border-bottom: 1px dashed ",";\n      color: ",";\n\n      &[data-link] {\n        border-bottom: 1px solid ",";\n      }\n\n      &[data-custom-markers] {\n        background-color: ",";\n      }\n\n      &[data-warning] {\n        background-color: ",";\n      }\n\n      &[data-error] {\n        background-color: ",";\n      }\n    "])),null==(t=a.sanity.color.selectable)?void 0:t[l].enabled.bg,null==(n=a.sanity.color.selectable)?void 0:n[l].enabled.fg,null==(i=a.sanity.color.selectable)?void 0:i[l].enabled.fg,null==(r=a.sanity.color.selectable)?void 0:r[l].enabled.fg,a.sanity.color.dark?or.VG.purple[950].hex:or.VG.purple[50].hex,a.sanity.color.muted.caution.hovered.bg,a.sanity.color.muted.critical.hovered.bg)}),_N=(0,a0.ZP)(l4.xu).attrs({forwardedAs:"span"})(n9||(n9=_L(["\n  max-width: 250px;\n"])));function _V(e){var t;let{children:n,editorNodeFocused:i,floatingBoundary:r,focused:l,onItemClose:a,onItemOpen:o,onPathFocus:s,path:d,readOnly:c,referenceBoundary:u,renderAnnotation:p,renderBlock:h,renderCustomMarkers:f,renderField:m,renderInlineBlock:g,renderInput:x,renderItem:v,renderPreview:b,schemaType:y,selected:j,value:w}=e,{Markers:k=m5}=mY().__internal.components,C=(0,sE._F)(),_=(0,lJ.useMemo)(()=>d.slice(0,d.length-2).concat(["markDefs",{_key:w._key}]),[d,w._key]),[S,T]=(0,lJ.useState)(null),E=(0,lJ.useMemo)(()=>d.slice(d.length-3,d.length),[d]),P=Cy(gP(_)),{validation:A}=Cf(null==P?void 0:P.node),O=Cx(d),z=(0,lJ.useMemo)(()=>(0,lG.jsx)("span",{"data-annotation":"",children:n}),[n]),M=(0,lJ.useCallback)(()=>{P&&(sE.q$.blur(C),s(P.node.focusPath),o(P.node.path))},[C,P,o,s]),I=(0,lJ.useCallback)(()=>{a();let e=sE.q$.getSelection(C),t=(null==e?void 0:e.focus.path)&&(0,lY.Xy)(e.focus.path,E)&&e.focus.offset,n=(null==e?void 0:e.anchor.path)&&(0,lY.Xy)(e.anchor.path,E)&&e.anchor.offset;sE.q$.select(C,{anchor:{path:E,offset:n||0},focus:{path:E,offset:t||0}}),sE.q$.focus(C)},[C,E,a]),R=(0,lJ.useCallback)(()=>{sE.q$.removeAnnotation(C,y),sE.q$.focus(C)},[C,y]),F=(0,lJ.useMemo)(()=>A.length>0||O.length>0?(0,lG.jsx)(l4.u,{placement:"bottom",portal:"default",content:(0,lG.jsx)(_N,{padding:2,children:(0,lG.jsx)(k,{markers:O,renderCustomMarkers:f,validation:A})}),children:z}):void 0,[k,O,f,z,A]),D=gi(d,!0),Z=(0,lJ.useMemo)(()=>D.filter(e=>(0,lY.Xy)(e.path,d)),[d,D]),L=!!(null==P?void 0:P.member.open),q=null==P?void 0:P.input,N=(null==P?void 0:P.node.path)||ch,V=(0,lJ.useMemo)(()=>({__unstable_floatingBoundary:r,__unstable_referenceBoundary:u,__unstable_referenceElement:S,__unstable_textElementFocus:i,children:q,focused:l,markers:O,onClose:I,onOpen:M,onPathFocus:s,onRemove:R,open:L,parentSchemaType:C.schemaTypes.block,path:N,presence:Z,readOnly:!!c,renderAnnotation:p,renderBlock:h,renderField:m,renderInlineBlock:g,renderInput:x,renderPreview:b,renderItem:v,renderDefault:_U,schemaType:y,selected:j,textElement:F||z,validation:A,value:w}),[C.schemaTypes.block,i,r,l,q,L,O,F,N,I,M,s,R,c,u,S,p,h,m,g,x,v,b,Z,y,j,z,A,w]),U=null==(t=y.components)?void 0:t.annotation,B=(0,lJ.useCallback)(e=>{(null==P?void 0:P.elementRef)&&(P.elementRef.current=e),T(e)},[P]);return(0,lJ.useMemo)(()=>(0,lG.jsx)("span",{ref:B,style:Cj(),children:U?(0,lG.jsx)(U,{...V}):(0,lG.jsx)(_U,{...V})}),[U,V,B])}let _U=e=>{let{__unstable_floatingBoundary:t,__unstable_referenceBoundary:n,__unstable_referenceElement:i,children:r,focused:l,markers:a,onClose:o,onOpen:s,onRemove:d,open:c,readOnly:u,selected:p,schemaType:h,textElement:f,validation:m}=e,g="link"===h.name,x=m.filter(e=>"error"===e.level).length>0,v=m.filter(e=>"warning"===e.level).length>0,b=a.length>0,y=(0,lJ.useMemo)(()=>x?"critical":v?"caution":g?"primary":"default",[g,x,v]);return(0,lG.jsxs)(_q,{$toneKey:y,"data-link":g?"":void 0,"data-error":x?"":void 0,"data-warning":v?"":void 0,"data-markers":b||void 0,onClick:u?s:void 0,children:[f,(0,lG.jsx)(_F,{annotationOpen:c,floatingBoundary:t,onOpen:s,onRemove:d,referenceBoundary:n,referenceElement:i,selected:p,title:h.title||h.name}),c&&(0,lG.jsx)(CH,{defaultType:"popover",floatingBoundary:t,onClose:o,autoFocus:l,referenceBoundary:n,referenceElement:i,schemaType:h,children:r})]})};function _B(e){var t;return(null==(t=e.components)?void 0:t.block)?e.components.block:Cu(e)?_v:C$}function _K(e){var t;return(null==(t=e.components)?void 0:t.inlineBlock)?e.components.inlineBlock:_O}function _H(e){var t;return(null==(t=e.components)?void 0:t.annotation)?e.components.annotation:_U}let _W=/^\d+$/;function _$(e){return e.split(/[[.\]]/g).filter(Boolean).map(e=>e.includes("==")?function(e){let[t,n]=e.split("==");return{[t]:n.replace(/^['"]/,"").replace(/['"]$/,"")}}(e):_W.test(e)?Number(e):e)}function _X(e){let{reference:t,children:n,observeAsset:i,waitPlaceholder:r}=e,l=null==t?void 0:t._ref,a=(0,l5.m2)(()=>i(l),[l,i]);return(0,lG.jsx)(lG.Fragment,{children:l&&a?n(a):r})}function _G(e){return null===e?[]:[e]}function _Y(e){return Promise.all(e.map(e=>{if("file"===e.kind&&e.webkitGetAsEntry){let t;try{t=e.webkitGetAsEntry()}catch(t){return _G(e.getAsFile())}return t?t.isDirectory?function e(t){if(t.isFile)return new Promise((e,n)=>t.file(e,n)).then(e=>[e]);if(t.isDirectory){let n=t.createReader();return new Promise((e,t)=>n.readEntries(e,t)).then(e=>e.filter(e=>!e.name.startsWith("."))).then(t=>Promise.all(t.map(e)).then(ow()))}return Promise.resolve([])}(t):_G(e.getAsFile()):[]}if("file"===e.kind){let t=e.getAsFile();return Promise.resolve(t?[t]:[])}return"string"===e.kind?console.warn('DataTransfer with kind="string" is currently not supported'):console.warn("Unknown DataTransferItem.kind: %s",e.kind),Promise.resolve([])}))}let _J={opacity:0,position:"absolute"};function _Q(e){return lJ.forwardRef(function(t,n){let{onFiles:i,onFilesOver:r,onFilesOut:l,disabled:a,...o}=t,[s,d]=lJ.useState(!1),c=lJ.useRef(null),u=(0,l4.ts)(n),p=lJ.useRef([]),h=(0,lJ.useCallback)(e=>{null==i||i(e)},[i]),f=(0,lJ.useCallback)(e=>{e.target===u.current&&(e.ctrlKey||e.metaKey)&&"v"===e.key&&d(!0)},[u]),m=(0,lJ.useCallback)(e=>{var t;((t=e.clipboardData).files&&t.files.length>0?Promise.resolve(Array.from(t.files||[])):_Y(Array.from(t.items||[])).then(ow())).then(e=>c.current?e.length>0?e:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"image/jpeg";return e.isContentEditable?new Promise(e=>setTimeout(e,10)).then(()=>Array.from(e.querySelectorAll("img"))).then(t=>(e.innerHTML="",t)).then(e=>Promise.all(e.map(e=>(function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"image/jpeg",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return e.match(/^webkit-fake-url:\/\//)?Promise.reject(Error("Cannot read image contents from webkit fake url")):new Promise((i,r)=>{let l=new Image;l.crossOrigin="anonymous",l.referrerPolicy="strict-origin-when-cross-origin",l.onload=()=>{let e=document.createElement("canvas");e.width=l.width,e.height=l.height;let a=e.getContext("2d");null==a||a.drawImage(l,0,0,e.width,e.height);try{e.toBlob(i,t,n)}catch(e){r(e)}},l.src=e})})(e.src)))).then(e=>e.map(e=>new File([e],"pasted-image.jpg",{type:t}))):Promise.reject(Error('Expected element to be contentEditable="true". Instead found a non contenteditable '.concat(e.tagName)))}(c.current,"image/jpeg"):[]).then(e=>{var t;h(e),d(!1),null==(t=u.current)||t.focus()})},[h,u]),g=(0,lJ.useCallback)(e=>{p.current=[],e.preventDefault(),e.stopPropagation();let t=e.nativeEvent.dataTransfer;i&&t&&(function(e){let t=Array.from(e.files||[]),n=Array.from(e.items||[]);return t&&t.length>0?Promise.resolve(t):_Y(n).then(ow())})(t).then(e=>{e&&h(e)}),null==l||l()},[h,i,l]),x=(0,lJ.useCallback)(e=>{i&&(e.preventDefault(),e.stopPropagation())},[i]),v=(0,lJ.useCallback)(e=>{e.stopPropagation(),r&&u.current===e.currentTarget&&(p.current=[...new Set(p.current),e.currentTarget],r(Array.from(e.dataTransfer.items).map(e=>({type:e.type,kind:e.kind}))))},[r,u]),b=(0,lJ.useCallback)(e=>{e.stopPropagation();let t=p.current.indexOf(e.currentTarget);t>-1&&p.current.splice(t,1),0===p.current.length&&(null==l||l())},[l]),y=lJ.useRef(!1);return lJ.useEffect(()=>{var e;!y.current&&s&&c.current?(c.current.focus(),function(e){let t=document.createRange();t.selectNodeContents(e);let n=window.getSelection();null==n||n.removeAllRanges(),null==n||n.addRange(t)}(c.current)):y.current&&!s&&(null==(e=c.current)||e.focus()),y.current=s},[s]),(0,lG.jsxs)(lG.Fragment,{children:[(0,lG.jsx)(e,{...o,ref:u,onKeyDown:a?void 0:f,onDragOver:a?void 0:x,onDragEnter:a?void 0:v,onDragLeave:a?void 0:b,onDrop:a?void 0:g}),!a&&s&&(0,lG.jsx)("div",{contentEditable:!0,onPaste:m,ref:c,style:_J})]})})}function _0(e){return"inset 0 0 0 ".concat(e.width,"px ").concat(e.color)}function _1(e){let{base:t,border:n,focusRing:i}=e,r=i.offset+i.width,l=0-i.offset,a=t?t.bg:"var(--card-bg-color)";return[l>0&&"inset 0 0 0 ".concat(l,"px var(--card-focus-ring-color)"),n&&_0(n),l<0&&"0 0 0 ".concat(0-l,"px ").concat(a),r>0&&"0 0 0 ".concat(r,"px var(--card-focus-ring-color)")].filter(Boolean).join(",")}var _2=Object.freeze,_3=Object.defineProperty,_4=(e,t)=>_2(_3(e,"raw",{value:_2(t||e.slice())}));function _5(e){return(0,a0.ZP)(e)(e=>{let t={width:e.$border?1:0,color:"var(--card-border-color)"};return(0,a0.iv)(n7||(n7=_4(["\n        --card-focus-box-shadow: ",";\n\n        border-radius: ",";\n        outline: none;\n        box-shadow: var(--card-focus-box-shadow);\n\n        &:focus {\n          --card-focus-box-shadow: ",";\n        }\n      "])),_0(t),(0,l4.hO)(e.theme.sanity.radius[1]),_1({base:e.theme.sanity.color.base,border:t,focusRing:e.theme.sanity.focusRing}))})}let _6=_5(_Q(l4.Zb));var _8=Object.freeze,_9=Object.defineProperty,_7=(e,t)=>_8(_9(e,"raw",{value:_8(t||e.slice())}));let Se=(0,a0.ZP)(l4.Zb)(ie||(ie=_7(["\n  min-height: 82px;\n  box-sizing: border-box;\n"]))),St=(0,a0.ZP)(l4.kC)(it||(it=_7(["\n  text-overflow: ellipsis;\n  overflow: hidden;\n  overflow: clip;\n"]))),Sn=(0,a0.ZP)(l4.Kq)(ii||(ii=_7(["\n  position: relative;\n  width: 60%;\n"]))),Si=(0,a0.ZP)(l4.EK)(ir||(ir=_7(["\n  position: relative;\n  width: 100%;\n\n  code {\n    overflow: hidden;\n    overflow: clip;\n    text-overflow: ellipsis;\n    position: relative;\n    max-width: 200px;\n  }\n"]))),Sr=e=>new Date().getTime()-new Date(e).getTime();function Sl(e){let{uploadState:t,onCancel:n,onStale:i,height:r}=e,l=t.file.name;return(0,lJ.useEffect)(()=>{Sr(t.updatedAt)>12e4&&(null==i||i())},[t.updatedAt,i]),(0,lG.jsx)(Se,{tone:"primary",padding:4,border:!0,style:{height:"".concat(r,"px")},children:(0,lG.jsxs)(St,{align:"center",justify:"space-between",height:"fill",direction:"row",gap:2,children:[(0,lG.jsxs)(Sn,{children:[(0,lG.jsx)(l4.kC,{justify:"center",gap:[3,3,2,2],direction:["column","column","row"],children:(0,lG.jsx)(l4.xv,{size:1,children:(0,lG.jsxs)(l4.gF,{space:2,children:["Uploading",(0,lG.jsx)(Si,{size:1,children:l||"..."})]})})}),(0,lG.jsx)(l4.Zb,{marginTop:3,radius:5,shadow:1,children:(0,lG.jsx)(pb,{value:t.progress})})]}),n?(0,lG.jsx)(l4.zx,{fontSize:2,text:"Cancel upload",mode:"ghost",tone:"critical",onClick:n}):null]})})}function Sa(e,t){var n;let i=e.split(","),r=null==(n=i[0].match(/:(.*?);/))?void 0:n[1],l=atob(i[1]),a=l.length,o=new Uint8Array(a);for(;a--;)o[a]=l.charCodeAt(a);return new File([o],t,{type:r})}function So(e){var t,n;let{assetFromSource:i,onChange:r,type:l,resolveUploader:a,uploadWith:o,isImage:s}=e;if(!i)throw Error("No asset given");if(!Array.isArray(i)||0===i.length)throw Error("Returned value must be an array with at least one item (asset)");let d=i[0],c=d.assetDocumentProps,u=null==c?void 0:c.originalFilename,p=null==c?void 0:c.label,h=null==c?void 0:c.title,f=null==c?void 0:c.description,m=null==c?void 0:c.creditLine,g=null==c?void 0:c.source,x=s?[mq(["hotspot"]),mq(["crop"])]:[];switch(d.kind){case"assetDocumentId":r([mD({_type:l.name}),...x,mL({_type:"reference",_ref:d.value},["asset"])]);break;case"file":{let e=a(l,d.value);e&&o(e,d.value,{label:p,title:h,description:f,creditLine:m,source:g});break}case"base64":(t=d.value,new Promise((e,n)=>{let i=t.toString(),r=i.substring(11,i.indexOf(";base64"));if(!r&&!u){n(Error("Could not find mime type for image"));return}e(Sa(t,u||"".concat((0,sy.Z)(),".").concat(r)))})).then(e=>{let t=a(l,e);t&&o(t,e,{label:p,title:h,description:f,creditLine:m,source:g})});break;case"url":(n=d.value,new Promise((e,t)=>{let i=new XMLHttpRequest;i.onload=()=>{let n=new FileReader;n.onloadend=()=>{var i;let r=null==(i=n.result)?void 0:i.toString(),l=null==r?void 0:r.substring(11,r.indexOf(";base64"));if(!l&&!u){t(Error("Could not find mime type for image"));return}e(Sa(n.result,u||"".concat((0,sy.Z)(),".").concat(l)))},n.readAsDataURL(i.response)},i.onerror=e=>{t(e)},i.open("GET",n),i.responseType="blob",i.send()})).then(e=>{let t=a(l,e);t&&o(t,e,{label:p,title:h,description:f,creditLine:m,source:g})});break;default:throw Error("Invalid value returned from asset source plugin")}}var Ss=Object.freeze,Sd=Object.defineProperty;let Sc=(0,a0.ZP)(l4.sN)(il||(il=Ss(Sd(R=["\n  position: relative;\n\n  & input {\n    overflow: hidden;\n    overflow: clip;\n    top: 0;\n    left: 0;\n    width: 100%;\n    height: 100%;\n    position: absolute;\n    min-width: 0;\n    display: block;\n    appearance: none;\n    padding: 0;\n    margin: 0;\n    border: 0;\n    opacity: 0;\n  }\n"],"raw",{value:Ss(R.slice())})))),Su=lJ.forwardRef(function(e,t){let{icon:n,id:i,accept:r,capture:l,fontSize:a,multiple:o,onSelect:s,padding:d=3,space:c=3,textAlign:u,text:p,disabled:h,...f}=e,m="".concat(i||"","-").concat((0,lJ.useId)()),g=lJ.useCallback(e=>{s&&e.target.files&&s(Array.from(e.target.files))},[s]),x=(0,lG.jsxs)(l4.kC,{align:"center",justify:"flex-start",padding:d,children:[n&&(0,lG.jsx)(l4.xu,{marginRight:p?c:void 0,children:(0,lG.jsxs)(l4.xv,{size:a,children:[(0,lJ.isValidElement)(n)&&n,(0,oi.isValidElementType)(n)&&(0,lJ.createElement)(n)]})}),p&&(0,lG.jsx)(l4.xv,{align:u,size:a,textOverflow:"ellipsis",children:p})]});return(0,lG.jsxs)(Sc,{...f,htmlFor:m,padding:0,fontSize:2,disabled:h,ref:t,children:[x,(0,lG.jsx)("input",{"data-testid":"file-menuitem-input",accept:r,capture:l,id:m,multiple:o,onChange:g,type:"file",value:"",disabled:h})]})});function Sp(e){let{onUpload:t,onReset:n,readOnly:i,accept:r,directUploads:l,browse:a,downloadUrl:o,copyUrl:s}=e,{push:d}=(0,l4.pm)(),c=(0,lJ.useCallback)(()=>{navigator.clipboard.writeText(s||""),d({closable:!0,status:"success",title:"The URL is copied to the clipboard"})},[d,s]);return(0,lG.jsxs)(lG.Fragment,{children:[(0,lG.jsx)(l4.xu,{padding:2,children:(0,lG.jsx)(l4.__,{muted:!0,size:1,children:"Replace"})}),(0,lG.jsx)(Su,{icon:a8.rG2,mode:"bleed",onSelect:t,accept:r,text:"Upload","data-testid":"file-input-upload-button",disabled:i||!l,fontSize:2}),a,(o||s)&&(0,lG.jsx)(l4.R,{}),o&&(0,lG.jsx)(l4.sN,{as:"a",icon:a8._8t,text:"Download",href:o}),s&&(0,lG.jsx)(l4.sN,{icon:a8.TIy,text:"Copy URL",onClick:c}),(0,lG.jsx)(l4.R,{}),(0,lG.jsx)(l4.sN,{tone:"critical",icon:a8.X5P,text:"Clear field",onClick:n,disabled:i,"data-testid":"file-input-clear"})]})}var Sh=Object.freeze,Sf=Object.defineProperty;let Sm=(0,a0.ZP)(l4.kC)(ia||(ia=Sh(Sf(F=["\n  pointer-events: none;\n"],"raw",{value:Sh(F.slice())}))));function Sg(e){let{hoveringFiles:t,type:n,readOnly:i,acceptedFiles:r,rejectedFilesCount:l,directUploads:a}=e,o="file"===n,s=(0,lJ.useMemo)(()=>i?(0,lG.jsx)(a8.CPA,{}):t&&l>0||!a?(0,lG.jsx)(a8.vaB,{}):o?(0,lG.jsx)(a8.bg6,{}):(0,lG.jsx)(a8.XBm,{}),[a,t,o,i,l]),d=(0,lJ.useMemo)(()=>{let e="Drag or paste ".concat(n," here");return a?(i&&(e="Read only"),t&&a&&!i&&(r.length>0&&(e="Drop to upload ".concat(n)),l>0&&(e="Can't upload ".concat(l," file").concat(l>1?"s":""," here"))),e):"Can't upload files here"},[r.length,a,t,i,l,n]);return(0,lG.jsxs)(Sm,{align:"center",gap:2,justify:"center",children:[(0,lG.jsx)(l4.xv,{muted:!0,children:s}),(0,lG.jsx)(l4.xv,{size:1,muted:!0,children:d})]})}var Sx=Object.freeze,Sv=Object.defineProperty,Sb=(e,t)=>Sx(Sv(e,"raw",{value:Sx(t||e.slice())}));let Sy=(0,a0.ZP)(l4.zx).attrs({forwardedAs:"label"})(e=>{let{theme:t}=e,{focusRing:n}=t.sanity,i=t.sanity.color.base;return(0,a0.iv)(io||(io=Sb(["\n      &:not([data-disabled='true']) {\n        &:focus-within {\n          box-shadow: ",";\n        }\n      }\n\n      & input {\n        overflow: hidden;\n        overflow: clip;\n        top: 0;\n        left: 0;\n        width: 100%;\n        height: 100%;\n        position: absolute;\n        min-width: 0;\n        display: block;\n        appearance: none;\n        padding: 0;\n        margin: 0;\n        border: 0;\n        opacity: 0;\n      }\n    "])),_1({base:i,border:{width:1,color:"var(--card-border-color)"},focusRing:n}))}),Sj=lJ.forwardRef(function(e,t){let{icon:n,id:i,accept:r,capture:l,fontSize:a,multiple:o,onSelect:s,padding:d=3,space:c=3,textAlign:u,text:p,disabled:h,...f}=e,m="".concat(i||"","-").concat((0,lJ.useId)()),g=(0,l4.Fg)(),x=lJ.useCallback(e=>{s&&e.target.files&&s(Array.from(e.target.files))},[s]),v=(0,lG.jsxs)(l4.kC,{align:"center",justify:"center",padding:d,children:[n&&(0,lG.jsx)(l4.xu,{marginRight:p?c:void 0,children:(0,lG.jsxs)(l4.xv,{size:a,children:[(0,lJ.isValidElement)(n)&&n,(0,oi.isValidElementType)(n)&&(0,lJ.createElement)(n)]})}),p&&(0,lG.jsx)(l4.xv,{align:u,size:a,textOverflow:"ellipsis",weight:g.sanity.button.textWeight,children:p})]});return(0,lG.jsxs)(Sy,{...f,htmlFor:m,padding:0,fontSize:2,disabled:h,children:[v,(0,lG.jsx)("input",{"data-testid":"file-button-input",accept:r,capture:l,id:m,multiple:o,onChange:x,ref:t,type:"file",value:"",disabled:h})]})}),Sw=lJ.memo(function(e){let{accept:t,acceptedFiles:n,browse:i,directUploads:r,hoveringFiles:l,onUpload:a,readOnly:o,rejectedFilesCount:s,type:d}=e,[c,u]=(0,lJ.useState)(null),p=(0,l4.h4)(c),h=(null==p?void 0:p.border)&&p.border.width<440;return(0,lG.jsxs)(l4.kC,{align:h?void 0:"center",direction:h?"column":"row",gap:4,justify:"space-between",paddingY:h?1:void 0,ref:u,children:[(0,lG.jsx)(l4.kC,{flex:1,justify:"center",children:(0,lG.jsx)(Sg,{acceptedFiles:n,directUploads:r,hoveringFiles:l,readOnly:o,rejectedFilesCount:s,type:d})}),(0,lG.jsxs)(l4.kC,{align:"center",gap:2,justify:"center",wrap:"wrap",children:[(0,lG.jsx)(Sj,{accept:t,"data-testid":"file-input-upload-button",disabled:o||!r,icon:a8.rG2,mode:"ghost",onSelect:a,text:"Upload"}),i]})]})});var Sk=Object.freeze,SC=Object.defineProperty;let S_=(0,a0.ZP)(l4.zx)(is||(is=Sk(SC(D=["\n  width: 100%;\n"],"raw",{value:Sk(D.slice())}))));function SS(e){let{onClearStale:t}=e;return(0,lG.jsxs)(l4.Zb,{tone:"caution",padding:4,border:!0,radius:2,children:[(0,lG.jsxs)(l4.kC,{gap:4,marginBottom:4,children:[(0,lG.jsx)(l4.xu,{children:(0,lG.jsx)(l4.xv,{size:1,children:(0,lG.jsx)(a8.foC,{})})}),(0,lG.jsxs)(l4.Kq,{space:3,children:[(0,lG.jsx)(l4.xv,{size:1,weight:"semibold",children:"Incomplete upload"}),(0,lG.jsx)(l4.xv,{size:1,children:"An upload has made no progress in the last 6m and likely got interrupted. You can safely clear the incomplete upload and try uploading again."})]})]}),(0,lG.jsx)(S_,{icon:a8.X5P,text:"Clear upload",onClick:t,mode:"ghost"})]})}var ST=Object.freeze,SE=Object.defineProperty,SP=(e,t)=>ST(SE(e,"raw",{value:ST(t||e.slice())}));let SA=(0,a0.ZP)(l4.Zb)(id||(id=SP(["\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n"]))),SO=(0,a0.ZP)(l4.kC)(ic||(ic=SP(["\n  height: 100%;\n"])));function Sz(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;if(0===e)return"0 Bytes";let n=Math.floor(Math.log(e)/Math.log(1024));return"".concat(parseFloat((e/Math.pow(1024,n)).toFixed(t<0?0:t))," ").concat(["Bytes","KB","MB","GB","TB","PB","EB","ZB","YB"][n])}function SM(e){let{originalFilename:t,size:n,children:i,muted:r,disabled:l,onClick:a,isMenuOpen:o,onMenuOpen:s,setMenuButtonElement:d}=e,[c,u]=(0,lJ.useState)(null),[p,h]=(0,lJ.useState)(null),f=(0,lJ.useCallback)(()=>s(!0),[s]);(0,l4.qh)((0,lJ.useCallback)(e=>{o&&("Escape"===e.key||"Tab"===e.key)&&(s(!1),null==p||p.focus())},[o,s,p])),(0,l4.O8)((0,lJ.useCallback)(e=>{(null==p?void 0:p.contains(e.target))||s(!1)},[p,s]),[c]);let m=(0,lJ.useCallback)(e=>{d(e),h(e)},[d]);return(0,lJ.useEffect)(()=>{o&&(null==c||c.focus())},[o,c]),(0,lG.jsxs)(l4.kC,{wrap:"nowrap",justify:"space-between",align:"center",children:[(0,lG.jsx)(l4.Zb,{as:r||l?void 0:"button",radius:2,padding:2,tone:"inherit",onClick:a,flex:1,children:(0,lG.jsxs)(l4.kC,{wrap:"nowrap",align:"center",children:[(0,lG.jsx)(l4.Zb,{padding:3,tone:"transparent",shadow:1,radius:1,children:(0,lG.jsx)(l4.xv,{muted:r,children:(0,lG.jsx)(a8.bg6,{})})}),(0,lG.jsxs)(l4.Kq,{flex:1,space:2,marginLeft:3,children:[(0,lG.jsx)(l4.xv,{size:2,textOverflow:"ellipsis",muted:r,"data-testid":"file-name",children:t}),(0,lG.jsx)(l4.xv,{size:1,muted:!0,"data-testid":"file-size",children:Sz(n)})]})]})}),(0,lG.jsx)(l4.xu,{padding:2,children:(0,lG.jsx)(l4.kC,{justify:"center",children:(0,lG.jsx)(l4.J2,{content:(0,lG.jsx)(l4.v2,{ref:u,children:i}),id:"file-actions-menu",portal:!0,open:o,constrainSize:!0,children:(0,lG.jsx)(l4.zx,{"aria-label":"Open file options menu","data-testid":"options-menu-button",icon:a8.zGg,mode:"bleed",onClick:f,ref:m})})})})]})}function SI(){return(0,lG.jsxs)(l4.kC,{align:"center",justify:"flex-start",padding:2,children:[(0,lG.jsx)(l4.Od,{padding:3,radius:1,animated:!0}),(0,lG.jsxs)(l4.Kq,{flex:1,space:2,marginLeft:3,children:[(0,lG.jsx)(l4.JQ,{style:{width:"100%"},radius:1,animated:!0}),(0,lG.jsx)(l4.JQ,{style:{width:"100%"},radius:1,animated:!0})]})]})}var SR=Object.freeze,SF=Object.defineProperty;let SD=(0,a0.ZP)(l4.zx)(iu||(iu=SR(SF(Z=["\n  width: 100%;\n"],"raw",{value:SR(Z.slice())}))));function SZ(e){let{onClearValue:t}=e;return(0,lG.jsxs)(l4.Zb,{tone:"caution",padding:4,border:!0,radius:2,children:[(0,lG.jsxs)(l4.kC,{gap:4,marginBottom:4,children:[(0,lG.jsx)(l4.xu,{children:(0,lG.jsx)(l4.xv,{size:1,children:(0,lG.jsx)(a8.foC,{})})}),(0,lG.jsxs)(l4.Kq,{space:3,children:[(0,lG.jsx)(l4.xv,{size:1,weight:"semibold",children:"Invalid file value"}),(0,lG.jsx)(l4.xv,{size:1,children:"The value of this field is not a valid file. Resetting this field will let you choose a new file."})]})]}),(0,lG.jsx)(SD,{icon:a8.X5P,text:"Reset value",onClick:t,mode:"ghost"})]})}function SL(e){let{children:t}=e;return t}let Sq=["asset"];class SN extends lJ.PureComponent{constructor(e){var t;super(e),t=this,this.uploadSubscription=null,this.browseButtonElement=null,this.state={isUploading:!1,selectedAssetSource:null,hoveringFiles:[],isStale:!1,isMenuOpen:!1},this.toast=null,this.handleRemoveButtonClick=()=>{let{path:e,value:t}=this.props,n=e.slice(-1)[0],i=Object.keys(t||{}),r=0===i.filter(e=>!["_type","_key","_upload","asset"].includes(e)).length,l=["asset"].concat(i.filter(e=>["_upload"].includes(e))).map(e=>mq([e]));this.props.onChange(mN.from(r&&!("string"!=typeof n)?mq():l))},this.handleCancelUpload=()=>{this.cancelUpload()},this.handleClearUploadState=()=>{this.setState({isStale:!1}),this.clearUploadStatus()},this.handleStaleUpload=()=>{this.setState({isStale:!0})},this.handleClearField=()=>{this.props.onChange(mq(["asset"]))},this.handleSelectFiles=e=>{let{directUploads:t,readOnly:n}=this.props,{hoveringFiles:i}=this.state;t&&!n?this.uploadFirstAccepted(e):i.length>0&&this.handleFilesOut()},this.handleSelectFileFromAssetSource=e=>{this.setState({selectedAssetSource:e})},this.handleAssetSourceClosed=()=>{var e;this.setState({selectedAssetSource:null}),null==(e=this.browseButtonElement)||e.focus()},this.setBrowseButtonElement=e=>{this.browseButtonElement=e},this.uploadWith=function(e,n){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},{schemaType:r,onChange:l,client:a}=t.props,{source:o}=i,s={metadata:ob()(r,"options.metadata"),storeOriginalFilename:ob()(r,"options.storeOriginalFilename"),source:o};t.cancelUpload(),t.setState({isUploading:!0}),l(mN.from([mD({_type:r.name})])),t.uploadSubscription=e.upload(a,n,r,s).subscribe({next:e=>{e.patches&&l(mN.from(e.patches))},error:e=>{var n;console.error(e),null==(n=t.toast)||n.push({status:"error",description:"The upload could not be completed at this time.",title:"Upload failed"}),t.clearUploadStatus()},complete:()=>{t.setState({isUploading:!1})}})},this.handleSelectAssetFromSource=e=>{let{onChange:t,schemaType:n,resolveUploader:i}=this.props;So({assetFromSource:e,onChange:t,type:n,resolveUploader:i,uploadWith:this.uploadWith}),this.setState({selectedAssetSource:null})},this.handleFileTargetFocus=e=>{var t;e.currentTarget===e.target&&e.currentTarget===(null==(t=this.props.elementProps.ref)?void 0:t.current)&&this.props.elementProps.onFocus(e)},this.handleFilesOver=e=>{this.setState({hoveringFiles:e})},this.handleFilesOut=()=>{this.setState({hoveringFiles:[]})},this.handleUpload=e=>{let{file:t,uploader:n}=e;this.uploadWith(n,t)},this.setToast=e=>{this.toast=e},this._assetFieldPath=e.path.concat(Sq)}clearUploadStatus(){var e;(null==(e=this.props.value)?void 0:e._upload)&&this.props.onChange(mN.from([mq(["_upload"])]))}cancelUpload(){this.uploadSubscription&&(this.uploadSubscription.unsubscribe(),this.clearUploadStatus())}uploadFirstAccepted(e){let{schemaType:t}=this.props,n=e.map(e=>{var n,i;return{file:e,uploader:null==(i=(n=this.props).resolveUploader)?void 0:i.call(n,t,e)}}).find(e=>e.uploader);n&&this.uploadWith(n.uploader,n.file),this.setState({isMenuOpen:!1})}renderUploadState(e){let{isUploading:t}=this.state;return(0,lG.jsx)(Sl,{uploadState:e,onCancel:t?this.handleCancelUpload:void 0,onStale:this.handleStaleUpload})}renderAssetSource(){let{selectedAssetSource:e}=this.state,{value:t,schemaType:n,observeAsset:i}=this.props;if(!e)return null;let r=ob()(n,"options.accept",""),l=e.component;return t&&t.asset?(0,lG.jsx)(_X,{observeAsset:i,reference:t.asset,waitPlaceholder:(0,lG.jsx)(SI,{}),children:e=>(0,lG.jsx)(l,{selectedAssets:[e],selectionType:"single",assetType:"file",accept:r,dialogHeaderTitle:"Select file",onClose:this.handleAssetSourceClosed,onSelect:this.handleSelectAssetFromSource})}):(0,lG.jsx)(l,{selectedAssets:[],selectionType:"single",assetType:"file",accept:r,dialogHeaderTitle:"Select file",onClose:this.handleAssetSourceClosed,onSelect:this.handleSelectAssetFromSource})}renderAsset(){let{value:e,changed:t,readOnly:n,elementProps:i}=this.props,{hoveringFiles:r,isStale:l}=this.state,a=!!((null==e?void 0:e._upload)||(null==e?void 0:e.asset));return!e||void 0===e.asset||(null==e?void 0:e._upload)||(0,o7.OT)(e)?o=>(0,lG.jsxs)(lG.Fragment,{children:[l&&(0,lG.jsx)(l4.xu,{marginBottom:2,children:(0,lG.jsx)(SS,{onClearStale:this.handleClearUploadState})}),(0,lG.jsx)(cU,{path:this._assetFieldPath,hasFocus:!!o.focused,isChanged:t,children:(null==e?void 0:e._upload)?this.renderUploadState(e._upload):(0,lG.jsx)(_6,{...i,onFocus:this.handleFileTargetFocus,tabIndex:0,disabled:!!n,onFiles:this.handleSelectFiles,onFilesOver:this.handleFilesOver,onFilesOut:this.handleFilesOut,tone:this.getFileTone(),$border:a||r.length>0,style:{padding:1},sizing:"border",radius:2,children:(0,lG.jsxs)("div",{style:{position:"relative"},children:[!(null==e?void 0:e.asset)&&this.renderUploadPlaceholder(),(null==e?void 0:e.asset)&&r.length>0?this.renderAssetMenu(this.getFileTone()):null,!(null==e?void 0:e._upload)&&(null==e?void 0:e.asset)&&this.renderPreview()]})})})]}):()=>(0,lG.jsx)(SZ,{onClearValue:this.handleClearField})}renderPreview(){let{value:e,readOnly:t,assetSources:n,schemaType:i,directUploads:r,observeAsset:l}=this.props,{isMenuOpen:a}=this.state,o=null==e?void 0:e.asset;if(!o)return null;let s=ob()(i,"options.accept",""),d=n&&(null==n?void 0:n.length)===0?null:(0,lG.jsx)(l4.sN,{icon:a8.W1M,text:"Browse",onClick:()=>{this.setState({isMenuOpen:!1}),this.handleSelectFileFromAssetSource(n[0])},disabled:t,"data-testid":"file-input-browse-button"});return n.length>1&&(d=n.map(e=>(0,lG.jsx)(l4.sN,{text:e.title,onClick:()=>{this.setState({isMenuOpen:!1}),this.handleSelectFileFromAssetSource(e)},icon:e.icon||a8.XBm,disabled:t,"data-testid":"file-input-browse-button-".concat(e.name)},e.name))),(0,lG.jsx)(_X,{reference:o,observeAsset:l,waitPlaceholder:(0,lG.jsx)(SI,{}),children:n=>{let i,l,{originalFilename:o,extension:c,url:u,size:p}=n;return(0,o7.OT)(e)&&(l="".concat(u,"?dl"),i=u),(0,lG.jsx)(SM,{size:p,originalFilename:o||"download.".concat(c),muted:!t,onMenuOpen:e=>this.setState({isMenuOpen:e}),isMenuOpen:a,setMenuButtonElement:this.setBrowseButtonElement,children:(0,lG.jsx)(Sp,{onUpload:this.handleSelectFiles,browse:d,onReset:this.handleRemoveButtonClick,downloadUrl:l,copyUrl:i,readOnly:t,accept:s,directUploads:r})})}})}renderAssetMenu(e){let{schemaType:t,readOnly:n,directUploads:i,resolveUploader:r}=this.props,{hoveringFiles:l}=this.state,a=l.filter(e=>null==r?void 0:r(t,e)),o=l.length-a.length;return(0,lG.jsx)(SA,{tone:e,children:(0,lG.jsx)(SO,{align:"center",justify:"center",gap:2,flex:1,children:(0,lG.jsx)(Sg,{readOnly:n,hoveringFiles:l,acceptedFiles:a,rejectedFilesCount:o,directUploads:i,type:"file"})})})}renderBrowser(){let{assetSources:e,readOnly:t,directUploads:n,id:i}=this.props;return 0===e.length?null:e.length>1&&!t&&n?(0,lG.jsx)(l4.j2,{id:"".concat(i,"_assetFileButton"),ref:this.setBrowseButtonElement,button:(0,lG.jsx)(l4.zx,{mode:"ghost",text:"Select","data-testid":"file-input-multi-browse-button",icon:a8.W1M}),"data-testid":"input-select-button",menu:(0,lG.jsx)(l4.v2,{children:e.map(e=>(0,lG.jsx)(l4.sN,{text:e.title,onClick:()=>{this.setState({isMenuOpen:!1}),this.handleSelectFileFromAssetSource(e)},icon:e.icon||a8.XBm,disabled:t,"data-testid":"file-input-browse-button-".concat(e.name)},e.name))})}):(0,lG.jsx)(l4.zx,{fontSize:2,text:"Browse",icon:a8.W1M,mode:"ghost",onClick:()=>{this.setState({isMenuOpen:!1}),this.handleSelectFileFromAssetSource(e[0])},"data-testid":"file-input-browse-button",disabled:t,ref:this.setBrowseButtonElement})}renderUploadPlaceholder(){let{readOnly:e,schemaType:t,directUploads:n,resolveUploader:i}=this.props,{hoveringFiles:r}=this.state,l=r.filter(e=>null==i?void 0:i(t,e)),a=r.length-l.length,o=ob()(t,"options.accept","");return(0,lG.jsx)("div",{style:{padding:1},children:(0,lG.jsx)(l4.Zb,{tone:e?"transparent":"inherit",border:!0,padding:3,style:0===r.length?{borderStyle:"dashed"}:{borderStyle:"dashed",borderColor:"transparent"},children:(0,lG.jsx)(Sw,{browse:this.renderBrowser(),onUpload:this.handleSelectFiles,readOnly:e,hoveringFiles:r,acceptedFiles:l,rejectedFilesCount:a,type:"file",accept:o,directUploads:n})})})}getFileTone(){let{directUploads:e,schemaType:t,value:n,readOnly:i,resolveUploader:r}=this.props,{hoveringFiles:l}=this.state,a=l.filter(e=>null==r?void 0:r(t,e)),o=l.length-a.length;return l.length>0&&(o>0||!e)?"critical":(null==n?void 0:n._upload)||i||!(l.length>0)?(null==n?void 0:n._upload)&&(null==n?void 0:n.asset)&&i?"transparent":"default":"primary"}render(){let{members:e,renderAnnotation:t,renderBlock:n,renderInlineBlock:i,renderItem:r,renderInput:l,renderField:a,renderPreview:o}=this.props,{selectedAssetSource:s}=this.state;return(0,lG.jsxs)(lG.Fragment,{children:[(0,lG.jsx)(p9,{ref:this.setToast}),e.map(e=>"field"===e.kind&&("crop"===e.name||"hotspot"===e.name)?null:"field"===e.kind?(0,lG.jsx)(kd,{member:e,renderAnnotation:t,renderInlineBlock:i,renderBlock:n,renderInput:"asset"===e.name?this.renderAsset():l,renderField:"asset"===e.name?SL:a,renderItem:r,renderPreview:o},e.key):"fieldSet"===e.kind?(0,lG.jsx)(kC,{member:e,renderAnnotation:t,renderBlock:n,renderField:a,renderInlineBlock:i,renderInput:l,renderItem:r,renderPreview:o},e.key):"error"===e.kind?(0,lG.jsx)(kk,{member:e},e.key):(0,lG.jsxs)(lG.Fragment,{children:["Unknown member kind: $",e.kind]})),s&&this.renderAssetSource()]})}}var SV=Object.freeze,SU=Object.defineProperty;let SB=(0,a0.ZP)(l4.xu)(ip||(ip=SV(SU(L=["\n  position: relative;\n  padding-bottom: calc("," * 100%);\n\n  & > div {\n    position: absolute;\n    top: ","px;\n    left: ","px;\n    right: ","px;\n    bottom: ","px;\n  }\n"],"raw",{value:SV(L.slice())}))),e=>{let{ratio:t=1.5}=e;return 1/t},e=>{let{padding:t=0}=e;return t},e=>{let{padding:t=0}=e;return t},e=>{let{padding:t=0}=e;return t},e=>{let{padding:t=0}=e;return t});function SK(e){let{src:t,children:n}=e,[i,r]=(0,lJ.useState)(!0),[l,a]=(0,lJ.useState)(null),[o,s]=(0,lJ.useState)(null);return(0,lJ.useEffect)(()=>{a(null),s(null),r(!0);let e=new Image;e.onload=()=>{a(e),s(null),r(!1)},e.onerror=()=>{s(Error("Could not load image from ".concat(JSON.stringify(t)))),r(!1)},e.referrerPolicy="strict-origin-when-cross-origin",e.src=t},[t]),n({image:l,error:o,isLoading:i})}let SH=["","webkit","moz","ms","o"].map(e=>"".concat(e,"backingStoreRatio")),SW=-1;function S$(e,t){let n={x:t.center.x,y:t.center.y},i=t.width/2,r=t.height/2;if(i<=0||r<=0)return!1;let l={x:e.x-n.x,y:e.y-n.y};return Math.pow(l.x,2)/Math.pow(i,2)+Math.pow(l.y,2)/Math.pow(r,2)<=1}function SX(e,t){let{x:n,y:i}=e;return Math.pow(n-t.x,2)+Math.pow(i-t.y,2)<Math.pow(t.radius,2)}function SG(e,t){return e.x>=t.left&&e.x<=t.left+t.width&&e.y>=t.top&&e.y<=t.top+t.height}function SY(e,t){return{x:t.center.x-t.width/2*Math.cos(e),y:t.center.y-t.height/2*Math.sin(e)}}class SJ{constructor(e,t){this.x=e,this.y=t}}class SQ{constructor(e,t,n){this.y=e,this._left=t,this._right=n}get right(){return new SJ(this._right,this.y)}get left(){return new SJ(this._left,this.y)}get length(){return this._right-this._left}}class S0{constructor(e){this.rect=e}get top(){return new SQ(this.rect.top,this.rect.left,this.rect.right)}get bottom(){return new SQ(this.rect.bottom,this.rect.left,this.rect.right)}}class S1{static fromEdges(e){let{left:t,right:n,top:i,bottom:r}=e;return new S1(t,i,1-t-n,1-i-r)}constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;this.left=e,this.top=t,this.width=n,this.height=i}setTopLeft(e,t){return new S1(e,t,this.width||0,this.height||0)}setSize(e,t){return new S1(this.left||0,this.top||0,e,t)}setCenter(e,t){let n=this.width||0,i=this.height||0;return new S1(e-n/2,t-i/2,n||0,i||0)}get center(){return new SJ(this.left+this.width/2,this.top+this.height/2)}get corners(){return new S0(this)}get right(){return this.left+this.width}get bottom(){return this.top+this.height}multiply(e){return new S1((this.left||0)+this.width*e.left,(this.top||0)+this.height*e.top,this.width*e.width,this.height*e.height)}grow(e){return new S1(this.left-e,this.top-e,this.width+2*e,this.height+2*e)}shrink(e){return this.grow(-e)}cropRelative(e){let t=this.top+e.top*this.height,n=this.left+e.left*this.width,i=this.height*e.height;return new S1(n,t,this.width*e.width,i)}clamp(e){let{left:t,top:n,width:i,height:r}=this;return e.width<i&&(i=e.width,t=e.left),e.height<r&&(r=e.height,n=e.top),t+i>e.left+e.width&&(t=e.right-i),n+r>e.top+e.height&&(n=e.bottom-r),new S1(Math.max(t,e.left),Math.max(n,e.top),i,r)}}let S2=sX()("sanity-imagetool");function S3(e,t,n){return{x:e-n.left,y:t-n.top}}function S4(e){return"touches"in e?e.touches.length>0?{x:e.touches[0].clientX,y:e.touches[0].clientY}:{x:0,y:0}:{x:e.clientX,y:e.clientY}}var S5=Object.freeze,S6=Object.defineProperty,S8=(e,t)=>S5(S6(e,"raw",{value:S5(t||e.slice())}));let S9=class extends lJ.PureComponent{constructor(){super(...arguments),this.domNode=null,this.currentPos=null,this.isDragging=!1,this.handleTouchMove=e=>{this.isDragging&&e.preventDefault()},this.handleDragStart=e=>{let{onDragStart:t,readOnly:n}=this.props;if(n||!this.domNode)return;if(this.isDragging){S2("Start cancelled, already a drag in progress");return}this.isDragging=!0;let i=S4(e);S2("Drag started %o",i),t(S3(i.x,i.y,this.domNode.getBoundingClientRect())),this.currentPos=i},this.handleDrag=e=>{var t;if(!this.isDragging||this.props.readOnly||!this.currentPos)return;let{onDrag:n}=this.props,i=S4(e),r=(t=this.currentPos,{x:i.x-t.x,y:i.y-t.y});n(r),S2("moving by %o",r),this.currentPos=i},this.handleDragEnd=e=>{let{onDragEnd:t,readOnly:n}=this.props;if(!this.isDragging||n||!this.domNode)return;let i=S4(e);t(S3(i.x,i.y,this.domNode.getBoundingClientRect())),this.isDragging=!1,this.currentPos=null,S2("Done moving %o",i)},this.handleDragCancel=()=>{if(!this.isDragging||this.props.readOnly||!this.currentPos||!this.domNode)return;let{onDragEnd:e}=this.props;this.isDragging=!1,e(S3(this.currentPos.x,this.currentPos.y,this.domNode.getBoundingClientRect())),this.currentPos=null},this.setDomNode=e=>{this.domNode=e}}componentDidMount(){cP?(document.body.addEventListener("touchmove",this.handleTouchMove,{passive:!1}),document.body.addEventListener("touchend",this.handleDragEnd),document.body.addEventListener("touchcancel",this.handleDragCancel)):(document.body.addEventListener("mousemove",this.handleDrag),document.body.addEventListener("mouseup",this.handleDragEnd),document.body.addEventListener("mouseleave",this.handleDragCancel))}componentWillUnmount(){cP?(document.body.removeEventListener("touchmove",this.handleTouchMove),document.body.removeEventListener("touchend",this.handleDragEnd),document.body.removeEventListener("touchcancel",this.handleDragCancel)):(document.body.removeEventListener("mousemove",this.handleDrag),document.body.removeEventListener("mouseup",this.handleDragEnd),document.body.removeEventListener("mouseleave",this.handleDragCancel))}render(){let{readOnly:e,onDragStart:t,onDragEnd:n,onDrag:i,...r}=this.props;return(0,lG.jsx)("canvas",{ref:this.setDomNode,onTouchStart:e?void 0:this.handleDragStart,onMouseDown:e?void 0:this.handleDragStart,onTouchMove:e?void 0:this.handleDrag,...r})}},S7=a0.ZP.div(ih||(ih=S8(["\n  width: 100%;\n  height: 100%;\n  position: relative;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n"]))),Te=(0,a0.ZP)(S9)(im||(im=S8(["\n  display: block;\n  position: relative;\n  max-width: calc(100% - 0.5em); /* to prevent overlap with change bar */\n  max-height: calc(100% + 1em);\n  user-select: none;\n"]))),Tt={x:.5,y:.5,height:1,width:1},Tn={top:0,left:0,right:0,bottom:0};function Ti(e,t){let{top:n,right:i,bottom:r,left:l}=e.crop||Tn;return{value:{hotspot:e.hotspot,crop:{top:n+(t.top||0)>0?n:0,right:i+(t.right||0)>0?i:0,bottom:r+(t.bottom||0)>0?r:0,left:l+(t.left||0)>0?l:0}},delta:{top:n+(t.top||0)>0&&t.top||0,right:i+(t.right||0)>0&&t.right||0,bottom:r+(t.bottom||0)>0&&t.bottom||0,left:l+(t.left||0)>0&&t.left||0}}}let Tr=oo()(()=>{let e=window.devicePixelRatio||1,t=document.createElement("canvas").getContext("2d");return e/(t&&(-1===SW&&(SW=SH.find(e=>e in t)),SW&&t[SW])||1)}),Tl=["left","right","top","topLeft","topRight","bottom","bottomLeft","bottomRight"];class Ta extends lJ.PureComponent{constructor(){super(...arguments),this.state={cropping:!1,cropMoving:!1,moving:!1,resizing:!1,mousePosition:null},this.handleDragStart=e=>{let{x:t,y:n}=e,i={x:t*this.getScale(),y:n*this.getScale()},r=S$(i,this.getHotspotRect()),l=SX(i,this.getDragHandleCoords()),a=this.getActiveCropHandleFor(i),o=SG(i,this.getCropRect());a?this.setState({cropping:a}):l?this.setState({resizing:!0}):r?this.setState({moving:!0}):o&&this.setState({cropMoving:!0})},this.handleDrag=e=>{this.state.cropping?this.emitCrop(this.state.cropping,e):this.state.cropMoving?this.emitCropMove(e):this.state.moving?this.emitMove(e):this.state.resizing&&this.emitResize(e)},this.handleDragEnd=()=>{let{onChange:e,onChangeEnd:t}=this.props;this.setState({moving:!1,resizing:!1,cropping:!1,cropMoving:!1});let{hotspot:n,crop:i}=this.getClampedValue(),r=function(e){let t=e.top>e.bottom,n=e.left>e.right;return{top:t?e.bottom:e.top,bottom:t?e.top:e.bottom,left:n?e.right:e.left,right:n?e.left:e.right}}(i),l={crop:{top:r.top,bottom:1-r.bottom,left:r.left,right:1-r.right},hotspot:{x:n.center.x,y:n.center.y,height:Math.abs(n.height),width:Math.abs(n.width)}};e(l),t&&t(l)},this.handleMouseOut=()=>{this.setState({mousePosition:null})},this.handleMouseMove=e=>{let t=e.currentTarget.getBoundingClientRect();this.setState({mousePosition:{x:(e.clientX-t.left)*this.getScale(),y:(e.clientY-t.top)*this.getScale()}})},this.setCanvas=e=>{this.canvas=e}}getHotspotRect(){let{value:e,image:t}=this.props,n=e.hotspot||Tt,i=new S1().setSize(n.width,n.height).setCenter(n.x,n.y);return new S1().setSize(t.width,t.height).shrink(8*this.getScale()).multiply(i)}getCropRect(){let{value:e,image:t}=this.props;return new S1().setSize(t.width,t.height).shrink(8*this.getScale()).cropRelative(S1.fromEdges(e.crop||Tn).clamp(new S1(0,0,1,1)))}getCropHandles(){let e=this.getCropRect(),t=12*this.getScale(),n=t/2,i=new S1(0,0,t,t);return{left:i.setTopLeft(e.left-n,e.center.y-n),right:i.setTopLeft(e.right-n,e.center.y-n),top:i.setTopLeft(e.center.x-n,e.top-n),topLeft:i.setTopLeft(e.left-n,e.top-n),topRight:i.setTopLeft(e.right-n,e.top-n),bottom:i.setTopLeft(e.center.x-n,e.bottom-n),bottomLeft:i.setTopLeft(e.left-n,e.bottom-n),bottomRight:i.setTopLeft(e.right-n,e.bottom-n)}}getActiveCropHandleFor(e){let{x:t,y:n}=e,i=this.getCropHandles();for(let e of Tl)if(SG({x:t,y:n},i[e]))return e;return!1}emitMove(e){let{image:t,value:n,onChange:i}=this.props,r=this.getScale();i(function(e,t){let n=e&&e.hotspot||Tt;return{...e,hotspot:{...n,x:n.x+t.x,y:n.y+t.y}}}(n,{x:e.x*r/t.width,y:e.y*r/t.height}))}emitCropMove(e){let{image:t,onChange:n,value:i}=this.props,r=this.getScale(),l=e.x*r/t.width,a={left:l,right:-e.x*r/t.width,top:e.y*r/t.height,bottom:-e.y*r/t.height};!i||!i.crop||i.crop.top+a.top<0||i.crop.left+a.left<0||i.crop.right+a.right<0||i.crop.bottom+a.bottom<0||n(To(i,a))}emitCrop(e,t){let{image:n,onChange:i,value:r}=this.props,l=this.getScale(),a=0,o=0,s=0,d=0;"left"==e||"topLeft"===e||"bottomLeft"===e?a=t.x*l/n.width:("right"==e||"topRight"===e||"bottomRight"===e)&&(o=-t.x*l/n.width),"top"==e||"topLeft"===e||"topRight"===e?s=t.y*l/n.height:("bottom"==e||"bottomLeft"===e||"bottomRight"===e)&&(d=-t.y*l/n.height);let c={left:a,right:o,top:s,bottom:d};i(To(Ti(r,c).value,Ti(r,c).delta))}emitResize(e){let{image:t,onChange:n,value:i}=this.props,r=this.getScale(),l={x:e.x*r*2/t.width,y:e.y*r*2/t.height};n(function(e,t){let n=e&&e.hotspot||Tt;return{...e,hotspot:{...n,height:n.height+t.height,width:n.width+t.width}}}(i,{height:l.y,width:l.x}))}getClampedValue(){let e=this.props.value,t=S1.fromEdges(e.crop||Tn).clamp(new S1(0,0,1,1)),n=e.hotspot||Tt,i=new S1(0,0,1,1).setSize(n.width,n.height).setCenter(n.x,n.y).clamp(t);return{crop:t,hotspot:i}}paintHotspot(e,t){let{image:n,readOnly:i}=this.props,r=new S1().setSize(n.width,n.height),{hotspot:l,crop:a}=this.getClampedValue(),o=this.getScale(),s=8*o;function d(t,i,r,l,a,o,s,d){e.save(),e.drawImage(n,t,i,r,l,a,o,s,d),e.restore()}e.save(),function(){let t=r.cropRelative(a),n=r.shrink(s).cropRelative(a);e.save(),d(t.left,t.top,t.width,t.height,n.left,n.top,n.width,n.height),e.globalAlpha=.5,e.fillStyle="black",e.fillRect(n.left,n.top,n.width,n.height),e.restore()}(),function(){e.save();let n=r.shrink(s).multiply(l),i=n.height/n.width;e.scale(1,i),e.beginPath(),e.globalAlpha=t,e.arc(n.center.x,n.center.y/i,Math.abs(n.width/2),0,2*Math.PI,!1),e.strokeStyle="white",e.lineWidth=1.5*o,e.stroke(),e.closePath(),e.restore()}(),e.clip(),function(){let e=r.multiply(l),t=r.shrink(s).multiply(l);d(e.left,e.top,e.width,e.height,t.left,t.top,t.width,t.height)}(),e.restore(),i||function(t){e.save();let n=10*o,i=SY(t,r.shrink(s).multiply(l));e.beginPath(),e.arc(i.x,i.y,n,0,2*Math.PI,!1),e.fillStyle="rgb(255,255,255)",e.fill(),e.closePath(),e.restore(),e.beginPath(),e.arc(i.x,i.y,n,0,2*Math.PI,!1),e.strokeStyle="rgb(0, 0, 0)",e.lineWidth=.5*o,e.stroke(),e.closePath()}(1.25*Math.PI)}getActualSize(){var e;let t=null==(e=this.canvas)?void 0:e.domNode;return t?{height:t.clientHeight,width:t.clientWidth}:{height:0,width:0}}getDragHandleCoords(){let e=SY(1.25*Math.PI,this.getHotspotRect());return{x:e.x,y:e.y,radius:8*this.getScale()}}debug(e){e.save();let{image:t}=this.props,n=this.getHotspotRect(),i=this.getScale(),r=8*i;function l(e){o(e,r,e,t.height-r)}function a(e){o(r,e,t.width-r,e)}function o(t,n,i,r){e.beginPath(),e.moveTo(t,n),e.lineTo(i,r),e.stroke(),e.closePath()}e.setLineDash&&e.setLineDash([2*i,2*i]),e.lineWidth=.5*i,e.strokeStyle="rgba(200, 200, 200, 0.5)",l(n.center.x),a(n.center.y),e.strokeStyle="rgba(150, 150, 150, 0.5)",a(n.top),a(n.bottom),l(n.left),l(n.right),e.restore()}paintBackground(e){let{image:t}=this.props,n=new S1().setSize(t.width,t.height).shrink(8*this.getScale());e.save(),e.fillStyle="white",e.clearRect(0,0,t.width,t.height),e.globalAlpha=.3,e.drawImage(t,n.left,n.top,n.width,n.height),e.restore()}paint(e){let{readOnly:t}=this.props;e.save();let n=Tr();e.scale(n,n);let i=!t&&this.state.mousePosition?.8:.2;this.paintBackground(e),this.paintHotspot(e,i),this.debug(e),this.paintCropBorder(e),t||this.highlightCropHandles(e,i),e.restore()}paintMousePosition(e){if(!this.state.mousePosition)return;let{x:t,y:n}=this.state.mousePosition;e.beginPath(),e.arc(t,n,14*this.getScale(),0,2*Math.PI,!1),e.fillStyle="lightblue",e.fill(),e.restore()}paintCropBorder(e){let t=this.getCropRect();e.save(),e.beginPath(),e.fillStyle="rgba(66, 66, 66, 0.9)",e.lineWidth=1,e.rect(t.left,t.top,t.width,t.height),e.stroke(),e.closePath(),e.restore()}highlightCropHandles(e,t){e.save();let n=this.getCropHandles();Tl.forEach(i=>{e.fillStyle=this.state.cropping===i?"rgba(202, 54, 53, ".concat(t,")"):"rgba(230, 230, 230, ".concat(t+.4,")");let{left:r,top:l,height:a,width:o}=n[i];e.fillRect(r,l,o,a),e.beginPath(),e.fillStyle="rgba(66, 66, 66, ".concat(t,")"),e.rect(r,l,o,a),e.closePath(),e.stroke()}),e.restore()}getScale(){let e=this.getActualSize();return this.props.image.width/e.width}getCursor(){let{mousePosition:e}=this.state,{readOnly:t}=this.props;if(!e||t)return"auto";let n=this.state.cropping||this.getActiveCropHandleFor(e);if(n)return function(e){switch(e){case"left":case"right":return"col-resize";case"top":case"bottom":return"row-resize";case"topRight":case"bottomLeft":return"nesw-resize";case"topLeft":case"bottomRight":return"nwse-resize";default:return null}}(n)||"auto";let i=SX(e,this.getDragHandleCoords());if(this.state.resizing||i)return"move";if(this.state.moving||this.state.cropMoving)return"url(".concat("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAQAAADZc7J/AAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAAAmJLR0QA/4ePzL8AAABdSURBVEjH7ZA7DsAwCEMN6v2vTCdESpLKQRl5gxfzMQDNRQyWlEK83QAIRh3cH/QbIhQwMDl8gORl7A16WD/xxAdq6N6SgycKUblf41+wbFBT44RiCi11NU3TLHgBxRUUD4ITqnIAAAAldEVYdGRhdGU6Y3JlYXRlADIwMTUtMDEtMjFUMDA6MTM6NDMrMDE6MDC74T7AAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDEyLTA0LTAyVDA0OjEzOjM3KzAyOjAwQJ35wQAAAABJRU5ErkJggg==","), move");let r=S$(e,this.getHotspotRect()),l=SG(e,this.getCropRect());return r||l?"url(".concat("data:image/png;base64,AAACAAEAICACAAcABQAwAQAAFgAAACgAAAAgAAAAQAAAAAEAAQAAAAAAAAEAAAAAAAAAAAAAAgAAAAAAAAAAAAAA////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD8AAAA/AAAAfwAAAP+AAAH/gAAB/8AAA//AAAd/wAAGf+AAAH9gAADbYAAA2yAAAZsAAAGbAAAAGAAAAAAAAA//////////////////////////////////////////////////////////////////////////////////////gH///4B///8Af//+AD///AA///wAH//4AB//8AAf//AAD//5AA///gAP//4AD//8AF///AB///5A////5///8=","), move"):"auto"}componentDidMount(){this.draw()}componentDidUpdate(){this.draw()}draw(){if(!this.canvas)return;let e=this.canvas.domNode,t=e.getContext("2d");if(!t)return;this.paint(t);let n=e.style.cursor,i=this.getCursor();n!==i&&(e.style.cursor=i)}render(){let{image:e,readOnly:t}=this.props,n=Tr();return(0,lG.jsx)(S7,{children:(0,lG.jsx)(Te,{readOnly:t,ref:this.setCanvas,onDrag:this.handleDrag,onDragStart:this.handleDragStart,onDragEnd:this.handleDragEnd,onMouseMove:this.handleMouseMove,onMouseOut:this.handleMouseOut,height:e.height*n,width:e.width*n})})}}function To(e,t){let n=e&&e.crop||Tn;return{...e,crop:{left:n.left+(t.left||0),right:n.right+(t.right||0),top:n.top+(t.top||0),bottom:n.bottom+(t.bottom||0)}}}function Ts(e){let{image:t,maxHeight:n,maxWidth:i,children:r}=e,[l]=(0,lJ.useState)(()=>{let e=document.createElement("canvas");return e.style.display="none",e});return(0,lJ.useEffect)(()=>(document.body.appendChild(l),()=>{document.body.removeChild(l)}),[l]),r((0,lJ.useCallback)((e,t,n)=>{let i=e.width/e.height,r=Math.min(e.width,n),a=Math.min(e.height,t),o=e.width>e.height,s=o?r:a*i,d=o?r/i:a;l.width=s,l.height=d;let c=l.getContext("2d");return c&&c.drawImage(e,0,0,e.width,e.height,0,0,s,d),l},[l])(t,n,i))}function Td(e){return(0,lG.jsx)(SK,{src:e.src,children:t=>{let{isLoading:n,image:i,error:r}=t;return n?(0,lG.jsx)("div",{children:"Loading..."}):r?(0,lG.jsx)("div",{children:r.message}):i?(0,lG.jsx)(Ts,{image:i,maxHeight:Td.maxHeight,maxWidth:Td.maxWidth,children:t=>(0,lG.jsx)(Ta,{image:t,...e})}):null}})}function Tc(e){if(!e)return null;if("aspectRatio"in e)return e.aspectRatio;if("height"in e||"width"in e){if("number"!=typeof e.height&&"number"!=typeof e.width)throw Error("Height and width must be numbers, got ".concat(JSON.stringify(e)));return e.width/e.height}return null}function Tu(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2,n=Math.pow(10,t);return Math.round(e*n)/n}function Tp(e){return 0===e?0:"".concat(e,"%")}function Th(e){return Tp(Tu(100*e))}Td.maxHeight=500,Td.maxWidth=1e3;var Tf=Object.freeze,Tm=Object.defineProperty;let Tg=a0.ZP.div(ig||(ig=Tf(Tm(q=["\n  position: relative;\n  width: 100%;\n"],"raw",{value:Tf(q.slice())})))),Tx=sX()("sanity-imagetool"),Tv=(0,lJ.memo)(function(e){let{alignX:t="center",alignY:n="center",alt:i,aspectRatio:r="none",className:l="",crop:a=Tn,hotspot:o=Tt,onError:s,onLoad:d,src:c,srcAspectRatio:u,srcSet:p,style:h}=e,[f,m]=(0,lJ.useState)(null),g=(0,lJ.useRef)(null),x=(0,lJ.useRef)(null),v=(0,lJ.useCallback)(()=>{if(g.current){if("auto"===r){let e=g.current.parentNode;(0,lJ.startTransition)(()=>m(e.offsetWidth/e.offsetHeight))}else m(null)}},[r]);(0,lJ.useEffect)(()=>{let e=x.current;return e&&e.src&&e.complete&&void 0!==e.naturalWidth&&(Tx("Image '%s' already loaded, refreshing (from cache) to trigger onLoad / onError",c),e.src=e.src),v(),window.addEventListener("resize",v),()=>{window.removeEventListener("resize",v)}},[c,v]);let b=(0,lJ.useMemo)(()=>"none"===r?a?function(e,t){let n=1/t,i=t*n;return(i-(e.left+e.right)*i)/(n-(e.top+e.bottom)*n)}(a,u):u:"auto"===r?f:r||null,[r,f,a,u]),y=(0,lJ.useMemo)(()=>(function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=Tc(e.image)||1,n=e.hotspot||Tt,i=e.crop||Tn,r=Tc(e.container)||t*function(e){let t=1-e.top-e.bottom;return(1-e.left-e.right)/t}(i),l=function(e,t,n){let i,r,l;let a=t.crop,o=n.aspect,s=n.align,d=1-a.left-a.right,c=1-a.top-a.bottom,u={top:-a.top/c,left:-a.left/d,width:1/d,height:1/c},p=d/c*e,h={x:(t.hotspot.x-a.left)/d,y:(t.hotspot.y-a.top)/c,height:t.hotspot.height/c,width:t.hotspot.width/d},f=Math.min(1/h.width,1/h.height*p/o),m=p<=o;if((i=m?1:p/o)>f){let e;r="letterbox";let t=i-f;l={width:e=m?1-t:f,height:e/p*o,left:0,top:0};let n=h.x*l.width-h.width*l.width/2;switch(s.x){case"left":l.left=m?0:-n;break;case"right":l.left=m?1-l.width:n;break;case"center":l.left=m?(1-l.width)/2:-n;break;default:throw Error("Invalid x alignment: '".concat(s.x,"'. Must be either 'left', 'right' or 'center'"))}let a=h.y*l.height-h.height*l.height/2;switch(s.y){case"top":l.top=m?-a:0;break;case"bottom":l.top=a;break;case"center":l.top=m?-a:(1-l.height)/2;break;default:throw Error("Invalid y alignment: '".concat(s.y,"'. Must be either 'top', 'bottom' or 'center'"))}}else if(m){r="full_width";let e=-h.y/p*o+.5,t=i/p*o;e>0?e=0:-e>t-1&&(e=-(t-1)),l={width:i,height:t,left:0,top:e}}else{r="full_height";let e=.5-h.x*i;e>0?e=0:-e>i-1&&(e=-(i-1)),l={width:i,height:i/p*o,top:0,left:e}}return{method:r,crop:l,image:u}}(t,{hotspot:n,crop:i},{aspect:r,align:e.align||{x:"center",y:"center"}}),a=Tp(Tu(100/r));return{debug:{result:l},container:{overflow:"hidden",position:"relative",width:"100%",height:a},padding:{marginTop:a},crop:{position:"absolute",overflow:"hidden",height:Th(l.crop.height),width:Th(l.crop.width),top:Th(l.crop.top),left:Th(l.crop.left)},image:{position:"absolute",height:Th(l.image.height),width:Th(l.image.width),top:Th(l.image.top),left:Th(l.image.left)}}})({container:{aspectRatio:b||u},image:{aspectRatio:u},hotspot:o,crop:a,align:{x:t,y:n}}),[t,n,a,o,u,b]);return(0,lG.jsx)(Tg,{className:"".concat(l),style:h,ref:g,children:(0,lG.jsxs)("div",{style:y.container,children:[(0,lG.jsx)("div",{style:y.padding}),(0,lG.jsx)("div",{style:y.crop,children:(0,lG.jsx)("img",{ref:x,src:c,alt:i,srcSet:p,onLoad:d,onError:s,style:y.image})})]})})}),Tb={isLoading:!0};var Ty=Object.freeze,Tj=Object.defineProperty;let Tw=["hotspot"],Tk=[["3:4",3/4],["Square",1],["16:9",16/9],["Panorama",4]],TC={crop:Tn,hotspot:Tt},T_=a0.ZP.div(ix||(ix=Ty(Tj(N=["\n  min-height: 6em;\n"],"raw",{value:Ty(N.slice())}))));function TS(e){return(0,lG.jsx)(l4.kC,{align:"center",justify:"center",padding:4,style:{overflowWrap:"break-word"},children:e.children})}function TT(e){let{imageUrl:t,value:n,changed:i,level:r,path:l,focusPath:a=ch,presence:o,onChange:s,schemaType:d,onPathFocus:c,readOnly:u,elementProps:p}=e,[h,f]=(0,lJ.useState)(n||TC),{image:m,isLoading:g,error:x}=function(e){let[t,n]=(0,lJ.useState)(Tb);return(0,lJ.useEffect)(()=>{n(Tb);let t=new al.y(t=>{let n=document.createElement("img"),i=!1;return n.onload=()=>{i=!0,t.next(n),t.complete()},n.onerror=()=>{i=!0,t.error(Error("Could not load image from ".concat(e.startsWith("blob:")?"blob":e)))},n.src=e,()=>{n.onload=null,n.onerror=null,i||(n.src="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=")}}).subscribe({error:e=>{n({isLoading:!1,error:e})},next:e=>{n({image:e,isLoading:!1})}});return()=>{t.unsubscribe()}},[e]),t}(t),v=(0,lJ.useCallback)(()=>{c(Tw)},[c]);(0,lJ.useEffect)(()=>{f(n||TC)},[n]);let b="hotspot"===a[0];m$(b,e=>{var t;!e&&b&&(null==(t=p.ref.current)||t.focus())});let y=(0,lJ.useCallback)(e=>{if(u)return;let t=d.fields.find(e=>"crop"===e.name&&"object"!==e.type.name),n=d.fields.find(e=>"object"!==e.type.name&&"hotspot"===e.name),i=t?{_type:t.type.name,...e.crop||Tn}:e.crop,r=n?{_type:n.type.name,...e.hotspot||Tt}:e.hotspot;s([mL(i,["crop"]),mL(r,["hotspot"])])},[s,u,d.fields]);return(0,lG.jsx)(jy,{title:"Hotspot & crop",level:r,description:"Adjust the rectangle to crop image. Adjust the circle to specify the area that should always be visible.",__unstable_presence:o,children:(0,lG.jsxs)("div",{children:[(0,lG.jsx)(l4.Zb,{__unstable_checkered:!0,__unstable_focusRing:!0,tabIndex:0,ref:p.ref,onFocus:v,children:(0,lG.jsx)(cU,{path:l.concat(Tw),hasFocus:"hotspot"===a[0],isChanged:i,children:(0,lG.jsxs)(SB,{ratio:1.5,children:[(g||x)&&(0,lG.jsx)(TS,{children:x?(0,lG.jsx)(l4.Zb,{padding:4,radius:2,tone:"critical",border:!0,children:(0,lG.jsxs)(l4.xv,{children:["Error: ",x.message]})}):(0,lG.jsx)(l4.xv,{muted:!0,children:"Loading image… "})}),!g&&m&&(0,lG.jsx)(l4.xu,{margin:1,children:(0,lG.jsx)(Td,{value:h,src:m.src,readOnly:!!u,onChangeEnd:y,onChange:f})})]})})}),(0,lG.jsx)(l4.xu,{marginTop:3,children:(0,lG.jsx)(l4.rj,{columns:Tk.length,gap:1,children:Tk.map(e=>{let[t,n]=e;return(0,lG.jsxs)("div",{children:[(0,lG.jsx)(l4.X6,{as:"h4",size:0,children:t}),(0,lG.jsx)(l4.xu,{marginTop:2,children:(0,lG.jsx)(SB,{ratio:n,children:(0,lG.jsx)(l4.Zb,{__unstable_checkered:!0,children:!g&&m?(0,lG.jsx)(Tv,{aspectRatio:n,src:m.src,srcAspectRatio:m.width/m.height,hotspot:h.hotspot||Tt,crop:h.crop||Tn}):(0,lG.jsx)(T_,{})})})})]},n)})})})]})})}var TE=Object.freeze,TP=Object.defineProperty;let TA=(0,a0.ZP)(l4.gF)(iv||(iv=TE(TP(V=["\n  position: absolute;\n  top: 0;\n  right: 0;\n"],"raw",{value:TE(V.slice())}))));function TO(e){let{onEdit:t,children:n,showEdit:i,setHotspotButtonElement:r,setMenuButtonElement:l,onMenuOpen:a,isMenuOpen:o}=e,[s,d]=(0,lJ.useState)(null),[c,u]=(0,lJ.useState)(null),p=(0,lJ.useCallback)(()=>a(!o),[a,o]);(0,l4.qh)((0,lJ.useCallback)(e=>{o&&("Escape"===e.key||"Tab"===e.key)&&(a(!1),null==c||c.focus())},[o,a,c])),(0,l4.O8)((0,lJ.useCallback)(e=>{(null==c?void 0:c.contains(e.target))||a(!1)},[c,a]),[s]);let h=(0,lJ.useCallback)(e=>{l(e),u(e)},[l]);return(0,lJ.useEffect)(()=>{o&&(null==s||s.focus())},[o,s]),(0,lG.jsxs)(TA,{"data-buttons":!0,space:1,padding:2,children:[i&&(0,lG.jsx)(l4.u,{content:(0,lG.jsx)(l4.xv,{size:1,children:"Crop image"}),padding:2,children:(0,lG.jsx)(l4.zx,{"aria-label":"Open image edit dialog","data-testid":"options-menu-edit-details",icon:a8.Rf5,mode:"ghost",onClick:t,ref:r})}),(0,lG.jsx)(l4.J2,{id:"image-actions-menu",content:(0,lG.jsx)(l4.v2,{ref:d,children:n}),portal:!0,open:o,constrainSize:!0,children:(0,lG.jsx)(l4.zx,{"aria-label":"Open image options menu","data-testid":"options-menu-button",icon:a8.zGg,mode:"ghost",onClick:p,ref:h})})]})}var Tz=Object.freeze,TM=Object.defineProperty,TI=(e,t)=>Tz(TM(e,"raw",{value:Tz(t||e.slice())}));let TR=(0,a0.ZP)(l4.Zb)(ib||(ib=TI(["\n  position: relative;\n  width: 100%;\n  overflow: hidden;\n  overflow: clip;\n  min-height: 3.75rem;\n  max-height: 20rem;\n\n  & > div[data-container] {\n    top: 0;\n    left: 0;\n    width: 100%;\n    height: 100%;\n    display: flex !important;\n    align-items: center;\n    justify-content: center;\n  }\n\n  & img {\n    max-width: 100%;\n    max-height: 100%;\n  }\n"]))),TF=(0,a0.ZP)(l4.$j)(iy||(iy=TI(["\n  position: absolute;\n"]))),TD=(0,a0.ZP)(l4.kC)(e=>{let{$drag:t,$tone:n}=e,i=l4.Lg.color.light[n].card.enabled.fg,r=(0,l4.m4)(l4.Lg.color.light[n].card.enabled.bg,.8);return(0,a0.iv)(ij||(ij=TI(["\n    position: absolute;\n    top: 0;\n    left: 0;\n    right: 0;\n    bottom: 0;\n    backdrop-filter: ",";\n    color: ",";\n    background-color: ",";\n  "])),t?"blur(10px)":"",n?i:"",t?r:"transparent")}),TZ=(0,a0.ZP)(l4.kC)(iw||(iw=TI(["\n  position: absolute;\n  top: 0;\n  left: 0;\n  bottom: 0;\n  right: 0;\n"]))),TL=e=>{let t=new URLSearchParams(e.split("?")[1]).get("rect");return t?[t.split(",")[2],t.split(",")[3]].map(Number):e.split("-")[1].split(".")[0].split("x").map(Number)};function Tq(e){let{drag:t,readOnly:n,isRejected:i,src:r,...l}=e,[a,o]=(0,lJ.useState)(!1),[s,d]=(0,lJ.useState)(null),c=(0,l4.XL)(s),u=(null==c?void 0:c.width)||0,p=i||n?"critical":"primary",h=t?p:"default",f=30*document.documentElement.clientHeight/100,[m,g]=TL(r);(0,lJ.useEffect)(()=>{o(!1)},[r]);let x=(0,lJ.useCallback)(()=>{o(!0)},[]);return(0,lG.jsxs)(TR,{...l,ref:d,style:{height:(m>u?u/(m/g):g)<f?null:"".concat(30,"vh")},tone:"transparent",children:[(0,lG.jsxs)(l4.Zb,{"data-container":!0,tone:"inherit",children:[!a&&(0,lG.jsx)(TU,{cardTone:"transparent",drag:!0,content:(0,lG.jsx)(TF,{})}),(0,lG.jsx)("img",{src:r,"data-testid":"hotspot-image-input",alt:e.alt,onLoad:x,referrerPolicy:"strict-origin-when-cross-origin"})]}),t&&(0,lG.jsx)(TU,{cardTone:h,drag:t,content:(0,lG.jsxs)(lG.Fragment,{children:[(0,lG.jsx)(l4.xu,{marginBottom:3,children:(0,lG.jsx)(l4.X6,{children:(0,lG.jsx)(TN,{isRejected:i,readOnly:n})})}),(0,lG.jsx)(TV,{isRejected:i,readOnly:n})]})})]})}function TN(e){let{isRejected:t,readOnly:n}=e;return t?(0,lG.jsx)(a8.vaB,{}):n?(0,lG.jsx)(a8.CPA,{}):(0,lG.jsx)(a8.XBm,{})}function TV(e){let{isRejected:t,readOnly:n}=e,i="Drop image to upload";return t&&(i="Cannot upload this file here"),n&&(i="This field is read only"),(0,lG.jsx)(l4.xv,{size:1,children:i})}function TU(e){let{cardTone:t,drag:n,content:i}=e;return(0,lG.jsx)(TD,{justify:"flex-end",padding:3,$drag:n,$tone:t,children:(0,lG.jsx)(TZ,{direction:"column",align:"center",justify:"center",children:i})})}var TB=Object.freeze,TK=Object.defineProperty;let TH=(0,a0.ZP)(l4.zx)(ik||(ik=TB(TK(U=["\n  width: 100%;\n"],"raw",{value:TB(U.slice())}))));function TW(e){let{onClearValue:t}=e;return(0,lG.jsxs)(l4.Zb,{tone:"caution",padding:4,border:!0,radius:2,children:[(0,lG.jsxs)(l4.kC,{gap:4,marginBottom:4,children:[(0,lG.jsx)(l4.xu,{children:(0,lG.jsx)(l4.xv,{size:1,children:(0,lG.jsx)(a8.foC,{})})}),(0,lG.jsxs)(l4.Kq,{space:3,children:[(0,lG.jsx)(l4.xv,{size:1,weight:"semibold",children:"Invalid image value"}),(0,lG.jsx)(l4.xv,{size:1,children:"The value of this field is not a valid image. Resetting this field will let you choose a new image."})]})]}),(0,lG.jsx)(TH,{icon:a8.X5P,text:"Reset value",onClick:t,mode:"ghost"})]})}let T$=()=>"undefined"!=typeof window&&window.devicePixelRatio?Math.round(Math.max(1,window.devicePixelRatio)):1;function TX(e){let{children:t}=e;return t}let TG=["asset"],TY={portal:!0};class TJ extends lJ.PureComponent{constructor(e){var t;super(e),t=this,this._previewElement=null,this.uploadSubscription=null,this.state={isUploading:!1,selectedAssetSource:null,hoveringFiles:[],isStale:!1,hotspotButtonElement:null,menuButtonElement:null,isMenuOpen:!1},this.toast=null,this.setPreviewElement=e=>{this._previewElement=e},this.setHotspotButtonElement=e=>{this.setState({hotspotButtonElement:e})},this.setMenuButtonElement=e=>{this.setState({menuButtonElement:e})},this.getUploadOptions=e=>{let{schemaType:t,resolveUploader:n}=this.props,i=n&&n(t,e);return i?[{type:t,uploader:i}]:[]},this.uploadWith=function(e,n){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},{schemaType:r,onChange:l,client:a}=t.props,{label:o,title:s,description:d,creditLine:c,source:u}=i,p={metadata:ob()(r,"options.metadata"),storeOriginalFilename:ob()(r,"options.storeOriginalFilename"),label:o,title:s,description:d,creditLine:c,source:u};t.cancelUpload(),t.setState({isUploading:!0}),l(mD({_type:r.name})),t.uploadSubscription=e.upload(a,n,r,p).subscribe({next:e=>{e.patches&&l(e.patches)},error:e=>{var n;console.error(e),null==(n=t.toast)||n.push({status:"error",description:"The upload could not be completed at this time.",title:"Upload failed"}),t.clearUploadStatus()},complete:()=>{l([mq(["hotspot"]),mq(["crop"])]),t.setState({isUploading:!1})}})},this.handleRemoveButtonClick=()=>{let{value:e}=this.props,t=Object.keys(e||{}),n=0===t.filter(e=>!["_type","_key","_upload","asset","crop","hotspot"].includes(e)).length,i=["asset"].concat(t.filter(e=>["crop","hotspot","_upload"].includes(e))).map(e=>mq([e]));this.props.onChange(n&&!this.valueIsArrayElement()?mq():i)},this.handleFieldChange=e=>{let{onChange:t,schemaType:n}=this.props;if(!this.valueIsArrayElement()&&this.eventIsUnsettingLastFilledField(e)){t(mq());return}t(e.prepend(mD({_type:n.name})).patches)},this.eventIsUnsettingLastFilledField=e=>{let t=e.patches[0];if(1!==e.patches.length||"unset"!==t.type)return!1;let n=Object.keys(this.props.value||{}).filter(e=>!["_type","_key","crop","hotspot"].includes(e));return 1===e.patches[0].path.length&&1===n.length&&n[0]===e.patches[0].path[0]},this.valueIsArrayElement=()=>{let{path:e}=this.props;return"string"!=typeof e.slice(-1)[0]},this.handleOpenDialog=()=>{this.props.onPathFocus(["hotspot"])},this.handleCloseDialog=()=>{var e;this.props.onPathFocus([]),null==(e=this.state.hotspotButtonElement)||e.focus()},this.handleSelectAssetFromSource=e=>{let{onChange:t,schemaType:n,resolveUploader:i}=this.props;So({assetFromSource:e,onChange:t,type:n,resolveUploader:i,uploadWith:this.uploadWith,isImage:!0}),this.setState({selectedAssetSource:null})},this.handleFileTargetFocus=e=>{var t;e.currentTarget===e.target&&e.currentTarget===(null==(t=this.props.elementProps.ref)?void 0:t.current)&&this.props.elementProps.onFocus(e)},this.handleFilesOver=e=>{this.setState({hoveringFiles:e.filter(e=>"string"!==e.kind)})},this.handleFilesOut=()=>{this.setState({hoveringFiles:[]})},this.handleCancelUpload=()=>{this.cancelUpload()},this.handleClearUploadState=()=>{this.setState({isStale:!1}),this.clearUploadStatus()},this.handleStaleUpload=()=>{this.setState({isStale:!0})},this.handleClearField=()=>{this.props.onChange([mq(["asset"]),mq(["crop"]),mq(["hotspot"])])},this.handleSelectFiles=e=>{let{directUploads:t,readOnly:n}=this.props,{hoveringFiles:i}=this.state;t&&!n?this.uploadFirstAccepted(e):i.length>0&&this.handleFilesOut()},this.handleSelectImageFromAssetSource=e=>{this.setState({selectedAssetSource:e})},this.handleAssetSourceClosed=()=>{var e;this.setState({selectedAssetSource:null}),null==(e=this.state.menuButtonElement)||e.focus()},this.renderHotspotInput=e=>{let{value:t,changed:n,id:i,imageUrlBuilder:r}=this.props,l=this.isImageToolEnabled()&&t&&t.asset;return(0,lG.jsx)(l4.Vq,{__unstable_autoFocus:!1,header:"Edit hotspot and crop",id:"".concat(i,"_dialog"),onClickOutside:this.handleCloseDialog,onClose:this.handleCloseDialog,width:1,children:(0,lG.jsx)(y5,{children:(0,lG.jsx)(l4.xu,{padding:4,children:(0,lG.jsx)(l4.Kq,{space:5,children:l&&(null==t?void 0:t.asset)&&(0,lG.jsx)(TT,{...this.props,imageUrl:r.image(t.asset).url(),value:t,presence:e.presence,changed:n})})})})})},this.renderPreview=()=>{let{value:e,schemaType:t,readOnly:n,directUploads:i,imageUrlBuilder:r,resolveUploader:l}=this.props;if(!e||!(0,o7.JZ)(e))return null;let{hoveringFiles:a}=this.state,o=a.filter(e=>l(t,e)),s=a.length-o.length,d=r.width(2e3).fit("max").image(e).dpr(T$()).auto("format").url();return(0,lG.jsx)(Tq,{drag:!(null==e?void 0:e._upload)&&a.length>0,isRejected:s>0||!i,readOnly:n,src:d,alt:"Preview of uploaded image"})},this.setToast=e=>{this.toast=e},this._assetPath=e.path.concat(TG)}isImageToolEnabled(){return!0===ob()(this.props.schemaType,"options.hotspot")}clearUploadStatus(){var e;(null==(e=this.props.value)?void 0:e._upload)&&this.props.onChange(mq(["_upload"]))}cancelUpload(){this.uploadSubscription&&(this.uploadSubscription.unsubscribe(),this.clearUploadStatus())}uploadFirstAccepted(e){let{schemaType:t,resolveUploader:n}=this.props,i=e.map(e=>({file:e,uploader:n(t,e)})).find(e=>e.uploader);i&&this.uploadWith(i.uploader,i.file),this.setState({isMenuOpen:!1})}renderAssetMenu(){let{value:e,assetSources:t,schemaType:n,readOnly:i,directUploads:r,imageUrlBuilder:l,observeAsset:a}=this.props,o=null==e?void 0:e.asset;if(!o)return null;let s=ob()(n,"options.accept","image/*"),d=e&&o&&this.isImageToolEnabled(),c=t&&0===t.length?null:(0,lG.jsx)(l4.sN,{icon:a8.W1M,text:"Select",onClick:()=>{this.setState({isMenuOpen:!1}),this.handleSelectImageFromAssetSource(t[0])},disabled:i,"data-testid":"file-input-browse-button"});return t&&t.length>1&&(c=t.map(e=>(0,lG.jsx)(l4.sN,{text:e.title,onClick:()=>{this.setState({isMenuOpen:!1}),this.handleSelectImageFromAssetSource(e)},icon:e.icon||a8.XBm,"data-testid":"file-input-browse-button-".concat(e.name),disabled:i},e.name))),(0,lG.jsx)(_X,{observeAsset:a,reference:o,children:t=>{let n,a,{_id:o,originalFilename:u,extension:p}=t;return(0,o7.JZ)(e)&&(a=l.image(o).forceDownload(u||"download.".concat(p)).url(),n=l.image(o).url()),(0,lG.jsx)(TO,{isMenuOpen:this.state.isMenuOpen,onEdit:this.handleOpenDialog,onMenuOpen:e=>this.setState({isMenuOpen:e}),setHotspotButtonElement:this.setHotspotButtonElement,setMenuButtonElement:this.setMenuButtonElement,showEdit:d,children:(0,lG.jsx)(Sp,{onUpload:this.handleSelectFiles,browse:c,onReset:this.handleRemoveButtonClick,downloadUrl:a,copyUrl:n,readOnly:i,directUploads:r,accept:s})})}})}renderBrowser(){let{assetSources:e,readOnly:t,directUploads:n,id:i}=this.props;return e&&0===e.length?null:e&&e.length>1&&!t&&n?(0,lG.jsx)(l4.j2,{id:"".concat(i,"_assetImageButton"),ref:this.setMenuButtonElement,button:(0,lG.jsx)(l4.zx,{"data-testid":"file-input-multi-browse-button",icon:a8.W1M,iconRight:a8.v4q,mode:"ghost",text:"Select"}),menu:(0,lG.jsx)(l4.v2,{children:e.map(e=>(0,lG.jsx)(l4.sN,{text:e.title,onClick:()=>{this.setState({isMenuOpen:!1}),this.handleSelectImageFromAssetSource(e)},icon:e.icon||a8.XBm,disabled:t,"data-testid":"file-input-browse-button-".concat(e.name)},e.name))}),popover:TY}):(0,lG.jsx)(l4.zx,{fontSize:2,text:"Select",icon:a8.W1M,mode:"ghost",onClick:()=>{this.setState({isMenuOpen:!1}),this.handleSelectImageFromAssetSource(e[0])},"data-testid":"file-input-browse-button",disabled:t})}renderUploadPlaceholder(){let{schemaType:e,readOnly:t,directUploads:n,resolveUploader:i}=this.props,{hoveringFiles:r}=this.state,l=r.filter(t=>i(e,t)),a=r.length-l.length,o=ob()(e,"options.accept","image/*");return(0,lG.jsx)("div",{style:{padding:1},children:(0,lG.jsx)(l4.Zb,{tone:t?"transparent":"inherit",border:!0,padding:3,style:0===r.length?{borderStyle:"dashed"}:{borderStyle:"dashed",borderColor:"transparent"},children:(0,lG.jsx)(Sw,{browse:this.renderBrowser(),onUpload:this.handleSelectFiles,readOnly:t,hoveringFiles:r,acceptedFiles:l,rejectedFilesCount:a,type:"image",accept:o,directUploads:n})})})}renderUploadState(e){var t;let{isUploading:n}=this.state,i=null==(t=this._previewElement)?void 0:t.offsetHeight;return(0,lG.jsx)(Sl,{uploadState:e,onCancel:n?this.handleCancelUpload:void 0,onStale:this.handleStaleUpload,height:i})}renderAssetSource(){let{selectedAssetSource:e}=this.state,{value:t,schemaType:n,observeAsset:i}=this.props,r=ob()(n,"options.accept","image/*");if(!e)return null;let l=e.component;return t&&t.asset?(0,lG.jsx)(_X,{observeAsset:i,reference:t.asset,children:e=>(0,lG.jsx)(l,{selectedAssets:[e],assetType:"image",accept:r,selectionType:"single",onClose:this.handleAssetSourceClosed,onSelect:this.handleSelectAssetFromSource})}):(0,lG.jsx)(l,{selectedAssets:[],selectionType:"single",assetType:"image",accept:r,onClose:this.handleAssetSourceClosed,onSelect:this.handleSelectAssetFromSource})}getFileTone(){let{schemaType:e,value:t,readOnly:n,directUploads:i,resolveUploader:r}=this.props,{hoveringFiles:l}=this.state,a=l.filter(t=>r(e,t)),o=l.length-a.length;return l.length>0&&(o>0||!i)?"critical":(null==t?void 0:t._upload)||n||!(l.length>0)?n?"transparent":(null==t?void 0:t._upload)&&(null==t?void 0:t.asset)?"transparent":"default":"primary"}renderAsset(){let{value:e,readOnly:t,elementProps:n}=this.props,{hoveringFiles:i,isStale:r}=this.state,l=!!((null==e?void 0:e._upload)||(null==e?void 0:e.asset));return!e||void 0===e.asset||(null==e?void 0:e._upload)||(0,o7.JZ)(e)?a=>(0,lG.jsxs)(lG.Fragment,{children:[r&&(0,lG.jsx)(l4.xu,{marginBottom:2,children:(0,lG.jsx)(SS,{onClearStale:this.handleClearUploadState})}),(0,lG.jsx)(cU,{path:a.path.concat(TG),hasFocus:!!a.focused,isChanged:a.changed,children:(null==e?void 0:e._upload)?this.renderUploadState(e._upload):(0,lG.jsxs)(_6,{...n,onFocus:this.handleFileTargetFocus,tabIndex:0,disabled:!!t,onFiles:this.handleSelectFiles,onFilesOver:this.handleFilesOver,onFilesOut:this.handleFilesOut,tone:this.getFileTone(),$border:l||i.length>0,style:{padding:1},sizing:"border",radius:2,children:[!(null==e?void 0:e.asset)&&this.renderUploadPlaceholder(),!(null==e?void 0:e._upload)&&(null==e?void 0:e.asset)&&(0,lG.jsxs)("div",{style:{position:"relative"},ref:this.setPreviewElement,children:[this.renderPreview(),this.renderAssetMenu()]})]})})]}):()=>(0,lG.jsx)(TW,{onClearValue:this.handleClearField})}render(){let{focusPath:e,members:t,renderAnnotation:n,renderBlock:i,renderField:r,renderInlineBlock:l,renderInput:a,renderItem:o,renderPreview:s}=this.props,{selectedAssetSource:d}=this.state,c=t.find(e=>"field"===e.kind&&"hotspot"===e.name);return(0,lG.jsxs)(l4.Kq,{space:5,"data-testid":"image-input",children:[(0,lG.jsx)(p9,{ref:this.setToast}),t.map(e=>"field"===e.kind&&("crop"===e.name||"hotspot"===e.name)?null:"field"===e.kind?(0,lG.jsx)(kd,{member:e,renderAnnotation:n,renderBlock:i,renderInlineBlock:l,renderInput:"asset"===e.name?this.renderAsset():a,renderField:"asset"===e.name?TX:r,renderItem:o,renderPreview:s},e.key):"fieldSet"===e.kind?(0,lG.jsx)(kC,{member:e,renderAnnotation:n,renderBlock:i,renderField:r,renderInlineBlock:l,renderInput:a,renderItem:o,renderPreview:s},e.key):"error"===e.kind?(0,lG.jsx)(kk,{member:e},e.key):(0,lG.jsxs)(lG.Fragment,{children:["Unknown member kind: $",e.kind]})),c&&"hotspot"===e[0]&&(0,lG.jsx)(kF,{...this.props,absolutePath:c.field.path,renderInput:this.renderHotspotInput}),d&&this.renderAssetSource()]})}}let TQ=()=>{},T0={isLoading:!0,result:void 0,error:void 0,retry:TQ},T1={isLoading:!1,result:void 0,error:void 0,retry:TQ};function T2(e,t){let[n,i]=(0,lJ.useState)(0),r=(0,lJ.useCallback)(()=>{i(e=>e+1)},[]),l=(0,lJ.useMemo)(()=>({_id:e._id,_type:e._type}),[e._id,e._type]),a=(0,l5.m2)(()=>l._id?t(l).pipe((0,ag.U)(e=>({isLoading:!1,result:e,error:void 0,retry:r,retryAttempt:n})),(0,ak.O)(T0),(0,av.K)(e=>(console.error(e),(0,l6.of)({isLoading:!1,result:void 0,error:e,retry:r,retryAttempt:n})))):(0,l6.of)(T1),[l,t,r,n],T0);return mW(e._id,e._id)!==e._id?T0:a}var T3=Object.freeze,T4=Object.defineProperty,T5=(e,t)=>T3(T4(e,"raw",{value:T3(t||e.slice())}));let T6=(0,a0.ZP)(l4.kC)(iC||(iC=T5(["\n  /* this is a hack to avoid layout jumps while previews are loading\n  or the message is not tall enough to fill the card\n  there's probably better ways of solving this */\n  min-height: 36px;\n"]))),T8=(0,a0.ZP)(l4.kC)(i_||(i_=T5(["\n  /* This limits the width of the tooltip content */\n  max-width: 250px;\n"])));function T9(e){return(0,lG.jsx)(T8,{padding:3,children:(0,lG.jsx)(l4.xu,{flex:1,children:(0,lG.jsx)(l4.xu,{children:(0,lG.jsx)(l4.xv,{as:"p",size:1,children:e.children})})})})}function T7(e){var t,n,i;let{refType:r,showStudioUrlIcon:l,hasStudioUrl:a,showTypeLabel:o,availability:s,preview:d,id:c,dataset:u,projectId:p}=e,h=(null==s?void 0:s.reason)==="NOT_FOUND",f=(null==s?void 0:s.reason)==="PERMISSION_DENIED",m=null==(t=d.published)?void 0:t.media,g=(0,lJ.useMemo)(()=>{if(m){let e=void 0!==(null==m?void 0:m.asset)&&(0,o7.JZ)(m),t=lJ.isValidElement(m);return e||t?function(e){let{dimensions:n}=e;return t?m:(0,lG.jsx)("img",{src:o9()({dataset:u,projectId:p}).image(m).withOptions(n).url(),alt:"Image preview of referenced document",referrerPolicy:"strict-origin-when-cross-origin"})}:null}return(null==r?void 0:r.icon)?(0,lJ.createElement)(r.icon):null},[m,u,p,null==r?void 0:r.icon]);return(0,lG.jsxs)(T6,{align:"center",justify:"center",flex:1,"data-testid":"preview",children:[(null==s?void 0:s.available)?(0,lG.jsx)(l4.xu,{flex:1,children:(0,lG.jsx)(u5,{title:null==(n=d.published)?void 0:n.title,subtitle:null==(i=d.published)?void 0:i.subtitle,media:g||!1})}):(0,lG.jsx)(l4.xu,{flex:1,children:(0,lG.jsx)(l4.kC,{align:"center",children:(0,lG.jsx)(l4.xu,{flex:1,paddingY:2,children:(0,lG.jsx)(l4.xv,{muted:!0,children:"Document unavailable"})})})}),(0,lG.jsx)(l4.xu,{paddingLeft:3,children:(0,lG.jsxs)(l4.gF,{space:4,children:[r&&o&&(0,lG.jsx)(l4.__,{size:1,muted:!0,children:r.title||r.type}),(f||h)&&(0,lG.jsx)(l4.xu,{children:(0,lG.jsx)(l4.u,{portal:!0,content:h?(0,lG.jsxs)(T9,{children:["The referenced document no longer exist and might have been deleted.",(0,lG.jsx)("br",{}),"(id: ",(0,lG.jsx)("code",{children:c}),")"]}):(0,lG.jsx)(T9,{children:"The referenced document could not be accessed due to insufficient permissions"}),children:(0,lG.jsx)(p6,{tone:"default",children:f?(0,lG.jsx)(a8.vaB,{}):(0,lG.jsx)(a8.BHU,{})})})}),!(h||f)&&l&&(0,lG.jsx)(l4.xu,{children:(0,lG.jsx)(l4.u,{portal:!0,content:(0,lG.jsx)(T8,{padding:2,children:a?(0,lG.jsx)(l4.xv,{size:1,children:"This document opens in a new tab"}):(0,lG.jsxs)(l4.xv,{size:1,children:["This document cannot be opened ",(0,lG.jsx)("br",{})," (unable to resolve URL to Studio)"]})}),children:(0,lG.jsx)(p6,{size:1,tone:"default",muted:!a,children:(0,lG.jsx)(a8.buG,{})})})})]})})]})}function Ee(){return qJ(fT).config().projectId}function Et(e){var t;let{isLoading:n,result:i,error:r}=T2(e.document,e.getReferenceInfo),l=Ee();if(n)return(0,lG.jsxs)(l4.Kq,{space:2,padding:1,children:[(0,lG.jsx)(l4.Qr,{style:{maxWidth:320},radius:1,animated:!0}),(0,lG.jsx)(l4.Qr,{style:{maxWidth:200},radius:1,size:1,animated:!0})]});if(r)return(0,lG.jsx)(l4.Kq,{space:2,padding:1,children:(0,lG.jsxs)(mH,{title:"Failed to load referenced document",children:["Error: ",r.message]})});if(!i)return null;if((null==(t=i.availability)?void 0:t.reason)==="PERMISSION_DENIED")return(0,lG.jsx)(l4.Kq,{space:2,padding:1,children:"Insufficient permissions to view this document"});let a=e.referenceType.to.find(e=>e.type===i.type);return a?i&&a&&(0,lG.jsx)(T7,{id:i.id,availability:i.availability,preview:i.preview,refType:a,dataset:e.referenceType.dataset,projectId:l,showTypeLabel:e.referenceType.to.length>1}):(0,lG.jsxs)(l4.Kq,{space:2,padding:1,children:["Search returned a type that's not valid for this reference: \"$",i.type,'"']})}function En(e){var t,n;let{value:i,type:r,showStudioUrlIcon:l,hasStudioUrl:a,referenceInfo:o}=e,s=Ee();if(o.isLoading||o.error)return(0,lG.jsxs)(l4.Kq,{space:2,padding:1,children:[(0,lG.jsx)(l4.Qr,{style:{maxWidth:320},radius:1,animated:!o.error}),(0,lG.jsx)(l4.Qr,{style:{maxWidth:200},radius:1,size:1,animated:!o.error})]});let d=r.to.length>1,c=null==(t=o.result)?void 0:t.type,u=r.to.find(e=>e.type===c);return(null==(n=o.result.availability)?void 0:n.available)&&!u?(0,lG.jsx)(l4.Kq,{space:2,padding:2,children:(0,lG.jsxs)(l4.xv,{as:"p",children:["The referenced document is of invalid type: (",c||"unknown",")",(0,lG.jsx)("pre",{children:JSON.stringify(i,null,2)})]})}):(0,lG.jsx)(T7,{availability:o.result.availability,hasStudioUrl:a,showStudioUrlIcon:l,preview:o.result.preview,refType:u,projectId:s,dataset:r.dataset,id:i._ref,showTypeLabel:d})}var Ei=Object.freeze,Er=Object.defineProperty,El=(e,t)=>Ei(Er(e,"raw",{value:Ei(t||e.slice())}));let Ea=(0,a0.ZP)(l4.J2)(iS||(iS=El(["\n  & > div {\n    overflow: auto;\n    -webkit-overflow-scrolling: touch;\n  }\n"]))),Eo=(0,a0.ZP)(l4.xv)(iT||(iT=El(["\n  word-break: break-word;\n"]))),Es=["top-start","bottom-start"],Ed=(0,lJ.forwardRef)(function(e,t){let n=e.options&&e.options.length>0,i=(0,lJ.useCallback)((t,i)=>{let{content:r,hidden:l,inputElement:a,onMouseEnter:o,onMouseLeave:s}=t;return(0,lG.jsx)(Ea,{"data-testid":"autocomplete-popover",placement:"bottom-start",fallbackPlacements:Es,arrow:!1,constrainSize:!0,onMouseEnter:o,onMouseLeave:s,content:(0,lG.jsx)("div",{ref:i,children:n?r:(0,lG.jsx)(l4.xu,{padding:4,children:(0,lG.jsx)(l4.kC,{align:"center",height:"fill",justify:"center",children:(0,lG.jsxs)(Eo,{align:"center",muted:!0,children:["No results for ",(0,lG.jsxs)("strong",{children:["“",e.searchString,"”"]})]})})})}),open:!e.loading&&!l,ref:e.portalRef,portal:!0,referenceElement:e.referenceElement||a,matchReferenceWidth:!0})},[n,e.searchString,e.loading,e.portalRef,e.referenceElement]);return(0,lG.jsx)(l4.F2,{...e,ref:t,renderPopover:i})});var Ec=Object.freeze,Eu=Object.defineProperty;let Ep=(0,a0.ZP)(l4.zx)(iE||(iE=Ec(Eu(B=["\n  width: 100%;\n"],"raw",{value:Ec(B.slice())}))));function Eh(e){let{value:t,onClearValue:n}=e,i=(0,lJ.useMemo)(()=>!!(null==t?void 0:t._ref),[null==t?void 0:t._ref]);return(0,lG.jsxs)(l4.Zb,{tone:"caution",padding:4,border:!0,radius:2,"data-testid":"alert-cross-dataset-reference-feature-disabled",children:[(0,lG.jsxs)(l4.kC,{gap:4,marginBottom:i?4:void 0,children:[(0,lG.jsx)(l4.xu,{children:(0,lG.jsx)(l4.xv,{size:1,children:(0,lG.jsx)(a8.foC,{})})}),(0,lG.jsxs)(l4.Kq,{space:3,children:[(0,lG.jsx)(l4.xv,{as:"h2",size:1,weight:"semibold",children:"Unavailable feature: Cross dataset reference"}),i&&(0,lG.jsxs)(l4.Kq,{space:3,children:[(0,lG.jsxs)(l4.xv,{as:"p",size:1,children:["This feature has been disabled. Read how to enable it in"," ",(0,lG.jsx)("a",{href:"https://www.sanity.io/docs/cross-dataset-references",target:"_blank",rel:"noreferrer",children:"documentation"})]}),(0,lG.jsx)(l4.xv,{as:"p",size:1,children:"You can still clear this field's existing reference, but that cannot be revoked as long as the feature is disabled."})]}),!i&&(0,lG.jsxs)(l4.xv,{as:"p",size:1,children:["Read how to enable it in"," ",(0,lG.jsx)("a",{href:"https://www.sanity.io/docs/cross-dataset-references",target:"_blank",rel:"noreferrer",children:"documentation"})]})]})]}),n&&i&&(0,lG.jsx)(Ep,{icon:a8.X5P,text:"Reset value",onClick:n,mode:"ghost"})]})}let Ef={hits:[],isLoading:!1},Em=()=>!0,Eg=["_ref"];function Ex(e){var t,n,i;let{changed:r,focused:l,focusPath:a,getReferenceInfo:o,onChange:s,onPathFocus:d,onSearch:c,path:u,readOnly:p,schemaType:h,validation:f,value:m,elementProps:g}=e,x=Ee(),[v,b]=(0,lJ.useState)(Ef),y=(0,lJ.useCallback)(e=>{if(!e){s(mq()),d([]);return}if(!v.hits.find(t=>t.id===e))throw Error("Selected an item that wasnt part of the result set");s(mL({_type:h.name,_ref:cd(e),_projectId:x,_dataset:h.dataset,_weak:h.weak,_key:null==m?void 0:m._key})),d([])},[null==m?void 0:m._key,v.hits,h.name,h.dataset,h.weak,x,s,d]),j=(0,lJ.useCallback)(()=>{s(mq())},[s]),w=(0,lJ.useCallback)(e=>{27===e.keyCode&&(null==d||d([]))},[d]),k=(0,lJ.useCallback)(e=>o(e,h),[o,h]),C=T2((0,lJ.useMemo)(()=>({_id:null==m?void 0:m._ref}),[null==m?void 0:m._ref]),k),_=Nl("crossDatasetReferences"),S=(0,lJ.useRef)(null),T=1===a.length&&"_ref"===a[0],E=g.ref;m$({hasFocusAt:T,ref:null==m?void 0:m._ref},(e,t)=>{var n;let i=(null==e?void 0:e.ref)!==t.ref;((null==e?void 0:e.hasFocusAt)!==t.hasFocusAt||i)&&t.hasFocusAt&&(null==(n=E.current)||n.focus())});let P=(null==m?void 0:m._weak)?"weak":"strong",A=!0===h.weak?"weak":"strong",O=!!(null==m?void 0:m._ref),z=(0,lJ.useCallback)(()=>{s(!0===h.weak?mL(!0,["_weak"]):mq(["_weak"]))},[s,h]),{push:M}=(0,l4.pm)(),I=(0,lJ.useMemo)(()=>f.filter(e=>"error"===e.level),[f]),R=(0,lJ.useCallback)(e=>{e.currentTarget===g.ref.current&&(null==d||d([lY.Zg]))},[g.ref,d]),F=(0,lJ.useCallback)(e=>{e.currentTarget===g.ref.current&&(null==d||d(Eg))},[g.ref,d]),D=(0,lJ.useCallback)(()=>{null==d||d(Eg)},[d]),Z=(0,lJ.useId)(),L=(0,l5.W2)(e=>e.pipe((0,aj.h)(cr),(0,ax.x)(),(0,ab.w)(e=>(0,l8.z)((0,l6.of)({isLoading:!0}),c(e).pipe((0,ag.U)(t=>({hits:t,searchString:e,isLoading:!1})),(0,av.K)(e=>(M({title:"Reference search failed",description:e.message,status:"error",id:"reference-search-fail-".concat(Z)}),console.error(e),(0,l6.of)({hits:[]})))))),(0,ay.R)((e,t)=>({...e,...t}),Ef),(0,am.b)(b)),[Z,c,M]),q=(0,lJ.useCallback)(()=>{L("")},[L]),N=!C.isLoading&&O&&P!==A,V=(null==m?void 0:m._ref)&&(null==(n=h.studioUrl)?void 0:n.call(h,{id:null==m?void 0:m._ref,type:null==(t=null==C?void 0:C.result)?void 0:t.type}))||null,U=(0,lJ.useCallback)(e=>(0,lG.jsx)(uU,{as:"button",type:"button",radius:2,children:(0,lG.jsx)(l4.xu,{paddingX:3,paddingY:1,children:(0,lG.jsx)(Et,{referenceType:h,document:e.hit.published,getReferenceInfo:k})})}),[h,k]),B=null==(i=C.result)?void 0:i.preview.published,K=T||!(null==m?void 0:m._ref),H=(0,lJ.useRef)(null),W=(0,lJ.useRef)(null);return mX([H,W,(0,lJ.useRef)(null)],()=>{T&&d([])}),(0,lG.jsxs)(lG.Fragment,{children:[!_.isLoading&&!_.enabled&&(0,lG.jsx)(Eh,{value:m,onClearValue:j}),(_.isLoading||_.enabled)&&(0,lG.jsx)(l4.Kq,{space:1,children:K?(0,lG.jsx)(l4.Kq,{space:2,ref:H,children:(0,lG.jsx)(cU,{path:u,isChanged:r,hasFocus:!!l,children:(0,lG.jsx)("div",{ref:S,children:(0,lG.jsx)(Ed,{...g,"data-testid":"autocomplete",loading:v.isLoading,referenceElement:S.current,portalRef:W,id:Z||"",options:v.hits.map(e=>({value:e.id,hit:e})),onFocus:F,radius:1,placeholder:"Type to search",onKeyDown:w,readOnly:p,disabled:C.isLoading,onQueryChange:L,searchString:v.searchString,onChange:y,filterOption:Em,renderOption:U,openButton:{onClick:q}})})})}):(0,lG.jsx)(cU,{path:u,isChanged:r,hasFocus:!!l,children:(0,lG.jsxs)(l4.Zb,{padding:0,border:!0,flex:1,radius:1,tone:p?"transparent":C.error||I.length>0?"critical":"default",children:[(0,lG.jsxs)(l4.kC,{align:"center",padding:1,children:[V?(0,lG.jsx)(uU,{as:"a",target:"_blank",rel:"noopener noreferrer",href:V,"data-as":"a",flex:1,padding:1,paddingRight:3,radius:2,tone:"inherit",__unstable_focusRing:!0,tabIndex:0,onFocus:R,ref:g.ref,children:(0,lG.jsx)(En,{value:m,referenceInfo:C,showStudioUrlIcon:!0,hasStudioUrl:!!V,type:h})}):(0,lG.jsx)(uU,{flex:1,padding:1,paddingRight:3,radius:2,tone:"inherit",__unstable_focusRing:!0,tabIndex:0,onFocus:R,ref:g.ref,children:(0,lG.jsx)(En,{value:m,referenceInfo:C,showStudioUrlIcon:!0,type:h})}),(0,lG.jsx)(l4.gF,{paddingX:1,children:(0,lG.jsx)(l4.j2,{button:(0,lG.jsx)(l4.zx,{padding:2,mode:"bleed",icon:a8.zGg,"data-testid":"menu-button"}),id:"".concat(Z,"-menuButton"),menu:(0,lG.jsx)(l4.v2,{children:!p&&(0,lG.jsxs)(lG.Fragment,{children:[(0,lG.jsx)(l4.sN,{text:"Clear",tone:"critical",icon:a8.X5P,"data-testid":"menu-item-clear",onClick:j}),(0,lG.jsx)(l4.sN,{text:"Replace",icon:a8.bnu,"data-testid":"menu-item-replace",onClick:D})]})}),placement:"right",popover:{portal:!0,tone:"default"}})})]}),N&&(0,lG.jsx)(wo,{padding:1,title:"Reference strength mismatch",status:"warning","data-testid":"alert-reference-strength-mismatch",children:(0,lG.jsxs)(l4.Kq,{space:3,children:[(0,lG.jsxs)(l4.xv,{as:"p",muted:!0,size:1,children:["This reference is ",(0,lG.jsx)("em",{children:P}),", but according to the current schema it should be ",(0,lG.jsxs)("em",{children:[A,"."]})]}),(0,lG.jsx)(l4.xv,{as:"p",muted:!0,size:1,children:h.weak?(0,lG.jsxs)(lG.Fragment,{children:['It will not be possible to delete the "',null==B?void 0:B.title,'"-document without first removing this reference.']}):(0,lG.jsxs)(lG.Fragment,{children:['This makes it possible to delete the "',null==B?void 0:B.title,'"-document without first deleting this reference, leaving this field referencing a nonexisting document.']})}),(0,lG.jsx)(l4.zx,{onClick:z,text:(0,lG.jsxs)(lG.Fragment,{children:["Convert to ",A," reference"]}),tone:"caution"})]})}),C.error&&(0,lG.jsx)(wo,{padding:1,title:"Unable to load reference metadata",status:"warning","data-testid":"alert-reference-info-failed",children:(0,lG.jsxs)(l4.Kq,{space:3,children:[(0,lG.jsxs)(l4.xv,{as:"p",muted:!0,size:1,children:["Error: ",C.error.message]}),(0,lG.jsx)(l4.zx,{onClick:C.retry,text:(0,lG.jsx)(lG.Fragment,{children:"Retry"}),tone:"primary"})]})})]})})})]})}let Ev={available:!0,reason:"READABLE"},Eb={available:!1,reason:"PERMISSION_DENIED"},Ey={available:!1,reason:"NOT_FOUND"};async function Ej(e,t,n,i){if(!e)return{};if("function"==typeof e.filter){let r=n.slice(0,-1),l=(0,lY.U2)(t,r);return await e.filter({document:t,parentPath:r,parent:l,getClient:i})}return{filter:e.filter,params:"filterParams"in e?e.filterParams:void 0}}async function Ew(e,t,n,i){if(!e)return{};if("function"==typeof e.filter){let r=n.slice(0,-1),l=lY.U2(t,r);return e.filter({document:t,parentPath:r,parent:l,getClient:i})}return{filter:e.filter,params:"filterParams"in e?e.filterParams:void 0}}function Ek(e){var t,n,i,r;let{path:l,schemaType:a}=e,o=Ic(),s=o.getClient(fT),d=q6(),c=Uj(),u=(0,lJ.useMemo)(()=>s.withConfig({apiVersion:"2021-03-25"}),[s]),{EditReferenceLinkComponent:p,onEditReference:h,activePath:f,initialValueTemplateItems:m}=yr(),g=function(e){let t=(0,lJ.useRef)(e);return t.current=e,t}(kW([])),x=null==(t=g.current)?void 0:t._type,v=(0,lJ.useMemo)(()=>{var e;return null==(e=d.get(x))?void 0:e.liveEdit},[x,d]),b=(null==(n=a.options)?void 0:n.disableNew)===!0,y=o.getClient,j=(0,lJ.useCallback)(e=>(0,as.D)(Ew(a.options,g.current,l,y)).pipe((0,aT.z)(t=>{let{filter:n,params:i}=t;return mI(u,e,a,{...a.options,filter:n,params:i,tag:"search.reference"})}),(0,av.K)(e=>{var t;let n=e.details&&"queryParseError"===e.details.type;return(null==(t=a.options)?void 0:t.filter)&&n&&(e.message='Invalid reference filter, please check the custom "filter" option'),(0,an._)(e)})),[g,l,u,a,y]),w=null==(r=null==(i=e.value)?void 0:i._strengthenOnPublish)?void 0:r.template,k=(0,lJ.useMemo)(()=>(0,lJ.forwardRef)(function(e,t){return p?(0,lG.jsx)(p,{...e,ref:t,parentRefPath:l,template:w}):null}),[p,l,w]),C=(0,lJ.useCallback)(e=>{null==h||h({parentRefPath:l,id:e.id,type:e.type,template:e.template})},[h,l]);return{selectedState:lY.Ny(l,(null==f?void 0:f.path)||[])?null==f?void 0:f.state:"none",handleSearch:j,isCurrentDocumentLiveEdit:v,handleEditReference:C,EditReferenceLink:k,createOptions:(0,lJ.useMemo)(()=>b?[]:(m||[]).filter(e=>a.to.some(t=>{var n;return t.name===(null==(n=e.template)?void 0:n.schemaType)})).map(e=>{var t;return(null==(t=e.template)?void 0:t.schemaType)?{id:e.id,title:e.title||"".concat(e.template.schemaType," from template ").concat(e.template.id),type:e.template.schemaType,icon:e.icon,template:{id:e.template.id,params:e.parameters},permission:{granted:e.granted,reason:e.reason}}:void 0}).filter(cr),[b,m,a.to]),getReferenceInfo:(0,lJ.useCallback)(e=>mM(c,e,a),[c,a])}}function EC(e){let{getReferenceInfo:t,id:n,renderPreview:i}=e,{isLoading:r,result:l,error:a}=wg(n,t);if(r)return(0,lG.jsxs)(l4.Kq,{space:2,padding:1,children:[(0,lG.jsx)(l4.Qr,{style:{maxWidth:320},radius:1,animated:!0}),(0,lG.jsx)(l4.Qr,{style:{maxWidth:200},radius:1,size:1,animated:!0})]});if(a)return(0,lG.jsx)(l4.Kq,{space:2,padding:1,children:(0,lG.jsx)(mH,{title:"Failed to load referenced document",children:(0,lG.jsxs)(l4.xv,{muted:!0,size:1,children:["Error: ",a.message]})})});if(!l)return null;if("PERMISSION_DENIED"===l.availability.reason)return(0,lG.jsx)(l4.Kq,{space:2,padding:1,children:"Insufficient permissions to view this document"});let o=e.type.to.find(e=>e.name===l.type);return o?l&&o&&(0,lG.jsx)(wx,{id:l.id,layout:"default",preview:l.preview,refType:o,renderPreview:i,showTypeLabel:e.type.to.length>1}):(0,lG.jsxs)(l4.Kq,{space:2,padding:1,children:["Search returned a type that's not valid for this reference: \"$",l.type,'"']})}let E_={display:"inline-flex"},ES={width:"100%"},ET={portal:!0,tone:"default",constrainSize:!0,fallbackPlacements:["bottom","left","top"],placement:"right",preventOverflow:!0};function EE(e){let{createOptions:t,onCreate:n,id:i,...r}=e;return t.some(e=>e.permission.granted)?t.length>1?(0,lG.jsx)(l4.j2,{button:(0,lG.jsx)(l4.zx,{...r,disabled:e.readOnly,text:"Create new…",mode:"ghost",icon:a8.dtP}),id:i,menu:(0,lG.jsx)(l4.v2,{ref:e.menuRef,children:t.map(e=>(0,lG.jsx)(l4.u,{disabled:e.permission.granted,content:(0,lG.jsx)(l4.xu,{padding:2,children:(0,lG.jsx)(uP,{operationLabel:"create this type of document"})}),portal:!0,children:(0,lG.jsx)("div",{children:(0,lG.jsx)(l4.sN,{disabled:!e.permission.granted,icon:e.icon,text:e.title,onClick:()=>n(e)})})},e.id))}),popover:ET}):(0,lG.jsx)(l4.zx,{...r,text:"Create new",mode:"ghost",disabled:!t[0].permission.granted||e.readOnly,onClick:()=>n(t[0]),icon:a8.dtP}):(0,lG.jsx)(l4.u,{content:(0,lG.jsx)(l4.xu,{padding:2,children:(0,lG.jsx)(uP,{operationLabel:"create a new reference"})}),children:(0,lG.jsx)("div",{style:E_,children:(0,lG.jsx)(l4.zx,{text:"Create new",mode:"ghost",disabled:!0,icon:a8.dtP,style:ES})})})}var EP=Object.freeze,EA=Object.defineProperty,EO=(e,t)=>EP(EA(e,"raw",{value:EP(t||e.slice())}));let Ez=(0,a0.ZP)(l4.J2)(iP||(iP=EO(["\n  & > div {\n    overflow: auto;\n    -webkit-overflow-scrolling: touch;\n  }\n"]))),EM=(0,a0.ZP)(l4.xv)(iA||(iA=EO(["\n  word-break: break-word;\n"]))),EI=["top-start","bottom-start"],ER=(0,lJ.forwardRef)(function(e,t){let n=e.options&&e.options.length>0,i=(0,lJ.useCallback)((t,i)=>{var r;let{content:l,hidden:a,inputElement:o,onMouseEnter:s,onMouseLeave:d}=t;return(0,lG.jsx)(Ez,{placement:"bottom-start",fallbackPlacements:EI,arrow:!1,constrainSize:!0,onMouseEnter:s,onMouseLeave:d,content:(0,lG.jsx)("div",{ref:i,children:n?l:(0,lG.jsx)(l4.xu,{padding:4,children:(0,lG.jsx)(l4.kC,{align:"center",height:"fill",justify:"center",children:(0,lG.jsxs)(EM,{align:"center",muted:!0,children:["No results for ",(0,lG.jsxs)("strong",{children:["“",e.searchString,"”"]}),(null==(r=e.searchString)?void 0:r.toLowerCase())==="capybara"?(0,lG.jsx)(lG.Fragment,{children:". What a shame. There should be more Capybaras."}):null]})})})}),open:!e.loading&&!a,ref:e.portalRef,portal:!0,referenceElement:e.referenceElement||o,matchReferenceWidth:!0})},[n,e.searchString,e.loading,e.portalRef,e.referenceElement]);return(0,lG.jsx)(l4.F2,{...e,ref:t,renderPopover:i})});var EF=Object.freeze,ED=Object.defineProperty,EZ=(e,t)=>EF(ED(e,"raw",{value:EF(t||e.slice())}));let EL=(0,a0.iv)(iO||(iO=EZ(["\n  grid-template-columns: minmax(0px, 1fr);\n"]))),Eq=(0,a0.iv)(iz||(iz=EZ(["\n  grid-template-columns: 1fr min-content;\n"]))),EN=(0,a0.ZP)(l4.rj)(e=>e.$narrow?EL:Eq),EV=(0,lJ.forwardRef)(function(e,t){let[n,i]=(0,lJ.useState)(null),r=(0,lJ.useCallback)(e=>{"function"==typeof t?t(e):t&&(t.current=e),i(e)},[t]),l=(0,l4.XL)(n);return(0,lG.jsx)(EN,{ref:r,gap:1,$narrow:480>((null==l?void 0:l.width)||0),children:e.children})});var EU=Object.freeze,EB=Object.defineProperty;let EK=(0,a0.ZP)(uU)(iM||(iM=EU(EB(K=["\n  /* this is a hack to avoid layout jumps while previews are loading\n  there's probably better ways of solving this */\n  min-height: 36px;\n"],"raw",{value:EU(K.slice())})))),EH={hits:[],isLoading:!1},EW=()=>!0;function E$(e){return null!==e}function EX(e){var t,n,i,r,l,a;let{createOptions:o,onChange:s,onEditReference:d,onSearch:c,schemaType:u,readOnly:p,id:h,onPathFocus:f,value:m,renderPreview:g,path:x,elementProps:v,focusPath:b}=e,{getReferenceInfo:y}=Ek({path:x,schemaType:u,value:m}),[j,w]=(0,lJ.useState)(EH),k=(0,lJ.useCallback)(e=>{let t=(0,sy.Z)();s([mD({}),mL(u.name,["_type"]),mL(t,["_ref"]),mL(!0,["_weak"]),mL({type:e.type,weak:u.weak,template:e.template},["_strengthenOnPublish"])].filter(cr)),d({id:t,type:e.type,template:e.template}),f([])},[s,d,f,u]),C=(0,lJ.useCallback)(e=>{if(!e){s(mq()),f([]);return}let t=j.hits.find(t=>t.id===e);if(!t)throw Error("Selected an item that wasnt part of the result set");s([mD({}),mL(u.name,["_type"]),mL(cd(e),["_ref"]),t.published&&!u.weak?mq(["_weak"]):mL(!0,["_weak"]),t.published?mq(["_strengthenOnPublish"]):mL({type:null==t?void 0:t.type,weak:u.weak},["_strengthenOnPublish"])].filter(cr)),f([])},[s,f,u.name,u.weak,j.hits]),_=(0,lJ.useCallback)(()=>{s(mq())},[s]),S=(0,lJ.useCallback)(()=>{(null==m?void 0:m._ref)||_()},[_,null==m?void 0:m._ref]),T=(0,lJ.useCallback)(e=>{"Escape"===e.key&&f([])},[f]),E=wg(null==m?void 0:m._ref,y),P=(0,lJ.useRef)(null),{push:A}=(0,l4.pm)(),O=(0,l5.W2)(e=>e.pipe((0,aj.h)(E$),(0,ab.w)(e=>(0,l8.z)((0,l6.of)({isLoading:!0}),c(e).pipe((0,ag.U)(t=>({hits:t,searchString:e,isLoading:!1})),(0,av.K)(e=>(A({title:"Reference search failed",description:e.message,status:"error",id:"reference-search-fail-".concat(h)}),console.error(e),(0,l6.of)({hits:[]})))))),(0,ay.R)((e,t)=>({...e,...t}),EH),(0,am.b)(w)),[h,c,A]),z=(0,lJ.useCallback)(()=>{O("")},[O]),M=(0,lJ.useCallback)(e=>{"Escape"===e.key&&f([])},[f]),I=(0,lJ.useCallback)(e=>{var t,n;let i=(null==(t=e.hit.draft)?void 0:t._id)||(null==(n=e.hit.published)?void 0:n._id)||e.value;return(0,lG.jsx)(EK,{forwardedAs:"button",type:"button",radius:2,tone:"inherit",children:(0,lG.jsx)(l4.xu,{paddingX:3,paddingY:1,children:(0,lG.jsx)(EC,{getReferenceInfo:y,id:i,renderPreview:g,type:u})})})},[u,y,g]),R=(0,lJ.useCallback)(()=>{var e,t,n,i;return(null==(t=null==(e=E.result)?void 0:e.preview.draft)?void 0:t.title)||(null==(i=null==(n=E.result)?void 0:n.preview.published)?void 0:i.title)||""},[null==(n=null==(t=E.result)?void 0:t.preview.draft)?void 0:n.title,null==(r=null==(i=E.result)?void 0:i.preview.published)?void 0:r.title]),F=(0,lJ.useCallback)(()=>f(["_ref"]),[f]),D=(0,lJ.useCallback)(t=>{var n;(null==(n=P.current)?void 0:n.contains(t.relatedTarget))||e.elementProps.onBlur(t)},[e.elementProps]),Z=(null==(a=null==(l=null==E?void 0:E.result)?void 0:l.availability)?void 0:a.reason)==="NOT_FOUND"&&!(null==m?void 0:m._strengthenOnPublish)&&(null==m?void 0:m._weak);m$((null==b?void 0:b[0])==="_ref",(e,t)=>{var n;!e&&t&&(null==(n=v.ref.current)||n.focus())});let L=(0,lJ.useMemo)(()=>j.hits.map(e=>({value:e.id,hit:e})),[j.hits]),q=1===b.length&&"_ref"===b[0],{menuRef:N,containerRef:V}=(0,lJ.useContext)(wS)||{menuRef:{current:null},containerRef:{current:null}},U=(0,lJ.useRef)(null),B=(0,lJ.useRef)(null),K=(0,lJ.useRef)(null);return mX([V,U,B,K,N],()=>{q&&S()}),(0,lG.jsx)(l4.Kq,{space:1,"data-testid":"reference-input",ref:U,children:(0,lG.jsxs)(l4.Kq,{space:2,children:[Z?(0,lG.jsx)(mH,{"data-testid":"alert-nonexistent-document",title:"Nonexistent document reference",suffix:(0,lG.jsx)(l4.Kq,{padding:2,children:(0,lG.jsx)(l4.zx,{text:"Clear",onClick:_})}),children:(0,lG.jsxs)(l4.xv,{size:1,children:["This field is currently referencing a document that doesn't exist (ID:",(0,lG.jsx)("code",{children:m._ref}),"). You can either remove the reference or replace it with another document."]})}):null,(0,lG.jsxs)(EV,{ref:P,children:[(0,lG.jsx)(ER,{...v,onFocus:F,onBlur:D,"data-testid":"autocomplete",loading:j.isLoading,referenceElement:P.current,options:L,radius:1,placeholder:"Type to search",onKeyDown:T,readOnly:E.isLoading||p,onQueryChange:O,searchString:j.searchString,onChange:C,filterOption:EW,renderOption:I,renderValue:R,openButton:{onClick:z},portalRef:B,value:null==m?void 0:m._ref}),o.length>0&&(0,lG.jsx)(EE,{id:"".concat(h,"-selectTypeMenuButton"),readOnly:p,createOptions:o,onCreate:k,onKeyDown:M,menuRef:K})]})]})})}async function EG(e,t,n,i){if(!e)return{};if("function"==typeof e.filter){let r=n.slice(0,-1),l=(0,lY.U2)(t,r);return await e.filter({document:t,parentPath:r,parent:l,getClient:i})}return{filter:e.filter,params:"filterParams"in e?e.filterParams:void 0}}function EY(e){var t,n,i,r;let l=Ic(),a=l.getClient(fT),o=q6(),s=Uj(),{path:d,schemaType:c}=e,{EditReferenceLinkComponent:u,onEditReference:p,activePath:h,initialValueTemplateItems:f}=yr(),m=function(e){let t=(0,lJ.useRef)(e);return t.current=e,t}(kW([])),g=null==(t=m.current)?void 0:t._type,x=o.get(g),v=(0,lJ.useMemo)(()=>null==x?void 0:x.liveEdit,[x]),b=(null==(n=c.options)?void 0:n.disableNew)===!0,y=l.getClient,j=(0,lJ.useCallback)(e=>(0,as.D)(EG(c.options,m.current,d,y)).pipe((0,aT.z)(t=>{let{filter:n,params:i}=t;return mI(a,e,c,{...c.options,filter:n,params:i,tag:"search.reference"})}),(0,av.K)(e=>{var t;let n=e.details&&"queryParseError"===e.details.type;return(null==(t=c.options)?void 0:t.filter)&&n&&(e.message='Invalid reference filter, please check the custom "filter" option'),(0,an._)(e)})),[m,d,a,c,y]),w=null==(r=null==(i=e.value)?void 0:i._strengthenOnPublish)?void 0:r.template,k=(0,lJ.useMemo)(()=>(0,lJ.forwardRef)(function(e,t){return u?(0,lG.jsx)(u,{...e,ref:t,parentRefPath:d,template:w}):null}),[u,d,w]),C=(0,lJ.useCallback)(e=>{null==p||p({parentRefPath:d,id:e.id,type:e.type,template:e.template})},[p,d]),_=lY.Ny(d,(null==h?void 0:h.path)||[])?null==h?void 0:h.state:"none",S=(0,lJ.useMemo)(()=>b?[]:(f||[]).filter(e=>c.to.some(t=>{var n;return t.name===(null==(n=e.template)?void 0:n.schemaType)})).map(e=>{var t,n,i;return(null==(t=e.template)?void 0:t.schemaType)?{id:e.id,title:e.title||"".concat(e.template.schemaType," from template ").concat(null==(n=e.template)?void 0:n.id),type:e.template.schemaType,icon:e.icon,template:{id:null==(i=e.template)?void 0:i.id,params:e.parameters},permission:{granted:e.granted,reason:e.reason}}:void 0}).filter(cr),[b,f,c.to]),T=(0,lJ.useCallback)((e,t)=>mM(s,e,t),[s]);return(0,lG.jsx)(EX,{...e,onSearch:j,liveEdit:v,getReferenceInfo:T,selectedState:_,editReferenceLinkComponent:k,createOptions:S,onEditReference:C})}function EJ(e,t){if(e===t)return!0;if(typeof e!=typeof t)return!1;if("object"!=typeof e&&!Array.isArray(e))return e===t;if(e._key&&e._key===t._key)return!0;if(Array.isArray(e))return!e.length===t.length&&e.every((n,i)=>EJ(e[i],t[i]));let n=Object.keys(e),i=Object.keys(e);return n.length===i.length&&n.every(n=>EJ(e[n],t[n]))}function EQ(e,t){return!!e&&e.some(e=>EJ(e,t))}let E0=[];function E1(e){var t,n;let{renderPreview:i,schemaType:r,onChange:l,onPathFocus:a,value:o=[],readOnly:s,elementProps:d,path:c,changed:u}=e,p=(0,lJ.useMemo)(()=>{var e;return((null==(e=r.options)?void 0:e.list)||E0).map((e,t)=>(0,lX.fU)(e)?e:{...e,_key:"auto-generated-".concat(t)})},[null==(t=r.options)?void 0:t.list]),h=(0,lJ.useCallback)((e,t)=>{if(!e&&(0,lX.fU)(t)){l(mq([{_key:t._key}]));return}let n=p.filter(n=>EJ(t,n)?e:EQ(o,n));l(n.length>0?mL(n):mq())},[l,p,o]),f=(0,lJ.useCallback)(e=>{a([e])},[a]),m=(null==(n=r.options)?void 0:n.layout)==="grid";return(0,lG.jsx)(cU,{path:c,isChanged:u,hasFocus:!1,children:(0,lG.jsx)(l4.rj,{gap:2,columns:m?Math.min(p.length,4):1,tabIndex:0,...d,children:p.map((e,t)=>{let n=r.of.find(t=>t.name===(0,sT.wq)(e)),l=EQ(o,e),a=!n;return(0,lG.jsxs)(l4.kC,{align:"center",as:"label",muted:a,children:[(0,lG.jsx)(l4.XZ,{disabled:a,checked:l,onChange:t=>h(t.currentTarget.checked,e),onFocus:()=>f(t),readOnly:s}),(0,lG.jsx)(l4.xu,{flex:1,marginLeft:2,children:n?i({layout:"default",schemaType:n,value:e}):(0,lG.jsx)(l4.Zb,{tone:"caution",radius:2,children:(0,lG.jsx)(kO,{value:e,onFocus:()=>f(t)})})})]},t)})})})}var E2=Object.freeze,E3=Object.defineProperty;let E4=(0,a0.ZP)(l4.Zb)(iI||(iI=E2(E3(H=["\n  max-width: ","px;\n"],"raw",{value:E2(H.slice())}))),e=>{let{theme:t}=e;return t.sanity.container[1]});function E5(e){let{value:t,onFocus:n,vertical:i,...r}=e,[l,a]=lJ.useState(!1),[o,s]=lJ.useState(null);(0,l4.O8)(()=>a(!1),[o]);let d=lJ.useCallback(e=>{("Escape"===e.key||"Tab"===e.key)&&a(!1)},[]),c=(0,lJ.useCallback)(()=>{a(e=>!e)},[]),u=(0,sT.wq)(t);return(0,lG.jsx)(l4.J2,{open:l,ref:s,onKeyDown:d,portal:!0,constrainSize:!0,tone:"default",content:(0,lG.jsx)(E4,{margin:1,padding:3,onKeyDown:d,tabIndex:0,overflow:"auto",children:(0,lG.jsxs)(l4.Kq,{space:4,children:[(0,lG.jsx)(l4.xu,{children:(0,lG.jsx)(l4.xv,{weight:"semibold",children:"Why is this happening?"})}),(0,lG.jsxs)(l4.xv,{size:1,children:["The current schema does not declare items of type ",(0,lG.jsx)("code",{children:u})," as valid for this list. This could mean that the type has been removed as a valid item type, or that someone else has added it to their own local schema that is not yet deployed."]}),(0,lG.jsx)(l4.xu,{children:(0,lG.jsxs)(l4.xv,{size:1,children:[(0,lG.jsx)(a8.sLo,{})," You can still move or delete this item, but it cannot be edited since the schema definition for its type is nowhere to be found."]})}),(0,lG.jsxs)(l4.Kq,{space:2,children:[(0,lG.jsx)(l4.xv,{size:1,weight:"semibold",children:"JSON representation of this item:"}),(0,lG.jsx)(l4.Zb,{padding:2,overflow:"auto",border:!0,children:(0,lG.jsx)(l4.EK,{size:1,as:"pre",language:"json",children:JSON.stringify(t,null,2)})})]})]})}),children:(0,lG.jsx)(l4.Zb,{as:"button",type:"button",radius:2,tone:"inherit",paddingX:2,paddingY:3,flex:1,onFocus:n,onClick:c,onKeyDown:d,__unstable_focusRing:!0,...r,children:(0,lG.jsxs)(l4.kC,{align:"center",children:[(0,lG.jsx)(l4.xu,{marginRight:3,children:(0,lG.jsx)(l4.xv,{children:(0,lG.jsx)(a8.Tzq,{})})}),(0,lG.jsx)(l4.xu,{flex:1,children:(0,lG.jsxs)(l4.xv,{size:1,textOverflow:"ellipsis",children:["Item of type ",(0,lG.jsx)("code",{children:u})," not valid for this list"]})})]})})})}function E6(e){var t,n;let{schemaType:i,onChange:r,value:l=[],readOnly:a,path:o,changed:s,onIndexFocus:d,elementProps:c}=e,u=(0,lJ.useMemo)(()=>{var e;return((null==(e=i.options)?void 0:e.list)||[]).map(e=>e&&"object"==typeof e&&"title"in e&&"value"in e?{title:e.title||op()(String(e.value)),value:e.value}:{title:op()(String(e)),value:e})},[null==(t=i.options)?void 0:t.list]),p=(e,t)=>{let n=u.map(e=>e.value).filter(n=>n===t?e:l.includes(n));r(n.length>0?mL(n):mq())},h=(null==(n=i.options)?void 0:n.layout)==="grid";return(0,lG.jsx)(cU,{path:o,isChanged:s,hasFocus:!1,children:(0,lG.jsx)(l4.rj,{gap:2,columns:h?Math.min(u.length,4):1,...c,children:u.map((e,t)=>{let n=i.of.find(t=>t.name===(0,sT.wq)(e.value)),r=l.includes(e.value),o=!n;return(0,lG.jsxs)(l4.kC,{align:"center",as:"label",muted:o,children:[(0,lG.jsx)(l4.XZ,{disabled:o,checked:r,onChange:t=>p(t.currentTarget.checked,e.value),onFocus:()=>d(t),readOnly:a}),(0,lG.jsx)(l4.xu,{padding:2,children:(0,lG.jsx)(l4.xv,{children:e.title})}),!n&&(0,lG.jsx)(E5,{value:e,onFocus:()=>d(t)})]},t)})})})}function E8(e){return(0,lX.M1)(e.schemaType)?(0,lG.jsx)(E1,{...e}):(0,lG.jsx)(E6,{...e})}var E9=Object.freeze,E7=Object.defineProperty,Pe=(e,t)=>E9(E7(e,"raw",{value:E9(t||e.slice())}));let Pt=a0.ZP.div(iR||(iR=Pe(["\n  position: relative;\n"]))),Pn=a0.ZP.div(iF||(iF=Pe(["\n  z-index: 13;\n  opacity: 0;\n  transition: opacity 300ms linear;\n"]))),Pi=(0,a0.ZP)(l4.Zb)(iD||(iD=Pe(["\n  border: 1px solid var(--card-border-color);\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  z-index: 12;\n  transition: opacity 150ms ease-in-out;\n  opacity: 0;\n  box-sizing: border-box;\n"]))),Pr=(0,a0.ZP)(l4.kC)(iZ||(iZ=Pe(["\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n\n  :hover,\n  :focus {\n    & "," {\n      opacity: 0.9;\n    }\n\n    & "," {\n      opacity: 1;\n    }\n  }\n"])),Pi,Pn),Pl=()=>"undefined"!=typeof window&&"ontouchstart"in window||"undefined"!=typeof navigator&&navigator.maxTouchPoints>0;function Pa(e){let{children:t,message:n,onActivate:i,isOverlayActive:r}=e,[l,a]=(0,lJ.useState)(!1),o=(0,lJ.useCallback)(()=>{i&&i()},[i]),s=(0,lJ.useCallback)(e=>{r&&"Space"===e.code&&i&&(e.preventDefault(),i())},[r,i]),d=(0,lJ.useCallback)(()=>{a(!0)},[]),c=(0,lJ.useCallback)(()=>{a(!1)},[]),u=(0,lJ.useMemo)(()=>{let e=Pl(),t=e?"Tap":"Click";l&&!e&&(t+=" or press space");let i=n||"".concat(t," to activate");return(0,lG.jsx)(l4.xv,{weight:"semibold",children:i})},[l,n]);return(0,lG.jsxs)(Pt,{onBlur:c,onClick:o,onFocus:d,onKeyDown:s,children:[r&&(0,lG.jsxs)(Pr,{"data-testid":"activate-overlay",tabIndex:0,align:"center",justify:"center",children:[(0,lG.jsx)(Pi,{radius:1}),(0,lG.jsx)(Pn,{children:u})]}),t]})}var Po=Object.freeze,Ps=Object.defineProperty;let Pd=a0.ZP.span(iL||(iL=Po(Ps(W=["\n  /* Make sure the annotation styling is visible */\n  &[data-mark='code'] {\n    mix-blend-mode: multiply;\n    color: inherit;\n  }\n"],"raw",{value:Po(W.slice())}))));function Pc(e){let{value:t,focused:n,selected:i,children:r,schemaType:l}=e,a=CJ[t],o=l.component,s=(0,lJ.useCallback)(e=>(0,lG.jsx)(Pd,{as:a,"data-mark":t,children:e.children}),[a,t]);return(0,lJ.useMemo)(()=>{let e={focused:n,renderDefault:s,schemaType:l,selected:i,title:l.title,value:t};return o?(0,lG.jsx)(o,{...e,children:r}):(0,lG.jsx)(s,{...e,children:r})},[o,s,r,n,l,i,t])}let Pu={portal:!0,constrainSize:!0},Pp=(0,lJ.forwardRef)(function(e,t){let{disableRestoreFocusOnClose:n,menuButton:i,menuButtonProps:r,menuOptions:l,onMenuClose:a}=e;return(0,lG.jsx)(l4.j2,{__unstable_disableRestoreFocusOnClose:n,id:"menu-button",ref:t,onClose:a,popover:Pu,...r,button:i,menu:(0,lG.jsx)(l4.v2,{children:l.map((e,t)=>{let{collapsedProps:n={},expandedProps:i={},tooltipProps:r={},tooltipText:l,dividerBefore:a,fontSize:o,padding:s,text:d,icon:c,selected:u,...p}=e.props;return(0,lG.jsxs)(lJ.Fragment,{children:[a&&0!==t&&(0,lG.jsx)(l4.R,{}),(0,lG.jsx)(l4.sN,{text:d,icon:c,pressed:u,...p})]},e.key)})})})});var Ph=Object.freeze,Pf=Object.defineProperty;let Pm=a0.ZP.div(iq||(iq=Ph(Pf($=["\n  border-right: 1px solid var(--card-border-color);\n  height: auto;\n\n  &[data-hidden] {\n    opacity: 0;\n  }\n"],"raw",{value:Ph($.slice())}))));function Pg(e){let{hidden:t,...n}=e;return(0,lG.jsx)(Pm,{"data-ui":"CollapseMenuDivider","data-hidden":t?"":void 0,...n})}var Px=Object.freeze,Pv=Object.defineProperty,Pb=(e,t)=>Px(Pv(e,"raw",{value:Px(t||e.slice())}));let Py=(0,a0.iv)(iN||(iN=Pb(["\n  list-style: none;\n  display: flex;\n  white-space: nowrap;\n\n  &[data-hidden='true'] {\n    opacity: 0;\n    visibility: hidden;\n  }\n"]))),Pj=(0,a0.ZP)(l4.kC)(iV||(iV=Pb(["\n  padding: ","px;\n  margin: -","px;\n  box-sizing: border-box;\n"])),3,3),Pw=(0,a0.ZP)(l4.kC)(iU||(iU=Pb(["\n  border-radius: inherit;\n  position: relative;\n"]))),Pk=(0,a0.ZP)(l4.kC)(iB||(iB=Pb(["\n  width: max-content;\n  &[data-hidden='true'] {\n    visibility: hidden;\n    position: relative;\n    margin-top: -1px;\n    height: 1px;\n  }\n"]))),PC=(0,a0.ZP)(function(e){let{onIntersectionChange:t,children:n,options:i,...r}=e,[l,a]=(0,lJ.useState)(null);return(0,lJ.useEffect)(()=>{if(!l)return;let e=new IntersectionObserver(t,i);return e.observe(l),()=>{e.unobserve(l),e.disconnect()}},[l,t,i]),(0,lG.jsx)(l4.kC,{ref:a,...r,children:n})})(iK||(iK=Pb(["\n  ","\n"])),Py);function P_(e){return!!e}let PS=(0,lJ.forwardRef)(function(e,t){let{children:n,collapsed:i,disableRestoreFocusOnClose:r,onMenuClose:l,menuButtonProps:a,...o}=e,s=(0,lJ.useMemo)(()=>lJ.Children.toArray(n).filter(P_),[n]),d=(0,lJ.useMemo)(()=>(null==a?void 0:a.button)||(0,lG.jsx)(l4.zx,{icon:a8.zGg,mode:"bleed"}),[a]);return i?(0,lG.jsx)(Pp,{ref:t,disableRestoreFocusOnClose:r,menuButton:d,menuButtonProps:a,menuOptions:s,onMenuClose:l}):(0,lG.jsx)(PT,{...o,ref:t,disableRestoreFocusOnClose:r,menuButtonProps:a,menuOptions:s,onMenuClose:l})}),PT=(0,lJ.forwardRef)(function(e,t){let{collapseText:n=!0,disableRestoreFocusOnClose:i,gap:r,menuOptions:l,menuButtonProps:a,onMenuClose:o,...s}=e,[d,c]=(0,lJ.useState)(null),[u,p]=(0,lJ.useState)({}),[h,f]=(0,lJ.useState)({}),m=(0,lJ.useMemo)(()=>({root:d,threshold:.99,rootMargin:"2px"}),[d]),g=(0,lJ.useMemo)(()=>l.map(e=>e.key),[l]),x=(0,lJ.useMemo)(()=>[...s3()(g,Object.keys(u)),...s3()(g,Object.keys(h))],[g,u,h]),v=(0,lJ.useMemo)(()=>l.filter(e=>{let t=u[e.key];return t&&!t.intersects}),[u,l]),b=(0,lJ.useCallback)((e,t)=>{p(n=>{let i=t.key;if(null===i)throw Error("Expected element to have a non-null key");let r={intersects:e.isIntersecting,element:t},l=n[i];return l&&l.intersects===r.intersects?n:{...n,[i]:r}})},[]),y=(0,lJ.useCallback)((e,t)=>{f(n=>{let i=t.key;if(null===i)throw Error("Expected child element to have a non-null key");let r=n[i],l={intersects:e.isIntersecting,element:t};return(null==r?void 0:r.intersects)===l.intersects?n:{...n,[i]:l}})},[]),j=(0,lJ.useMemo)(()=>l.map(e=>{let{collapsedProps:t}=e.props,i=n?void 0:e.props.text;return(0,lJ.cloneElement)(e,{...t,text:i})}),[l,n]),w=(0,lJ.useMemo)(()=>l.filter(e=>{let t=h[e.key];return(null==t?void 0:t.intersects)===!1}),[l,h]),k=v.length>0?j.filter(e=>{let t=h[e.key];return(null==t?void 0:t.intersects)===!0}):l,C=(0,lJ.useMemo)(()=>(null==a?void 0:a.button)||(0,lG.jsx)(l4.zx,{icon:a8.zGg,mode:"bleed"}),[a]);return(0,lG.jsxs)(Pj,{align:"center","data-ui":"CollapseMenu",overflow:"hidden",sizing:"border",ref:t,...s,children:[(0,lG.jsxs)(Pw,{direction:"column",flex:1,justify:"center",ref:c,children:[(0,lG.jsx)(Pk,{gap:r,children:0===x.length&&k.map((e,t)=>{let{dividerBefore:n,tooltipText:i="",tooltipProps:r={}}=e.props,l=!e.key||!(e.key in u)||w.includes(e);return(0,lG.jsxs)(lJ.Fragment,{children:[n&&0!==t&&(0,lG.jsx)(Pg,{hidden:l}),(0,lG.jsx)(l4.u,{portal:!0,disabled:!i,content:(0,lG.jsx)(l4.xu,{padding:2,sizing:"border",children:(0,lG.jsx)(l4.xv,{size:1,children:i})}),...r,children:(0,lG.jsx)(l4.kC,{children:(0,lJ.cloneElement)(e,{disabled:e.props.disabled||l,"aria-hidden":l})})})]},e.key)})}),(0,lG.jsx)(PE,{gap:r,elements:l,intersectionOptions:m,onIntersectionChange:b}),(0,lG.jsx)(PE,{gap:r,elements:j,intersectionOptions:m,onIntersectionChange:y})]}),w.length>0&&(0,lG.jsx)(l4.kC,{marginLeft:r,children:(0,lG.jsx)(Pp,{disableRestoreFocusOnClose:i,menuButton:C,menuButtonProps:a,menuOptions:w,onMenuClose:o})})]})}),PE=(0,lJ.memo)(function(e){let{elements:t,gap:n,intersectionOptions:i,onIntersectionChange:r}=e;return(0,lG.jsx)(Pk,{"data-hidden":!0,"aria-hidden":"true",gap:n,overflow:"hidden",children:t.map((e,t)=>{let{dividerBefore:n}=e.props;return(0,lG.jsxs)(lJ.Fragment,{children:[n&&0!==t&&(0,lG.jsx)(Pg,{hidden:!0}),(0,lG.jsx)(PC,{options:i,onIntersectionChange:t=>r(t[0],e),children:(0,lG.jsx)(l4.kC,{children:(0,lJ.cloneElement)(e,{disabled:!0,"aria-hidden":!0})})})]},e.key)})})}),PP=(0,lJ.forwardRef)(function(e,t){let{collapsedProps:n={},expandedProps:i={},tooltipProps:r={},tooltipText:l,dividerBefore:a,...o}=e;return(0,lG.jsx)(l4.zx,{"data-ui":"CollapseMenuButton",...o,ref:t})});var PA=Object.freeze,PO=Object.defineProperty;let Pz=a0.ZP.div(iH||(iH=PA(PO(X=["\n  width: 1em;\n  height: 1em;\n  border-radius: inherit;\n  background-origin: content-box;\n  background-position: center;\n  background-repeat: no-repeat;\n  background-size: cover;\n  transform: scale(0.7);\n"],"raw",{value:PA(X.slice())}))));function PM(e){let{icon:t,active:n}=e,i=(0,lJ.useMemo)(()=>({backgroundImage:"url(".concat(t,")"),filter:n?"invert(100%)":"invert(0%)"}),[n,t]);return(0,lG.jsx)(Pz,{style:i})}function PI(e,t){let n=ob()(e,"to[0].icon");return e.icon||e.type&&e.type.icon||n||t}let PR={link:a8.xPt},PF={strong:a8.mY4,em:a8.h32,"strike-through":a8.dwl,underline:a8.Adg,code:a8.dNJ},PD={number:a8.NvX,bullet:a8.AEM};function PZ(){let e=(0,sE._F)(),t=(0,sE.L9)();return(0,lJ.useMemo)(()=>sE.q$.focusBlock(e),[e,t])}let PL=(0,lJ.memo)(PS),Pq={constrainSize:!0,portal:!0},PN={padding:2,mode:"bleed"},PV=(0,lJ.memo)(function(e){let{disabled:t,groups:n,isFullscreen:i,collapsed:r}=e,l=PZ(),a=(0,sE._F)(),o=(null==l?void 0:l._type)!==a.schemaTypes.block.name,s=!o&&Array.isArray(l.children)&&1===l.children.length&&(null==l?void 0:l.children[0].text)==="",d=t||o,c=(0,lJ.useMemo)(()=>n.reduce((e,t)=>e.concat(t.actions.map((e,t)=>0===t?{...e,firstInGroup:!0}:e)),[]),[n]),u=function(e){let{actions:t}=e,n=(0,sE._F)(),i=(0,sE.L9)();return cn((0,lJ.useMemo)(()=>{let e=sE.q$.activeAnnotations(n).map(e=>e._type);return t.filter(t=>"annotation"===t.type?e.includes(t.key):"listStyle"===t.type?sE.q$.hasListStyle(n,t.key):sE.q$.isMarkActive(n,t.key)).map(e=>e.key)},[n,i]))}({actions:c}),p=(0,lJ.useCallback)(()=>{sE.q$.focus(a)},[a]),h=(0,lJ.useMemo)(()=>c.map(e=>{let t="annotation"===e.type&&s,n=u.includes(e.key);return(0,lJ.createElement)(PP,{"data-testid":"action-button-".concat(e.key),disabled:d||t,...PN,dividerBefore:e.firstInGroup,icon:e.icon?"string"==typeof e.icon?(0,lG.jsx)(PM,{active:n,icon:e.icon}):e.icon:"annotation"===e.type?PR[e.key]||a8.Tzq:"listStyle"===e.type?PD[e.key]||a8.Tzq:PF[e.key]||a8.Tzq,key:e.key,onClick:()=>e.handle(n),selected:n,text:e.title||e.key,tooltipText:e.title||e.key,tooltipProps:{disabled:d||t,placement:i?"bottom":"top",portal:"default"}})}),[c,u,d,s,i]),f=(0,lJ.useMemo)(()=>({button:(0,lG.jsx)(l4.zx,{icon:a8.zGg,mode:"bleed",padding:2,disabled:d}),popover:Pq}),[d]);return(0,lG.jsx)(PL,{collapsed:r,disableRestoreFocusOnClose:!0,gap:1,menuButtonProps:f,onMenuClose:p,children:h})});var PU=Object.freeze,PB=Object.defineProperty,PK=(e,t)=>PU(PB(e,"raw",{value:PU(t||e.slice())}));let PH=(0,lJ.memo)(l4.j2),PW=(0,a0.ZP)(l4.sN)(iW||(iW=PK(["\n  // Change the border color variable used by BlockQuote\n  // to make the border visible when the MenuItem is selected\n  &[data-selected] {\n    [data-option='blockquote'] {\n      --card-border-color: var(--card-muted-fg-color);\n    }\n  }\n"]))),P$=(0,a0.ZP)(l4.zx)(i$||(i$=PK(["\n  width: 100%;\n"]))),PX={constrainSize:!0,placement:"bottom-start",portal:"default"},PG={h1:e=>(0,lG.jsx)(_s,{children:e}),h2:e=>(0,lG.jsx)(_d,{children:e}),h3:e=>(0,lG.jsx)(_c,{children:e}),h4:e=>(0,lG.jsx)(_u,{children:e}),h5:e=>(0,lG.jsx)(_p,{children:e}),h6:e=>(0,lG.jsx)(_h,{children:e}),normal:e=>(0,lG.jsx)(_o,{children:e}),blockquote:e=>(0,lG.jsx)(_m,{"data-option":"blockquote",children:e})},PY=Object.keys(PG),PJ=e=>e.preventDefault(),PQ={key:"style-none",style:"",title:"No style"},P0=(0,lJ.memo)(function(e){let{disabled:t,items:n}=e,i=(0,sE._F)(),r=PZ(),l=t||!!r&&i.schemaTypes.block.name!==r._type,a=function(e){let{items:t}=e,n=(0,sE._F)(),i=PZ(),r=(0,sE.L9)();return cn((0,lJ.useMemo)(()=>t.filter(e=>sE.q$.hasBlockStyle(n,e.style)).map(e=>e.style),[i,r]))}({items:n}),{activeItems:o,items:s}=(0,lJ.useMemo)(()=>{let e=n.filter(e=>a.includes(e.style)),t=n;return 0===e.length&&t.length>1&&(t=t.concat([PQ]),e.push(PQ)),{activeItems:e,items:t}},[a,n]),d=(0,lJ.useMemo)(()=>o.length>1?"Multiple":1===o.length?o[0].title:PQ.title,[o]),c=(0,lJ.useCallback)(e=>{r&&e.style!==r.style&&(sE.q$.toggleBlockStyle(i,e.style),sE.q$.focus(i))},[i,r]),u=(0,lJ.useCallback)((e,t)=>{let n=PY.includes(e),i=PG[e];return n?i(t):(0,lG.jsx)(l4.xv,{children:t})},[]),p=(0,lJ.useMemo)(()=>(0,lG.jsx)(P$,{disabled:l,iconRight:a8.GVG,mode:"bleed",onClick:PJ,padding:2,text:d}),[l,d]),h=(0,lJ.useMemo)(()=>(0,lG.jsx)(l4.v2,{disabled:l,children:s.map(e=>(0,lG.jsx)(PW,{pressed:o.includes(e),onClick:l?void 0:()=>c(e),children:u(e.style,(null==e?void 0:e.title)||e.style)},e.key))}),[l,o,c,s,u]);return(0,lG.jsx)(PH,{popover:PX,id:"block-style-select",button:p,menu:h})}),P1=(0,lJ.memo)(PS),P2={constrainSize:!0,portal:!0},P3=(0,lJ.memo)(function(e){let{disabled:t,items:n,isFullscreen:i,collapsed:r}=e,l=PZ(),a=(0,sE._F)(),o=l&&l._type!==a.schemaTypes.block.name,s=(0,lJ.useCallback)(()=>{sE.q$.focus(a)},[a]),d=(0,lJ.useMemo)(()=>n.map(e=>{let n=e.type.title||dK()(e.type.name);return(0,lG.jsx)(PP,{"aria-label":"Insert ".concat(n).concat(e.inline?" (inline)":" (block)"),padding:2,mode:"bleed",disabled:t||o&&!0===e.inline,icon:e.icon,onClick:e.handle,text:n,tooltipText:"Insert ".concat(n),tooltipProps:{disabled:t,placement:i?"bottom":"top",portal:"default"}},e.key)}),[n,t,o,i]),c=(0,lJ.useMemo)(()=>({button:(0,lG.jsx)(l4.zx,{icon:a8.dtP,mode:"bleed",padding:2,disabled:t}),popover:P2}),[t]);return(0,lG.jsx)(P1,{collapsed:r,collapseText:!1,disableRestoreFocusOnClose:!0,gap:1,menuButtonProps:c,onMenuClose:s,children:d})});var P4=Object.freeze,P5=Object.defineProperty,P6=(e,t)=>P4(P5(e,"raw",{value:P4(t||e.slice())}));let P8=(0,a0.ZP)(l4.kC)(iX||(iX=P6(["\n  width: 100%;\n"]))),P9=(0,a0.ZP)(l4.xu)(iG||(iG=P6(["\n  width: 8em;\n"]))),P7=(0,a0.ZP)(l4.kC)(iY||(iY=P6(["\n  border-right: 1px solid var(--card-border-color);\n"]))),Ae=(0,a0.ZP)(l4.xu)(iQ||(iQ=P6(["\n  ","\n"])),e=>{let{$withInsertMenu:t}=e;return t&&(0,a0.iv)(iJ||(iJ=P6(["\n      max-width: max-content;\n      border-right: 1px solid var(--card-border-color);\n    "])))}),At=(0,a0.ZP)(l4.xu)(i0||(i0=P6(["\n  border-left: 1px solid var(--card-border-color);\n"]))),An="undefined"!=typeof window&&/Mac|iPod|iPhone|iPad/.test(window.navigator.platform),Ai=(0,lJ.memo)(function(e){let{actionGroups:t,blockStyles:n,disabled:i,insertMenuItems:r,isFullscreen:l,onToggleFullscreen:a}=e,o=t.reduce((e,t)=>e+t.actions.length,0),s=r.length>0,[d,c]=(0,lJ.useState)(null),u=(0,l4.XL)(d),p=!!u&&(null==u?void 0:u.width)<400,h=n.length>1;pJ({rootElement:d});let f=(0,lJ.useCallback)(e=>{e.preventDefault()},[]);return(0,lG.jsxs)(P8,{align:"center",ref:c,onMouseDown:f,children:[h&&(0,lG.jsx)(P7,{flex:p?1:void 0,children:(0,lG.jsx)(P9,{padding:l?2:1,children:(0,lG.jsx)(P0,{disabled:i,items:n})})}),(0,lG.jsxs)(l4.kC,{flex:1,children:[o>0&&(0,lG.jsx)(Ae,{flex:p?void 0:1,padding:l?2:1,$withInsertMenu:s,children:(0,lG.jsx)(PV,{disabled:i,collapsed:p,groups:t,isFullscreen:l})}),s&&(0,lG.jsx)(l4.xu,{flex:p?void 0:1,padding:l?2:1,children:(0,lG.jsx)(P3,{disabled:i,collapsed:p,items:r,isFullscreen:l})})]}),(0,lG.jsx)(At,{padding:l?2:1,children:(0,lG.jsx)(l4.u,{content:(0,lG.jsxs)(l4.kC,{align:"center",padding:1,children:[(0,lG.jsx)(l4.xu,{flex:1,paddingX:1,children:(0,lG.jsx)(l4.xv,{size:1,children:"".concat(l?"Collapse":"Expand"," editor")})}),(0,lG.jsx)(l4.xu,{marginLeft:1,children:(0,lG.jsx)(l4.p8,{keys:["".concat(An?"Cmd":"Ctrl"),"Enter"]})})]}),placement:l?"bottom":"top",portal:"default",children:(0,lG.jsx)(l4.zx,{padding:2,icon:l?a8.W5x:a8.Qq,mode:"bleed",onClick:a})})})]})});function Ar(e){let{hotkeys:t,isFullscreen:n,readOnly:i,onMemberOpen:r,onToggleFullscreen:l}=e,a=(0,sE._F)(),o=(0,sE.L9)(),s=Vg(),d=i||!o,{push:c}=(0,l4.pm)(),u=(0,lJ.useCallback)(e=>{let t=!1,n=setTimeout(()=>{t=!0,c({id:"resolving-initial-value",status:"info",title:"Resolving initial value…"})},300);return s(e,{}).then(e=>(t&&c({id:"resolving-initial-value",status:"info",duration:500,title:"Initial value resolved"}),e)).catch(t=>{c({title:"Could not resolve initial value",id:"resolving-initial-value",description:"Unable to resolve initial value for type: ".concat(e.name,": ").concat(t.message,"."),status:"error"})}).finally(()=>clearTimeout(n))},[c,s]),p=(0,lJ.useCallback)(async e=>{let t=await u(e),n=sE.q$.insertBlock(a,e,t);n&&r(n)},[a,r,u]),h=(0,lJ.useCallback)(async e=>{let t=await u(e),n=sE.q$.insertChild(a,e,t);n&&r(n)},[a,r,u]),f=function(e){let{hotkeys:t,onMemberOpen:n,resolveInitialValue:i,disabled:r}=e,l=(0,sE._F)(),a=(0,lJ.useCallback)(async e=>{let t=await i(e),r=sE.q$.addAnnotation(l,e,t);r&&r.markDefPath&&n(r.markDefPath)},[l,n,i]);return(0,lJ.useMemo)(()=>l?[{name:"format",actions:l.schemaTypes.decorators.map(e=>{let n=Object.keys(t.marks||{}).find(n=>{var i;return(null==(i=t.marks)?void 0:i[n])===e.value}),i=[];return n&&(i=[n]),{type:"format",disabled:r,icon:null==e?void 0:e.icon,key:e.value,handle:()=>{sE.q$.toggleMark(l,e.value),sE.q$.focus(l)},hotkeys:i,title:e.title}})},{name:"list",actions:l.schemaTypes.lists.map(e=>({type:"listStyle",key:e.value,disabled:r,icon:null==e?void 0:e.icon,handle:()=>{sE.q$.toggleList(l,e.value)},title:e.title}))},{name:"annotation",actions:function(e,t,n){let i=e.schemaTypes,r=sE.q$.focusChild(e),l=r&&r.text;return i.annotations.map(i=>({type:"annotation",disabled:!l||t,icon:ob()(i,"icon")||ob()(i,"type.icon")||ob()(i,"type.to.icon")||ob()(i,"type.to[0].icon"),key:i.name,handle:t=>{t?(sE.q$.removeAnnotation(e,i),sE.q$.focus(e)):n(i)},title:i.title||sK()(i.name)}))}(l,r,a)}]:[],[r,l,a,t])}({hotkeys:t,onMemberOpen:r,resolveInitialValue:u,disabled:!0}),m=(0,lJ.useMemo)(()=>a.schemaTypes.styles.map(e=>({key:"style-".concat(e.value),style:e.value,styleComponent:e&&e.component,title:e.title})),[a]),g=(0,lJ.useMemo)(()=>(function(e,t,n,i){let r=e.blockObjects.map((e,t)=>({handle:()=>n(e),icon:PI(e,a8.sTT),inline:!1,key:"block-".concat(t),type:e})),l=e.inlineObjects.map((e,t)=>({handle:()=>i(e),icon:PI(e,a8.Kz2),inline:!0,key:"inline-".concat(t),type:e}));return r.concat(l).filter(e=>{var t;return!(null==(t=e.type)?void 0:t.hidden)})})(a.schemaTypes,0,p,h),[d,a,p,h]);return(0,lG.jsx)(Ai,{actionGroups:f,blockStyles:m,disabled:d,insertMenuItems:g,isFullscreen:n,onToggleFullscreen:l})}var Al=Object.freeze,Aa=Object.defineProperty,Ao=(e,t)=>Al(Aa(e,"raw",{value:Al(t||e.slice())}));let As=(0,a0.ZP)(l4.Zb)(i1||(i1=Ao(["\n  height: ",";\n\n  &:not([hidden]) {\n    display: flex;\n  }\n\n  flex-direction: column;\n"])),e=>{let{$fullscreen:t}=e;return t?"100%":"15em"}),Ad=(0,a0.ZP)(l4.Zb)(i2||(i2=Ao(["\n  z-index: 10;\n  line-height: 0;\n"]))),Ac=(0,a0.ZP)(l4.Zb)(i3||(i3=Ao(["\n  position: relative;\n  overflow: hidden;\n  overflow: clip;\n\n  & > [data-portal] {\n    position: absolute;\n    top: 0;\n    left: 0;\n    right: 0;\n    bottom: 0;\n    pointer-events: none;\n\n    & > * {\n      pointer-events: initial;\n    }\n  }\n\n  &::selection,\n  *::selection {\n    background-color: transparent;\n  }\n"]))),Au=(0,a0.ZP)(cH)(i4||(i4=Ao(["\n  position: relative;\n  overflow: auto;\n  height: 100%;\n  display: flex;\n  flex-direction: column;\n\n  & > * {\n    flex: 1;\n    min-height: auto;\n  }\n"]))),Ap=(0,a0.ZP)(l4.W2)(i5||(i5=Ao(["\n  /* @todo: calculate from theme */\n  /* max-width: 728px; */\n"]))),Ah=(0,a0.ZP)(l4.Zb)(i9||(i9=Ao(["\n  height: 100%;\n  width: 100%;\n  counter-reset: ",";\n  overflow: hidden;\n  overflow: clip;\n\n  & > div {\n    height: 100%;\n  }\n\n  & .pt-editable {\n    display: block;\n    width: 100%;\n    height: 100%;\n\n    ","\n\n    & > .pt-list-item-bullet + .pt-list-item-number,\n    & > .pt-list-item-number + .pt-list-item-bullet {\n      margin-top: ","px;\n      counter-reset: ",";\n    }\n\n    & > :not(.pt-list-item) + .pt-list-item {\n      margin-top: ","px;\n    }\n\n    /* Reset the list count if the element is not a numbered list item */\n    & > :not(.pt-list-item-number) {\n      counter-reset: ",";\n    }\n\n    ","\n\n    & > .pt-list-item + :not(.pt-list-item) {\n      margin-top: ","px;\n    }\n\n    & > :first-child {\n      padding-top: ","px;\n    }\n\n    & > :last-child {\n      padding-bottom: ","px;\n    }\n\n    /* & > .pt-block {\n      & .pt-inline-object {\n      }\n    } */\n\n    & .pt-drop-indicator {\n      pointer-events: none;\n      border: 1px solid var(--card-focus-ring-color) !important;\n      height: 0px !important;\n      border-radius: 1px;\n      margin-top: -3px;\n      left: calc(\n        "," - 1px\n      );\n      right: calc(\n        "," - 1px\n      );\n      width: calc(\n        100% -\n          "," + 2px\n      ) !important;\n    }\n  }\n"])),CX.map(e=>C0(e)).join(" "),CX.map(e=>(0,a0.iv)(i6||(i6=Ao(["\n        & > .pt-list-item-number[class~='pt-list-item-level-","'] {\n          counter-increment: ",";\n        }\n      "])),e,C0(e))),e=>{let{theme:t}=e;return t.sanity.space[3]},CX.map(e=>C0(e)).join(" "),e=>{let{theme:t}=e;return t.sanity.space[2]},CX.map(e=>C0(e)).join(" "),CX.slice(1).map(e=>(0,a0.iv)(i8||(i8=Ao(["\n        & > .pt-list-item-level-"," + .pt-list-item-level-"," {\n          counter-reset: ",";\n        }\n      "])),e,e-1,C0(e))),e=>{let{theme:t}=e;return t.sanity.space[3]},e=>{let{$isFullscreen:t,theme:n}=e;return n.sanity.space[t?5:3]},e=>{let{$isFullscreen:t,theme:n}=e;return n.sanity.space[t?9:5]},e=>{let{$isFullscreen:t,theme:n}=e;return t?(0,l4.hO)(n.sanity.space[5]):(0,l4.hO)(n.sanity.space[3])},e=>{let{$isFullscreen:t,theme:n}=e;return t?(0,l4.hO)(n.sanity.space[5]):(0,l4.hO)(n.sanity.space[3])},e=>{let{$isFullscreen:t,theme:n}=e;return t?(0,l4.hO)(2*n.sanity.space[5]):(0,l4.hO)(2*n.sanity.space[3])}),Af=e=>{let{block:t,focused:n,children:i,selected:r,schemaType:l}=e,a=(0,lJ.useMemo)(()=>(t.style&&_g[t.style]?_g[t.style]:_g[0])||_o,[t.style]),o=(0,lJ.useCallback)(e=>(0,lG.jsx)(a,{children:(0,lG.jsx)(_a,{"data-testid":"text-style--".concat(t.style),children:e.children})}),[a,t.style]);return(0,lJ.useMemo)(()=>{let e=l.component,{title:a,value:s}=l,d={block:t,focused:n,renderDefault:o,schemaType:l,selected:r,title:a,value:s};return e?(0,lG.jsx)(e,{...d,children:i}):(0,lG.jsx)(o,{...d,children:i})},[o,t,i,n,l,r])},Am=e=>(0,lG.jsx)(lG.Fragment,{children:e.children}),Ag=e=>{let{block:t,children:n,schemaType:i,selected:r,focused:l,level:a,value:o}=e,{title:s,component:d}=i;return(0,lJ.useMemo)(()=>{let e={block:t,focused:l,level:a,renderDefault:Am,schemaType:i,selected:r,title:s,value:o};return d?(0,lG.jsx)(d,{...e,children:n}):(0,lG.jsx)(Am,{...e,children:n})},[d,t,n,l,a,i,r,s,o])},Ax={outline:"none"},Av=e=>(0,lG.jsx)(Pc,{...e}),Ab=e=>(0,lG.jsx)(Af,{...e}),Ay=e=>(0,lG.jsx)(Ag,{...e});function Aj(e){let{hotkeys:t,initialSelection:n,isActive:i,isFullscreen:r,onCopy:l,onItemOpen:a,onPaste:o,onToggleFullscreen:s,path:d,readOnly:c,renderAnnotation:u,renderBlock:p,renderChild:h,scrollElement:f,setPortalElement:m,setScrollElement:g,ariaDescribedBy:x}=e,{isTopLayer:v}=(0,l4.sJ)(),b=(0,lJ.useRef)(null),{element:y}=(0,l4.sz)();(0,l4.qh)((0,lJ.useCallback)(e=>{v&&r&&"Escape"===e.key&&s()},[s,r,v]));let j=(0,lJ.useCallback)(()=>(0,lG.jsx)("span",{"data-testid":"pt-input-placeholder",children:"Empty"}),[]),w=function(){let e=(0,sE._F)();return(0,lJ.useMemo)(()=>{var t;let n=null==(t=e.schemaTypes.block.options)?void 0:t.spellCheck,i="undefined"!=typeof navigator&&/Chrome\/96/.test(navigator.userAgent);return(void 0!==n||!0!==i)&&n},[e])}(),k=(0,lJ.useMemo)(()=>(e,t)=>{if(sE.q$.getSelection(e)){let e=t.startContainer.parentElement;e&&(0,sF.Z)(e,{scrollMode:"if-needed",boundary:f,block:"start",inline:"nearest"})}},[f]),C=(0,lJ.useMemo)(()=>(0,lG.jsx)(sE.iV,{"aria-describedby":x,hotkeys:t,onCopy:l,onPaste:o,ref:b,renderAnnotation:u,renderBlock:p,renderChild:h,renderDecorator:Av,renderListItem:Ay,renderPlaceholder:j,renderStyle:Ab,scrollSelectionIntoView:k,selection:n,spellCheck:w,style:Ax}),[x,t,n,l,o,u,p,h,j,k,w]),_=(0,lJ.useCallback)(e=>{a(d.concat(e))},[a,d]);return(0,lG.jsxs)(As,{$fullscreen:r,"data-testid":"pt-editor",children:[i&&(0,lG.jsx)(Ad,{"data-testid":"pt-editor__toolbar-card",shadow:1,children:(0,lG.jsx)(Ar,{hotkeys:t,isFullscreen:r,onMemberOpen:_,onToggleFullscreen:s,readOnly:c})}),(0,lG.jsxs)(Ac,{flex:1,tone:c?"transparent":"default",children:[(0,lG.jsx)(Au,{ref:g,children:(0,lG.jsx)(Ap,{padding:r?2:0,sizing:"border",width:1,children:(0,lG.jsx)(Ah,{$isFullscreen:r,tone:c?"transparent":"default",children:(0,lG.jsx)(l4.NM,{element:r?f:y,children:C})})})}),(0,lG.jsx)("div",{"data-portal":"",ref:m})]})]})}var Aw=Object.freeze,Ak=Object.defineProperty,AC=(e,t)=>Aw(Ak(e,"raw",{value:Aw(t||e.slice())}));let A_=a0.ZP.div(e=>{let{theme:t}=e,{focusRing:n,input:i}=t.sanity,r=t.sanity.color.base,l={color:t.sanity.color.input.default.enabled.border,width:i.border.width};return(0,a0.iv)(i7||(i7=AC(["\n    --input-box-shadow: ",";\n\n    position: relative;\n\n    & [data-wrapper] {\n      overflow: hidden;\n      overflow: clip;\n      position: relative;\n      z-index: 1;\n      padding: ","px;\n    }\n\n    & [data-border] {\n      position: absolute;\n      top: 0;\n      left: 0;\n      right: 0;\n      bottom: 0;\n      box-shadow: var(--input-box-shadow);\n      z-index: 2;\n      border-radius: 1px;\n      pointer-events: none;\n    }\n\n    &:not([data-read-only])[data-focused] [data-border] {\n      --input-box-shadow: ",";\n    }\n  "])),_0(l),i.border.width,_1({base:r,border:l,focusRing:n}))}),AS=(0,a0.ZP)(l4.mh)(re||(re=AC(["\n  position: absolute;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n"])));function AT(e){let{changed:t,focused:n,focusPath:i=ch,hasFocusWithin:r,hotkeys:l,isActive:a,isFullscreen:o,onActivate:s,onCopy:d,onItemClose:c,onItemOpen:u,onItemRemove:p,onPaste:h,onPathFocus:f,onToggleFullscreen:m,path:g,readOnly:x,renderAnnotation:v,renderBlock:b,renderBlockActions:y,renderCustomMarkers:j,renderField:w,renderInlineBlock:k,renderInput:C,renderItem:_,renderPreview:S,value:T}=e,E=(0,sE._F)(),P=(0,l4.sz)().element,[A,O]=(0,lJ.useState)(null),[z,M]=(0,lJ.useState)(null),I=(0,lJ.useCallback)(()=>{m()},[m]),R=function(e){let t=(0,sE._F)(),[n]=(0,lJ.useState)(()=>e);return n!==e&&console.warn("Make sure that hotkeys are a stable object across renders, or there will be issues with key handling in the Portable Text Editor."),(0,lJ.useMemo)(()=>{let e={marks:{}};return t.schemaTypes.decorators.forEach(t=>{switch(t.value){case"strong":e.marks["mod+b"]=t.value;break;case"em":e.marks["mod+i"]=t.value;break;case"underline":e.marks["mod+u"]=t.value;break;case"code":e.marks["mod+'"]=t.value}}),{marks:{...e.marks,...(n||{}).marks},custom:n.custom}},[t,n])}((0,lJ.useMemo)(()=>({...l,custom:{"mod+enter":m,...(null==l?void 0:l.custom)||{}}}),[l,m])),F=T&&y?y:void 0,D=T&&j?j:void 0,[Z,L]=(0,lJ.useState)(null),q=(0,lJ.useCallback)(e=>{let{children:t,focused:n,path:i,selected:r,schemaType:l,value:a}=e;return(0,lG.jsx)(_x,{floatingBoundary:P,focused:n,isFullscreen:o,onItemClose:c,onItemOpen:u,onItemRemove:p,onPathFocus:f,path:g.concat(i),readOnly:x,referenceBoundary:z,renderAnnotation:v,renderField:w,renderInlineBlock:k,renderInput:C,renderItem:_,renderBlockActions:F,renderCustomMarkers:D,renderPreview:S,renderBlock:b,schemaType:l,selected:r,value:a,children:t})},[F,D,z,o,c,u,p,f,P,g,x,v,b,w,k,C,_,S]),N=(0,lJ.useCallback)(e=>{let{focused:t,path:n,selected:i,schemaType:r,value:l}=e;return(0,lG.jsx)(CW,{floatingBoundary:P,focused:t,isFullscreen:o,onItemClose:c,onItemOpen:u,onItemRemove:p,onPathFocus:f,path:g.concat(n),readOnly:x,referenceBoundary:z,relativePath:n,renderAnnotation:v,renderBlock:b,renderBlockActions:F,renderCustomMarkers:D,renderField:w,renderInlineBlock:k,renderInput:C,renderItem:_,renderPreview:S,schemaType:r,selected:i,value:l})},[P,z,o,c,u,p,f,g,x,v,b,F,D,w,k,C,_,S]),V=(0,lJ.useCallback)(e=>{let{value:t}=e;return t._type===E.schemaTypes.block.name?q(e):N(e)},[E.schemaTypes.block.name,N,q]),U=(0,lJ.useCallback)(e=>{let{children:t,focused:n,path:i,selected:r,schemaType:l,value:a}=e;return a._type===E.schemaTypes.span.name?t:(0,lG.jsx)(_A,{floatingBoundary:P,focused:n,onItemClose:c,onItemOpen:u,onPathFocus:f,path:g.concat(i),readOnly:x,referenceBoundary:z,relativePath:i,renderAnnotation:v,renderBlock:b,renderCustomMarkers:j,renderField:w,renderInlineBlock:k,renderInput:C,renderItem:_,renderPreview:S,schemaType:l,selected:r,value:a})},[P,z,E.schemaTypes.span.name,c,u,f,g,x,v,b,j,w,k,C,_,S]),B=(0,lJ.useCallback)(e=>{let{children:t,focused:i,path:r,selected:l,schemaType:a,value:o}=e;return(0,lG.jsx)(_V,{editorNodeFocused:i,floatingBoundary:P,focused:!!n,onItemClose:c,onItemOpen:u,onPathFocus:f,path:g.concat(r),readOnly:x,referenceBoundary:z,renderAnnotation:v,renderBlock:b,renderCustomMarkers:j,renderField:w,renderInlineBlock:k,renderInput:C,renderItem:_,renderPreview:S,schemaType:a,selected:l,value:o,children:t})},[P,z,n,c,u,f,g,x,v,b,j,w,k,C,_,S]),K=e.elementProps["aria-describedby"],H=(0,lJ.useMemo)(()=>{if(r)return{anchor:{path:i,offset:0},focus:{path:i,offset:0}}},[]),W=(0,lJ.useMemo)(()=>(0,lG.jsx)(Aj,{ariaDescribedBy:K,initialSelection:H,hotkeys:R,isActive:a,isFullscreen:o,onItemOpen:u,onCopy:d,onPaste:h,onToggleFullscreen:I,path:g,readOnly:x,renderAnnotation:B,renderBlock:V,renderChild:U,setPortalElement:L,scrollElement:z,setScrollElement:M}),[K,R,B,V,U,I,H,a,o,d,u,h,g,x,z]),$=(0,l4.vI)(),X=(0,lJ.useMemo)(()=>({collapsed:A,default:$.element,editor:Z,expanded:$.element}),[$.element,Z,A]);!function(e){let{focusPath:t,boundaryElement:n,onItemClose:i}=e,r=function(){let e=(0,lJ.useContext)(Cv);if(!e)throw Error("Form context not provided");return e}(),l=(0,sE._F)(),a=(0,sE.L9)();(0,lJ.useLayoutEffect)(()=>{var e,i,o,s,d;if(0===t.length)return;let c=r.find(e=>e.member.open);if(c&&(null==(e=c.elementRef)?void 0:e.current)){if(n&&((0,sF.Z)(n,{scrollMode:"if-needed",block:"start",inline:"start"}),(0,sF.Z)(c.elementRef.current,{scrollMode:"if-needed",boundary:n,block:"start",inline:"start"})),(null==a?void 0:a.focus.path)&&(0,lY.Xy)(a.focus.path,t))return;let e="textBlock"===c.kind,r=1===t.length;if(e||r){let n=e&&(0,lX.fU)(t[2])?t[2]._key:void 0,a=n&&Array.isArray(null==(i=c.node.value)?void 0:i.children)?null==(o=c.node.value)?void 0:o.children.find(e=>e._key===n):void 0,u=a&&"span"===a._type&&4===t.length&&"children"===t[1]&&"text"===t[3]||!1,p=e&&(3===t.length&&"children"===t[1]||u),h=[];p?h=t.slice(0,3):e&&r&&Array.isArray(null==(s=c.node.value)?void 0:s.children)?h=[t[0],"children",{_key:null==(d=c.node.value)?void 0:d.children[0]._key}]:r&&(h=[{_key:c.key}]),h.length&&(sE.q$.select(l,{anchor:{path:h,offset:0},focus:{path:h,offset:0}}),e&&sE.q$.focus(l))}}},[n,l,t,i,r,null==a?void 0:a.focus.path])}({focusPath:i,boundaryElement:z,onItemClose:c});let G=n||r;return(0,lG.jsx)(l4.Xp,{__unstable_elements:X,element:$.element,children:(0,lG.jsx)(Pa,{onActivate:s,isOverlayActive:!a,children:(0,lG.jsx)(cU,{disabled:o,hasFocus:!!n,isChanged:t,path:g,children:(0,lG.jsxs)(A_,{"data-focused":G?"":void 0,"data-read-only":x?"":void 0,children:[(0,lG.jsx)(l4.xu,{"data-wrapper":"",ref:O,children:(0,lG.jsx)(l4.h_,{__unstable_name:o?"expanded":"collapsed",children:o?(0,lG.jsx)(AS,{children:W}):W})}),(0,lG.jsx)("div",{"data-border":""})]})})})})}function AE(e){let{onChange:t,onIgnore:n,resolution:i,readOnly:r}=e,l=(0,lJ.useCallback)(()=>{i&&t({type:"mutation",patches:i.patches})},[t,i]);return i?(0,lG.jsx)(mH,{suffix:(0,lG.jsxs)(l4.Kq,{padding:2,children:[i.action&&(0,lG.jsxs)(l4.rj,{columns:[1,2],gap:1,children:[(0,lG.jsx)(l4.zx,{mode:"ghost",onClick:n,text:"Ignore"}),!r&&(0,lG.jsx)(l4.zx,{onClick:l,text:i.action,tone:"caution"})]}),(0,lG.jsx)(l4.xu,{padding:3,children:i.action&&(0,lG.jsx)(l4.xv,{as:"p",muted:!0,size:1,children:"NOTE: It’s generally safe to perform the action above, but if you are in doubt, get in touch with those responsible for configuring your studio."})})]}),title:(0,lG.jsx)(lG.Fragment,{children:"Invalid Portable Text Editor value"}),children:(0,lG.jsxs)(l4.Kq,{space:3,children:[(0,lG.jsx)(l4.xv,{as:"p",muted:!0,size:1,children:i.description}),(0,lG.jsx)(l4.Zb,{border:!0,overflow:"auto",padding:2,tone:"inherit",children:(0,lG.jsx)(l4.EK,{language:"json",children:JSON.stringify(i.item,null,2)})})]})}):null}function AP(e,t){if(e===t)return!0;if(!Array.isArray(e)||!Array.isArray(t)||e.length<t.length)return!1;for(let n=0,i=t.length;n<i;n++)if(!function(e,t){let n=typeof e;return n===typeof t&&("object"===n?a6()(e,t):e===t)}(t[n],e[n]))return!1;return!0}function AA(e){let{elementProps:t,hotkeys:n,markers:i=ch,members:r,onChange:l,onCopy:a,onItemRemove:o,onInsert:s,onPaste:d,onPathFocus:c,path:u,readOnly:p,renderBlockActions:h,renderCustomMarkers:f,schemaType:m,value:g}=e,{onBlur:x}=t;(0,lJ.useImperativeHandle)(t.ref,()=>({focus(){b.current&&sE.q$.focus(b.current)}}));let{subscribe:v}=function(e){let{path:t}=e,{patchChannel:n}=mY().__internal;return{subscribe:(0,lJ.useCallback)(e=>n.subscribe(n=>{let{snapshot:i,patches:r}=n,l=r.filter(e=>AP(e.path,t)).map(e=>({...e,path:e.path.slice(t.length)}));l.length&&e({shouldReset:r.some(e=>{var n;return(0===(n=e.path).length||AP(t,n)&&!AP(n,t))&&("set"===e.type||"unset"===e.type)}),snapshot:cg(i)?t.reduce((e,t)=>"object"==typeof t?sY()(e,t):ob()(e,t),i):{},patches:l})}),[t,n])}}({path:u}),b=(0,lJ.useRef)(null),[y,j]=(0,lJ.useState)(!1),[w,k]=(0,lJ.useState)(null),[C,_]=(0,lJ.useState)(!1),[S,T]=(0,lJ.useState)(!1),[E,P]=(0,lJ.useState)(!1),[A,O]=(0,lJ.useState)(!1),z=(0,l4.pm)(),M=(0,lJ.useRef)([]),I=(0,lJ.useMemo)(()=>new l7.x,[]),R=(0,lJ.useMemo)(()=>I.asObservable(),[I]),F=(0,lJ.useRef)(null),D=(0,lJ.useCallback)(()=>{b.current&&_(e=>!e)},[]);(0,lJ.useEffect)(()=>{w&&g!==w.value&&k(null)},[w,g]),(0,lJ.useEffect)(()=>v(e=>{let{patches:t,snapshot:n}=e;I.next({patches:t,snapshot:n})}),[I,v]);let Z=(0,lJ.useMemo)(()=>{var t;let n=[];for(let e of r)if("item"===e.kind){if(Cu(e.item.schemaType)){(e.item.validation.length>0||e.item.changed||(null==(t=e.item.presence)?void 0:t.length))&&n.push({kind:"textBlock",member:e,node:e.item});let i=e.item.members.find(e=>"field"===e.kind&&"children"===e.name);if(i&&"field"===i.kind&&ks(i))for(let e of i.field.members)"item"===e.kind&&"span"!==e.item.schemaType.name&&n.push({kind:"inlineObject",member:e,node:e.item});let r=e.item.members.filter(Cp).find(e=>"markDefs"===e.name);if(r)for(let e of r.field.members)"item"===e.kind&&"object"===e.item.schemaType.jsonType&&n.push({kind:"annotation",member:e,node:e.item})}else n.push({kind:"objectBlock",member:e,node:e.item})}let i=n.map(t=>{let n;let i=gP(t.node.path),r=M.current.find(e=>e.key===i);if("textBlock"!==t.kind&&(t.member.open||!r)){let i={...e,absolutePath:t.node.path};n=(0,lG.jsx)(kF,{...i})}return r?(r.input=n,r.member=t.member,r.node=t.node,r):{kind:t.kind,key:i,member:t.member,node:t.node,elementRef:(0,lJ.createRef)(),input:n}});return M.current=i,i},[r,e]);(0,lJ.useEffect)(()=>{A&&T(!0)},[A]);let L=(0,lJ.useCallback)(e=>{switch(e.type){case"mutation":case"undo":case"redo":l(e.patches.map(e=>({...e,patchType:mF})));break;case"connection":"offline"===e.value?P(!0):"online"===e.value&&P(!1);break;case"selection":(0,lJ.startTransition)(()=>{e.selection&&c(e.selection.focus.path)});break;case"focus":T(!0),O(!0);break;case"blur":x(e.event),O(!1);break;case"invalidValue":k(e);break;case"error":z.push({status:e.level,description:e.description})}},[x,l,c,z]);(0,lJ.useEffect)(()=>{j(!1)},[g]);let q=(0,lJ.useCallback)(()=>{j(!0)},[]),N=(0,lJ.useMemo)(()=>w&&w.resolution?(0,lG.jsx)(l4.xu,{marginBottom:2,children:(0,lG.jsx)(AE,{onChange:L,onIgnore:q,resolution:w.resolution,readOnly:E||p})}):null,[L,q,w,E,p]),V=(0,lJ.useCallback)(()=>{!S&&(T(!0),b.current&&sE.q$.focus(b.current))},[S]);return(0,lG.jsxs)(l4.xu,{ref:F,children:[!y&&N,(!w||y)&&(0,lG.jsx)(Cg,{markers:i,children:(0,lG.jsx)(Cb,{memberItems:Z,children:(0,lG.jsx)(sE.q$,{ref:b,patches$:R,onChange:L,maxBlocks:void 0,readOnly:E||p,schemaType:m,value:g,children:(0,lG.jsx)(AT,{...e,hasFocusWithin:A,hotkeys:n,isActive:S,isFullscreen:C,onActivate:V,onItemRemove:o,onCopy:a,onInsert:s,onPaste:d,onToggleFullscreen:D,renderBlockActions:h,renderCustomMarkers:f})})})})]})}function AO(e){return"inset 0 0 0 ".concat(e.width,"px ").concat(e.color)}var Az=Object.freeze,AM=Object.defineProperty,AI=(e,t)=>Az(AM(e,"raw",{value:Az(t||e.slice())}));let AR=(0,a0.ZP)(l4.Zb)(e=>{let{theme:t}=e,{focusRing:n,input:i,radius:r}=t.sanity,l=t.sanity.color.input,a=(0,l4.hO)(t.sanity.space[1]);return{position:"relative",borderRadius:"".concat(r[1],"px"),color:l.default.enabled.fg,boxShadow:AO({color:l.default.enabled.border,width:i.border.width}),"& > .content":{position:"relative",lineHeight:0,margin:"-".concat(a," 0 0 -").concat(a)},"& > .content > div":{display:"inline-block",verticalAlign:"top",padding:"".concat(a," 0 0 ").concat(a)},"&:not([data-read-only])":{cursor:"text"},"@media(hover:hover):not([data-disabled]):not([data-read-only]):hover":{borderColor:l.default.hovered.border},"&:not([data-disabled]):not([data-read-only])[data-focused]":{boxShadow:function(e){let{base:t,border:n,focusRing:i}=e,r=i.offset+i.width,l=0-i.offset,a=t?t.bg:"var(--card-bg-color)";return[l>0&&"inset 0 0 0 ".concat(l,"px var(--card-focus-ring-color)"),n&&AO(n),l<0&&"0 0 0 ".concat(0-l,"px ").concat(a),r>0&&"0 0 0 ".concat(r,"px var(--card-focus-ring-color)")].filter(Boolean).join(",")}({border:{color:l.default.enabled.border,width:i.border.width},focusRing:n})},"*:disabled + &":{color:l.default.disabled.fg,backgroundColor:l.default.disabled.bg,boxShadow:AO({color:l.default.disabled.border,width:i.border.width})}}}),AF=a0.ZP.input(e=>{let{theme:t}=e,n=t.sanity.fonts.text,i=t.sanity.color.input,r=t.sanity.space[2],l=t.sanity.fonts.text.sizes[2];return{appearance:"none",background:"none",border:0,borderRadius:0,outline:"none",fontSize:(0,l4.hO)(l.fontSize),lineHeight:l.lineHeight/l.fontSize,fontFamily:n.family,fontWeight:n.weights.regular,margin:0,display:"block",minWidth:"1px",maxWidth:"100%",boxSizing:"border-box",paddingTop:(0,l4.hO)(r-l.ascenderHeight),paddingRight:(0,l4.hO)(r),paddingBottom:(0,l4.hO)(r-l.descenderHeight),paddingLeft:(0,l4.hO)(r),"&:not(:invalid):not(:disabled)":{color:i.default.enabled.fg},"&:not(:invalid):disabled":{color:i.default.disabled.fg}}}),AD=(0,a0.ZP)(l4.xu)(e=>{let{theme:t}=e,n=t.sanity.color.input;return(0,a0.iv)(rt||(rt=AI(["\n    position: absolute;\n    top: 0;\n    left: 0;\n    right: 0;\n    pointer-events: none;\n    --card-fg-color: ",";\n  "])),n.default.enabled.placeholder)}),AZ=(0,a0.ZP)(l4.xu)(rn||(rn=AI(['\n  // This is needed to make textOverflow="ellipsis" work properly for the Text primitive\n  max-width: 100%;\n']))),AL=(0,lJ.forwardRef)((e,t)=>{let{disabled:n,onChange:i,onFocus:r,placeholder:l,readOnly:a,value:o=[],...s}=e,d=(0,lJ.useMemo)(()=>l||("undefined"!=typeof window&&"ontouchstart"in window?"Enter tag…":"Enter tag and press ENTER…"),[l]),[c,u]=(0,lJ.useState)(""),p=!n&&!a,[h,f]=(0,lJ.useState)(!1),m=(0,l4.ts)(t),g=(0,lJ.useRef)(null),x=(0,lJ.useCallback)(e=>{if((0,l4.Re)(e.target)&&e.target.closest('[data-ui="Tag"]'))return;let t=m.current;t&&setTimeout(()=>t.focus(),0)},[m]),v=(0,lJ.useCallback)(()=>{f(!1)},[]),b=(0,lJ.useCallback)(e=>{u(e.currentTarget.value)},[]),y=(0,lJ.useCallback)(e=>{f(!0),r&&r(e)},[r]),j=(0,lJ.useCallback)(e=>{if("Enter"===e.key&&(e.preventDefault(),e.stopPropagation(),i&&c)){let e=o.concat([{value:c}]);u(""),i&&i(e)}},[c,i,o]),w=(0,lJ.useCallback)(e=>{if(!i)return;let t=o.slice(0);t.splice(e,1),i(t)},[i,o]);return(0,lJ.useEffect)(()=>{let e=m.current;e&&(e.style.width="0",e.style.width="".concat(e.scrollWidth,"px"))},[m,c]),(0,lG.jsxs)(AR,{"data-disabled":n?"":void 0,"data-focused":h?"":void 0,"data-read-only":a?"":void 0,"data-ui":"TagInput",onPointerDown:x,overflow:"auto",padding:1,ref:g,children:[p&&(0,lG.jsx)(AD,{hidden:!!(c||o.length),padding:3,children:(0,lG.jsx)(l4.xv,{textOverflow:"ellipsis",children:d})}),(0,lG.jsxs)("div",{className:"content",children:[o.map((e,t)=>(0,lG.jsx)(AZ,{children:(0,lG.jsx)(Aq,{enabled:p,index:t,muted:!p,onRemove:w,tag:e})},"tag-".concat(t))),(0,lG.jsx)("div",{children:(0,lG.jsx)(AF,{...s,disabled:!p,onBlur:v,onChange:b,onFocus:y,onKeyDown:j,ref:m,type:"text",value:c})},"tag-input")]})]})});function Aq(e){let{enabled:t,index:n,muted:i,onRemove:r,tag:l}=e,a=(0,lJ.useCallback)(()=>{r(n)},[n,r]);return(0,lG.jsx)(l4.Zb,{"data-ui":"Tag",padding:1,radius:2,tone:"transparent",children:(0,lG.jsxs)(l4.kC,{align:"center",children:[(0,lG.jsx)(l4.xu,{flex:1,padding:1,children:(0,lG.jsx)(l4.xv,{muted:i,textOverflow:"ellipsis",children:l.value})}),t&&(0,lG.jsx)(l4.xu,{marginLeft:1,children:(0,lG.jsx)(l4.zx,{icon:a8.Two,mode:"bleed",onClick:a,padding:1})})]})})}function AN(e){let{onChange:t,readOnly:n,value:i=[],elementProps:r,path:l,changed:a}=e,o=(0,lJ.useMemo)(()=>null==i?void 0:i.map(e=>({value:e})),[i]),s=(0,lJ.useCallback)(e=>{t(0===e.length?mq():mL(e.map(e=>e.value)))},[t]);return(0,lG.jsx)(cU,{path:l,isChanged:a,hasFocus:!1,children:(0,lG.jsx)(AL,{onChange:s,readOnly:n,value:o,...r})})}AL.displayName="TagInput";let AV={portal:!0,tone:"default"};function AU(e){let{member:t,sortable:n,onRemove:i}=e,r=(0,lJ.useId)();return(0,lG.jsx)(l4.xu,{paddingX:1,children:(0,lG.jsx)(j6,{dragHandle:n,tone:"caution",menu:(0,lG.jsx)(l4.j2,{button:(0,lG.jsx)(l4.zx,{padding:2,mode:"bleed",icon:a8.zGg}),id:"".concat(r,"-menuButton"),menu:(0,lG.jsx)(l4.v2,{children:(0,lG.jsx)(l4.sN,{text:"Remove",tone:"critical",icon:a8.XHJ,onClick:i})}),popover:AV}),children:"INVALID_ITEM_TYPE"===t.error.type?(0,lG.jsx)(E5,{value:t.error.value}):(0,lG.jsxs)("div",{children:["Unexpected Error: ",t.error.type]})})})}function AB(e){let{hoveringFiles:t,types:n,resolveUploader:i}=e,r=t.filter(e=>n.some(t=>i(t,e))),l=t.length-r.length,a=n.length>1;return(0,lG.jsx)(lG.Fragment,{children:r.length>0?(0,lG.jsxs)(lG.Fragment,{children:[(0,lG.jsxs)(l4.gF,{space:2,children:[(0,lG.jsx)(l4.xv,{children:(0,lG.jsx)(a8.rG2,{})}),(0,lG.jsxs)(l4.xv,{children:["Drop to upload"," ",a&&(0,lG.jsxs)(lG.Fragment,{children:[r.length," file",r.length>1?"s":""]})]})]}),l>0&&(0,lG.jsx)(l4.xu,{marginTop:4,children:(0,lG.jsxs)(l4.gF,{space:2,children:[(0,lG.jsx)(l4.xv,{muted:!0,size:1,children:(0,lG.jsx)(a8.vaB,{})}),(0,lG.jsxs)(l4.xv,{muted:!0,size:1,children:[l," file",l>1?"s":""," can't be uploaded here"]})]})})]}):(0,lG.jsxs)(l4.gF,{space:2,children:[(0,lG.jsx)(l4.xv,{children:(0,lG.jsx)(a8.vaB,{})}),(0,lG.jsxs)(l4.xv,{children:["Can't upload ",t.length>1?"any of these files":"this file"," here"]})]})})}var AK=Object.freeze,AH=Object.defineProperty;let AW=(0,a0.ZP)(l4.mh)(ri||(ri=AK(AH(G=["\n  position: absolute;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  top: -2px;\n  left: -2px;\n  right: -2px;\n  bottom: -2px;\n  background-color: var(--card-bg-color);\n  opacity: 0.8;\n"],"raw",{value:AK(G.slice())}))));var A$=Object.freeze,AX=Object.defineProperty;let AG=a0.ZP.div(rr||(rr=A$(AX(Y=["\n  position: relative;\n"],"raw",{value:A$(Y.slice())})))),AY=_5(function(e){let t=_Q(e);return lJ.forwardRef(function(e,n){let{children:i,resolveUploader:r,onUpload:l,types:a,...o}=e,{push:s}=(0,l4.pm)(),d=lJ.useCallback((e,t)=>{let{type:n,uploader:i}=t;null==l||l({file:e,schemaType:n,uploader:i})},[l]),c=lJ.useCallback(e=>{if(!r)return;let t=e.map(e=>({file:e,uploaderCandidates:a.map(t=>({type:t,uploader:r(t,e)})).filter(e=>e.uploader)})),n=t.filter(e=>e.uploaderCandidates.length>0),i=t.filter(e=>0===e.uploaderCandidates.length);if(i.length>0){let e=i.length>1;s({closable:!0,status:"warning",title:"The following item".concat(e?"s":""," can't be uploaded because there's no known conversion from content type").concat(e?"s":""," to array item:"),description:i.map((e,t)=>(0,lG.jsxs)(l4.kC,{padding:2,children:[(0,lG.jsx)(l4.xu,{marginLeft:1,children:(0,lG.jsx)(l4.xv,{weight:"semibold",children:e.file.name})}),(0,lG.jsx)(l4.xu,{paddingLeft:2,children:(0,lG.jsxs)(l4.xv,{size:1,children:["(",e.file.type,")"]})})]},t))})}n.forEach(e=>{d(e.file,a2()(e.uploaderCandidates,e=>e.uploader.priority)[0])})},[s,r,a,d]),[u,p]=lJ.useState([]),h=lJ.useCallback(()=>p([]),[]);return(0,lG.jsx)(AG,{children:(0,lG.jsxs)(t,{...o,ref:n,onFiles:c,onFilesOver:p,onFilesOut:h,children:[r&&u.length>0&&(0,lG.jsx)(AW,{zOffset:10,children:(0,lG.jsx)(AB,{hoveringFiles:u,types:a,resolveUploader:r})}),i]})})})}(l4.Zb)),AJ={portal:!0,tone:"default"},AQ=lJ.forwardRef(function(e,t){let{sortable:n,value:i,insertableTypes:r,onInsert:l,onRemove:a,readOnly:o,inputId:s,validation:d,children:c,presence:u,schemaType:p}=e,h=d.filter(e=>"error"===e.level).length>0,f=d.filter(e=>"warning"===e.level).length>0,m=(0,lJ.useCallback)((e,t)=>{l({position:e,items:[kS(t)]})},[l]),g=(0,lJ.useCallback)(()=>{i&&l({position:"after",items:[i]})},[l,i]),x=(0,lJ.useMemo)(()=>h?"critical":f?"caution":void 0,[h,f]),v=(0,lG.jsx)(l4.j2,{button:(0,lG.jsx)(l4.zx,{padding:2,mode:"bleed",icon:a8.zGg}),id:"".concat(s,"-menuButton"),popover:AJ,menu:(0,lG.jsxs)(l4.v2,{children:[(0,lG.jsx)(l4.sN,{text:"Remove",tone:"critical",icon:a8.XHJ,onClick:a}),(0,lG.jsx)(l4.sN,{text:"Duplicate",icon:a8.TIy,onClick:g}),(0,lG.jsx)(wu,{types:r,onInsert:m})]})});return(0,lG.jsx)(j6,{tone:x,menu:!o&&v,dragHandle:!o&&n,presence:0===u.length?null:(0,lG.jsx)(yA,{presence:u,maxAvatars:1}),validation:d.length>0?(0,lG.jsx)(l4.xu,{marginLeft:1,paddingX:1,paddingY:3,children:(0,lG.jsx)(jf,{validation:d})}):null,children:(0,lG.jsx)(l4.kC,{align:p?"flex-end":"center",ref:t,children:(0,lG.jsx)(l4.kC,{align:"flex-end",flex:1,children:(0,lG.jsx)(l4.xu,{flex:1,marginRight:2,children:c})})})})});function A0(e){let{schemaType:t,readOnly:n,children:i,onValueCreate:r,onItemAppend:l}=e,a=(0,lJ.useId)(),o=lJ.useCallback(e=>{l(r(e))},[r,l]),s=lJ.useCallback(()=>{o(t.of[0])},[t,o]),d=(0,lJ.useMemo)(()=>({constrainSize:!0,portal:!0}),[]);return n?(0,lG.jsx)(l4.u,{portal:!0,content:(0,lG.jsx)(l4.xu,{padding:2,sizing:"border",children:(0,lG.jsx)(l4.xv,{size:1,children:"This field is read-only"})}),children:(0,lG.jsx)(l4.rj,{children:(0,lG.jsx)(l4.zx,{icon:a8.dtP,mode:"ghost",disabled:!0,text:1===t.of.length?"Add item":"Add item..."})})}):(0,lG.jsxs)(l4.rj,{gap:1,style:{gridTemplateColumns:"repeat(auto-fit, minmax(100px, 1fr))"},children:[1===t.of.length?(0,lG.jsx)(l4.zx,{icon:a8.dtP,mode:"ghost",onClick:s,text:"Add item"}):(0,lG.jsx)(l4.j2,{button:(0,lG.jsx)(l4.zx,{icon:a8.dtP,mode:"ghost",text:"Add item…"}),id:a||"",menu:(0,lG.jsx)(l4.v2,{children:t.of.map((e,t)=>{var n,i;let r=(0,lX.dD)(e)&&1===(e.to||[]).length&&e.to[0].icon,l=e.icon||(null==(n=e.type)?void 0:n.icon)||r;return(0,lG.jsx)(l4.sN,{text:e.title||(null==(i=e.type)?void 0:i.name),onClick:()=>o(e),icon:l},t)})}),popover:d}),i]})}class A1 extends lJ.PureComponent{constructor(e){super(e),this._element=null,this.handleAppend=e=>{let{value:t=[],onIndexFocus:n,onItemAppend:i}=this.props;i(e),n(t.length)},this.handlePrepend=e=>{let{onIndexFocus:t,value:n=[],onItemPrepend:i}=this.props;i(e),t(n.length)},this.handleSortEnd=e=>{let{onIndexFocus:t,onMoveItem:n,value:i}=this.props;i&&n(e),t(e.toIndex)},this.handleItemMoveStart=()=>{this.setState({disableTransition:!1})},this.handleItemMoveEnd=()=>{this.setState({disableTransition:!0})},this.renderArrayItem=e=>{var t;let{schemaType:n}=this.props,i=(null==(t=n.options)?void 0:t.sortable)!==!1;return(0,lG.jsx)(AQ,{...e,sortable:i,insertableTypes:n.of})},this.state={disableTransition:!1}}focus(){this._element&&this._element.focus()}getSnapshotBeforeUpdate(e){var t;let{focusPath:n=[],value:i=[]}=e,{focusPath:r=[],value:l=[]}=this.props;if(n[0]===r[0]&&i.length!==l.length){let e=r[0],n=window.getSelection();if(!((null==n?void 0:n.focusNode)instanceof HTMLElement))return null;let i=null==(t=n.focusNode)?void 0:t.querySelector("input,textarea");return i instanceof HTMLInputElement?{prevFocusedIndex:e,restoreSelection:{text:n.toString(),start:i.selectionStart,end:i.selectionEnd,value:i.value}}:{}}return null}componentDidUpdate(e,t,n){var i;let{onIndexFocus:r}=this.props;if((null==n?void 0:n.restoreSelection)&&e.value){let t=e.value[n.prevFocusedIndex],l=function(e,t,n){let i=t-1,r=t,l=e.length;for(;i>-1||r<l;){let t=e[r];if(r<l&&n(t,r))return r;let a=e[i];if(i>-1&&n(a,i))return i;i--,r++}return -1}(this.props.value||[],n.prevFocusedIndex,e=>e===t);if(-1===l)return;let a=null==(i=this._element)?void 0:i.querySelector("[data-item-index='".concat(l,"'] input,textarea"));if(a instanceof HTMLInputElement){a.focus();try{a.setSelectionRange(n.restoreSelection.start,n.restoreSelection.end)}catch{}}r(l)}}render(){let{schemaType:e,members:t,readOnly:n,renderInput:i,onUpload:r,onItemRemove:l,resolveUploader:a,elementProps:o,arrayFunctions:s=A0,path:d,changed:c}=this.props,u=!n&&!1!==ob()(e,"options.sortable"),p=t.map(e=>({id:"".concat(e.key,"-").concat("item"===e.kind?e.item.value:"error"),member:e}));return(0,lG.jsxs)(l4.Kq,{space:3,"data-testid":"array-primitives-input",children:[(0,lG.jsx)(AY,{types:e.of,resolveUploader:a,onUpload:r,...o,tabIndex:0,children:(0,lG.jsx)(l4.Kq,{space:1,children:0===p.length?(0,lG.jsx)(l4.Zb,{padding:3,border:!0,style:{borderStyle:"dashed"},radius:2,children:(0,lG.jsx)(l4.xv,{align:"center",muted:!0,size:1,children:e.placeholder||(0,lG.jsx)(lG.Fragment,{children:"No items"})})}):(0,lG.jsx)(l4.Zb,{padding:1,border:!0,children:(0,lG.jsx)(j1,{onItemMove:this.handleSortEnd,onItemMoveStart:this.handleItemMoveStart,onItemMoveEnd:this.handleItemMoveEnd,items:p.map(e=>e.id),sortable:u,gap:1,children:p.map((e,t)=>{let{member:n,id:r}=e;return(0,lG.jsxs)(j2,{id:r,sortable:u,disableTransition:this.state.disableTransition,children:["item"===n.kind&&(0,lG.jsx)(cU,{path:n.item.path,isChanged:c,hasFocus:!1,children:(0,lG.jsx)(kT,{member:n,renderItem:this.renderArrayItem,renderInput:i})}),"error"===n.kind&&(0,lG.jsx)(AU,{sortable:u,member:n,onRemove:()=>l(t)})]},n.key)})})})})}),(0,lG.jsx)(s,{onChange:this.props.onChange,onItemAppend:this.handleAppend,onItemPrepend:this.handlePrepend,onValueCreate:kS,readOnly:this.props.readOnly,schemaType:this.props.schemaType,value:this.props.value})]})}}var A2=Object.freeze,A3=Object.defineProperty,A4=(e,t)=>A2(A3(e,"raw",{value:A2(t||e.slice())}));let A5=(0,a0.ZP)(l4.kC)(rl||(rl=A4(["\n  min-height: 35px;\n"]))),A6=(0,a0.ZP)(l4.kC)(ra||(ra=A4(["\n  position: absolute;\n  top: 0;\n  right: 0;\n  height: 35px;\n"]))),A8=(0,a0.ZP)(l4.Zb)(ro||(ro=A4(["\n  position: absolute;\n  top: 0;\n  left: 0;\n"]))),A9=(0,a0.ZP)(l4.Zb)(rs||(rs=A4(["\n  transition: border-color 250ms;\n  box-sizing: border-box;\n  position: relative;\n\n  @media (hover: hover) {\n    "," {\n      opacity: 0;\n    }\n\n    &:hover,\n    &:focus-within {\n      "," {\n        opacity: 1;\n      }\n    }\n  }\n\n  ."," & {\n    box-shadow:\n      0 0 0 0,\n      0 8px 17px 2px var(--card-shadow-umbra-color),\n      0 3px 14px 2px var(--card-shadow-penumbra-color),\n      0 5px 5px -3px var(--card-shadow-ambient-color);\n  }\n\n  &[aria-selected='true'] {\n    box-shadow: 0 0 0 2px var(--card-focus-ring-color);\n  }\n"])),A8,A8,j$);function A7(e){let{validation:t,selected:n,tone:i,presence:r,children:l,dragHandle:a,menu:o,footer:s,...d}=e;return(0,lG.jsxs)(A9,{forwardedAs:l4.kC,direction:"column",border:!0,selected:n,"aria-selected":n,radius:2,tone:i,...d,children:[l,a&&(0,lG.jsx)(A8,{margin:1,radius:2,display:"flex",tone:"inherit","data-ui":"DragHandleCard",children:(0,lG.jsx)(jU,{grid:!0,padding:2,mode:"ghost"})}),r&&(0,lG.jsx)(A6,{align:"center",marginX:1,children:r}),(0,lG.jsxs)(A5,{align:"center",paddingX:1,sizing:"border",justify:"space-between",children:[(0,lG.jsx)(l4.kC,{children:t}),(0,lG.jsx)(l4.xu,{children:s}),o]})]})}var Oe=Object.freeze,Ot=Object.defineProperty;let On=(0,a0.ZP)(l4.Zb)(rd||(rd=Oe(Ot(J=["\n  border-top-right-radius: inherit;\n  border-top-left-radius: inherit;\n  height: 100%;\n  position: relative;\n\n  @media (hover: hover) {\n    &:hover {\n      filter: brightness(95%);\n    }\n  }\n\n  &:focus:focus-visible {\n    box-shadow: 0 0 0 2px var(--card-focus-ring-color);\n  }\n"],"raw",{value:Oe(J.slice())})))),Oi={portal:!0,tone:"default"},Or={position:"absolute",top:0,left:0,bottom:0,right:0};function Ol(e){var t,n,i,r,l,a;let{schemaType:o,parentSchemaType:s,path:d,readOnly:c,onRemove:u,value:p,open:h,onInsert:f,onFocus:m,onOpen:g,onClose:x,changed:v,focused:b,children:y,inputProps:{renderPreview:j}}=e,w=!c&&(null==(t=s.options)?void 0:t.sortable)!==!1,k=s.of,C=(0,lJ.useRef)(null);ya(C,h),m$(b,(e,t)=>{var n;!e&&t&&C.current&&(null==(n=C.current)||n.focus())});let _=p._resolvingInitialValue,S=(0,lJ.useCallback)(()=>{f({items:[{...p,_key:ys()}],position:"after"})},[f,p]),T=(0,lJ.useCallback)((e,t)=>{f({items:[wd(t)],position:e})},[f]),E=gi(d,!0),P=(0,lJ.useMemo)(()=>0===E.length?null:(0,lG.jsx)(yA,{presence:E,maxAvatars:1}),[E]),A=ga(d,!0),O=(0,lJ.useMemo)(()=>0===A.length?null:(0,lG.jsx)(l4.xu,{marginLeft:1,paddingX:1,paddingY:3,children:(0,lG.jsx)(jf,{validation:A,__unstable_showSummary:!0})}),[A]),z=A.some(e=>"error"===e.level),M=A.some(e=>"warning"===e.level),I=(0,lJ.useMemo)(()=>c?null:(0,lG.jsx)(l4.j2,{button:(0,lG.jsx)(l4.zx,{padding:2,mode:"bleed",icon:a8.zGg}),id:"".concat(e.inputId,"-menuButton"),menu:(0,lG.jsxs)(l4.v2,{children:[(0,lG.jsx)(l4.sN,{text:"Remove",tone:"critical",icon:a8.XHJ,onClick:u}),(0,lG.jsx)(l4.sN,{text:"Duplicate",icon:a8.TIy,onClick:S}),(0,lG.jsx)(wu,{types:k,onInsert:T})]}),popover:Oi}),[S,T,u,k,e.inputId,c]),R=function(e){let{readOnly:t,hasErrors:n,hasWarnings:i}=e;return t?"transparent":n?"critical":i?"caution":"default"}({readOnly:c,hasErrors:z,hasWarnings:M}),F=(0,lG.jsx)(A7,{menu:I,presence:P,validation:O,tone:R,radius:2,border:!0,focused:b,dragHandle:w,selected:h,children:(0,lG.jsxs)(On,{tone:"inherit",overflow:"auto",forwardedAs:"button","data-ui":"PreviewCard","data-as":"button",type:"button",flex:1,tabIndex:0,disabled:_,onClick:g,ref:C,onFocus:m,__unstable_focusRing:!0,children:[j({schemaType:o,value:p,layout:"media",withBorder:!1,withShadow:!1}),_&&(0,lG.jsx)(l4.Zb,{as:l4.kC,style:Or,children:(0,lG.jsxs)(l4.kC,{align:"center",justify:"center",gap:1,padding:1,children:[(0,lG.jsx)(l4.xu,{padding:3,children:(0,lG.jsx)(l4.$j,{muted:!0})}),(0,lG.jsx)(l4.xv,{muted:!0,size:1,children:"Resolving initial value…"})]})})]})}),D=fS(o);return(0,lG.jsxs)(lG.Fragment,{children:[(0,lG.jsx)(cU,{path:d,isChanged:v,hasFocus:!!b,children:F}),h&&(0,lG.jsx)(kN,{header:c?"View ".concat(D):"Edit ".concat(D),type:(null==(i=null==(n=null==s?void 0:s.options)?void 0:n.modal)?void 0:i.type)||"dialog",width:null!=(a=null==(l=null==(r=null==s?void 0:s.options)?void 0:r.modal)?void 0:l.width)?a:1,id:p._key,onClose:x,autofocus:b,legacy_referenceElement:C.current,children:y})]})}var Oa=Object.freeze,Oo=Object.defineProperty;let Os=(0,a0.ZP)(l4.Zb)(rc||(rc=Oa(Oo(Q=["\n  max-width: ","px;\n"],"raw",{value:Oa(Q.slice())}))),e=>{let{theme:t}=e;return t.sanity.container[1]});function Od(e){let{value:t,onFocus:n,vertical:i,...r}=e,[l,a]=lJ.useState(!1),[o,s]=lJ.useState(null);(0,l4.O8)(()=>a(!1),[o]);let d=lJ.useCallback(e=>{("Escape"===e.key||"Tab"===e.key)&&a(!1)},[]),c=(0,lJ.useCallback)(()=>{a(e=>!e)},[]),u=(0,sT.wq)(t);return(0,lG.jsx)(l4.J2,{open:l,ref:s,onKeyDown:d,portal:!0,constrainSize:!0,tone:"default",content:(0,lG.jsx)(Os,{margin:1,padding:3,onKeyDown:d,tabIndex:0,overflow:"auto",children:(0,lG.jsxs)(l4.Kq,{space:4,children:[(0,lG.jsx)(l4.xu,{children:(0,lG.jsx)(l4.xv,{weight:"semibold",children:"Why is this happening?"})}),(0,lG.jsxs)(l4.xv,{size:1,children:["The current schema does not declare items of type ",(0,lG.jsx)("code",{children:u})," as valid for this list. This could mean that the type has been removed as a valid item type, or that someone else has added it to their own local schema that is not yet deployed."]}),(0,lG.jsx)(l4.xu,{children:(0,lG.jsxs)(l4.xv,{size:1,children:[(0,lG.jsx)(a8.sLo,{})," You can still move or delete this item, but it cannot be edited since the schema definition for its type is nowhere to be found."]})}),(0,lG.jsxs)(l4.Kq,{space:2,children:[(0,lG.jsx)(l4.xv,{size:1,weight:"semibold",children:"JSON representation of this item:"}),(0,lG.jsx)(l4.Zb,{padding:2,overflow:"auto",border:!0,children:(0,lG.jsx)(l4.EK,{size:1,as:"pre",language:"json",children:JSON.stringify(t,null,2)})})]})]})}),children:(0,lG.jsx)(l4.Zb,{as:"button",type:"button",radius:2,tone:"inherit",paddingX:2,paddingY:3,style:{height:"100%"},onFocus:n,onClick:c,onKeyDown:d,__unstable_focusRing:!0,...r,children:(0,lG.jsxs)(l4.Kq,{space:4,marginTop:2,children:[(0,lG.jsx)(l4.xu,{margin:1,children:(0,lG.jsx)(l4.xv,{align:"center",size:4,children:(0,lG.jsx)(a8.Tzq,{})})}),(0,lG.jsxs)(l4.xv,{align:"center",size:1,children:["Items of type ",(0,lG.jsx)("code",{children:u})," is not valid for this list"]})]})})})}let Oc={portal:!0,tone:"default"};function Ou(e){let{member:t,sortable:n}=e,i=(0,lJ.useId)(),{onChange:r}=m7(),l=(0,lJ.useCallback)(()=>{r(mN.from([mq([{_key:t.key}])]))},[r,t.key]);return(0,lG.jsx)(A7,{dragHandle:n,tone:"caution",style:{height:"100%"},menu:(0,lG.jsx)(l4.j2,{button:(0,lG.jsx)(l4.zx,{padding:2,mode:"bleed",icon:a8.zGg}),id:"".concat(i,"-menuButton"),menu:(0,lG.jsx)(l4.v2,{children:(0,lG.jsx)(l4.sN,{text:"Remove",tone:"critical",icon:a8.XHJ,onClick:l})}),popover:Oc}),children:"INVALID_ITEM_TYPE"===t.error.type?(0,lG.jsx)(Od,{value:t.error.value,vertical:!0}):(0,lG.jsxs)("div",{children:["Unexpected Error: ",t.error.type]})})}let Op=[];function Oh(e){var t;let{arrayFunctions:n=mQ,elementProps:i,members:r,onChange:l,onInsert:a,onItemMove:o,onUpload:s,readOnly:d,renderAnnotation:c,renderBlock:u,renderField:p,renderInlineBlock:h,renderInput:f,renderPreview:m,resolveUploader:g,schemaType:x,value:v=Op}=e,b=(0,lJ.useCallback)(e=>{a({items:[e],position:"before",referenceItem:0})},[a]),y=(0,lJ.useCallback)(e=>{a({items:[e],position:"after",referenceItem:-1})},[a]),j=(null==(t=x.options)?void 0:t.sortable)!==!1,w=(0,lJ.useCallback)(e=>(0,lG.jsx)(Ol,{...e}),[]),k=(0,lJ.useMemo)(()=>r.map(e=>e.key),[r]);return(0,lG.jsxs)(l4.Kq,{space:3,children:[(0,lG.jsx)(AY,{types:x.of,resolveUploader:g,onUpload:s,...i,tabIndex:0,children:(0,lG.jsxs)(l4.Kq,{"data-ui":"ArrayInput__content",space:3,children:[(null==r?void 0:r.length)===0&&(0,lG.jsx)(l4.Zb,{padding:3,border:!0,style:{borderStyle:"dashed"},radius:2,children:(0,lG.jsx)(l4.xv,{align:"center",muted:!0,size:1,children:x.placeholder||(0,lG.jsx)(lG.Fragment,{children:"No items"})})}),(null==r?void 0:r.length)>0&&(0,lG.jsx)(l4.Zb,{border:!0,radius:1,children:(0,lG.jsx)(j1,{columns:[2,3,4],gap:3,padding:1,margin:1,items:k,onItemMove:o,sortable:j,children:r.map(e=>(0,lG.jsxs)(j2,{sortable:j,id:e.key,flex:1,children:["item"===e.kind&&(0,lG.jsx)(k_,{member:e,renderAnnotation:c,renderBlock:u,renderInlineBlock:h,renderItem:w,renderField:p,renderInput:f,renderPreview:m}),"error"===e.kind&&(0,lG.jsx)(Ou,{sortable:j,member:e})]},e.key))})})]})}),(0,lG.jsx)(n,{onChange:l,onItemAppend:y,onItemPrepend:b,onValueCreate:wd,readOnly:d,schemaType:x,value:v})]})}let Of=[];function Om(e){var t;let{arrayFunctions:n=mQ,elementProps:i,members:r,onChange:l,onInsert:a,onItemMove:o,onUpload:s,focusPath:d,readOnly:c,renderAnnotation:u,renderBlock:p,renderField:h,renderInlineBlock:f,renderInput:m,renderItem:g,renderPreview:x,resolveUploader:v,schemaType:b,value:y=Of}=e,[j,w]=(0,lJ.useState)(null),{space:k}=(0,l4.Fg)().sanity,C=(0,lJ.useCallback)(e=>{a({items:[e],position:"before",referenceItem:0})},[a]),_=(0,lJ.useCallback)(e=>{a({items:[e],position:"after",referenceItem:-1})},[a]),S=function(e,t){let n=(0,lJ.useRef)(e),i=n.current,r=t(i,e);return(0,lJ.useEffect)(()=>{r||(n.current=e)}),r?i:e}((0,lJ.useMemo)(()=>r.map(e=>e.key),[r]),a6()),{scrollElement:T,containerElement:E}=function(){let e=(0,lJ.useContext)(kZ);if(!e)throw Error("VirtualizerScrollInstance: missing context value");return e}(),P=(0,lJ.useRef)(null),A=(0,lJ.useMemo)(()=>(0,lX.Fd)(d[0])?d[0]._key:d[0],[d]),O=(0,lJ.useCallback)(e=>{let t={...e};if(null!==j&&(t.startIndex=Math.min(e.startIndex,j),t.endIndex=Math.max(e.endIndex,j)),A){let e=S.findIndex(e=>e===A);-1!==e&&(t.startIndex=Math.min(t.startIndex,e),t.endIndex=Math.max(t.endIndex,e))}return(0,a4.MK)(t)},[j,A,S]),z=(0,lJ.useCallback)((e,t)=>{if(!e.scrollElement)return;let n=e.scrollElement,i=()=>{var e,i,r,l;let a=null!=(i=null==(e=E.current)?void 0:e.getBoundingClientRect().top)?i:0,o=null!=(l=null==(r=P.current)?void 0:r.getBoundingClientRect().top)?l:0;t(n.scrollTop-Math.floor(o-a))};return i(),e.scrollElement.addEventListener("scroll",i,{capture:!1,passive:!0}),()=>{n.removeEventListener("scroll",i)}},[E]),M=(0,lJ.useCallback)(()=>53,[]),I=(0,a3.MG)({count:r.length,estimateSize:M,getScrollElement:(0,lJ.useCallback)(()=>T,[T]),observeElementOffset:z,rangeExtractor:O,getItemKey:(0,lJ.useCallback)(e=>S[e],[S]),scrollToFn:(e,t,n)=>{e!==n.scrollOffset&&(0,a4.sA)(e,t,n)}}),R=I.getVirtualItems(),F=(0,lJ.useCallback)(e=>{var t,n;let{active:i}=e;w(null==(n=null==(t=i.data.current)?void 0:t.sortable)?void 0:n.index)},[]),D=(0,lJ.useCallback)(()=>{w(null)},[]),Z=(null==(t=b.options)?void 0:t.sortable)!==!1;return(0,lG.jsxs)(l4.Kq,{space:3,ref:P,children:[(0,lG.jsx)(AY,{types:b.of,resolveUploader:v,onUpload:s,...i,tabIndex:0,children:(0,lG.jsx)(l4.Kq,{"data-ui":"ArrayInput__content",space:3,children:0===r.length?(0,lG.jsx)(l4.Zb,{padding:3,border:!0,style:{borderStyle:"dashed"},radius:2,children:(0,lG.jsx)(l4.xv,{align:"center",muted:!0,size:1,children:b.placeholder||(0,lG.jsx)(lG.Fragment,{children:"No items"})})}):(0,lG.jsx)(l4.Zb,{border:!0,radius:1,style:{height:"".concat(I.getTotalSize()+R.length*k[1]+k[1],"px"),width:"100%",position:"relative"},children:(0,lG.jsx)(j1,{axis:"y",gap:1,paddingY:1,items:S,onItemMove:o,onItemMoveStart:F,onItemMoveEnd:D,sortable:Z,style:{position:"absolute",top:0,left:0,width:"100%",transform:"translateY(".concat(R[0].start,"px)")},children:R.map(t=>{let n=r[t.index];return(0,lG.jsxs)(j2,{ref:I.measureElement,sortable:Z,"data-index":t.index,id:n.key,children:["item"===n.kind&&(0,lG.jsx)(k_,{member:n,renderAnnotation:u,renderBlock:p,renderField:h,renderInlineBlock:f,renderInput:m,renderItem:g,renderPreview:x}),"error"===n.kind&&(0,lG.jsx)(AU,{sortable:Z,member:n,onRemove:()=>e.onItemRemove(n.key)})]},t.key)})})})})}),(0,lG.jsx)(n,{onChange:l,onItemAppend:_,onItemPrepend:C,onValueCreate:wd,readOnly:c,schemaType:b,value:y})]})}function Og(e){var t;return(null==(t=e.schemaType.options)?void 0:t.layout)==="grid"?(0,lG.jsx)(Oh,{...e}):(0,lG.jsx)(Om,{...e})}let Ox=["string","number","boolean"];function Ov(e){return(0,lX.n4)(e)?e:{title:sK()("".concat(e)),value:e}}let Ob={title:"",value:void 0};function Oy(e){var t,n;let{value:i,readOnly:r,validationError:l,schemaType:a,onChange:o,path:s,changed:d,focused:c,elementProps:u}=e,p=(0,lJ.useMemo)(()=>{var e;return((null==(e=a.options)?void 0:e.list)||[]).map(Ov)},[null==(t=a.options)?void 0:t.list]),h=p.find(e=>e.value===i),f=a.options&&"radio"===a.options.layout,m=(0,lJ.useCallback)(e=>p[Number(e)],[p]),g=(0,lJ.useCallback)(e=>String(p.indexOf(e)),[p]),x=(0,lJ.useId)(),v=lJ.useCallback(e=>{o(mN.from(void 0===(null==e?void 0:e.value)?mq():mL(e.value)))},[o]),b=(0,lJ.useCallback)(e=>{let t=m(e.currentTarget.value);if(!t){v(Ob);return}v(t)},[v,m]),y=f?(0,lG.jsx)(Oj,{...u,value:h,inputId:x,items:p,direction:(null==(n=a.options)?void 0:n.direction)||"vertical",customValidity:l,onChange:v,readOnly:r}):(0,lG.jsx)(l4.Ph,{...u,customValidity:l,value:g(h),readOnly:r,onChange:b,children:[Ob,...p].map((e,t)=>(0,lG.jsx)("option",{value:t-1,children:e.title},"".concat(t-1)))});return(0,lG.jsx)(cU,{path:s,isChanged:d,hasFocus:!!c,children:y})}let Oj=(0,lJ.forwardRef)(function(e,t){let{items:n,value:i,onChange:r,onFocus:l,readOnly:a,customValidity:o,direction:s,inputId:d}=e,c="horizontal"===s?l4.gF:l4.Kq;return(0,lG.jsx)(l4.Zb,{border:!0,padding:3,radius:1,children:(0,lG.jsx)(c,{space:3,role:"group",children:n.map((e,n)=>(0,lG.jsx)(Ow,{customValidity:o,inputId:d,item:e,onChange:r,onFocus:l,readOnly:a,ref:0===n?t:null,value:i},n))})})}),Ow=(0,lJ.forwardRef)(function(e,t){let{customValidity:n,inputId:i,item:r,onChange:l,onFocus:a,readOnly:o,value:s}=e,d=(0,lJ.useCallback)(()=>{l(r)},[r,l]);return(0,lG.jsxs)(l4.kC,{as:"label",align:"center",children:[(0,lG.jsx)(l4.Y8,{ref:t,checked:s===r,onChange:d,onFocus:a,readOnly:o,customValidity:n,name:i}),(0,lG.jsx)(l4.xu,{marginLeft:2,children:(0,lG.jsx)(l4.xv,{size:1,weight:"semibold",children:r.title})})]})});function Ok(e){let{validationError:t,elementProps:n}=e;return(0,lG.jsx)(l4.oi,{...n,customValidity:t,"data-testid":"string-input"})}let OC=(e,t)=>{if("function"==typeof e)throw Error('Schema type "'.concat((null==t?void 0:t.name)||"<not-found>","\"'s `validation` was not run though `inferFromSchema`"));return e?Array.isArray(e)?e:[e]:[]};function O_(e,t){for(let n of OC(null==e?void 0:e.validation,e))for(let e of n._rules)if(e.flag===t)return e;return null}function OS(e){let{schemaType:t,validationError:n,elementProps:i}=e,r=O_(t,"min"),l=O_(t,"integer"),a=O_(t,"precision"),o="number"==typeof(null==r?void 0:r.constraint)&&(null==r?void 0:r.constraint)>=0,s=l||(null==a?void 0:a.constraint)===0;return(0,lG.jsx)(l4.oi,{...i,type:"number",step:"any",inputMode:o?s?"numeric":"decimal":"text",customValidity:n,placeholder:t.placeholder,pattern:o?"[d]*":void 0,max:Number.MAX_SAFE_INTEGER,min:Number.MIN_SAFE_INTEGER,"data-testid":"number-input"})}var OT=Object.freeze,OE=Object.defineProperty,OP=(e,t)=>OT(OE(e,"raw",{value:OT(t||e.slice())}));let OA=(0,a0.ZP)(l4.xu)(ru||(ru=OP(["\n  align-self: center;\n"]))),OO=(0,a0.ZP)(l4.xu)(rp||(rp=OP(["\n  line-height: 0;\n"])));function Oz(e){let{fieldNames:t,onChange:n,readOnly:i,value:r}=e,l=t.length,a=(0,lJ.useCallback)(e=>{n(mq([e]))},[n]);return(0,lG.jsxs)(mH,{status:"warning",title:(0,lG.jsxs)(lG.Fragment,{children:[1===l&&(0,lG.jsx)(lG.Fragment,{children:"Unknown field found"}),l>1&&(0,lG.jsx)(lG.Fragment,{children:"Unknown fields found"})]}),children:[(0,lG.jsx)(l4.xv,{as:"p",muted:!0,size:1,children:1===l?(0,lG.jsx)(lG.Fragment,{children:"Encountered a field that is not defined in the schema."}):(0,lG.jsxs)(lG.Fragment,{children:["Encountered ",l," fields that are not defined in the schema."]})}),(0,lG.jsxs)(wr,{marginTop:4,open:v5,title:(0,lG.jsx)(lG.Fragment,{children:"Developer info"}),children:[(0,lG.jsx)(l4.xu,{marginBottom:3,children:(0,lG.jsx)(l4.xv,{as:"p",muted:!0,size:1,children:1===l?(0,lG.jsx)(lG.Fragment,{children:"This field is not defined in the schema, which could mean that the field definition has been removed or that someone else has added it to their own local project and have not deployed their changes yet."}):(0,lG.jsx)(lG.Fragment,{children:"These fields are not defined in the document’s schema, which could mean that the field definitions have been removed or that someone else has added them to their own local project and have not deployed their changes yet."})})}),(0,lG.jsx)(l4.Kq,{as:"ul",space:3,children:t.map(e=>(0,lG.jsx)(OM,{fieldName:e,onUnsetClick:a,readOnly:i,value:null==r?void 0:r[e]},e))})]})]})}function OM(e){let{fieldName:t,onUnsetClick:n,readOnly:i,value:r}=e,l=(0,lJ.useCallback)(()=>{n(t)},[t,n]);return(0,lG.jsx)(l4.Zb,{as:"li",padding:3,radius:2,shadow:1,tone:"caution",children:(0,lG.jsxs)(l4.Kq,{space:2,children:[(0,lG.jsxs)(l4.Zb,{border:!0,radius:1,children:[(0,lG.jsx)(l4.Zb,{borderBottom:!0,padding:3,children:(0,lG.jsx)(l4.EK,{weight:"medium",children:t})}),(0,lG.jsx)(l4.xu,{overflow:"auto",padding:3,children:(0,lG.jsx)(l4.EK,{language:"json",children:JSON.stringify(r,null,2)})})]}),i&&(0,lG.jsxs)(l4.xv,{as:"p",muted:!0,size:1,children:["This field is ",(0,lG.jsx)("strong",{children:"read only"})," according to the document’s schema and cannot be unset. If you want to be able to unset this in Studio, make sure you remove the"," ",(0,lG.jsx)("code",{children:"readOnly"})," field from the enclosing type in the schema."]}),!i&&(0,lG.jsx)(l4.zx,{icon:a8.XHJ,onClick:l,tone:"critical",text:(0,lG.jsx)(lG.Fragment,{children:"Remove field"})})]})})}var OI=Object.freeze,OR=Object.defineProperty;let OF=(0,a0.ZP)(l4.Zb)(rh||(rh=OI(OR(ee=["\n  margin-bottom: ","px;\n  padding-bottom: ","px;\n"],"raw",{value:OI(ee.slice())}))),e=>{let{$level:t,theme:n}=e;return 0===t?0:-1*n.sanity.space[5]},e=>{let{$level:t,theme:n}=e;return n.sanity.space[4]}),OD=(0,lJ.forwardRef)(function(e,t){let{onClick:n}=e,i=lJ.useCallback(()=>{null==n||n(e.name)},[e.name,n]);return(0,lG.jsx)(l4.OK,{"data-testid":"group-tab-".concat(name),size:1,id:"".concat(e.name,"-tab"),label:e.title,ref:t,...e,onClick:i})}),OZ=e=>{let{name:t,title:n,...i}=e,{selected:r}=e;return(0,lG.jsx)("option",{title:n,value:t,id:"".concat(t,"-tab"),"aria-controls":i["aria-controls"],"data-testid":"group-select-".concat(t),"aria-selected":r?"true":"false",children:n||t})};var OL=Object.freeze,Oq=Object.defineProperty;let ON=(0,a0.ZP)(l4.iX)(rf||(rf=OL(Oq(et=["\n  /* Hide on small screens */\n  &[data-eq-max~='0'] [data-ui='TabList'] {\n    display: none;\n  }\n\n  /* Hide on medium to large screens */\n  [data-ui='Select'] {\n    display: none;\n  }\n\n  /* Show on small screens */\n  &[data-eq-max~='0'] [data-ui='Select'] {\n    display: block;\n  }\n"],"raw",{value:OL(et.slice())})))),OV=e=>{let{inputId:t,groups:n,onClick:i,shouldAutoFocus:r=!0,disabled:l}=e;return(0,lG.jsx)(l4.td,{space:2,"data-testid":"field-group-tabs",children:n.map(e=>(0,lG.jsx)(OD,{"aria-controls":"".concat(t,"-field-group-fields"),autoFocus:r&&e.selected,disabled:l||e.disabled,icon:null==e?void 0:e.icon,name:e.name,onClick:i,selected:!!e.selected,title:e.title||e.name},"".concat(t,"-").concat(e.name,"-tab")))})},OU=e=>{var t;let{disabled:n,groups:i,inputId:r,onSelect:l,shouldAutoFocus:a=!0}=e,o=(0,lJ.useCallback)(e=>{l(e.currentTarget.value)},[l]);return(0,lG.jsx)(l4.Ph,{"aria-label":"Field groups",autoFocus:a,"data-testid":"field-group-select",disabled:n,fontSize:2,muted:!0,onChange:o,value:null==(t=i.find(e=>e.selected))?void 0:t.name,children:i.map(e=>(0,lG.jsx)(OZ,{"aria-controls":"".concat(r,"-field-group-fields"),disabled:e.disabled,name:e.name,selected:!!e.selected,title:e.title||e.name},"".concat(r,"-").concat(e.name,"-tab")))})},OB=lJ.memo(function(e){let{disabled:t=!1,onClick:n,...i}=e,r=(0,lJ.useCallback)(e=>{null==n||n(e)},[n]);return(0,lG.jsxs)(ON,{"data-testid":"field-group-root",children:[(0,lG.jsx)(OV,{...i,disabled:t,onClick:r}),(0,lG.jsx)(OU,{...i,disabled:t,onSelect:r})]})}),OK=(0,lJ.memo)(function(e){let{schemaType:t,groups:n,members:i,onChange:r,renderAnnotation:l,renderBlock:a,renderInlineBlock:o,renderInput:s,renderField:d,renderItem:c,renderPreview:u,level:p,value:h,id:f,onFieldGroupSelect:m}=e,{columns:g}=t.options||{},x=(0,lJ.useMemo)(()=>{if(!t.fields)return null;let e=t.fields.map(e=>e.name),n=Object.keys(h||{}).filter(t=>!t.startsWith("_")&&!e.includes(t));return 0===n.length?null:(0,lG.jsx)(Oz,{fieldNames:n,value:h,onChange:r})},[r,t.fields,h]),v=(0,lJ.useCallback)(()=>(0,lG.jsx)(kI,{members:i,renderAnnotation:l,renderBlock:a,renderField:d,renderInlineBlock:o,renderInput:s,renderItem:c,renderPreview:u}),[i,l,a,d,o,s,c,u]);return 0===i.length?null:(0,lG.jsxs)(l4.Kq,{space:5,children:[n.length>0?(0,lG.jsx)(OF,{$level:p,"data-testid":"field-groups",children:(0,lG.jsx)(OB,{groups:n,inputId:f,onClick:m,shouldAutoFocus:!1})}):null,g?(0,lG.jsx)(l4.rj,{columns:g,gap:4,marginTop:1,children:v()}):v(),x]})});function OH(e){let{date:t,focused:n,isCurrentMonth:i,isToday:r,onSelect:l,selected:a}=e,o=(0,lJ.useCallback)(()=>{l(t)},[t,l]);return(0,lG.jsx)("div",{"aria-selected":a,"data-ui":"CalendarDay",children:(0,lG.jsx)(l4.Zb,{"aria-label":t.toDateString(),"aria-pressed":a,as:"button",__unstable_focusRing:!0,"data-weekday":!0,"data-focused":n?"true":"",role:"button",tabIndex:-1,onClick:o,padding:3,radius:2,selected:a,tone:r||a?"primary":"default",children:(0,lG.jsx)(l4.xv,{muted:!a&&!i,style:{textAlign:"center"},weight:i?"medium":"regular",children:t.getDate()})})})}let OW=["January","February","March","April","May","June","July","August","September","October","November","December"],O$=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],OX=sQ()(0,24),OG=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],OY=[1,2,3,4,5,6],OJ=e=>{let t=(0,oT.Z)(e);return(0,oE.Z)({start:t,end:(0,oP.Z)(t)})},OQ=e=>e.map(e=>[e,...OY.map(t=>(0,oA.Z)(e,t))]),O0=e=>OQ(OJ(e)).map(e=>({number:(0,oO.Z)(e[0]),days:e}));function O1(e){return(0,lG.jsx)(l4.xu,{"aria-hidden":e.hidden||!1,"data-ui":"CalendarMonth",children:(0,lG.jsxs)(l4.rj,{gap:1,style:{gridTemplateColumns:"repeat(7, minmax(44px, 46px))"},children:[O$.map(e=>(0,lG.jsx)(l4.xu,{paddingY:2,children:(0,lG.jsx)(l4.xv,{size:1,weight:"medium",style:{textAlign:"center"},children:e})},e)),O0(e.date).map((t,n)=>t.days.map((t,i)=>{let r=e.focused&&(0,oz.Z)(t,e.focused),l=e.selected&&(0,oz.Z)(t,e.selected),a=(0,oz.Z)(t,new Date),o=e.focused&&(0,oM.Z)(t,e.focused);return(0,lG.jsx)(OH,{date:t,focused:r,isCurrentMonth:o,isToday:a,onSelect:e.onSelect,selected:l},"".concat(n,"-").concat(i))}))]})})}let O2={dayPresets:!1,timePresets:!1},O3=lJ.forwardRef(function(e,t){let{onChange:n,onBlur:i,onKeyPress:r,value:l,...a}=e,[o,s]=lJ.useState(),d=lJ.useCallback(e=>{s(e.currentTarget.value)},[]),c=lJ.useCallback(e=>{e.currentTarget.value!=="".concat(l)&&n&&n(e),s(void 0)},[n,l]),u=lJ.useCallback(e=>{c(e),i&&i(e)},[c,i]),p=lJ.useCallback(e=>{"Enter"===e.key&&c(e),r&&r(e)},[c,r]);return(0,lG.jsx)(l4.oi,{...a,"data-testid":"date-input",ref:t,value:void 0===o?l:o,onChange:d,onBlur:u,onKeyPress:p})}),O4=e=>{let{onChange:t,...n}=e,i=lJ.useCallback(e=>{let n=parseInt(e.currentTarget.value,10);isNaN(n)||t(n)},[t]);return(0,lG.jsx)(O3,{...n,onChange:i,inputMode:"numeric"})},O5=(0,lG.jsx)("span",{"data-preserve-focus":!0,style:{overflow:"hidden",position:"absolute",outline:"none"},tabIndex:-1}),O6=(0,lJ.forwardRef)(function(e,t){let{selectTime:n,onFocusedDateChange:i,selectedDate:r=new Date,focusedDate:l=r,timeStep:a=1,onSelect:o,...s}=e,d=(0,lJ.useCallback)(e=>i(e),[i]),c=(0,lJ.useCallback)(e=>d((0,oI.Z)((0,oR.Z)(l,e),1)),[l,d]),u=(0,lJ.useCallback)(e=>c(Number(e.currentTarget.value)),[c]),p=(0,lJ.useCallback)(e=>d((0,oF.Z)(l,e)),[l,d]),h=(0,lJ.useCallback)(e=>d((0,oD.Z)(l,e)),[l,d]),f=(0,lJ.useCallback)(e=>{o((0,oZ.Z)((0,oL.Z)(e,r.getHours()),r.getMinutes()))},[o,r]),m=(0,lJ.useCallback)(e=>{let t=Number(e.currentTarget.value);o((0,oZ.Z)(r,t))},[o,r]),g=(0,lJ.useCallback)(e=>{let t=Number(e.currentTarget.value);o((0,oL.Z)(r,t))},[o,r]);(0,lJ.useCallback)((e,t)=>{o((0,oL.Z)((0,oZ.Z)(r,t),e))},[o,r]);let x=(0,l4.ts)(t),v=(0,lJ.useCallback)(()=>{var e,t;null==(t=null==(e=x.current)?void 0:e.querySelector('[data-focused="true"]'))||t.focus()},[x]),b=(0,lJ.useCallback)(e=>{var t,n;if(OG.includes(e.key)){if(e.preventDefault(),e.target.hasAttribute("data-calendar-grid")){v();return}"ArrowUp"===e.key&&i((0,oA.Z)(l,-7)),"ArrowDown"===e.key&&i((0,oA.Z)(l,7)),"ArrowLeft"===e.key&&i((0,oA.Z)(l,-1)),"ArrowRight"===e.key&&i((0,oA.Z)(l,1)),null==(n=null==(t=x.current)?void 0:t.querySelector("[data-preserve-focus]"))||n.focus()}},[x,v,i,l]);(0,lJ.useEffect)(()=>{v()},[v]),(0,lJ.useEffect)(()=>{var e;(null==(e=document.activeElement)?void 0:e.matches("[data-calendar-grid], [data-calendar-grid] [data-preserve-focus]"))&&v()},[x,v,l]),(0,lJ.useCallback)(()=>f((0,oA.Z)(new Date,-1)),[f]),(0,lJ.useCallback)(()=>f(new Date),[f]),(0,lJ.useCallback)(()=>f((0,oA.Z)(new Date,1)),[f]);let y=(0,lJ.useCallback)(()=>o(new Date),[o]);return(0,lG.jsxs)(l4.xu,{"data-ui":"Calendar",...s,ref:x,children:[(0,lG.jsxs)(l4.xu,{padding:2,children:[O2.dayPresets,(0,lG.jsxs)(l4.kC,{children:[(0,lG.jsx)(l4.xu,{flex:1,children:(0,lG.jsx)(O8,{moveFocusedDate:p,onChange:u,value:null==l?void 0:l.getMonth()})}),(0,lG.jsx)(l4.xu,{marginLeft:2,children:(0,lG.jsx)(O9,{moveFocusedDate:p,onChange:h,value:l.getFullYear()})})]}),(0,lG.jsxs)(l4.xu,{"data-calendar-grid":!0,onKeyDown:b,marginTop:2,overflow:"hidden",tabIndex:0,children:[(0,lG.jsx)(O1,{date:l,focused:l,onSelect:f,selected:r}),O5]})]}),n&&(0,lG.jsxs)(l4.xu,{padding:2,style:{borderTop:"1px solid var(--card-border-color)"},children:[(0,lG.jsxs)(l4.kC,{align:"center",children:[(0,lG.jsxs)(l4.kC,{align:"center",flex:1,children:[(0,lG.jsx)(l4.xu,{children:(0,lG.jsx)(l4.Ph,{"aria-label":"Select hour",value:null==r?void 0:r.getHours(),onChange:g,children:OX.map(e=>(0,lG.jsx)("option",{value:e,children:"".concat(e).padStart(2,"0")},e))})}),(0,lG.jsx)(l4.xu,{paddingX:1,children:(0,lG.jsx)(l4.xv,{children:":"})}),(0,lG.jsx)(l4.xu,{children:(0,lG.jsx)(l4.Ph,{"aria-label":"Select minutes",value:null==r?void 0:r.getMinutes(),onChange:m,children:sQ()(0,60,a).map(e=>(0,lG.jsx)("option",{value:e,children:"".concat(e).padStart(2,"0")},e))})})]}),(0,lG.jsx)(l4.xu,{marginLeft:2,children:(0,lG.jsx)(l4.zx,{text:"Set to current time",mode:"bleed",onClick:y})})]}),O2.timePresets]})]})});function O8(e){let{moveFocusedDate:t,onChange:n,value:i}=e,r=(0,lJ.useCallback)(()=>t(-1),[t]),l=(0,lJ.useCallback)(()=>t(1),[t]);return(0,lG.jsxs)(l4.kC,{flex:1,children:[(0,lG.jsx)(l4.zx,{"aria-label":"Go to previous month",onClick:r,mode:"bleed",icon:a8.wyc,paddingX:2,radius:0}),(0,lG.jsx)(l4.xu,{flex:1,children:(0,lG.jsx)(l4.Ph,{radius:0,value:i,onChange:n,children:OW.map((e,t)=>(0,lG.jsx)("option",{value:t,children:e},t))})}),(0,lG.jsx)(l4.zx,{"aria-label":"Go to next month",mode:"bleed",icon:a8.XCv,onClick:l,paddingX:2,radius:0})]})}function O9(e){let{moveFocusedDate:t,onChange:n,value:i}=e,r=(0,lJ.useCallback)(()=>t(-12),[t]),l=(0,lJ.useCallback)(()=>t(12),[t]);return(0,lG.jsxs)(l4.kC,{children:[(0,lG.jsx)(l4.zx,{"aria-label":"Previous year",onClick:r,mode:"bleed",icon:a8.wyc,paddingX:2,radius:0}),(0,lG.jsx)(O4,{value:i,onChange:n,radius:0,style:{width:65}}),(0,lG.jsx)(l4.zx,{"aria-label":"Next year",onClick:l,mode:"bleed",icon:a8.XCv,paddingX:2,radius:0})]})}let O7=lJ.forwardRef(function(e,t){let{value:n=new Date,onChange:i,...r}=e,[l,a]=lJ.useState(),o=lJ.useCallback(e=>{i(e),a(void 0)},[i]);return(0,lG.jsx)(O6,{...r,ref:t,selectedDate:n,onSelect:o,focusedDate:l||n,onFocusedDateChange:a})}),ze=(0,lJ.forwardRef)(function(e,t){let{value:n,inputValue:i,onInputChange:r,onChange:l,selectTime:a,timeStep:o,...s}=e,[d,c]=(0,lJ.useState)(null),u=(0,l4.ts)(t),p=(0,lJ.useRef)(null),[h,f]=(0,lJ.useState)(!1);(0,l4.O8)(()=>f(!1),[d]);let m=(0,lJ.useCallback)(()=>{var e,t;null==(e=u.current)||e.focus(),null==(t=u.current)||t.select()},[u]),g=(0,lJ.useCallback)(e=>{"Escape"===e.key&&f(!1)},[]),x=(0,lJ.useCallback)(()=>f(!0),[]),v=(0,lG.jsx)(l4.xu,{padding:1,children:(0,lG.jsx)(l4.zx,{ref:p,icon:a8.Que,mode:"bleed",padding:2,onClick:x,style:{display:"block"},"data-testid":"select-date-button"})});return(0,lG.jsx)(O3,{ref:u,...s,value:i,onChange:r,suffix:h?(0,lG.jsx)(l4.li,{zOffset:1e3,children:(0,lG.jsx)(l4.J2,{constrainSize:!0,"data-testid":"date-input-dialog",portal:!0,content:(0,lG.jsx)(l4.xu,{overflow:"auto",children:(0,lG.jsx)(a7.ZP,{onDeactivation:m,children:(0,lG.jsx)(O7,{selectTime:a,timeStep:o,onKeyUp:g,value:n,onChange:l})})}),open:!0,placement:"bottom",ref:c,radius:2,children:v})}):v})}),zt=new Date,zn=lJ.forwardRef(function(e,t){let{id:n,deserialize:i,formatInputValue:r,onChange:l,parseInputValue:a,placeholder:o,readOnly:s,selectTime:d,serialize:c,timeStep:u,value:p,...h}=e,[f,m]=lJ.useState(null);(0,lJ.useEffect)(()=>{m(null)},[p]);let g=lJ.useCallback(e=>{let t=e.currentTarget.value,n=""===t?null:a(t);null===n?(l(null),void 0===p&&f&&m(null)):n.isValid?l(c(n.date)):m(t)},[a,l,p,f,c]),x=lJ.useCallback(e=>{l(e?c(e):null)},[c,l]),v=(0,l4.ts)(t),b=f?a(f):p?i(p):null,y=f||((null==b?void 0:b.isValid)?r(b.date):p);return s?(0,lG.jsx)(l4.oi,{value:y,readOnly:!0}):(0,lG.jsx)(ze,{...h,id:n,selectTime:d,timeStep:u,placeholder:o||"e.g. ".concat(r(zt)),ref:v,value:null==b?void 0:b.date,inputValue:y||"",readOnly:!!s,onInputChange:g,onChange:x,customValidity:null==b?void 0:b.error})});function zi(e){return e.toISOString()}function zr(e){let t=new Date(e);return t instanceof Date&&!isNaN(t.valueOf())?{isValid:!0,date:t}:{isValid:!1,error:'Invalid date value: "'.concat(e,'"')}}let zl="YYYY-MM-DD",za=e=>(0,sS.Q)(e,zl),zo=e=>(0,sS.W)(e,zl);var zs=Object.freeze,zd=Object.defineProperty;let zc=(0,a0.ZP)(l4.Kx)(rm||(rm=zs(zd(en=["\n  &[data-as='textarea'] {\n    resize: vertical;\n  }\n"],"raw",{value:zs(en.slice())})))),zu=(e,t)=>{var n;let i=null==(n=t.options)?void 0:n.maxLength;return e?s1()(e,{truncate:"number"==typeof i?i:200,symbols:!0}):""};async function zp(e,t,n){var i;return e?((null==(i=t.options)?void 0:i.slugify)||zu)(e,t,n):e}async function zh(e,t,n){return"function"==typeof e?e(t,n):lY.U2(t,e)}let zf={document:OK,object:OK,array:function(e){return(0,lJ.useMemo)(()=>{var t;return Array.isArray(null==(t=e.schemaType.options)?void 0:t.list)},[e.schemaType])?(0,lG.jsx)(E8,{...e}):(0,lX.d7)(e.schemaType)?(0,lG.jsx)(A1,{...e}):(0,lG.jsx)(Og,{...e})},boolean:function(e){var t;let{id:n,value:i,schemaType:r,readOnly:l,elementProps:a,validation:o}=e,s="checkbox"===((null==(t=r.options)?void 0:t.layout)||"switch")?l4.XZ:l4.rs;return(0,lG.jsx)(l4.Zb,{border:!0,"data-testid":"boolean-input",radius:1,tone:l?"transparent":void 0,children:(0,lG.jsxs)(l4.kC,{children:[(0,lG.jsx)(OO,{padding:3,children:(0,lG.jsx)(s,{label:r.title,...a,checked:i||!1,disabled:l,indeterminate:"boolean"!=typeof i,style:{margin:-4}})}),(0,lG.jsx)(l4.xu,{flex:1,paddingY:3,children:(0,lG.jsx)(jv,{description:r.description,inputId:n,validation:o,title:r.title})}),(0,lG.jsx)(OA,{paddingX:3,paddingY:1,children:(0,lG.jsx)(jZ,{maxAvatars:1,position:"top"})})]})})},number:OS,text:function(e){let{schemaType:t,validationError:n,value:i,elementProps:r}=e;return(0,lG.jsx)(zc,{customValidity:n,value:i||"",placeholder:t.placeholder,rows:"number"==typeof t.rows?t.rows:10,...r})},email:function(e){let{validationError:t,elementProps:n}=e;return(0,lG.jsx)(l4.oi,{...n,type:"email",inputMode:"email",customValidity:t})},datetime:function(e){let{onChange:t,schemaType:n,value:i,elementProps:r}=e,{dateFormat:l,timeFormat:a,timeStep:o}=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{dateFormat:e.dateFormat||"YYYY-MM-DD",timeFormat:e.timeFormat||"HH:mm",timeStep:"timeStep"in e&&Number(e.timeStep)||1,calendarTodayLabel:e.calendarTodayLabel||"Today"}}(n.options),s=(0,lJ.useCallback)(e=>{let n=e;null!==n&&o>1&&(n=function(e,t){if(!t||1===t)return e;let n=(0,oq.Z)(e),i=(0,oN.Z)(n),r=i%t;return 0!==r?zi((0,oZ.Z)(n,i-r)):zi(n)}(n,o)),t(null===n?mq():mL(n))},[t,o]),d=lJ.useCallback(e=>(0,sS.W)(e,"".concat(l," ").concat(a)),[l,a]),c=lJ.useCallback(e=>(0,sS.Q)(e,"".concat(l," ").concat(a)),[l,a]);return(0,lG.jsx)(zn,{...r,onChange:s,deserialize:zr,formatInputValue:d,parseInputValue:c,placeholder:n.placeholder,selectTime:!0,serialize:zi,timeStep:o,value:i})},date:function(e){let{readOnly:t,onChange:n,schemaType:i,elementProps:r,value:l}=e,{dateFormat:a}=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{dateFormat:e.dateFormat||zl,calendarTodayLabel:e.calendarTodayLabel||"Today"}}(i.options),o=(0,lJ.useCallback)(e=>{n(null===e?mq():mL(e))},[n]),s=(0,lJ.useCallback)(e=>(0,sS.W)(e,a),[a]),d=(0,lJ.useCallback)(e=>(0,sS.Q)(e,a),[a]);return(0,lG.jsx)(zn,{...r,deserialize:za,formatInputValue:s,onChange:o,parseInputValue:d,placeholder:i.placeholder,readOnly:t,selectTime:!1,serialize:zo,value:l})},url:function(e){var t,n;let{schemaType:i,validationError:r,elementProps:l}=e,a=O_(i,"uri"),o=(null==(n=null==(t=null==a?void 0:a.constraint)?void 0:t.options)?void 0:n.allowRelative)?"text":"url";return(0,lG.jsx)(l4.oi,{type:o,inputMode:"url",customValidity:r,...l})},image:function(e){var t;let n=null==(t=e.schemaType.options)?void 0:t.sources,{image:i}=mY().__internal,r=Uj(),l=qJ(fT),a=mY().__internal.image.directUploads,o=(0,lJ.useCallback)((e,t)=>a?wJ(e,t):null,[a]),s=lJ.useMemo(()=>n||i.assetSources,[i,n]),d=lJ.useMemo(()=>o9()(l),[l]),c=(0,lJ.useCallback)(e=>wZ(r,e),[r]);return(0,lG.jsx)(TJ,{...e,client:l,assetSources:s,directUploads:i.directUploads,imageUrlBuilder:d,observeAsset:c,resolveUploader:o})},file:function(e){var t;let n=null==(t=e.schemaType.options)?void 0:t.sources,i=Uj(),{file:r}=mY().__internal,l=qJ(fT),a=(0,lJ.useCallback)((e,t)=>r.directUploads?wJ(e,t):null,[r.directUploads]),o=(0,lJ.useMemo)(()=>n||r.assetSources,[r,n]),s=(0,lJ.useCallback)(e=>wZ(i,e),[i]);return(0,lG.jsx)(SN,{...e,client:l,assetSources:o,directUploads:r.directUploads,observeAsset:s,resolveUploader:a})},string:Ok,slug:function(e){var t;let{getDocument:n}=mY().__internal,{path:i,value:r,schemaType:l,validation:a,onChange:o,readOnly:s,elementProps:d}=e,c=null==(t=l.options)?void 0:t.source,u=(0,lJ.useMemo)(()=>a.filter(e=>"error"===e.level),[a]),p=function(){let{getClient:e}=Ic(),t=q6(),n=Ns(),i=q5(),r=q1();return(0,lJ.useMemo)(()=>({projectId:i,dataset:r,getClient:e,schema:t,currentUser:n}),[e,t,n,i,r])}(),h=(0,lJ.useCallback)(e=>{if(!e){o(mN.from(mq([])));return}o(mN.from([mD({_type:l.name}),mL(e,["current"])]))},[o,l.name]),[f,m]=function(e,t){let[n,i]=lJ.useState(null),r=lJ.useRef(0);return[n,lJ.useCallback(t=>{let n=++r.current;i({status:"pending"}),Promise.resolve().then(()=>e(t)).then(e=>{n===r.current&&i({status:"complete",result:e})},e=>{n===r.current&&i({status:"error",error:e})})},[e,...t])]}(()=>{if(!c)return Promise.reject(Error('Source is missing. Check source on type "'.concat(l.name,'" in schema')));let e=n()||{_type:l.name},t=function(e,t,n){let i=e.slice(0,-1),r=lY.U2(t,i);return{parentPath:i,parent:r,...n}}(i,e,p);return zh(c,e,t).then(e=>zp(e||"",l,t)).then(e=>h(e))},[c,n,l,i,p,h]),g=(null==f?void 0:f.status)==="pending",x=lJ.useCallback(e=>h(e.currentTarget.value),[h]);return(0,lG.jsx)(l4.Kq,{space:3,children:(0,lG.jsxs)(l4.kC,{children:[(0,lG.jsxs)(l4.xu,{flex:1,children:[(0,lG.jsx)(l4.oi,{customValidity:u.length>0?u[0].message:"",disabled:g,onChange:x,value:(null==r?void 0:r.current)||"",readOnly:s,...d}),(null==f?void 0:f.status)==="error"&&(0,lG.jsx)(l4.Zb,{padding:2,tone:"critical",children:f.error.message})]}),c&&(0,lG.jsx)(l4.xu,{marginLeft:1,children:(0,lG.jsx)(l4.zx,{mode:"ghost",type:"button",disabled:s||g,onClick:m,text:(null==f?void 0:f.status)==="pending"?"Generating…":"Generate"})})]})})},crossDatasetReference:function(e){let{path:t,schemaType:n}=e,i=Ic(),r=i.getClient(fT),l=Uj(),a=i.getClient,o=(0,lJ.useMemo)(()=>r.withConfig({dataset:n.dataset,apiVersion:"2022-03-07",ignoreBrowserTokenWarning:!0}).clone(),[r,n.dataset]),s=function(e){let t=(0,lJ.useRef)(e);return t.current=e,t}(kW([])),d=(0,lJ.useCallback)(e=>(0,as.D)(Ej(n.options,s.current,t,a)).pipe((0,aT.z)(t=>{var i;let{filter:r,params:l}=t;return i={...n.options,filter:r,params:l,tag:"search.cross-dataset-reference"},mP(n.to.map(e=>({name:e.type,__experimental_search:e.__experimental_search})),o,i)(e,{includeDrafts:!1}).pipe((0,ag.U)(e=>e.map(e=>e.hit)),(0,ag.U)(cc),(0,ag.U)(e=>e.map(e=>({id:e.id,type:e.type,published:e.published}))))}),(0,av.K)(e=>{var t;let i=e.details&&"queryParseError"===e.details.type;return(null==(t=n.options)?void 0:t.filter)&&i&&(e.message='Invalid reference filter, please check the custom "filter" option'),(0,an._)(e)})),[o,s,t,n,a]),c=(0,lJ.useMemo)(()=>(function(e){let{client:t,documentPreviewStore:n}=e,{dataset:i,projectId:r}=t.config(),l=i&&r?{dataset:i,projectId:r}:void 0;return function(e,i){return(e._type?(0,l6.of)(e):n.observeDocumentTypeFromId(e._id,l).pipe((0,ag.U)(t=>({_id:e._id,_type:t})))).pipe((0,ab.w)(r=>{if(!r._type)return(function(e,t){let n={uri:e.getDataUrl("doc",t),json:!0,query:{excludeContent:"true"},tag:"".concat("cross-dataset-refs",".availability")};return e.observable.request(n).pipe((0,ag.U)(e=>{let n=sl()(e.omitted||[],e=>e.id)[t];return n?"existence"===n.reason?Ey:"permission"===n.reason?Eb:null:Ev}))})(t,e._id).pipe((0,ag.U)(t=>({id:e._id,type:void 0,availability:t,preview:{published:void 0}})));let a=i.to.find(e=>e.type===r._type),o=[...fG(null==a?void 0:a.preview)||[],["_updatedAt"],["_createdAt"]],s=n.observePaths(e,o,l).pipe((0,ag.U)(e=>e?ms(e,a):e));return(0,ao.a)([s]).pipe((0,ag.U)(t=>{let[n]=t;return{type:r._type,id:e._id,availability:Ev,preview:{published:cg(n)?n:void 0}}}))}))}})({client:o,documentPreviewStore:l}),[o,l]);return(0,lG.jsx)(Ex,{...e,getReferenceInfo:c,onSearch:d})}};function zm(e){var t,n,i,r;if(null==(t=e.components)?void 0:t.input)return e.components.input;let l=fF("array",e)?1===(n=e).of.length&&fF("string",n.of[0])&&(null==(i=n.options)?void 0:i.layout)==="tags"?AN:(null==(r=n.options)?void 0:r.list)?E8:n.of.every(e=>Ox.includes(e.jsonType))?A1:n.of.some(e=>fF("block",e))?AA:Og:fF("reference",e)?EY:fF("string",e)?kY(e,"list")?Oy:Ok:fF("number",e)?kY(e,"list")?Oy:OS:void 0;if(l)return l;let a=Object.values(k2(e,new Set).reduce((e,t)=>(e[t.name]=t,e),{})).find(e=>zf[e.name]);if(a)return zf[a.name];throw Error("Could not find input component for schema type `".concat(e.name,"`"))}function zg(e){var t;return(null==(t=e.components)?void 0:t.preview)?e.components.preview:fL}function zx(e){let{componentResolver:t,componentProps:n}=e;if(!n.schemaType)throw Error("the `schemaType` property must be defined");let i=t(n.schemaType),r=(0,lJ.useCallback)(e=>{var n;if(!(null==(n=e.schemaType)?void 0:n.type))throw Error("Attempted to render form component of non-existent parent type");let{components:i,...r}=e.schemaType,l=t(r);return(0,lJ.createElement)(l,e)},[t]);return(0,lJ.createElement)(i,{...n,renderDefault:r})}function zv(e){return zx({componentProps:e,componentResolver:zm})}function zb(e){return zx({componentProps:e,componentResolver:k9})}function zy(e){return zx({componentProps:e,componentResolver:kH})}function zj(e){return zx({componentProps:e,componentResolver:zg})}function zw(e){return zx({componentProps:e,componentResolver:_B})}function zk(e){return zx({componentProps:e,componentResolver:_K})}function zC(e){return zx({componentProps:e,componentResolver:_H})}function z_(e){var t,n;return null==(n=null==(t=e.form)?void 0:t.components)?void 0:n.input}function zS(e){var t,n;return null==(n=null==(t=e.form)?void 0:t.components)?void 0:n.field}function zT(e){var t,n;return null==(n=null==(t=e.form)?void 0:t.components)?void 0:n.preview}function zE(e){var t,n;return null==(n=null==(t=e.form)?void 0:t.components)?void 0:n.item}function zP(e){var t,n;return null==(n=null==(t=e.form)?void 0:t.components)?void 0:n.block}function zA(e){var t,n;return null==(n=null==(t=e.form)?void 0:t.components)?void 0:n.inlineBlock}function zO(e){var t,n;return null==(n=null==(t=e.form)?void 0:t.components)?void 0:n.annotation}function zz(){return fR({defaultComponent:zj,pick:zT})}function zM(e){let t=zz();return(0,lG.jsx)(fX,{...e,component:t})}let zI=e=>{let{asset:t,assetType:n,referringDocuments:i}=e,r=i.length,l=r>0,a=t.originalFilename?(0,lG.jsx)("strong",{children:t.originalFilename}):"this ".concat(n);return l?(0,lG.jsxs)(lG.Fragment,{children:[(0,lG.jsx)(l4.Zb,{borderBottom:!0,marginTop:2,paddingBottom:2,marginBottom:1,children:(0,lG.jsxs)(l4.xv,{as:"h2",size:[1,1,2,2],weight:"regular",textOverflow:"ellipsis",children:[r," ",1===r?"document is":"documents are"," using ",a]})}),i.map(e=>(0,lG.jsx)(zR,{document:e},e._id))]}):(0,lG.jsxs)(l4.xv,{size:[1,1,2,2],as:"h2",weight:"regular",children:["No documents are using ",a]})},zR=e=>{let{document:t}=e,n=q6(),i=(0,lJ.useCallback)(e=>(0,lG.jsx)(a9.nR,{...e,params:{id:t._id,type:t._type},intent:"edit"}),[t]);return(0,lG.jsx)(l4.Zb,{as:i,paddingY:2,paddingX:1,radius:2,"data-as":"a",tabIndex:0,children:(0,lG.jsx)(l4.kC,{align:"center",gap:2,children:(0,lG.jsx)(zM,{layout:"default",value:{_type:"reference",_ref:t._id},schemaType:n.get(t._type)})})},t._id)},zF={maxWidth:"100%",height:"120px",objectFit:"contain",objectPosition:"center"},zD={gridColumn:"span 1",overflow:"hidden",display:"flex",alignSelf:"center",justifyContent:"center"},zZ={height:"100%"},zL=e=>{let{asset:t,assetType:n,hasResults:i=!1}=e,r="image"===n,l=t.originalFilename?(0,lG.jsxs)(lG.Fragment,{children:["The ",n," ",(0,lG.jsx)("strong",{children:t.originalFilename})]}):"this ".concat(n);return i?(0,lG.jsx)(l4.Zb,{tone:"caution",padding:[3,3,4],border:!0,radius:2,marginBottom:3,children:(0,lG.jsxs)(l4.rj,{columns:3,gap:[2,3,4],children:[(0,lG.jsxs)(l4.kC,{gap:[3,4],align:"center",style:{gridColumn:r?"span 2":"span 3"},children:[(0,lG.jsx)(l4.xv,{children:(0,lG.jsx)(a8.foC,{})}),(0,lG.jsxs)(l4.xv,{size:1,children:[l," cannot be deleted because it's being used. In order to delete the ",n," you need the remove all uses of it."]})]}),r&&(0,lG.jsx)(l4.Zb,{__unstable_checkered:!0,border:!0,radius:1,style:zD,children:(0,lG.jsx)(l4.kC,{align:"center",justify:"center",style:zZ,children:(0,lG.jsx)("img",{src:"".concat(t.url,"?w=200"),style:zF,alt:"Preview of image",referrerPolicy:"strict-origin-when-cross-origin"})})})]})}):(0,lG.jsx)(l4.Zb,{paddingX:[2,3,4],paddingY:[3,3,3,4],children:(0,lG.jsxs)(l4.rj,{columns:3,gap:3,children:[(0,lG.jsx)(l4.kC,{style:{gridColumn:r?"span 2":"span 3"},align:"center",children:(0,lG.jsxs)(l4.xv,{children:["You are about to delete the ",n,t.originalFilename&&(0,lG.jsxs)(lG.Fragment,{children:[" ",(0,lG.jsx)("strong",{children:t.originalFilename})]})," ","and its metadata.",(0,lG.jsx)("br",{}),(0,lG.jsx)("br",{}),"Are you sure?"]})}),r&&(0,lG.jsx)(l4.Zb,{__unstable_checkered:!0,border:!0,radius:1,style:zD,children:(0,lG.jsx)(l4.kC,{align:"center",justify:"center",style:zZ,children:(0,lG.jsx)("img",{src:"".concat(t.url,"?w=200"),style:zF,alt:"Preview of image",referrerPolicy:"strict-origin-when-cross-origin"})})})]})})},zq="confirmDelete",zN="listUsage";function zV(e){let{asset:t,assetType:n="image",mode:i=zN,isDeleting:r=!1,onClose:l,onDelete:a}=e,{isLoading:o,referringDocuments:s}=function(e){let t=Uw();return(0,l5.m2)(()=>t.listenQuery("*[references($docId)] [0...101]",{docId:e},{tag:"use-referring-documents"}).pipe((0,ag.U)(e=>({referringDocuments:e,isLoading:!1})),(0,ak.O)(fM)),[t,e],fM)}(t._id),d=i===zN?"Documents using ".concat(n):"Delete ".concat(n),[c,u]=(0,lJ.useState)(!1),[p,h]=(0,lJ.useState)(!0),[f,m]=(0,lJ.useState)([]),g=f.length>0,x=i===zN||g,v=i===zq&&!g,b=i===zq?(0,lG.jsxs)(l4.rj,{padding:2,gap:2,columns:2,children:[(0,lG.jsx)(l4.zx,{mode:"bleed",text:"Cancel",onClick:l}),(0,lG.jsx)(l4.zx,{text:"Delete",tone:"critical",icon:a8.XHJ,onClick:a,loading:r,disabled:!c})]}):void 0;return(0,lJ.useEffect)(()=>{let e=s.reduce((e,t)=>t._id.startsWith("drafts.")?e.concat(t._id.slice(7)):e,[]),t=s.filter(t=>!e.includes(t._id));m(t),u(0===t.length&&!o),h(o)},[o,s]),(0,lG.jsxs)(l4.Vq,{__unstable_autoFocus:!p,footer:b,header:d,id:"asset-dialog",onClickOutside:l,onClose:l,width:1,children:[p&&(0,lG.jsx)(l4.xu,{padding:4,children:(0,lG.jsx)(fz,{text:"Loading..."})}),!p&&(0,lG.jsxs)(l4.Kq,{paddingX:v?0:[2,3,4],paddingY:v?0:[3,3,3,4],space:1,children:[i===zq&&(0,lG.jsx)(zL,{asset:t,assetType:n,hasResults:g}),x&&(0,lG.jsx)(zI,{asset:t,referringDocuments:f,assetType:n})]})]})}function zU(e){let{isSelected:t,border:n=!0,onAction:i}=e;return(0,lG.jsx)(l4.j2,{button:(0,lG.jsx)(l4.zx,{padding:2,mode:n?"ghost":t?"default":"bleed",icon:a8.zGg,tone:n?"default":t?"primary":"default"}),id:"asset-menu",portal:!0,menu:(0,lG.jsxs)(l4.v2,{children:[(0,lG.jsx)(l4.sN,{text:"Show uses",icon:a8.xPt,onClick:()=>{i({type:"showUsage"})}}),(0,lG.jsx)(l4.sN,{text:"Delete",icon:a8.XHJ,tone:"critical",onClick:()=>{i({type:"delete"})}})]}),placement:"right"})}var zB=Object.freeze,zK=Object.defineProperty,zH=(e,t)=>zB(zK(e,"raw",{value:zB(t||e.slice())}));let zW="undefined"!=typeof window&&window.devicePixelRatio?Math.round(window.devicePixelRatio):1,z$=a0.ZP.img(rg||(rg=zH(["\n  position: absolute;\n  z-index: 1;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  display: block;\n  object-fit: contain;\n"]))),zX=(0,a0.ZP)(l4.Zb)(rx||(rx=zH(["\n  position: relative;\n  z-index: 1;\n  padding-bottom: 100%;\n"]))),zG=a0.ZP.div(rv||(rv=zH(["\n  position: relative;\n  display: inherit;\n"]))),zY=a0.ZP.div(rb||(rb=zH(["\n  box-sizing: border-box;\n  position: absolute;\n  z-index: 2;\n  top: 3px;\n  right: 3px;\n\n  & button[data-selected] {\n    display: block;\n  }\n\n  @media (hover: hover) {\n    // If hover is supported, hide the buttons until the user hovers or focuses the asset\n    // Use opacity to enable the buttons to still be focusable\n    & button {\n      opacity: 0;\n    }\n\n    ",":hover & {\n      button {\n        opacity: 1;\n      }\n    }\n\n    ",":focus-within & {\n      button {\n        opacity: 1;\n      }\n    }\n  }\n"])),zG,zG),zJ=lJ.memo(function(e){let t=qJ(fT),n=(0,l4.pm)(),i=(0,lJ.useRef)(),{asset:r,onClick:l,onKeyPress:a,onDeleteFinished:o,isSelected:s}=e,[d,c]=(0,lJ.useState)(!1),[u,p]=(0,lJ.useState)(!1),[h,f]=(0,lJ.useState)(!1);(0,lJ.useEffect)(()=>()=>{i.current&&i.current.unsubscribe()},[]);let m=(0,lJ.useCallback)(()=>{p(!0)},[p]),g=(0,lJ.useCallback)(()=>{c(!1),p(!1)},[c,p]),x=(0,lJ.useCallback)(()=>{c(!0)},[c]),v=(0,lJ.useCallback)(e=>{n.push({closable:!0,status:"error",title:"Image could not be deleted",description:e.message})},[n]),b=(0,lJ.useCallback)(()=>{n.push({status:"success",title:"Image was deleted"})},[n]),y=(0,lJ.useCallback)(()=>{f(!0),i.current=t.observable.delete(r._id).subscribe({next:()=>{f(!1),o(r._id),p(!1),b()},error:e=>{f(!1),v(e),console.error("Could not delete asset",e)}})},[r._id,v,b,o,t.observable]),j=(0,lJ.useCallback)(e=>{"delete"===e.type&&m(),"showUsage"===e.type&&x()},[m,x]),{originalFilename:w,_id:k,url:C}=r,_=200*Math.max(1,zW),S=C.includes(".gif")?"".concat(C,"?h=").concat(_,"&fit=max&fm=jpg"):"".concat(C,"?h=").concat(_,"&fit=max");return(0,lG.jsxs)(zG,{children:[(0,lG.jsx)(l4.zx,{tone:"primary",selected:s,tabIndex:0,"data-id":k,mode:"ghost",onKeyPress:a,padding:0,style:{padding:2},children:(0,lG.jsxs)(zX,{__unstable_checkered:!0,children:[(0,lG.jsx)(z$,{alt:w,src:S,onClick:l,"data-id":k}),h&&(0,lG.jsx)(fO,{})]})}),(0,lG.jsx)(zY,{children:(0,lG.jsx)(zU,{isSelected:s,onAction:j})}),(d||u)&&(0,lG.jsx)(zV,{asset:r,mode:u?"confirmDelete":"listUsage",onClose:g,onDelete:y,isDeleting:h})]})}),zQ=["B","kB","MB","GB","TB","PB","EB","ZB","YB"],z0=["B","kiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],z1=["b","kbit","Mbit","Gbit","Tbit","Pbit","Ebit","Zbit","Ybit"],z2=["b","kibit","Mibit","Gibit","Tibit","Pibit","Eibit","Zibit","Yibit"],z3=(e,t,n)=>{let i=e;return"string"==typeof t||Array.isArray(t)?i=e.toLocaleString(t,n):(!0===t||void 0!==n)&&(i=e.toLocaleString(void 0,n)),i},z4={"image/bmp":{title:"Bitmap Image"},"image/jpeg":{title:"JPEG Image"},"image/gif":{title:"GIF Image"},"image/vnd.microsoft.icon":{title:"Icon"},"image/png":{title:"PNG Image"},"image/svg+xml":{title:"SVG Image"},"image/webp":{title:"WebP Image"},"image/tiff":{title:"TIFF Image"},"image/heic":{title:"HEIC Image"},"audio/midi":{title:"MIDI Audio"},"audio/midi-x":{title:"MIDI Audio"},"audio/mpeg":{title:"MP3 Audio"},"audio/ogg":{title:"OGG Audio"},"audio/wav":{title:"WAV Audio"},"audio/webm":{title:"WebM Audio"},"audio/aac":{title:"AAC Audio"},"video/x-msvideo":{title:"AVI Video"},"video/mp4":{title:"MP4 Video"},"video/mpeg":{title:"MPEG Video"},"video/ogg":{title:"OGG Video"},"video/webm":{title:"WebM Video"},"video/quicktime":{title:"QuickTime Video"},"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":{title:"Excel Spreadsheet"},"application/vnd.ms-excel":{title:"Excel Spreadsheet"},"text/plain":{title:"Text"},"text/javascript":{title:"JavaScript"},"text/markdown":{title:"Markdown"},"text/csv":{title:"CSV"},"text/css":{title:"CSS"},"application/pdf":{title:"PDF Document"},"application/xml":{title:"XML Document"},"text/xml":{title:"XML Document"},"application/zip":{title:"ZIP Archive"},"application/vnd.rar":{title:"RAR Archive"},"application/x-7z-compressed":{title:"7-zip Archive"},"application/octet-stream":{title:"Binary"}};var z5=Object.freeze,z6=Object.defineProperty,z8=(e,t)=>z5(z6(e,"raw",{value:z5(t||e.slice())}));let z9=a0.ZP.span(ry||(ry=z8(["\n  background-color: transparent;\n  flex-shrink: 0;\n"]))),z7=(0,a0.ZP)(l4.kC)(rj||(rj=z8([""]))),Me=(0,a0.ZP)(l4.xv)(rw||(rw=z8([""]))),Mt=(0,a0.ZP)(l4.Zb)(rC||(rC=z8(["\n  &:hover-within "," {\n    --card-muted-fg-color: var(--card-muted-fg-color);\n    --card-fg-color: var(--card-fg-color);\n  }\n\n  ","\n"])),Me,e=>e.isSelected&&(0,a0.iv)(rk||(rk=z8(["\n      --card-muted-fg-color: var(--card-bg-color);\n      --card-fg-color: var(--card-bg-color);\n    "])))),Mn=(0,a0.ZP)(l4.zx)(rT||(rT=z8(["\n  box-shadow: none;\n  min-width: 0;\n  cursor: pointer;\n  position: initial;\n\n  &:before,\n  &:after {\n    content: '';\n    position: absolute;\n    left: 0;\n    top: 0;\n    width: 100%;\n    height: 100%;\n    z-index: 2;\n  }\n\n  &:before {\n    z-index: 0;\n    pointer-events: none;\n    border-radius: 0.1875rem;\n  }\n\n  ","\n\n  ","\n"])),e=>e.isSelected&&(0,a0.iv)(r_||(r_=z8(["\n      --card-muted-fg-color: var(--card-bg-color);\n      --card-fg-color: var(--card-bg-color);\n\n      &:before {\n        background-color: var(--card-focus-ring-color);\n      }\n\n      "," {\n        --card-muted-fg-color: var(--card-bg-color);\n      }\n\n      "," {\n        --card-muted-fg-color: var(--card-bg-color);\n        --card-fg-color: var(--card-bg-color);\n      }\n    "])),z9,z7),e=>!e.isSelected&&(0,a0.iv)(rS||(rS=z8(["\n      &:hover:before {\n        background-color: var(--card-bg-color);\n      }\n\n      &:focus:before {\n        background-color: var(--card-code-bg-color);\n      }\n\n      &:focus-within:before {\n        background-color: var(--card-bg-color);\n      }\n    "])))),Mi=(0,a0.ZP)(l4.xv)(rE||(rE=z8(["\n  overflow-wrap: anywhere;\n"]))),Mr={position:"relative"},Ml={flexShrink:0},Ma={minWidth:0},Mo={zIndex:3,marginTop:"-0.5rem",marginBottom:"-0.5rem"},Ms=e=>{let t=qJ(fT),n=(0,l4.pm)(),i=(0,lJ.useRef)(),[r,l]=(0,lJ.useState)(!1),[a,o]=(0,lJ.useState)(!1),[s,d]=(0,lJ.useState)(!1),[c,u]=(0,lJ.useState)(!1),{asset:p,onClick:h,onKeyPress:f,onDeleteFinished:m,isSelected:g,isMobile:x}=e,{originalFilename:v,_id:b,mimeType:y,size:j,_createdAt:w}=p,k=Nt(w,{agoSuffix:!0}),C=(null==z4?void 0:z4[y])?z4[y].title:function(e){let t=e.replace("x-","").split("/")[1];return t.charAt(0).toUpperCase()+t.slice(1)}(y),_=function(e){let t,{bits:n=!1,binary:i=!1,signed:r=!1,minimumFractionDigits:l,maximumFractionDigits:a,locale:o}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=e;if(!Number.isFinite(s))throw TypeError("Expected a finite number, got ".concat(typeof s,": ").concat(s));let d=n?i?z2:z1:i?z0:zQ;if(r&&0===s)return" 0 ".concat(d[0]);let c=s<0,u=c?"-":r?"+":"";if(c&&(s=-s),void 0!==l&&(t={minimumFractionDigits:l}),void 0!==a&&(t={maximumFractionDigits:a,...t}),s<1){let e=z3(s,o,t);return"".concat(u+e," ").concat(d[0])}let p=Math.min(Math.floor(i?Math.log(s)/Math.log(1024):Math.log10(s)/3),d.length-1);s/=(i?1024:1e3)**p,t||(s=s.toPrecision(3));let h=z3(Number(s),o,t),f=d[p];return"".concat(u+h," ").concat(f)}(j),S=(v||"").length>37,T=()=>{o(!0)},E=e=>{n.push({closable:!0,status:"error",title:"File could not be deleted",description:e.message})},P=()=>{n.push({status:"success",title:"File was deleted"})},A=()=>{d(!0),i.current=t.observable.delete(p._id).subscribe({next:()=>{d(!1),null==m||m(p._id),o(!1),P()},error:e=>{d(!1),E(e),console.error("Could not delete asset",e)}})},O=()=>{l(!1),o(!1)},z=()=>{l(!0)};return x?(0,lG.jsxs)(l4.Zb,{paddingBottom:2,style:Mr,children:[(0,lG.jsxs)(l4.rj,{columns:4,gap:1,style:{position:"relative",gridTemplateColumns:"1fr 30px",opacity:s?.5:1},children:[(0,lG.jsx)(Mn,{asset:p,mode:"bleed",padding:0,"data-id":b,onClick:h,paddingY:1,children:(0,lG.jsxs)(l4.kC,{gap:2,flex:2,align:"center",children:[(0,lG.jsx)(l4.Zb,{as:z9,padding:2,tone:"transparent",radius:2,children:(0,lG.jsx)(l4.xv,{muted:!0,size:2,style:Ml,children:(0,lG.jsx)(a8.$lS,{})})}),(0,lG.jsx)(l4.xv,{size:1,align:"left",textOverflow:"ellipsis",style:Ma,children:v})]})}),(0,lG.jsx)(l4.kC,{justify:"flex-end",align:"center",paddingRight:1,style:Mo,children:(0,lG.jsx)(l4.zx,{mode:"bleed",fontSize:1,padding:2,onClick:()=>{u(!c)},icon:c?a8.g8U:a8.v4q})})]}),c&&(0,lG.jsxs)(lG.Fragment,{children:[(0,lG.jsxs)(l4.rj,{marginTop:3,columns:3,gap:1,children:[(0,lG.jsxs)(l4.Kq,{space:2,children:[(0,lG.jsx)(l4.__,{size:1,muted:!0,children:"Size"}),(0,lG.jsx)(l4.xv,{size:1,muted:!0,children:_})]}),(0,lG.jsxs)(l4.Kq,{space:2,children:[(0,lG.jsx)(l4.__,{size:1,muted:!0,children:"Type"}),(0,lG.jsx)(l4.xv,{size:1,muted:!0,children:C})]}),(0,lG.jsxs)(l4.Kq,{space:2,children:[(0,lG.jsx)(l4.__,{size:1,muted:!0,children:"Date added"}),(0,lG.jsx)(l4.xv,{size:1,muted:!0,children:k})]})]}),(0,lG.jsxs)(l4.Kq,{space:2,marginTop:3,children:[(0,lG.jsx)(l4.zx,{fontSize:1,tone:"default",mode:"ghost",text:"Show uses",onClick:z,icon:a8.xPt}),(0,lG.jsx)(l4.zx,{fontSize:1,tone:"critical",mode:"ghost",text:"Delete",icon:a8.XHJ,disabled:g,title:g?"Cannot delete current file":"Delete file",onClick:T})]})]}),(r||a)&&(0,lG.jsx)(zV,{assetType:"file",asset:p,mode:a?"confirmDelete":"listUsage",onClose:O,onDelete:A,isDeleting:s})]}):(0,lG.jsxs)(Mt,{asset:p,paddingBottom:1,style:Mr,radius:0,overflow:"hidden",isSelected:g,"aria-selected":"true",children:[(0,lG.jsxs)(l4.rj,{columns:4,gap:1,"data-id":b,paddingY:1,style:{position:"relative",gridTemplateColumns:"3fr 1fr 1fr 2fr 30px",opacity:s?.5:1},children:[(0,lG.jsx)(Mn,{asset:p,mode:"bleed","data-id":b,onClick:h,padding:0,onKeyPress:f,title:"Select the file ".concat(v),isSelected:g,children:(0,lG.jsxs)(z7,{gap:2,flex:2,paddingRight:1,align:"center",onClick:h,onKeyPress:f,"data-id":b,title:"Select the file ".concat(v),children:[(0,lG.jsx)(l4.Zb,{as:z9,padding:2,tone:"transparent",radius:2,style:Ml,children:(0,lG.jsx)(l4.xv,{muted:!0,size:2,children:(0,lG.jsx)(a8.$lS,{})})}),S&&(0,lG.jsx)(l4.u,{content:(0,lG.jsx)(l4.xu,{padding:2,children:(0,lG.jsx)(l4.xv,{size:1,children:v})}),fallbackPlacements:["right","left"],placement:"top",portal:!0,children:(0,lG.jsx)(l4.xv,{size:1,align:"left",textOverflow:"ellipsis",style:Ma,children:v})}),!S&&(0,lG.jsx)(l4.xv,{size:1,align:"left",textOverflow:"ellipsis",style:Ma,children:v})]})}),(0,lG.jsx)(z7,{align:"center",children:(0,lG.jsx)(l4.xv,{size:1,muted:!0,children:_})}),(0,lG.jsx)(z7,{align:"center",children:(0,lG.jsx)(l4.xu,{children:(0,lG.jsx)(Mi,{size:1,muted:!0,textOverflow:"ellipsis",children:C})})}),(0,lG.jsx)(z7,{align:"center",children:(0,lG.jsx)(l4.xv,{as:"time",size:1,muted:!0,dateTime:w,children:k})}),(0,lG.jsx)(z7,{justify:"flex-end",align:"center",paddingX:1,paddingY:1,style:Mo,children:(0,lG.jsx)(zU,{border:!1,isSelected:!1,onAction:e=>{"delete"===e.type&&T(),"showUsage"===e.type&&z()}})})]}),(r||a)&&(0,lG.jsx)(zV,{assetType:"file",asset:p,mode:a?"confirmDelete":"listUsage",onClose:O,onDelete:A,isDeleting:s})]})},Md={paddingLeft:"2.2rem"},Mc={gridTemplateColumns:"3fr 1fr 1fr 2fr 30px"};function Mu(e){let t=2>(0,l4.d2)(),{assets:n,onClick:i,onKeyPress:r,onDeleteFinished:l,selectedAssets:a,isLoading:o}=e;return(0,lG.jsxs)(l4.xu,{padding:4,children:[(0,lG.jsx)(l4.Zb,{borderBottom:!0,paddingBottom:2,marginBottom:1,children:t?(0,lG.jsx)(l4.rj,{style:Mc,children:(0,lG.jsx)(l4.xu,{flex:2,paddingLeft:5,children:(0,lG.jsx)(l4.__,{muted:!0,size:1,children:"Filename"})})}):(0,lG.jsxs)(l4.rj,{gap:1,style:Mc,children:[(0,lG.jsx)(l4.xu,{flex:2,style:Md,children:(0,lG.jsx)(l4.__,{muted:!0,size:1,children:"Filename"})}),(0,lG.jsx)(l4.xu,{flex:1,children:(0,lG.jsx)(l4.__,{muted:!0,size:1,children:"Size"})}),(0,lG.jsx)(l4.xu,{flex:1,children:(0,lG.jsx)(l4.__,{muted:!0,size:1,children:"Type"})}),(0,lG.jsx)(l4.xu,{flex:1,children:(0,lG.jsx)(l4.__,{muted:!0,size:1,children:"Date added"})})]})}),(0,lG.jsxs)(l4.Kq,{children:[o&&0===n.length&&(0,lG.jsx)(l4.xu,{paddingTop:4,paddingBottom:2,children:(0,lG.jsx)(l4.kC,{justify:"center",children:(0,lG.jsx)(l4.$j,{muted:!0})})}),n.map(e=>(0,lG.jsx)(Ms,{asset:e,isMobile:t,isSelected:a.some(t=>t._id===e._id),onClick:i,onKeyPress:r,onDeleteFinished:l},e._id))]})]})}var Mp=Object.freeze,Mh=Object.defineProperty,Mf=(e,t)=>Mp(Mh(e,"raw",{value:Mp(t||e.slice())}));let Mm="sanity.imageAsset",Mg=e=>{let t=["image/*","audio/*","video/*"],n=e.split(",").map(e=>e.trim()).reduce((e,n)=>t.includes(n)?{...e,wildcards:"mimeType match '".concat(n,"' || ").concat(e.wildcards)}:0===n.indexOf(".")?{...e,extensions:"'".concat(n.replace(".",""),"', ").concat(e.extensions)}:{...e,mimes:"'".concat(n,"', ").concat(e.mimes)},{mimes:"",extensions:"",wildcards:""});return"&&\n  (\n    ".concat(n.wildcards," \n    extension in [").concat(n.extensions,"] ||\n    mimeType in [").concat(n.mimes,"]\n  )")},Mx=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:200,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Mm,i=arguments.length>3?arguments[3]:void 0,r=i.length>0?Mg(i):"";return'\n  *[_type == "'.concat(n,'" ').concat(r,"] | order(_updatedAt desc) [").concat(e,"...").concat(t,"] {\n    _id,\n    _updatedAt,\n    _createdAt,\n    url,\n    originalFilename,\n    mimeType,\n    extension,\n    size,\n    metadata {dimensions}\n  }\n")},Mv=(0,a0.ZP)(l4.rj)(rP||(rP=Mf(["\n  grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));\n"]))),Mb=(0,a0.ZP)(l4.Zb)(rA||(rA=Mf(["\n  border-top: 1px solid var(--card-border-color);\n  position: sticky;\n  bottom: 0;\n  z-index: 200;\n"]))),My=lJ.memo(lJ.forwardRef(function(e,t){let n=qJ(fT),i=(0,lJ.useMemo)(()=>n.withConfig({apiVersion:"2023-02-14"}),[n]),r=(0,lJ.useRef)("default-asset-source-".concat(oS()())),l=(0,lJ.useRef)(0),a=(0,lJ.useRef)(),[o,s]=(0,lJ.useState)([]),[d,c]=(0,lJ.useState)(!1),[u,p]=(0,lJ.useState)(!1),[h,f]=(0,lJ.useState)(!0),{selectedAssets:m,assetType:g="image",dialogHeaderTitle:x="Select image",onClose:v,onSelect:b,accept:y}=e,j=y?y.split(",").map(e=>e.trim()).join(", "):"",w=!h&&y&&y.length>0,k=y&&"image/*"===y&&"image"===g,C=(0,lJ.useCallback)(e=>{let t=200*e,n="image"===g,r=n?Mm:"sanity.fileAsset";f(!0),void 0!==y&&(a.current=i.observable.fetch(Mx(t,t+200,r,y),{},{tag:n?"asset.image-list":"asset.file-list"}).subscribe(e=>{c(e.length<200),s(t=>t.concat(e)),f(!1)}))},[g,y,i]),_=(0,lJ.useCallback)(e=>{s(t=>t.filter(t=>t._id!==e))},[s]),S=(0,lJ.useCallback)(e=>{o.find(t=>t._id===e)&&b([{kind:"assetDocumentId",value:e}])},[o,b]),T=(0,lJ.useCallback)(e=>{e.preventDefault(),S(e.currentTarget.getAttribute("data-id"))},[S]),E=(0,lJ.useCallback)(e=>{"Enter"===e.key&&(e.preventDefault(),S(e.currentTarget.getAttribute("data-id")))},[S]),P=(0,lJ.useCallback)(()=>{v&&v()},[v]),A=(0,lJ.useCallback)(e=>{e.preventDefault(),C(++l.current)},[C]);(0,lJ.useEffect)(()=>(C(l.current),()=>{a.current&&a.current.unsubscribe()}),[C]),(0,lJ.useEffect)(()=>{h||l.current&&0!==l.current||p(!0)},[h]);let O=(0,lJ.useMemo)(()=>(0,lG.jsxs)(l4.xu,{padding:4,children:[(0,lG.jsx)(Mv,{gap:2,children:o.map(e=>(0,lG.jsx)(zJ,{asset:e,isSelected:m.some(t=>t._id===e._id),onClick:T,onKeyPress:E,onDeleteFinished:_},e._id))}),h&&0===o.length&&(0,lG.jsx)(l4.kC,{justify:"center",children:(0,lG.jsx)(l4.$j,{muted:!0})}),!h&&0===o.length&&(0,lG.jsx)(l4.xv,{align:"center",muted:!0,children:"No images"})]}),[o,_,T,E,h,m]),z=(0,lJ.useMemo)(()=>(0,lG.jsx)(Mu,{isLoading:h,assets:o,selectedAssets:m,onClick:T,onKeyPress:E,onDeleteFinished:_}),[h,o,m,T,E,_]);return(0,lG.jsxs)(l4.Vq,{__unstable_autoFocus:u,header:x,id:r.current,onClickOutside:P,onClose:P,ref:t,width:2,children:[w&&!k&&(0,lG.jsx)(l4.Zb,{tone:"primary",marginTop:4,marginX:4,padding:[3,3,4],border:!0,radius:2,children:(0,lG.jsxs)(l4.kC,{gap:[3,4],align:"center",children:[(0,lG.jsx)(l4.xv,{children:(0,lG.jsx)(a8.hQ6,{})}),(0,lG.jsxs)(l4.xv,{size:1,children:["Only showing assets of accepted types: ",(0,lG.jsx)("b",{children:j})]})]})}),"image"===g&&O,"file"===g&&z,o.length>0&&!d&&(0,lG.jsx)(Mb,{tone:"default",padding:4,children:(0,lG.jsx)(l4.kC,{direction:"column",children:(0,lG.jsx)(l4.zx,{type:"button",icon:a8._8t,loading:h,onClick:A,text:"Load more",tone:"primary"})})})]})})),Mj={name:"sanity-default",title:"Uploaded files",component:My,icon:a8.TAM},Mw={name:"sanity-default",title:"Uploaded images",component:My,icon:a8.XBm},Mk=[{fieldPath:"_updatedAt",icon:a8.Que,operators:[{name:"dateTimeLast",type:"item"},{type:"divider"},{name:"dateTimeRange",type:"item"},{name:"dateTimeAfter",type:"item"},{name:"dateTimeBefore",type:"item"},{type:"divider"},{name:"dateTimeEqual",type:"item"},{name:"dateTimeNotEqual",type:"item"}],title:"Updated at",name:"updatedAt",type:"pinned"},{fieldPath:"_createdAt",icon:a8.Que,operators:[{name:"dateTimeLast",type:"item"},{type:"divider"},{name:"dateTimeRange",type:"item"},{name:"dateTimeAfter",type:"item"},{name:"dateTimeBefore",type:"item"},{type:"divider"},{name:"dateTimeEqual",type:"item"},{name:"dateTimeNotEqual",type:"item"}],title:"Created at",name:"createdAt",type:"pinned"},{icon:a8.xPt,operators:[{name:"referencesDocument",type:"item"},{name:"referencesAssetImage",type:"item"},{name:"referencesAssetFile",type:"item"}],title:"Contains document, image or file",name:"references",type:"pinned"},{fieldType:"array",icon:a8.AEM,name:"array",operators:[{name:"defined",type:"item"},{name:"notDefined",type:"item"},{type:"divider"},{name:"arrayCountEqual",type:"item"},{name:"arrayCountNotEqual",type:"item"},{type:"divider"},{name:"arrayCountGt",type:"item"},{name:"arrayCountGte",type:"item"},{name:"arrayCountLt",type:"item"},{name:"arrayCountLte",type:"item"},{type:"divider"},{name:"arrayCountRange",type:"item"}],type:"field"},{fieldType:"array",icon:a8.AEM,name:"arrayList",operators:[{name:"arrayListIncludes",type:"item"},{name:"arrayListNotIncludes",type:"item"},{type:"divider"},{name:"defined",type:"item"},{name:"notDefined",type:"item"},{type:"divider"},{name:"arrayCountEqual",type:"item"},{name:"arrayCountNotEqual",type:"item"},{type:"divider"},{name:"arrayCountGt",type:"item"},{name:"arrayCountGte",type:"item"},{name:"arrayCountLt",type:"item"},{name:"arrayCountLte",type:"item"},{type:"divider"},{name:"arrayCountRange",type:"item"}],type:"field"},{fieldType:"array",icon:a8.AEM,name:"arrayReferences",operators:[{name:"arrayReferenceIncludes",type:"item"},{name:"arrayReferenceNotIncludes",type:"item"},{type:"divider"},{name:"defined",type:"item"},{name:"notDefined",type:"item"},{type:"divider"},{name:"arrayCountEqual",type:"item"},{name:"arrayCountNotEqual",type:"item"},{type:"divider"},{name:"arrayCountGt",type:"item"},{name:"arrayCountGte",type:"item"},{name:"arrayCountLt",type:"item"},{name:"arrayCountLte",type:"item"},{type:"divider"},{name:"arrayCountRange",type:"item"}],type:"field"},{fieldType:"boolean",icon:a8.nSX,name:"boolean",operators:[{name:"booleanEqual",type:"item"},{type:"divider"},{name:"notDefined",type:"item"}],type:"field"},{fieldType:"date",icon:a8.Que,name:"date",operators:[{name:"dateLast",type:"item"},{type:"divider"},{name:"dateRange",type:"item"},{name:"dateAfter",type:"item"},{name:"dateBefore",type:"item"},{type:"divider"},{name:"dateEqual",type:"item"},{name:"dateNotEqual",type:"item"},{type:"divider"},{name:"defined",type:"item"},{name:"notDefined",type:"item"}],type:"field"},{fieldType:"datetime",icon:a8.Que,name:"datetime",operators:[{name:"dateTimeLast",type:"item"},{type:"divider"},{name:"dateTimeRange",type:"item"},{name:"dateTimeAfter",type:"item"},{name:"dateTimeBefore",type:"item"},{type:"divider"},{name:"dateTimeEqual",type:"item"},{name:"dateTimeNotEqual",type:"item"},{type:"divider"},{name:"defined",type:"item"},{name:"notDefined",type:"item"}],type:"field"},{fieldType:"email",icon:a8.Rhe,name:"email",operators:[{name:"stringMatches",type:"item"},{name:"stringNotMatches",type:"item"},{type:"divider"},{name:"stringEqual",type:"item"},{name:"stringNotEqual",type:"item"},{type:"divider"},{name:"defined",type:"item"},{name:"notDefined",type:"item"}],type:"field"},{fieldType:"file",icon:a8.$lS,name:"file",operators:[{name:"assetFileEqual",type:"item"},{name:"assetFileNotEqual",type:"item"},{type:"divider"},{name:"defined",type:"item"},{name:"notDefined",type:"item"}],type:"field"},{fieldType:"image",icon:a8.XBm,name:"image",operators:[{name:"assetImageEqual",type:"item"},{name:"assetImageNotEqual",type:"item"},{type:"divider"},{name:"defined",type:"item"},{name:"notDefined",type:"item"}],type:"field"},{fieldType:"number",icon:a8.yEv,name:"number",operators:[{name:"numberEqual",type:"item"},{name:"numberNotEqual",type:"item"},{type:"divider"},{name:"numberGt",type:"item"},{name:"numberGte",type:"item"},{name:"numberLt",type:"item"},{name:"numberLte",type:"item"},{type:"divider"},{name:"numberRange",type:"item"},{type:"divider"},{name:"defined",type:"item"},{name:"notDefined",type:"item"}],type:"field"},{fieldType:"array",icon:a8.aI,name:"portableText",operators:[{name:"portableTextMatches",type:"item"},{name:"portableTextNotMatches",type:"item"},{type:"divider"},{name:"portableTextEqual",type:"item"},{name:"portableTextNotEqual",type:"item"},{type:"divider"},{name:"defined",type:"item"},{name:"notDefined",type:"item"}],type:"field"},{fieldType:"reference",icon:a8.xPt,name:"reference",operators:[{name:"referenceEqual",type:"item"},{name:"referenceNotEqual",type:"item"},{type:"divider"},{name:"defined",type:"item"},{name:"notDefined",type:"item"}],type:"field"},{fieldType:"slug",icon:a8.Rhe,name:"slug",operators:[{name:"slugMatches",type:"item"},{name:"slugNotMatches",type:"item"},{type:"divider"},{name:"slugEqual",type:"item"},{name:"slugNotEqual",type:"item"},{type:"divider"},{name:"defined",type:"item"},{name:"notDefined",type:"item"}],type:"field"},{fieldType:"string",icon:a8.Rhe,name:"string",operators:[{name:"stringMatches",type:"item"},{name:"stringNotMatches",type:"item"},{type:"divider"},{name:"stringEqual",type:"item"},{name:"stringNotEqual",type:"item"},{type:"divider"},{name:"defined",type:"item"},{name:"notDefined",type:"item"}],type:"field"},{fieldType:"string",icon:a8.GVG,name:"stringList",operators:[{name:"stringListEqual",type:"item"},{name:"stringListNotEqual",type:"item"},{type:"divider"},{name:"stringMatches",type:"item"},{name:"stringNotMatches",type:"item"},{type:"divider"},{name:"defined",type:"item"},{name:"notDefined",type:"item"}],type:"field"},{fieldType:"text",icon:a8.Rhe,name:"text",operators:[{name:"stringMatches",type:"item"},{name:"stringNotMatches",type:"item"},{type:"divider"},{name:"stringEqual",type:"item"},{name:"stringNotEqual",type:"item"},{type:"divider"},{name:"defined",type:"item"},{name:"notDefined",type:"item"}],type:"field"},{fieldType:"url",icon:a8.Rhe,name:"url",operators:[{name:"stringMatches",type:"item"},{name:"stringNotMatches",type:"item"},{type:"divider"},{name:"stringEqual",type:"item"},{name:"stringNotEqual",type:"item"},{type:"divider"},{name:"defined",type:"item"},{name:"notDefined",type:"item"}],type:"field"}];function MC(e){let{documentId:t,schemaType:n}=e,i=Uj(),{draft:r,published:l,isLoading:a}=(0,l5.m2)(()=>fJ(i,n,t,""),[t,i,n]),o=f0({draft:r,published:l,value:(0,lJ.useMemo)(()=>({_id:t,_type:n.name}),[t,n.name])});return a?(0,lG.jsx)(l4.Od,{animated:!0,marginLeft:1,radius:2,style:{width:"10ch",height:"1em"}}):(0,lG.jsx)(lG.Fragment,{children:o.title||t.slice(0,8)})}let M_="yyyy-MM-dd";function MS(e){let{value:t}=e,n=(null==t?void 0:t.date)?new Date(t.date):null;return n&&(0,oV.Z)(n)?(0,lG.jsx)(lG.Fragment,{children:(0,oy.Z)(n,M_)}):null}function MT(e){let{value:t}=e,n=(null==t?void 0:t.date)?new Date(t.date):null;return n&&(0,oV.Z)(n)?(0,lG.jsx)(lG.Fragment,{children:(0,oy.Z)(n,M_)}):null}function ME(e){let{value:t}=e,n=(null==t?void 0:t.dateMin)?new Date(t.dateMin):null,i=(null==t?void 0:t.dateMax)?new Date(t.dateMax):null;return i&&n&&(0,oV.Z)(i)&&(0,oV.Z)(n)?(0,lG.jsxs)(lG.Fragment,{children:[(0,oy.Z)(n,M_)," → ",(0,oy.Z)(i,M_)]}):null}function MP(e){let{value:t}=e;return(0,lG.jsx)(lG.Fragment,{children:t})}function MA(e){let{value:t}=e;return(0,lG.jsxs)(lG.Fragment,{children:[t," ",(0,o6.Z)("item",t)]})}function MO(e){let{value:t}=e,n=q6(),i=t._ref,r=n.get(t._type);return r?(0,lG.jsx)(MC,{documentId:i,schemaType:r}):null}function Mz(e){let{value:t}=e;return(0,lG.jsx)(lG.Fragment,{children:t})}let MM=(0,lJ.createContext)(void 0);function MI(){let e=(0,lJ.useContext)(MM);if(void 0===e)throw Error("useSearchState must be used within an SearchProvider");return e}function MR(e){let{value:t,onChange:n}=e,[i,r]=(0,lJ.useState)(null!=t?t:""),{state:{fullscreen:l}}=MI(),a=(0,lJ.useCallback)(e=>{r(e.currentTarget.value);let t=parseFloat(e.currentTarget.value);n(Number.isFinite(t)?t:null)},[n]);return(0,lG.jsx)(l4.oi,{fontSize:l?2:1,onChange:a,placeholder:"Value",radius:2,step:"any",type:"number",value:i})}function MF(e){var t,n;let{onChange:i,value:r}=e,[l,a]=(0,lJ.useState)(null!=(t=null==r?void 0:r.max)?t:""),[o,s]=(0,lJ.useState)(null!=(n=null==r?void 0:r.min)?n:""),{state:{fullscreen:d}}=MI(),c=(0,lJ.useCallback)(e=>{var t;a(e.currentTarget.value);let n=parseFloat(e.currentTarget.value);i({max:Number.isFinite(n)?n:null,min:null!=(t=null==r?void 0:r.min)?t:null})},[null==r?void 0:r.min,i]),u=(0,lJ.useCallback)(e=>{var t;s(e.currentTarget.value);let n=parseFloat(e.currentTarget.value);i({max:null!=(t=null==r?void 0:r.max)?t:null,min:Number.isFinite(n)?n:null})},[null==r?void 0:r.max,i]);return(0,lG.jsxs)(l4.kC,{gap:2,children:[(0,lG.jsx)(l4.xu,{flex:1,children:(0,lG.jsx)(l4.oi,{fontSize:d?2:1,onChange:u,placeholder:"Min value",radius:2,step:"any",type:"number",value:o})}),(0,lG.jsx)(l4.xu,{flex:1,children:(0,lG.jsx)(l4.oi,{fontSize:d?2:1,onChange:c,placeholder:"Max value",radius:2,step:"any",type:"number",value:l})})]})}function MD(e,t){let n=t.split("."),i=n[0];if(i&&(0,lX.m$)(e)){let t=e.fields.find(e=>e.name===i);if(t){let e=n.slice(1).join(".");return e?MD(t.type,e):t}}}var MZ=Object.freeze,ML=Object.defineProperty,Mq=(e,t)=>MZ(ML(e,"raw",{value:MZ(t||e.slice())}));let MN=(0,a0.ZP)(l4.xu)(rO||(rO=Mq(["\n  @supports (-webkit-overflow-scrolling: touch) {\n    * [data-ui='Box'] {\n      background-attachment: scroll;\n    }\n  }\n"]))),MV=(0,a0.ZP)(l4.__)(rz||(rz=Mq(["\n  max-width: 150px;\n"])));function MU(e){let{documentId:t,presence:n,schemaType:i}=e,r=Uj(),{draft:l,published:a,isLoading:o}=(0,l5.m2)(()=>fJ(r,i,t,""),[t,r,i]),s=(0,lJ.useMemo)(()=>({_id:t,_type:i.name}),[t,i.name]),d=(0,lJ.useMemo)(()=>o?null:(0,lG.jsxs)(l4.gF,{space:3,children:[n&&n.length>0&&(0,lG.jsx)(yg,{presence:n}),(0,lG.jsx)(MV,{size:0,muted:!0,textOverflow:"ellipsis",children:i.title})]}),[o,n,i.title]);return(0,lG.jsx)(MN,{children:(0,lG.jsx)(fL,{...f0({draft:l,published:a,value:s}),isPlaceholder:null==o||o,layout:"default",icon:i.icon,status:d})})}function MB(e){let{compact:t,disableIntentLink:n,documentId:i,documentType:r,onClick:l,...a}=e,o=q6().get(r),s=Uu(i),d=(0,lJ.useMemo)(()=>({id:i,type:null==o?void 0:o.name}),[i,null==o?void 0:o.name]),{onClick:c,href:u}=(0,a9.PM)({intent:"edit",params:d}),p=(0,lJ.useCallback)(e=>{n||c(e),null==l||l()},[n,l,c]);return o?(0,lG.jsx)(l4.xu,{...a,children:(0,lG.jsx)(uU,{as:"a","data-as":"a",flex:1,href:n?void 0:u,onClick:p,padding:t?1:2,radius:2,tabIndex:-1,children:(0,lG.jsx)(MU,{documentId:i,presence:s,schemaType:o})})}):null}let MK="undefined"!=typeof window&&/Mac|iPod|iPhone|iPad/.test(window.navigator.platform)?"Cmd":"Ctrl",MH=l4.Lg.space[1];function MW(e){let{allowEmptyQueries:t,terms:n}=e,i=!!t||n.query.length>0,r=!!n.filter,l=n.types.length>0;return i||r||l}function M$(e){return mv(e).filter(e=>!1!==e.__experimental_omnisearch_visibility)}function MX(e,t){var n,i;return(null!=(n=e.title)?n:e.name).localeCompare(null!=(i=t.title)?i:t.name)}let MG={error:null,hits:[],loading:!1,terms:{query:"",types:[]}};function MY(e){return null!==e}function MJ(e){var t;return{...e,terms:{...e.terms,filter:null==(t=e.terms.filter)?void 0:t.trim(),query:e.terms.query.trim()}}}function MQ(e){let{allowEmptyQueries:t,initialState:n,onComplete:i,onError:r,onStart:l,schema:a}=e,[o,s]=(0,lJ.useState)(n),d=qJ(fT),c=(0,lJ.useMemo)(()=>mP(M$(a),d,{tag:"search.global",unique:!0}),[d,a]),u=(0,l5.W2)(e=>e.pipe((0,aj.h)(MY),(0,ag.U)(MJ),(0,ax.x)(aG()),(0,aR.D)(e=>(0,ai.H)((null==e?void 0:e.debounceTime)||300)),(0,am.b)(l),(0,ab.w)(e=>(0,l8.z)((0,l6.of)({...MG,loading:!0,options:e.options,terms:e.terms}),(0,ac.s)(()=>MW({allowEmptyQueries:t,terms:e.terms}),c(e.terms,e.options).pipe((0,ag.U)(e=>({hits:e})),(0,am.b)(e=>{let{hits:t}=e;return null==i?void 0:i(t)}),(0,av.K)(t=>(null==r||r(t),(0,l6.of)({...MG,error:t,loading:!1,options:e.options,terms:e.terms})))),(0,l6.of)(aa.E).pipe((0,am.b)(()=>null==i?void 0:i([])))),(0,l6.of)({loading:!1}))),(0,ay.R)((e,t)=>({...e,...t}),MG),(0,am.b)(s)),[t,c]);return{handleSearch:(0,lJ.useCallback)(e=>u(e),[u]),searchState:o}}function M0(e){let t,{availableCharacters:n=40,types:i}=e,r=i.reduce((t=n,function(e,i,r){let l=M1(i);return t-=l.length,0===r?e.push(i):n>l.length&&t>l.length&&e.push(i),e}),[]),l=i.length-r.length;return i.length?["".concat(r.map(M1).join(", ")),...l?["+".concat(l," more")]:[]].join(" "):"All types"}function M1(e){var t;return null!=(t=e.title)?t:e.name}var M2=Object.freeze,M3=Object.defineProperty;let M4=()=>!0,M5=(0,a0.ZP)(l4.xv)(rM||(rM=M2(M3(ei=["\n  word-break: break-word;\n"],"raw",{value:M2(ei.slice())})))),M6=(0,lJ.forwardRef)(function(e,t){let{onSelect:n,types:i=[],value:r}=e,l=(0,lJ.useRef)(null),a=q6(),{state:{fullscreen:o}}=MI(),s=(0,lJ.useId)(),[d,c]=(0,lJ.useState)([]),{handleSearch:u,searchState:p}=MQ({allowEmptyQueries:!0,initialState:{hits:[],loading:!1,error:null,terms:{query:"",types:i}},onComplete:e=>{c(e.map(e=>({hit:e,value:e.hit._id})))},schema:a}),h=(0,lJ.useCallback)(()=>{u({debounceTime:0,options:{limit:100},terms:{query:"",types:i}})},[u,i]),f=(0,lJ.useCallback)(e=>{e?u({options:{limit:100},terms:{query:e||"",types:i}}):u({debounceTime:0,options:{limit:0},terms:{query:"",types:i}})},[u,i]),m=(0,lJ.useCallback)(e=>{var t;let i=null==(t=d.find(t=>t.value===e))?void 0:t.hit.hit;i&&(null==n||n({_ref:cd(i._id),_type:i._type}))},[d,n]),g=(0,lJ.useMemo)(()=>{let e=M0({types:i});return i.length>0?"Search for ".concat(e):"Search all documents"},[i]),x=(0,lJ.useCallback)(e=>{let t=e.hit.hit._type;return(0,lG.jsx)(MB,{compact:!0,disableIntentLink:!0,documentId:e.value,documentType:t})},[]),v=(0,lJ.useCallback)((e,t)=>{let{content:n,hidden:i,onMouseEnter:r,onMouseLeave:a}=e,o=d&&d.length>0;return(0,lG.jsx)(l4.J2,{arrow:!1,constrainSize:!0,content:(0,lG.jsx)("div",{ref:t,children:o?n:p.terms.query&&(0,lG.jsx)(l4.xu,{padding:4,children:(0,lG.jsx)(l4.kC,{align:"center",height:"fill",justify:"center",children:(0,lG.jsxs)(M5,{align:"center",muted:!0,children:["No results for ",(0,lG.jsxs)("strong",{children:["“",p.terms.query,"”"]})]})})})}),matchReferenceWidth:!0,onMouseEnter:r,onMouseLeave:a,open:!p.loading&&!i,overflow:"auto",placement:"bottom-start",radius:2,referenceElement:l.current})},[d,p.loading,p.terms.query]);return(0,lG.jsx)("div",{ref:l,children:(0,lG.jsx)(l4.F2,{"aria-label":g,filterOption:M4,fontSize:o?2:1,id:s,loading:p.loading,openButton:{onClick:h},options:d,onQueryChange:f,onSelect:m,placeholder:g,radius:2,ref:t,renderOption:x,renderPopover:v,value:null==r?void 0:r._ref})})});function M8(e){let{fieldDefinition:t,onChange:n,value:i}=e,{onClose:r,state:{documentTypesNarrowed:l,fullscreen:a}}=MI(),o=q6(),s=(0,lJ.useCallback)(e=>n(e),[n]),d=(0,lJ.useMemo)(()=>t?t.documentTypes.filter(e=>l.includes(e)).flatMap(e=>{let n=o.get(e);if(n){let e=MD(n,t.fieldPath);if((0,lX.jB)(null==e?void 0:e.type))return null==e?void 0:e.type.of.filter(lX.dD).flatMap(e=>e.to);if((0,lX.dD)(null==e?void 0:e.type))return null==e?void 0:e.type.to}return[]}).reduce((e,t)=>(0>e.findIndex(e=>e.name===(null==t?void 0:t.name))&&e.push(t),e),[]):[],[l,t,o]),c=(0,lJ.useCallback)(()=>s(null),[s]),u=(0,lJ.useCallback)(()=>{null==r||r()},[r]);return(0,lG.jsx)(l4.xu,{style:{width:"min(calc(100vw - 40px), 420px)"},children:(null==i?void 0:i._ref)&&(null==i?void 0:i._type)?(0,lG.jsxs)(l4.Kq,{space:3,children:[(0,lG.jsx)(l4.Zb,{padding:1,radius:1,shadow:1,children:(0,lG.jsx)(MB,{compact:!0,documentId:i._ref,documentType:i._type,onClick:u})}),(0,lG.jsx)(l4.zx,{fontSize:a?2:1,mode:"ghost",onClick:c,text:"Clear",tone:"critical"})]}):(0,lG.jsx)(M6,{onSelect:s,types:d,value:i})})}function M9(e){let{onClick:t,selected:n,title:i,value:r}=e,l=(0,lJ.useCallback)(()=>t(r),[t,r]);return(0,lG.jsx)(l4.sN,{onClick:l,padding:3,pressed:n,tone:"default",children:(0,lG.jsx)(l4.kC,{align:"center",justify:"space-between",gap:3,children:(0,lG.jsxs)(l4.Kq,{paddingRight:2,space:2,children:[(0,lG.jsx)(l4.xv,{size:1,weight:"regular",children:i}),r&&(0,lG.jsx)(l4.EK,{muted:!0,size:0,children:r})]})})})}function M7(e){let{fieldDefinition:t,onChange:n,value:i}=e,r=(0,lJ.useId)(),{state:{documentTypesNarrowed:l}}=MI(),a=q6(),o=(0,lJ.useMemo)(()=>t?t.documentTypes.filter(e=>l.includes(e)).map(e=>{let n=a.get(e);if(n){let e=MD(n,t.fieldPath);return null==e?void 0:e.type.options}return null}).filter(cr).map(e=>e.list).flatMap(e=>null==e?void 0:e.map(e=>(0,lX.n4)(e)?e:{title:sK()("".concat(e)),value:e})).filter(cr).reduce((e,t)=>{let n=e.findIndex(e=>e.value===(null==t?void 0:t.value));if(n>-1){let i=e[n];e[n]={...e[n],title:sh()([...i.title,t.title]).sort()}}else e.push({...t,title:[t.title]});return e},[]):[],[l,t,a]),s=(0,lJ.useCallback)(e=>{n(e)},[n]);return(0,lG.jsx)(l4.j2,{button:(0,lG.jsx)(l4.zx,{mode:"ghost",padding:3,children:(0,lG.jsxs)(l4.kC,{align:"center",gap:2,justify:"space-between",children:[(0,lG.jsx)(l4.xv,{size:1,weight:"regular",children:i||"Select..."}),(0,lG.jsx)(l4.xu,{marginLeft:1,children:(0,lG.jsx)(l4.xv,{size:1,children:(0,lG.jsx)(a8.GVG,{})})})]})}),id:r||"",menu:(0,lG.jsx)(l4.v2,{children:o.map((e,t)=>(0,lG.jsx)(M9,{onClick:s,selected:e.value===i,title:e.title.join(", "),value:e.value||""},t))}),popover:{constrainSize:!0,placement:"bottom-start",portal:!1,radius:2}})}let Ie=()=>(0,lG.jsx)("svg",{width:"1em",height:"1em",viewBox:"0 0 25 25",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,lG.jsx)("path",{d:"M7.04 19V17.512H17.36V19H7.04ZM7.04 15.328V13.624L12.08 11.872L15.32 10.816V10.72L12.08 9.664L7.04 7.912V6.208L17.36 9.88V11.656L7.04 15.328Z",fill:"currentColor"})}),It=()=>(0,lG.jsx)("svg",{width:"1em",height:"1em",viewBox:"0 0 25 25",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,lG.jsx)("path",{d:"M7.568 18.848V16.952L14.792 12.08V11.984L7.568 7.112V5.216L16.52 11.288V12.776L7.568 18.848Z",fill:"currentColor"})}),In=()=>(0,lG.jsx)("svg",{width:"1em",height:"1em",viewBox:"0 0 25 25",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,lG.jsx)("path",{d:"M7.04 19V17.512H17.36V19H7.04ZM17.36 15.328L7.04 11.656V9.88L17.36 6.208V7.912L12.32 9.664L9.08 10.72V10.816L12.32 11.872L17.36 13.624V15.328Z",fill:"currentColor"})}),Ii=()=>(0,lG.jsx)("svg",{width:"1em",height:"1em",viewBox:"0 0 25 25",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,lG.jsx)("path",{d:"M16.952 19.632L8 13.56V12.072L16.952 6V7.896L9.728 12.768V12.864L16.952 17.736V19.632Z",fill:"currentColor"})});function Ir(e){return JSON.stringify(e)}let Il=(0,lJ.createContext)(null);function Ia(e){let{children:t,workspace:n}=e;return(0,lG.jsx)(Il.Provider,{value:n,children:t})}function Io(){let e=(0,lJ.useContext)(Il);if(!e)throw Error("Workspace: missing context value");return e}let Is=(0,lJ.createContext)(null);function Id(e){let{children:t,...n}=e,i=(0,lJ.useContext)(Is),{unstable_sources:r}=Io();if("source"in n){let{source:e}=n;return(0,lG.jsx)(Is.Provider,{value:e,children:t})}if("name"in n){let{name:e}=n,l=r.find(t=>t.name===e);if(!l)throw Error("Could not find source with name `".concat(e,"` in current workspace"));return i===l?(0,lG.jsx)(lG.Fragment,{children:t}):(0,lG.jsx)(Is.Provider,{value:l,children:t})}throw Error("Invalid props passed into SourceProvider. A `name` or a `source` object is required.")}function Ic(){let e=(0,lJ.useContext)(Is);if(!e)throw Error("Could not find `source` context");return e}function Iu(e){return(0,lG.jsx)(l4.xu,{...e,children:(0,lG.jsxs)(l4.kC,{align:"flex-start",gap:3,children:[(0,lG.jsx)(p6,{tone:"caution",children:(0,lG.jsx)(a8.foC,{})}),(0,lG.jsxs)(l4.Kq,{space:4,children:[(0,lG.jsx)(p6,{size:1,tone:"caution",weight:"semibold",children:"No valid asset sources found."}),(0,lG.jsx)(p6,{size:1,tone:"caution",children:"Currently, only the default asset source is supported."}),(0,lG.jsx)(p6,{size:1,tone:"caution",children:"Please ensure it's enabled in your studio configuration file."})]})]})})}function Ip(e){let{reference:t}=e,n=Uj(),i=(0,lJ.useCallback)(e=>wZ(n,e),[n]);return(0,lG.jsx)(_X,{observeAsset:i,reference:t,waitPlaceholder:(0,lG.jsx)(If,{}),children:e=>(0,lG.jsx)(Ih,{asset:e})})}function Ih(e){let{asset:t}=e;return(0,lG.jsx)(l4.Zb,{padding:2,shadow:1,children:(0,lG.jsxs)(l4.kC,{align:"center",justify:"space-between",wrap:"nowrap",children:[(0,lG.jsx)(l4.Zb,{padding:3,radius:1,shadow:1,tone:"transparent",children:(0,lG.jsx)(l4.xv,{children:(0,lG.jsx)(a8.bg6,{})})}),(0,lG.jsxs)(l4.Kq,{flex:1,space:2,marginLeft:3,children:[(0,lG.jsx)(l4.xv,{size:2,textOverflow:"ellipsis",muted:!0,children:(null==t?void 0:t.originalFilename)||t._id}),(0,lG.jsx)(l4.xv,{size:1,muted:!0,children:Sz(t.size)})]})]})})}function If(){return(0,lG.jsx)(l4.Zb,{padding:2,shadow:1,children:(0,lG.jsxs)(l4.kC,{align:"center",justify:"flex-start",children:[(0,lG.jsx)(l4.Zb,{padding:3,radius:1,shadow:1,tone:"transparent",children:(0,lG.jsx)(l4.xv,{children:(0,lG.jsx)(a8.bg6,{})})}),(0,lG.jsxs)(l4.Kq,{flex:1,space:2,marginLeft:3,children:[(0,lG.jsx)(l4.JQ,{animated:!0,style:{width:"100%"},radius:1}),(0,lG.jsx)(l4.JQ,{animated:!0,style:{width:"100%"},radius:1})]})]})})}var Im=Object.freeze,Ig=Object.defineProperty,Ix=(e,t)=>Im(Ig(e,"raw",{value:Im(t||e.slice())}));let Iv=(0,a0.ZP)(l4.Zb)(rI||(rI=Ix(["\n  position: relative;\n  padding-bottom: 100%;\n"]))),Ib=a0.ZP.img(rR||(rR=Ix(["\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  display: block;\n  object-fit: contain;\n"]))),Iy=(0,a0.ZP)(l4.kC)(rF||(rF=Ix(["\n  height: 100%;\n  position: absolute;\n  width: 100%;\n"])));function Ij(e){let{reference:t}=e,n=Uj(),i=(0,lJ.useCallback)(e=>wZ(n,e),[n]);return(0,lG.jsx)(_X,{observeAsset:i,reference:t,children:e=>(0,lG.jsx)(Iw,{asset:e})})}function Iw(e){let{asset:t}=e,[n,i]=(0,lJ.useState)(!1),r="".concat(t.url,"?h=800&fit=max"),l=(0,lJ.useCallback)(()=>i(!0),[]);return(0,lG.jsxs)(Iv,{__unstable_checkered:!0,border:!0,children:[!n&&(0,lG.jsx)(Iy,{align:"center",justify:"center",children:(0,lG.jsx)(l4.$j,{})}),(0,lG.jsx)(Ib,{onLoad:l,src:r})]})}function Ik(e){let{reference:t}=e;return t?t._type.startsWith("sanity.fileAsset")?(0,lG.jsx)(Ip,{reference:t}):t._type.startsWith("sanity.imageAsset")?(0,lG.jsx)(Ij,{reference:t}):null:null}var IC=Object.freeze,I_=Object.defineProperty;let IS={file:"sanity.fileAsset",image:"sanity.imageAsset"},IT=(0,a0.ZP)(l4.xu)(rD||(rD=IC(I_(er=["\n  width: min(calc(100vw - 40px), 320px);\n"],"raw",{value:IC(er.slice())}))));function IE(e){return function(t){let{onChange:n,value:i}=t,[r,l]=(0,lJ.useState)(null),[a,o]=(0,lJ.useState)(null),{state:{fullscreen:s}}=MI(),{file:d,image:c}=Ic().form,u=(0,lJ.useMemo)(()=>{switch(e){case"file":return d.assetSources.filter(e=>e.name===Mj.name);case"image":return c.assetSources.filter(e=>e.name===Mw.name);default:throw Error("Unknown asset source found")}},[d.assetSources,c.assetSources]),p=(0,lJ.useId)(),h=qJ(fT),f=(0,lJ.useCallback)(()=>{o(null),n(null)},[n]),m=(0,lJ.useCallback)(()=>{l(null)},[]),g=(0,lJ.useCallback)(e=>{o(e[0]),m()},[m]),x=(0,lJ.useCallback)(e=>l(e),[]);(0,lJ.useEffect)(()=>{(null==a?void 0:a.kind)==="assetDocumentId"&&"string"==typeof(null==a?void 0:a.value)&&e&&n({_ref:a.value,_type:IS[e]})},[h,n,a]);let v=null==r?void 0:r.component,b=s?2:1,y=i?"Change ".concat(e):"Select ".concat(e),j=ob()(e,"options.accept","image"===e?"image/*":"");return(0,lG.jsx)(IT,{children:(0,lG.jsxs)(l4.Kq,{space:3,children:[r&&v&&(0,lG.jsx)(l4.h_,{children:(0,lG.jsx)(v,{assetType:e,dialogHeaderTitle:"Select ".concat(e),onClose:m,onSelect:g,selectedAssets:[],selectionType:"single",accept:j})}),i&&(0,lG.jsx)(Ik,{reference:i}),(0,lG.jsxs)(l4.kC,{gap:2,children:[0===u.length&&(0,lG.jsx)(Iu,{padding:2}),u.length>0&&(0,lG.jsx)(lG.Fragment,{children:u.length>1?(0,lG.jsx)(l4.j2,{button:(0,lG.jsx)(l4.zx,{fontSize:b,icon:i?a8.UEU:a8.W1M,iconRight:a8.v4q,mode:"ghost",style:{flex:i?1:0},text:y}),id:p,menu:(0,lG.jsx)(l4.v2,{children:u.map(e=>(0,lG.jsx)(l4.sN,{fontSize:b,icon:e.icon||a8.XBm,onClick:()=>x(e),text:e.title},e.name))}),popover:{constrainSize:!0,portal:!1,radius:2}}):(0,lG.jsx)(l4.zx,{fontSize:b,icon:i?a8.UEU:a8.W1M,mode:"ghost",onClick:()=>x(u[0]),style:{flex:i?1:0},text:y})}),i&&(0,lG.jsx)(l4.zx,{fontSize:s?2:1,mode:"ghost",onClick:f,style:{flex:1},text:"Clear",tone:"critical"})]})]})})}}let IP={assetFileEqual:{buttonLabel:"is",buttonValueComponent:MO,groqFilter:e=>{let{fieldPath:t,value:n}=e;return(null==n?void 0:n._ref)&&t?"".concat(t,".asset._ref == ").concat(Ir(n._ref)):null},initialValue:null,inputComponent:IE("file"),label:"is",type:"assetFileEqual"},assetFileNotEqual:{buttonLabel:"is not",buttonValueComponent:MO,groqFilter:e=>{let{fieldPath:t,value:n}=e;return(null==n?void 0:n._ref)&&t?"".concat(t,".asset._ref != ").concat(Ir(n._ref)):null},initialValue:null,inputComponent:IE("file"),label:"is not",type:"assetFileNotEqual"},assetImageEqual:{buttonLabel:"is",buttonValueComponent:MO,groqFilter:e=>{let{fieldPath:t,value:n}=e;return(null==n?void 0:n._ref)&&t?"".concat(t,".asset._ref == ").concat(Ir(n._ref)):null},initialValue:null,inputComponent:IE("image"),label:"is",type:"assetImageEqual"},assetImageNotEqual:{buttonLabel:"is not",buttonValueComponent:MO,groqFilter:e=>{let{fieldPath:t,value:n}=e;return(null==n?void 0:n._ref)&&t?"".concat(t,".asset._ref != ").concat(Ir(n._ref)):null},initialValue:null,inputComponent:IE("image"),label:"is not",type:"assetImageNotEqual"}};var IA=Object.freeze,IO=Object.defineProperty;let Iz="Include time",IM=(0,a0.ZP)(l4.xv)(rZ||(rZ=IA(IO(el=["\n  cursor: default;\n"],"raw",{value:IA(el.slice())}))));function II(e){let{onChange:t,value:n}=e;return(0,lG.jsxs)(l4.kC,{align:"center",gap:2,justify:"flex-end",marginTop:1,children:[(0,lG.jsx)(l4.Kq,{children:(0,lG.jsx)(IM,{muted:!0,onClick:t,size:1,weight:"medium",children:Iz})}),(0,lG.jsx)(l4.rs,{checked:n,label:Iz,onChange:t})]})}let IR=(0,lJ.createContext)(void 0);function IF(){let e=(0,lJ.useContext)(IR);if(void 0===e)throw Error("useCalendar must be used within an CalendarContext.Provider");return e}let ID=["January","February","March","April","May","June","July","August","September","October","November","December"],IZ=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"];sQ()(0,24);let IL=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],Iq=[1,2,3,4,5,6];function IN(e){let{focusedDate:t}=IF(),{fontSize:n,moveFocusedDate:i,onNowClick:r}=e,l=(0,lJ.useCallback)(()=>i(-1),[i]),a=(0,lJ.useCallback)(()=>i(1),[i]);return(0,lG.jsxs)(l4.kC,{align:"center",flex:1,justify:"space-between",children:[(0,lG.jsxs)(l4.gF,{paddingLeft:2,space:1,children:[(0,lG.jsx)(l4.xv,{weight:"medium",children:ID[t.getMonth()]}),(0,lG.jsx)(l4.xv,{weight:"medium",children:t.getFullYear()})]}),(0,lG.jsxs)(l4.xu,{children:[(0,lG.jsx)(l4.zx,{fontSize:n,text:"Today",mode:"bleed",onClick:r}),(0,lG.jsx)(l4.zx,{"aria-label":"Go to previous month",onClick:l,mode:"bleed",icon:a8.wyc}),(0,lG.jsx)(l4.zx,{"aria-label":"Go to next month",mode:"bleed",icon:a8.XCv,onClick:a})]})]})}var IV=Object.freeze,IU=Object.defineProperty,IB=(e,t)=>IV(IU(e,"raw",{value:IV(t||e.slice())}));let IK=a0.ZP.svg(e=>{let{theme:t}=e;return(0,a0.iv)(rL||(rL=IB(["\n    bottom: 0;\n    left: 0;\n    position: absolute;\n    right: 0;\n    top: 0;\n\n    circle {\n      stroke: ",";\n      stroke-width: 3;\n      fill: none;\n    }\n  "])),t.sanity.color.card.enabled.border)}),IH=(0,a0.ZP)(l4.Zb)(rq||(rq=IB(["\n  position: relative;\n\n  &[data-focused='true'] {\n    z-index: 1;\n  }\n\n  &[data-start-date='true'] {\n    border-top-right-radius: 0;\n    border-bottom-right-radius: 0;\n  }\n\n  &[data-end-date='true'] {\n    border-top-left-radius: 0;\n    border-bottom-left-radius: 0;\n  }\n\n  &[data-within-range='true'] {\n    border-radius: 0;\n  }\n"])));function IW(e){let{date:t,onSelect:n}=e,i=(0,lJ.useCallback)(()=>{n(t)},[t,n]),{date:r,endDate:l,focusedDate:a,fontSize:o,selectRange:s}=IF(),d=r&&(0,oz.Z)(t,r),c=s&&r&&(0,oz.Z)(t,r),u=s&&l&&(0,oz.Z)(t,l),p=(0,oM.Z)(t,a),h=a&&(0,oz.Z)(t,a),f=(0,oz.Z)(t,new Date),m=r&&l&&!c&&!u&&(0,oU.Z)(t,r)&&(0,oB.Z)(t,l);return(0,lG.jsxs)(IH,{__unstable_focusRing:!0,"aria-label":t.toDateString(),"aria-pressed":d,"data-end-date":!!u||void 0,"data-focused":h?"true":"","data-ui":"CalendarDay","aria-selected":d,"data-start-date":!!c||void 0,"data-within-range":!!m||void 0,forwardedAs:"button",onClick:i,padding:3,radius:2,role:"button",selected:d||c||u,tabIndex:-1,tone:m?"primary":"default",children:[f&&(0,lG.jsx)(IK,{height:"100%",preserveAspectRatio:"xMidYMid meet",vectorEffect:"non-scaling-stroke",viewBox:"0 0 100 100",width:"100%",children:(0,lG.jsx)("circle",{cx:"50",cy:"50",r:"40%"})}),(0,lG.jsx)(l4.xv,{align:"center",muted:!d&&!p,size:o,weight:f?"medium":"regular",children:t.getDate()})]})}let I$=e=>{let t=(0,oT.Z)(e);return(0,oE.Z)({start:t,end:(0,oP.Z)(t)})},IX=e=>e.map(e=>[e,...Iq.map(t=>(0,oA.Z)(e,t))]),IG=e=>IX(I$(e)).map(e=>({number:(0,oO.Z)(e[0]),days:e}));var IY=Object.freeze,IJ=Object.defineProperty;let IQ=(0,a0.ZP)(l4.rj)(rN||(rN=IY(IJ(ea=["\n  grid-template-columns: repeat(7, minmax(44px, auto));\n"],"raw",{value:IY(ea.slice())}))));function I0(e){let{hidden:t,onSelect:n}=e,{focusedDate:i,fontSize:r}=IF();return(0,lG.jsx)(l4.xu,{"aria-hidden":t||!1,"data-ui":"CalendarMonth",children:(0,lG.jsxs)(IQ,{children:[IZ.map(e=>(0,lG.jsx)(l4.xu,{paddingBottom:3,paddingTop:2,children:(0,lG.jsx)(l4.xv,{align:"center",size:r,weight:"medium",children:e})},e)),IG(i).map((e,t)=>e.days.map((e,i)=>(0,lG.jsx)(IW,{date:e,onSelect:n},"".concat(t,"-").concat(i))))]})})}let I1=(0,lG.jsx)("span",{"data-preserve-focus":!0,style:{overflow:"hidden",position:"absolute",outline:"none"},tabIndex:-1});function I2(e){let{date:t,endDate:n,fontSize:i,onSelect:r,selectRange:l,selectTime:a}=e,[o,s]=(0,lJ.useState)(null),[d,c]=(0,lJ.useState)(!1),[u,p]=(0,lJ.useState)(t||new Date),h=(0,lJ.useRef)(t||null),f=(0,lJ.useRef)(n||null),m=(0,lJ.useCallback)(()=>{var e;null==(e=null==o?void 0:o.querySelector('[data-focused="true"]'))||e.focus()},[o]),g=(0,lJ.useCallback)(e=>{let i=(0,oK.Z)(e,{hours:e.getHours(),minutes:e.getMinutes(),seconds:0,milliseconds:0}),a=t&&(0,oB.Z)(i,t),o=n&&(0,oU.Z)(i,n);if(l){if(a||o){r({date:i,endDate:null});return}d?r({date:t||null,endDate:i}):r({date:i,endDate:t?null:n||null})}else r({date:i})},[t,n,r,d,l]),x=(0,lJ.useCallback)(()=>{let e=new Date;l?p(e):r({date:e})},[r,l,p]),v=(0,lJ.useCallback)(e=>{var t;if(IL.includes(e.key)){if(e.preventDefault(),e.target.hasAttribute("data-calendar-grid")){m();return}"ArrowUp"===e.key&&p((0,oA.Z)(u,-7)),"ArrowDown"===e.key&&p((0,oA.Z)(u,7)),"ArrowLeft"===e.key&&p((0,oA.Z)(u,-1)),"ArrowRight"===e.key&&p((0,oA.Z)(u,1)),null==(t=null==o?void 0:o.querySelector("[data-preserve-focus]"))||t.focus()}},[o,m,u,p]),b=(0,lJ.useCallback)(e=>p((0,oF.Z)(u,e)),[u,p]);return(0,lJ.useEffect)(()=>{m()},[m]),(0,lJ.useEffect)(()=>{var e;(null==(e=document.activeElement)?void 0:e.matches("[data-calendar-grid], [data-calendar-grid] [data-preserve-focus]"))&&m()},[m,u]),(0,lJ.useEffect)(()=>{var e,i;let l=(null==t?void 0:t.getTime())!==(null==(e=h.current)?void 0:e.getTime()),a=(null==n?void 0:n.getTime())!==(null==(i=f.current)?void 0:i.getTime()),o=t&&n&&(0,oU.Z)(t,n);l&&!a&&(o&&(c(!0),r({date:t,endDate:null})),c(!!t),t&&p(t)),!l&&a&&(o&&(c(!0),r({date:n,endDate:null})),c(!!t&&!n),n&&p(n)),l&&a&&(c(!0),t&&p(t)),h.current=t||null,f.current=n||null},[t,n,r]),(0,lG.jsx)(IR.Provider,{value:{date:t,endDate:n,focusedDate:u,fontSize:i,selectRange:l,selectTime:a},children:(0,lG.jsxs)(l4.xu,{"data-ui":"Calendar",ref:s,children:[(0,lG.jsx)(l4.kC,{children:(0,lG.jsx)(l4.xu,{flex:1,children:(0,lG.jsx)(IN,{fontSize:i,moveFocusedDate:b,onNowClick:x})})}),(0,lG.jsxs)(l4.xu,{"data-calendar-grid":!0,onKeyDown:v,marginTop:2,overflow:"hidden",tabIndex:0,children:[(0,lG.jsx)(I0,{onSelect:g}),I1]})]})})}function I3(e){let{date:t,endDate:n,onChange:i,selectRange:r,selectTime:l}=e,{state:{fullscreen:a}}=MI(),o=(0,lJ.useCallback)(e=>{i(e)},[i]);return(0,lG.jsx)(I2,{date:t,endDate:n,fontSize:a?2:1,onSelect:o,selectRange:r,selectTime:l})}var I4=Object.freeze,I5=Object.defineProperty,I6=(e,t)=>I4(I5(e,"raw",{value:I4(t||e.slice())}));let I8=(0,a0.ZP)(l4.xu)(e=>{let{background:t,smallClearButton:n}=e;return(0,a0.iv)(rV||(rV=I6(["\n    width: 100%;\n\n    input + span {\n      background: ",";\n    }\n\n    [data-qa='clear-button'] {\n      background: none;\n      box-shadow: none;\n      display: flex; /* TODO: hack, currently used to vertically center <TextInput>'s clearButton */\n      transform: ",";\n      &:hover {\n        opacity: 0.5;\n      }\n    }\n  "])),e=>{let{theme:n}=e;return t?n.sanity.color.card.disabled.bg2:"transparent"},n?"scale(0.8)":"scale(1)")}),I9=(0,lJ.forwardRef)(function(e,t){let{background:n,smallClearButton:i,...r}=e;return(0,lG.jsx)(I8,{background:n,smallClearButton:i,children:(0,lG.jsx)(l4.oi,{...r,ref:t})})});function I7(e){let t,{date:n,dateOnly:i,roundDay:r}=e;switch(r){case"end":t=(0,oH.Z)(n);break;case"start":t=(0,oW.Z)(n);break;default:t=n}return i?t.toISOString().split("T")[0]:t.toISOString()}var Re=Object.freeze,Rt=Object.defineProperty,Rn=(e,t)=>Re(Rt(e,"raw",{value:Re(t||e.slice())}));let Ri={date:{exampleDate:"Jan 1, 2000",pattern:"MMM d, yyyy"},datetime:{exampleDate:"Jan 1, 2000 12:00 AM",pattern:"MMM d, yyyy p"}},Rr=a0.ZP.span(e=>{let{theme:t}=e;return(0,a0.iv)(rU||(rU=Rn(["\n    font-weight: ",";\n  "])),t.sanity.fonts.text.weights.medium)}),Rl=(0,a0.ZP)(l4.xv)(rB||(rB=Rn(["\n  color: ",";\n"])),or.VG.red[500].hex);function Ra(e){let{isDateTime:t,onChange:n,placeholderDate:i,isDateTimeFormat:r,value:l,...a}=e,o=(0,lJ.useMemo)(()=>r?Ri.datetime.pattern:Ri.date.pattern,[r]),[s,d]=(0,lJ.useState)(void 0),[c,u]=(0,lJ.useState)(()=>{if(!l)return"";let e=new Date(l);return(0,oy.Z)(e,o)}),p=(0,lJ.useMemo)(()=>{let e=i||new Date;return(0,oy.Z)(e,o)},[o,i]),h=(0,lJ.useCallback)(e=>{let{dateString:i,triggerOnChange:r}=e;if(!i)return;let l=(0,o$.Z)(i,o,new Date),a=(0,oV.Z)(l);a&&(r&&n(I7({date:l,dateOnly:!t})),u((0,oy.Z)(l,o))),d(a?void 0:"Invalid ".concat(t?"datetime":"date"))},[o,t,n]),f=(0,lJ.useCallback)(()=>{h({dateString:c,triggerOnChange:!0})},[c,h]),m=(0,lJ.useCallback)(e=>{u(e.currentTarget.value)},[]),g=(0,lJ.useCallback)(()=>{n(null),d(void 0),u("")},[n]),x=(0,lJ.useCallback)(e=>{"Enter"===e.key&&h({dateString:c,triggerOnChange:!0})},[c,h]);return(0,lJ.useEffect)(()=>{let e=l&&new Date(l);e&&h({dateString:(0,oy.Z)(e,o),triggerOnChange:!1})},[o,h,r,l]),(0,lG.jsx)(l4.u,{content:(0,lG.jsxs)(l4.kC,{gap:2,children:[(0,lG.jsx)(Rl,{size:1,children:(0,lG.jsx)(a8.uIy,{})}),(0,lG.jsxs)(l4.xv,{muted:!0,size:1,children:["Must be in the format"," ",(0,lG.jsx)(Rr,{children:r?Ri.datetime.exampleDate:Ri.date.exampleDate})]})]}),disabled:!s,padding:3,placement:"top",portal:!0,children:(0,lG.jsx)("div",{children:(0,lG.jsx)(I9,{...a,clearButton:!!c,customValidity:s,onBlur:f,onChange:m,onClear:g,onKeyDown:x,placeholder:p,value:c})})})}function Ro(e){let{isDateTime:t,onChange:n,value:i}=e,{state:{fullscreen:r}}=MI(),l=(0,lJ.useCallback)(e=>{let{date:r}=e;if(r){let e=I7({date:r,dateOnly:!t});n({includeTime:null==i?void 0:i.includeTime,date:e})}else n(null)},[t,n,null==i?void 0:i.includeTime]),a=(0,lJ.useCallback)(()=>{let e=!(null==i?void 0:i.includeTime),r=(null==i?void 0:i.date)?new Date(i.date):null,l=null;r&&(l=I7({date:r,dateOnly:!t})),n({includeTime:e,date:l})},[t,n,i]),o=(0,lJ.useCallback)(e=>{n({includeTime:null==i?void 0:i.includeTime,date:e||null})},[n,null==i?void 0:i.includeTime]);return(0,lG.jsxs)(l4.Kq,{space:3,children:[(0,lG.jsx)(Ra,{"aria-label":"Date",fontSize:r?2:1,isDateTime:t,isDateTimeFormat:t&&(null==i?void 0:i.includeTime),onChange:o,radius:2,value:null==i?void 0:i.date}),(0,lG.jsx)(I3,{date:(null==i?void 0:i.date)?new Date(i.date):void 0,onChange:l,selectTime:t}),t&&(0,lG.jsx)(II,{onChange:a,value:!!(null==i?void 0:i.includeTime)})]})}function Rs(e){return(0,lG.jsx)(Ro,{...e,isDateTime:!1})}function Rd(e){let{direction:t,isDateTime:n,onChange:i,value:r}=e,{state:{fullscreen:l}}=MI(),a=(0,lJ.useMemo)(()=>{switch(t){case"after":return"end";case"before":return"start";default:return}},[t]),o=(0,lJ.useCallback)(e=>{let{date:t}=e,l=null;t&&(l=I7({date:t,dateOnly:!n,roundDay:(null==r?void 0:r.includeTime)?void 0:a})),i({includeTime:null==r?void 0:r.includeTime,date:l})},[n,i,a,null==r?void 0:r.includeTime]),s=(0,lJ.useCallback)(()=>{let e=!(null==r?void 0:r.includeTime),t=(null==r?void 0:r.date)?new Date(r.date):null,l=null;t&&(l=I7({date:t,dateOnly:!n,roundDay:e?"start":a})),i({includeTime:e,date:l})},[n,i,a,r]),d=(0,lJ.useCallback)(e=>{i({includeTime:null==r?void 0:r.includeTime,date:e||null})},[i,null==r?void 0:r.includeTime]);return(0,lG.jsxs)(l4.Kq,{space:3,children:[(0,lG.jsx)(Ra,{"aria-label":"Date",fontSize:l?2:1,isDateTime:n,isDateTimeFormat:n&&(null==r?void 0:r.includeTime),onChange:d,radius:2,value:null==r?void 0:r.date}),(0,lG.jsx)(I3,{date:(null==r?void 0:r.date)?new Date(r.date):void 0,onChange:o,selectTime:n}),n&&(0,lG.jsx)(II,{onChange:s,value:!!(null==r?void 0:r.includeTime)})]})}function Rc(e){let{onChange:t,value:n}=e,[i,r]=(0,lJ.useState)((null==n?void 0:n.unitValue)||""),l=(0,lJ.useRef)("days"),a=(0,lJ.useRef)((null==n?void 0:n.unitValue)||null),{state:{fullscreen:o}}=MI(),s=(0,lJ.useCallback)(()=>{t({unit:null==l?void 0:l.current,unitValue:null==a?void 0:a.current})},[t]),d=(0,lJ.useCallback)(e=>{l.current=e.currentTarget.value,s()},[s]),c=(0,lJ.useCallback)(e=>{r(e.currentTarget.value);let t=parseFloat(e.currentTarget.value);a.current=Number.isFinite(t)?t:null,s()},[s]);return(0,lG.jsxs)(l4.kC,{gap:2,children:[(0,lG.jsx)(l4.xu,{flex:1,children:(0,lG.jsx)(l4.oi,{"aria-label":"Unit value",fontSize:o?2:1,onChange:c,pattern:"\\d*",radius:2,step:"1",type:"number",value:i})}),(0,lG.jsx)(l4.xu,{flex:1,children:(0,lG.jsxs)(l4.Ph,{"aria-label":"Select unit",fontSize:o?2:1,onChange:d,radius:2,value:null==n?void 0:n.unit,children:[(0,lG.jsx)("option",{value:"days",children:"Days"}),(0,lG.jsx)("option",{value:"months",children:"Months"}),(0,lG.jsx)("option",{value:"years",children:"Years"})]})})]})}function Ru(e){let{isDateTime:t,onChange:n,value:i}=e,{state:{fullscreen:r}}=MI(),l=(0,lJ.useMemo)(()=>(0,oA.Z)(new Date,-7),[]),a=(0,lJ.useMemo)(()=>new Date,[]),o=(0,lJ.useCallback)(e=>{let{date:r,endDate:l}=e;n(Rp({date:r,endDate:l,includeTime:null==i?void 0:i.includeTime,isDateTime:t}))},[t,n,null==i?void 0:i.includeTime]),s=(0,lJ.useCallback)(()=>{let e=!(null==i?void 0:i.includeTime);n(Rp({date:(null==i?void 0:i.dateMin)?new Date(i.dateMin):null,endDate:(null==i?void 0:i.dateMax)?new Date(i.dateMax):null,includeTime:e,isDateTime:t}))},[t,n,i]),d=(0,lJ.useCallback)(e=>{n({includeTime:null==i?void 0:i.includeTime,dateMax:e||null,dateMin:(null==i?void 0:i.dateMin)||null})},[n,i]),c=(0,lJ.useCallback)(e=>{n({includeTime:null==i?void 0:i.includeTime,dateMax:(null==i?void 0:i.dateMax)||null,dateMin:e||null})},[n,i]);return(0,lG.jsx)("div",{children:(0,lG.jsxs)(l4.Kq,{space:3,children:[(0,lG.jsxs)(l4.kC,{direction:"column",gap:3,children:[(0,lG.jsx)(Ra,{"aria-label":"Start date",fontSize:r?2:1,isDateTime:t,isDateTimeFormat:t&&(null==i?void 0:i.includeTime),onChange:c,placeholderDate:l,radius:2,value:null==i?void 0:i.dateMin}),(0,lG.jsx)(Ra,{"aria-label":"End date",fontSize:r?2:1,isDateTime:t,isDateTimeFormat:t&&(null==i?void 0:i.includeTime),onChange:d,placeholderDate:a,radius:2,value:null==i?void 0:i.dateMax})]}),(0,lG.jsx)(I3,{date:(null==i?void 0:i.dateMin)?new Date(i.dateMin):void 0,endDate:(null==i?void 0:i.dateMax)?new Date(i.dateMax):void 0,onChange:o,selectRange:!0,selectTime:t}),t&&(0,lG.jsx)(II,{onChange:s,value:!!(null==i?void 0:i.includeTime)})]})})}function Rp(e){let{date:t,endDate:n,includeTime:i,isDateTime:r}=e;return i?{includeTime:i,dateMax:n?I7({date:n,dateOnly:!r,roundDay:"start"}):null,dateMin:t?I7({date:t,dateOnly:!r,roundDay:"start"}):null}:{includeTime:i,dateMax:n?I7({date:n,dateOnly:!r,roundDay:"end"}):null,dateMin:t?I7({date:t,dateOnly:!r,roundDay:"start"}):null}}function Rh(e){return(0,lG.jsx)(Ro,{...e,isDateTime:!0})}let Rf={dateAfter:{buttonLabel:"after",buttonValueComponent:MT,initialValue:null,label:"is after"},dateBefore:{buttonLabel:"before",buttonValueComponent:MT,initialValue:null,label:"is before"},dateEqual:{buttonLabel:"is",buttonValueComponent:MS,initialValue:{date:null,includeTime:!1},label:"is"},dateLast:{buttonLabel:"last",buttonValueComponent:function(e){var t;let{value:n}=e;return(0,lG.jsxs)(lG.Fragment,{children:[Math.floor(null!=(t=null==n?void 0:n.unitValue)?t:0)," ",n.unit]})},label:"is in the last"},dateNotEqual:{buttonLabel:"is not",buttonValueComponent:MS,initialValue:{date:null,includeTime:!1},label:"is not"},dateRange:{buttonLabel:"is between",initialValue:null,label:"is between"}},Rm={dateAfter:{...Rf.dateAfter,groqFilter:e=>{let{fieldPath:t,value:n}=e;return(null==n?void 0:n.date)&&t?"".concat(t," > ").concat(Ir(null==n?void 0:n.date)):null},inputComponent:function(e){return(0,lG.jsx)(Rd,{...e,direction:"after",isDateTime:!1})},type:"dateAfter"},dateBefore:{...Rf.dateBefore,groqFilter:e=>{let{fieldPath:t,value:n}=e;return(null==n?void 0:n.date)&&t?"".concat(t," < ").concat(Ir(null==n?void 0:n.date)):null},inputComponent:function(e){return(0,lG.jsx)(Rd,{...e,direction:"before",isDateTime:!1})},type:"dateBefore"},dateEqual:{...Rf.dateEqual,groqFilter:e=>{let{fieldPath:t,value:n}=e;return(null==n?void 0:n.date)&&t?"".concat(t," == ").concat(Ir(n.date)):null},inputComponent:Rs,type:"dateEqual"},dateLast:{...Rf.dateLast,groqFilter:e=>{let{fieldPath:t,value:n}=e,i="number"==typeof(null==n?void 0:n.unitValue)?Math.floor(n.unitValue):void 0,r=Number.isFinite(i)?(0,oX.Z)(new Date,{days:(null==n?void 0:n.unit)==="days"?i:0,months:(null==n?void 0:n.unit)==="months"?i:0,years:(null==n?void 0:n.unit)==="years"?i:0}).toISOString().split("T")[0]:null;return r&&t?"".concat(t," > ").concat(Ir(r)):null},inputComponent:Rc,initialValue:{unit:"days",unitValue:7},type:"dateLast"},dateNotEqual:{...Rf.dateNotEqual,groqFilter:e=>{let{fieldPath:t,value:n}=e;return(null==n?void 0:n.date)&&t?"".concat(t," != ").concat(Ir(n.date)):null},inputComponent:Rs,type:"dateNotEqual"},dateRange:{...Rf.dateRange,buttonValueComponent:ME,groqFilter:e=>{let{fieldPath:t,value:n}=e;return(null==n?void 0:n.dateMax)&&(null==n?void 0:n.dateMin)&&t?"".concat(t," >= ").concat(Ir(n.dateMin)," && ").concat(t," <= ").concat(Ir(n.dateMax)):null},initialValue:{includeTime:!1,dateMax:(0,oG.Z)().toISOString(),dateMin:null},inputComponent:function(e){return(0,lG.jsx)(Ru,{...e,isDateTime:!1})},type:"dateRange"},dateTimeAfter:{...Rf.dateAfter,groqFilter:e=>{let{fieldPath:t,value:n}=e;return(null==n?void 0:n.date)&&t?"dateTime(".concat(t,") > dateTime(").concat(Ir(n.date),")"):null},inputComponent:function(e){return(0,lG.jsx)(Rd,{...e,direction:"after",isDateTime:!0})},type:"dateTimeAfter"},dateTimeBefore:{...Rf.dateBefore,groqFilter:e=>{let{fieldPath:t,value:n}=e;return(null==n?void 0:n.date)&&t?"dateTime(".concat(t,") < dateTime(").concat(Ir(n.date),")"):null},inputComponent:function(e){return(0,lG.jsx)(Rd,{...e,direction:"before",isDateTime:!0})},type:"dateTimeBefore"},dateTimeEqual:{...Rf.dateEqual,groqFilter:e=>{let{fieldPath:t,value:n}=e,i=(null==n?void 0:n.date)&&new Date(n.date);if(!i||!(0,oV.Z)(i)||!t)return null;let r=((null==n?void 0:n.includeTime)?(0,oY.Z)(i):(0,oW.Z)(i)).toISOString(),l=((null==n?void 0:n.includeTime)?(0,oJ.Z)(i):(0,oH.Z)(i)).toISOString();return"dateTime(".concat(t,") > dateTime(").concat(Ir(r),") && dateTime(").concat(t,") < dateTime(").concat(Ir(l),")")},inputComponent:Rh,type:"dateTimeEqual"},dateTimeLast:{...Rf.dateLast,groqFilter:e=>{let{fieldPath:t,value:n}=e,i="number"==typeof(null==n?void 0:n.unitValue)?Math.floor(n.unitValue):void 0,r=Number.isFinite(i)?(0,oX.Z)(new Date,{days:(null==n?void 0:n.unit)==="days"?i:0,months:(null==n?void 0:n.unit)==="months"?i:0,years:(null==n?void 0:n.unit)==="years"?i:0}).toISOString():null;return r&&t?"dateTime(".concat(t,") > dateTime(").concat(Ir(r),")"):null},initialValue:{unit:"days",unitValue:7},inputComponent:Rc,type:"dateTimeLast"},dateTimeNotEqual:{...Rf.dateNotEqual,groqFilter:e=>{let{fieldPath:t,value:n}=e,i=(null==n?void 0:n.date)&&new Date(n.date);if(!i||!(0,oV.Z)(i)||!t)return null;let r=((null==n?void 0:n.includeTime)?(0,oY.Z)(i):(0,oW.Z)(i)).toISOString(),l=((null==n?void 0:n.includeTime)?(0,oJ.Z)(i):(0,oH.Z)(i)).toISOString();return"dateTime(".concat(t,") < dateTime(").concat(Ir(r),") || dateTime(").concat(t,") > dateTime(").concat(Ir(l),")")},inputComponent:Rh,type:"dateTimeNotEqual"},dateTimeRange:{...Rf.dateRange,buttonValueComponent:ME,groqFilter:e=>{let{fieldPath:t,value:n}=e;return(null==n?void 0:n.dateMax)&&(null==n?void 0:n.dateMin)&&t?"dateTime(".concat(t,") >= dateTime(").concat(Ir(n.dateMin),") && dateTime(").concat(t,") <= dateTime(").concat(Ir(n.dateMax),")"):null},initialValue:{includeTime:!1,dateMax:(0,oG.Z)().toISOString(),dateMin:null},inputComponent:function(e){return(0,lG.jsx)(Ru,{...e,isDateTime:!0})},type:"dateTimeRange"}};function Rg(e){let{onChange:t,value:n}=e,{state:{fullscreen:i}}=MI(),r=(0,lJ.useCallback)(e=>t(e.currentTarget.value||null),[t]);return(0,lG.jsx)(l4.oi,{fontSize:i?2:1,onChange:r,placeholder:"Value",radius:2,value:n||""})}let Rx={referenceEqual:{buttonLabel:"is",buttonValueComponent:MO,groqFilter:e=>{let{fieldPath:t,value:n}=e;return(null==n?void 0:n._ref)&&t?"".concat(t,"._ref == ").concat(Ir(n._ref)):null},initialValue:null,inputComponent:M8,label:"is",type:"referenceEqual"},referenceNotEqual:{buttonLabel:"is not",buttonValueComponent:MO,groqFilter:e=>{let{fieldPath:t,value:n}=e;return(null==n?void 0:n._ref)&&t?"".concat(t,"._ref != ").concat(Ir(n._ref)):null},initialValue:null,inputComponent:M8,label:"is not",type:"referenceNotEqual"},referencesAssetFile:{buttonLabel:"→",buttonValueComponent:MO,groqFilter:e=>{let{value:t}=e;return(null==t?void 0:t._ref)?"references(".concat(Ir(t._ref),")"):null},initialValue:null,inputComponent:IE("file"),label:"file",type:"referencesAssetFile"},referencesAssetImage:{buttonLabel:"→",buttonValueComponent:MO,groqFilter:e=>{let{value:t}=e;return(null==t?void 0:t._ref)?"references(".concat(Ir(t._ref),")"):null},initialValue:null,inputComponent:IE("image"),label:"image",type:"referencesAssetImage"},referencesDocument:{buttonLabel:"→",buttonValueComponent:MO,groqFilter:e=>{let{value:t}=e;return(null==t?void 0:t._ref)?"references(".concat(Ir(t._ref),")"):null},initialValue:null,inputComponent:M8,label:"document",type:"referencesDocument"}},Rv=Object.values({arrayCountEqual:{buttonLabel:"has",buttonValueComponent:MA,groqFilter:e=>{let{fieldPath:t,value:n}=e;return Number.isFinite(n)&&t?"count(".concat(t,") == ").concat(Ir(n)):null},initialValue:null,inputComponent:MR,label:"quantity is",type:"arrayCountEqual"},arrayCountGt:{buttonLabel:"has >",buttonValueComponent:MA,groqFilter:e=>{let{fieldPath:t,value:n}=e;return Number.isFinite(n)&&t?"count(".concat(t,") > ").concat(Ir(n)):null},icon:It,initialValue:null,inputComponent:MR,label:"quantity greater than",type:"arrayCountGt"},arrayCountGte:{buttonLabel:"has ≥",buttonValueComponent:MA,groqFilter:e=>{let{fieldPath:t,value:n}=e;return Number.isFinite(n)&&t?"count(".concat(t,") >= ").concat(Ir(n)):null},icon:Ie,initialValue:null,inputComponent:MR,label:"quantity greater than or equal to",type:"arrayCountGte"},arrayCountLt:{buttonLabel:"has <",buttonValueComponent:MA,groqFilter:e=>{let{fieldPath:t,value:n}=e;return Number.isFinite(n)&&t?"count(".concat(t,") < ").concat(Ir(n)):null},icon:Ii,initialValue:null,inputComponent:MR,label:"quantity less than",type:"arrayCountLt"},arrayCountLte:{buttonLabel:"has ≤",buttonValueComponent:MA,groqFilter:e=>{let{fieldPath:t,value:n}=e;return Number.isFinite(n)&&t?"count(".concat(t,") <= ").concat(Ir(n)):null},icon:In,initialValue:null,inputComponent:MR,label:"quantity less than or equal to",type:"arrayCountLte"},arrayCountNotEqual:{buttonLabel:"does not have",buttonValueComponent:MA,groqFilter:e=>{let{fieldPath:t,value:n}=e;return Number.isFinite(n)&&t?"count(".concat(t,") != ").concat(Ir(n)):null},initialValue:null,inputComponent:MR,label:"quantity is not",type:"arrayCountNotEqual"},arrayCountRange:{buttonLabel:"has between",buttonValueComponent:function(e){let{value:t}=e;return(0,lG.jsxs)(lG.Fragment,{children:[t.min," → ",t.max," items"]})},groqFilter:e=>{let{fieldPath:t,value:n}=e;return Number.isFinite(null==n?void 0:n.max)&&Number.isFinite(null==n?void 0:n.min)&&t?"count(".concat(t,") > ").concat(Ir(null==n?void 0:n.min)," && count(").concat(t,") < ").concat(Ir(null==n?void 0:n.max)):""},initialValue:null,inputComponent:MF,label:"quantity is between",type:"arrayCountRange"},arrayListIncludes:{buttonLabel:"includes",buttonValueComponent:Mz,groqFilter:e=>{let{fieldPath:t,value:n}=e;return n&&t?"".concat(Ir(n)," in ").concat(t):null},initialValue:null,inputComponent:M7,label:"includes",type:"arrayListIncludes"},arrayListNotIncludes:{buttonLabel:"does not include",buttonValueComponent:Mz,groqFilter:e=>{let{fieldPath:t,value:n}=e;return n&&t?"!(".concat(Ir(n)," in ").concat(t,")"):null},initialValue:null,inputComponent:M7,label:"does not include",type:"arrayListNotIncludes"},arrayReferenceIncludes:{buttonLabel:"includes",buttonValueComponent:MO,groqFilter:e=>{let{fieldPath:t,value:n}=e;return(null==n?void 0:n._ref)&&t?"".concat(Ir(n._ref)," in ").concat(t,"[]._ref"):null},initialValue:null,inputComponent:M8,label:"includes",type:"arrayReferenceIncludes"},arrayReferenceNotIncludes:{buttonLabel:"does not include",buttonValueComponent:MO,groqFilter:e=>{let{fieldPath:t,value:n}=e;return(null==n?void 0:n._ref)&&t?"!(".concat(Ir(n._ref)," in ").concat(t,"[]._ref)"):null},initialValue:null,inputComponent:M8,label:"does not include",type:"arrayReferenceNotIncludes"},...IP,booleanEqual:{buttonLabel:"is",buttonValueComponent:function(e){let{value:t}=e;return(0,lG.jsx)(lG.Fragment,{children:t?"True":"False"})},groqFilter:e=>{let{fieldPath:t,value:n}=e;return void 0!==n&&t?"".concat(t," == ").concat(Ir(n)):null},initialValue:!0,inputComponent:function(e){let{onChange:t,value:n}=e,{state:{fullscreen:i}}=MI(),r=(0,lJ.useCallback)(e=>{t("true"===e.currentTarget.value)},[t]);return(0,lG.jsxs)(l4.Ph,{fontSize:i?2:1,onChange:r,radius:2,value:String(null==n||n),children:[(0,lG.jsx)("option",{value:"true",children:"True"}),(0,lG.jsx)("option",{value:"false",children:"False"})]})},label:"is",type:"booleanEqual"},...Rm,defined:{buttonLabel:"not empty",groqFilter:e=>{let{fieldPath:t}=e;return t?"defined(".concat(t,")"):null},label:"not empty",type:"defined"},notDefined:{buttonLabel:"empty",groqFilter:e=>{let{fieldPath:t}=e;return t?"!defined(".concat(t,")"):null},label:"empty",type:"notDefined"},numberEqual:{buttonLabel:"is",buttonValueComponent:MP,groqFilter:e=>{let{fieldPath:t,value:n}=e;return Number.isFinite(n)&&t?"".concat(t," == ").concat(Ir(n)):null},initialValue:null,inputComponent:MR,label:"is",type:"numberEqual"},numberGt:{buttonLabel:">",buttonValueComponent:MP,groqFilter:e=>{let{fieldPath:t,value:n}=e;return Number.isFinite(n)&&t?"".concat(t," > ").concat(Ir(n)):null},icon:It,initialValue:null,inputComponent:MR,label:"greater than",type:"numberGt"},numberGte:{buttonLabel:"≥",buttonValueComponent:MP,groqFilter:e=>{let{fieldPath:t,value:n}=e;return Number.isFinite(n)&&t?"".concat(t," >= ").concat(Ir(n)):null},icon:Ie,initialValue:null,inputComponent:MR,label:"greater than or equal to",type:"numberGte"},numberLt:{buttonLabel:"<",buttonValueComponent:MP,groqFilter:e=>{let{fieldPath:t,value:n}=e;return Number.isFinite(n)&&t?"".concat(t," < ").concat(Ir(n)):null},icon:Ii,initialValue:null,inputComponent:MR,label:"less than",type:"numberLt"},numberLte:{buttonLabel:"≤",buttonValueComponent:MP,groqFilter:e=>{let{fieldPath:t,value:n}=e;return Number.isFinite(n)&&t?"".concat(t," <= ").concat(Ir(n)):null},icon:In,initialValue:null,inputComponent:MR,label:"less than or equal to",type:"numberLte"},numberNotEqual:{buttonLabel:"is not",buttonValueComponent:MP,groqFilter:e=>{let{fieldPath:t,value:n}=e;return Number.isFinite(n)&&t?"".concat(t," != ").concat(Ir(n)):null},initialValue:null,inputComponent:MR,label:"is not",type:"numberNotEqual"},numberRange:{buttonLabel:"is between",buttonValueComponent:function(e){let{value:t}=e;return(0,lG.jsxs)(lG.Fragment,{children:[t.min," → ",t.max]})},groqFilter:e=>{let{fieldPath:t,value:n}=e;return Number.isFinite(null==n?void 0:n.max)&&Number.isFinite(null==n?void 0:n.min)&&t?"".concat(t," > ").concat(Ir(null==n?void 0:n.min)," && ").concat(t," < ").concat(Ir(null==n?void 0:n.max)):""},initialValue:null,inputComponent:MF,label:"is between",type:"numberRange"},portableTextEqual:{buttonLabel:"is",buttonValueComponent:Mz,groqFilter:e=>{let{fieldPath:t,value:n}=e;return n&&t?"pt::text(".concat(t,") == ").concat(Ir(n)):null},initialValue:null,inputComponent:Rg,label:"is",type:"portableTextEqual"},portableTextMatches:{buttonLabel:"contains",buttonValueComponent:Mz,groqFilter:e=>{let{fieldPath:t,value:n}=e;return n&&t?"pt::text(".concat(t,") match ").concat(Ir(n)):null},initialValue:null,inputComponent:Rg,label:"contains",type:"portableTextMatches"},portableTextNotEqual:{buttonLabel:"is not",buttonValueComponent:Mz,groqFilter:e=>{let{fieldPath:t,value:n}=e;return n&&t?"pt::text(".concat(t,") != ").concat(Ir(n)):null},initialValue:null,inputComponent:Rg,label:"is not",type:"portableTextNotEqual"},portableTextNotMatches:{buttonLabel:"does not contain",buttonValueComponent:Mz,groqFilter:e=>{let{fieldPath:t,value:n}=e;return n&&t?"!(pt::text(".concat(t,") match ").concat(Ir(n),")"):null},initialValue:null,inputComponent:Rg,label:"does not contain",type:"portableTextNotMatches"},...Rx,slugEqual:{buttonLabel:"is",buttonValueComponent:Mz,groqFilter:e=>{let{fieldPath:t,value:n}=e;return n&&t?"".concat(t,".current == ").concat(Ir(n)):null},initialValue:null,inputComponent:Rg,label:"is",type:"slugEqual"},slugMatches:{buttonLabel:"contains",buttonValueComponent:Mz,groqFilter:e=>{let{fieldPath:t,value:n}=e;return n&&t?"".concat(t,".current match ").concat(Ir(n)):null},initialValue:null,inputComponent:Rg,label:"contains",type:"slugMatches"},slugNotEqual:{buttonLabel:"is not",buttonValueComponent:Mz,groqFilter:e=>{let{fieldPath:t,value:n}=e;return n&&t?"".concat(t,".current != ").concat(Ir(n)):null},initialValue:null,inputComponent:Rg,label:"is not",type:"slugNotEqual"},slugNotMatches:{buttonLabel:"does not contain",buttonValueComponent:Mz,groqFilter:e=>{let{fieldPath:t,value:n}=e;return n&&t?"!(".concat(t,".current match ").concat(Ir(n),")"):null},initialValue:null,inputComponent:Rg,label:"does not contain",type:"slugNotMatches"},stringEqual:{buttonLabel:"is",buttonValueComponent:Mz,groqFilter:e=>{let{fieldPath:t,value:n}=e;return n&&t?"".concat(t," == ").concat(Ir(n)):null},initialValue:null,inputComponent:Rg,label:"is",type:"stringEqual"},stringListEqual:{buttonLabel:"is",buttonValueComponent:Mz,groqFilter:e=>{let{fieldPath:t,value:n}=e;return n&&t?"".concat(t," == ").concat(Ir(n)):null},initialValue:null,inputComponent:M7,label:"is",type:"stringListEqual"},stringListNotEqual:{buttonLabel:"is not",buttonValueComponent:Mz,groqFilter:e=>{let{fieldPath:t,value:n}=e;return n&&t?"".concat(t," != ").concat(Ir(n)):null},initialValue:null,inputComponent:M7,label:"is not",type:"stringListNotEqual"},stringMatches:{buttonLabel:"contains",buttonValueComponent:Mz,groqFilter:e=>{let{fieldPath:t,value:n}=e;return n&&t?"".concat(t," match ").concat(Ir(n)):null},initialValue:null,inputComponent:Rg,label:"contains",type:"stringMatches"},stringNotEqual:{buttonLabel:"is not",buttonValueComponent:Mz,groqFilter:e=>{let{fieldPath:t,value:n}=e;return n&&t?"".concat(t," != ").concat(Ir(n)):null},initialValue:null,inputComponent:Rg,label:"is not",type:"stringNotEqual"},stringNotMatches:{buttonLabel:"does not contain",buttonValueComponent:Mz,groqFilter:e=>{let{fieldPath:t,value:n}=e;return n&&t?"!(".concat(t," match ").concat(Ir(n),")"):null},initialValue:null,inputComponent:Rg,label:"does not contain",type:"stringNotMatches"}});function Rb(e){let t=typeof e;if("object"===t){if(null===e)return"null";if(Array.isArray(e))return"array";if(e instanceof Object&&"Object"!==e.constructor.name)return e.constructor.name}return t}let Ry=(e,t)=>{let{plugins:n=[],...i}=e,r={config:i,path:[...t,i.name]};return[...n.flatMap(e=>Ry(e,[...t,i.name])),r]},Rj=[],Rw=[],Rk=[],RC=(e,t,n)=>{let{schema:i}=t,r=null==i?void 0:i.types;if(!r)return e;if("function"==typeof r)return r(e,n);if(Array.isArray(r))return[...e,...r];throw Error("Expected `schema.types` to be an array or a function, but received ".concat(Rb(r)))},R_=async(e,t,n)=>{let{document:i}=t,r=null==i?void 0:i.productionUrl;return r?await r(e,n):e},RS=(e,t,n)=>{let{tools:i}=t;if(!i)return e;if("function"==typeof i)return i(e,n);if(Array.isArray(i))return[...e,...i];throw Error("Expected `tools` to be an array or a function, but received ".concat(Rb(i)))},RT=(e,t,n)=>{let{schema:i}=t,r=null==i?void 0:i.templates;if(!r)return e;if("function"==typeof r)return r(e,n);if(Array.isArray(r))return[...e,...r];throw Error("Expected `schema.templates` to be an array or a function, but received ".concat(Rb(r)))},RE=(e,t,n)=>{let{document:i}=t,r=null==i?void 0:i.badges;if(!r)return e;if("function"==typeof r)return r(e,n);if(Array.isArray(r))return[...e,...r];throw Error("Expected `document.badges` to be an array or a function, but received ".concat(Rb(r)))},RP=(e,t,n)=>{let{document:i}=t,r=null==i?void 0:i.actions;if(!r)return e;if("function"==typeof r)return r(e,n);if(Array.isArray(r))return[...e,...r];throw Error("Expected `document.actions` to be an array or a function, but received ".concat(Rb(r)))},RA=(e,t,n)=>{let{document:i}=t,r=null==i?void 0:i.newDocumentOptions;if(!r)return e;if("function"!=typeof r)throw Error("Expected `document.resolveNewDocumentOptions` to be a function, but received ".concat(Rb(r)));return r(e,n)},RO=(e,t,n)=>{var i;let{form:r}=t,l=null==(i=null==r?void 0:r.file)?void 0:i.assetSources;if(!l)return e;if("function"==typeof l)return l(e,n);if(Array.isArray(l))return[...e,...l];throw Error("Expected `form.file.assetSources` to be an array or a function, but received ".concat(Rb(l)))},Rz=(e,t,n)=>{var i;let{form:r}=t,l=null==(i=null==r?void 0:r.image)?void 0:i.assetSources;if(!l)return e;if("function"==typeof l)return l(e,n);if(Array.isArray(l))return[...e,...l];throw Error("Expected `form.image.assetSources` to be an array or a function, but received ".concat(Rb(l)))},RM=(e,t,n)=>{let{document:i}=t,r=null==i?void 0:i.unstable_languageFilter;if(!r)return e;if("function"==typeof r)return r(e,n);if(Array.isArray(r))return[...e,...r];throw Error("Expected `document.unstable_languageFilter` to be an array or a function, but received ".concat(Rb(r)))},RI=(e,t,n)=>{let{document:i}=t,r=null==i?void 0:i.inspectors;if(!r)return e;if("function"==typeof r)return r(e,n);if(Array.isArray(r))return[...e,...r];throw Error("Expected `document.inspectors` to be an array or a function, but received ".concat(Rb(r)))},RR=e=>{let{config:t,context:n,initialValue:i}=e;return Ry(t,[]).reduce((e,t)=>{var i,r;let{config:l}=t,a=null==(r=null==(i=l.document)?void 0:i.unstable_comments)?void 0:r.enabled;if(!a&&"boolean"!=typeof a)return e;if("function"==typeof a)return a(n);if("boolean"==typeof a)return a;throw Error("Expected `document.unstable_comments.enabled` to be a boolean or a function, but received ".concat(Rb(a)))},i)};class RF extends Error{constructor(e){let{propertyName:t,path:n,cause:i}=e;super("An error occurred while resolving `".concat(t,"` from ").concat(n.join(" > ")).concat(cg(i)&&"string"==typeof(null==i?void 0:i.message)?": ".concat(i.message):"")),this.propertyName=t,this.cause=i,this.path=n}}function RD(e){let{config:t,context:n,initialValue:i,propertyName:r,...l}=e,a=Ry(t,[]);if("reducer"in l)return a.reduce((e,t)=>{let{config:i,path:a}=t;try{return l.reducer(e,i,n)}catch(e){throw new RF({propertyName:r,path:a,cause:e})}},i);let o=l.asyncReducer;return(async()=>{let e=i;for(let{config:t,path:i}of a)try{e=await o(e,t,n)}catch(e){throw new RF({propertyName:r,path:i,cause:e})}return e})()}class RZ extends Error{constructor(e){let{causes:t,name:n,type:i}=e;super("Could not resolve ".concat(i).concat(n?" `".concat(n,"`"):"",":\n").concat(t.filter(Boolean).map(e=>cg(e)&&"string"==typeof(null==e?void 0:e.message)?e.message:String(e)).map(e=>"	- ".concat(e)).join("\n"),"\n\n")),this.name=n,this.causes=t,this.type=i}}class RL extends Error{constructor(e){super("SchemaError"),this.schema=e}}var Rq=Object.freeze,RN=Object.defineProperty;function RV(e){return Math.abs(16807*e.split("").reduce((e,t)=>(e<<5)-e+t.charCodeAt(0)|0,0)%2147483647)/2147483647}let RU=a0.ZP.text(rK||(rK=Rq(RN(eo=["\n  font-family: ",";\n  font-weight: ",";\n  font-size: 16px;\n  transform: translateY(1px);\n"],"raw",{value:Rq(eo.slice())}))),e=>{let{theme:t}=e;return t.sanity.fonts.heading.family},e=>{let{theme:t}=e;return t.sanity.fonts.heading.weights.bold}),RB=e=>"error"===e.severity,RK=new WeakMap;function RH(e){let{projectId:t,dataset:n,schema:i,currentUser:r,getClient:l}=e;return(0,lJ.useMemo)(()=>({projectId:t,dataset:n,schema:i,currentUser:r,getClient:l}),[t,n,i,r,l])}function RW(e){let{projectId:t,dataset:n,schema:i,currentUser:r,getClient:l}=e;return{projectId:t,dataset:n,schema:i,currentUser:r,getClient:l}}function R$(e){let{title:t}=e;return(0,lG.jsx)(l4.xu,{padding:3,children:(0,lG.jsx)(l4.xv,{weight:"bold",children:t})})}let RX=(0,lJ.createContext)(null),RG=(0,lJ.createContext)(null);function RY(){return(0,l4.ue)()?"dark":"light"}function RJ(e){let{children:t,scheme:n}=e,i=RY();return(0,lG.jsx)(l4.f6,{scheme:"system"===n?i:n,theme:l4.Lg,children:t})}let RQ="sanityStudio:ui:colorScheme";function R0(e){let{children:t,onSchemeChange:n,scheme:i}=e;return i?(0,lG.jsx)(R3,{scheme:i,onSchemeChange:n,children:t}):(0,lG.jsx)(R1,{onSchemeChange:n,children:t})}function R1(e){let{children:t,onSchemeChange:n}=e,i=(0,lJ.useMemo)(()=>{let e;let t=new Set;return{subscribe:n=>(e||(e=R2(localStorage.getItem(RQ))||"system"),t.add(n),()=>{t.delete(n)}),getSnapshot:()=>e,setSnapshot:n=>{for(let i of(e=R2(n),t))i()},getServerSnapshot:()=>"system"}},[]),r=(0,lJ.useSyncExternalStore)(i.subscribe,i.getSnapshot,i.getServerSnapshot);return(0,lJ.useEffect)(()=>{"function"==typeof n&&n(r),localStorage.setItem(RQ,r)},[n,r]),(0,lG.jsx)(RG.Provider,{value:i.setSnapshot,children:(0,lG.jsx)(RX.Provider,{value:r,children:(0,lG.jsx)(RJ,{scheme:r,children:t})})})}function R2(e){switch(e){case"dark":case"light":return e;default:return"system"}}function R3(e){let{children:t,onSchemeChange:n,scheme:i}=e;return(0,lG.jsx)(RG.Provider,{value:"function"==typeof n&&n,children:(0,lG.jsx)(RX.Provider,{value:i,children:(0,lG.jsx)(RJ,{scheme:i,children:t})})})}function R4(){let e=(0,lJ.useContext)(RG);if(null===e)throw Error("Could not find `ColorSchemeSetValueContext` context");return e}function R5(){let e=(0,lJ.useContext)(RX);if(null===e)throw Error("Could not find `ColorSchemeValueContext` context");return e}function R6(){let e=R5(),t=RY();return"system"===e?t:e}function R8(){let e=R6(),t=R4();return(0,lJ.useMemo)(()=>({scheme:e,setScheme:t}),[e,t])}function R9(e){let t=R5();return(0,lJ.useMemo)(()=>[{title:"System",name:"system",label:"Use system appearance",selected:"system"===t,onSelect:()=>e("system"),icon:a8.ugZ},{title:"Dark",name:"dark",label:"Use dark appearance",selected:"dark"===t,onSelect:()=>e("dark"),icon:a8.kLh},{title:"Light",name:"light",label:"Use light appearance",selected:"light"===t,onSelect:()=>e("light"),icon:a8.NWY}],[t,e])}let R7=(0,lJ.createContext)(null);function Fe(e){let{config:t,children:n,basePath:i}=e,{workspaces:r}=(0,lJ.useMemo)(()=>(function(e,t){if(!Array.isArray(e)&&"missingConfigFile"in e)throw new RZ({name:"",type:"configuration file",causes:["No `sanity.config.ts` file found","No `sanity.config.js` file found"]});let n=function(e){let t=e||"";if("string"!=typeof t||t.length>0&&!t.startsWith("/"))throw new RZ({name:"",type:"options",causes:["basePath must be a string, and must start with a slash"]});return"/"===t?"":t}(null==t?void 0:t.basePath),i=Array.isArray(e)?e:[e];try{!function(e){let{workspaces:t}=e;if(0===t.length)throw new Fr("At least one workspace is required.");(function(e){let t=1===e.length,n=new Map;e.forEach((e,i)=>{let{name:r,title:l}=e,a=Fn(l,i);if(!r&&!t)throw new Fr("All workspaces must have a `name`, unless only a single workspace is defined. "+"Workspace ".concat(a," did not define a `name`."),{workspace:e,index:i});let o=t&&void 0===r?"default":r;if("string"!=typeof o)throw new Fr("Workspace at index ".concat(i," defined an invalid `name` - must be a string."),{workspace:e,index:i});let s=o.toLowerCase(),d=n.get(s);if(d){let t=Fn(d.workspace.title,d.index);throw new Fr("`name`s must be unique. Workspace ".concat(t," and ")+"workspace ".concat(a," both have the `name` `").concat(o,"`"),{workspace:e,index:i})}if(n.set(s,{index:i,workspace:e}),!/^[a-z0-9][a-z0-9_-]*$/i.test(o))throw new Fr("All workspace `name`s must consist of only a-z, 0-9, underscore and dashes, and cannot begin with an underscore or dash. "+"Workspace ".concat(a," has the invalid name `").concat(o,"`"),{workspace:e,index:i})})})(t),function(e){e.length>1&&e.every(Fl),e.every(Fa);let[t,...n]=e,i=(t.basePath||"/").substring(1).split("/").filter(Boolean).length;n.forEach((e,n)=>{let r=(e.basePath||"/").substring(1).split("/").length;if(i!==r)throw new Fr("All workspace `basePath`s must have the same amount of segments. Workspace `".concat(Ft(t,n),"` had ").concat(i," segment").concat(1===i?"":"s"," `").concat(t.basePath,"` but workspace `").concat(Ft(e,n),"` had ").concat(r," segment").concat(1===r?"":"s"," `").concat(e.basePath,"`"),{workspace:e,index:n})});let r=new Map;e.forEach((e,t)=>{let n=(e.basePath||"").toLowerCase(),i=r.get(n);if(i)throw new Fr("`basePath`s must be unique. Workspaces `".concat(i,"` and ")+"`".concat(Ft(e,t),"` both have the `basePath` `").concat(n,"`"),{workspace:e,index:t});r.set(n,Ft(e,t))})}(t)}({workspaces:i})}catch(e){throw new RZ({name:"",type:"workspace",causes:[e.message]})}return{type:"prepared-config",workspaces:i.map(e=>{if(RK.has(e))return RK.get(e);let{unstable_sources:t=[],...i}=e,r=[i,...t].map(e=>{let t;let{projectId:n,dataset:i}=e;try{t=RD({propertyName:"schema.types",config:e,context:{projectId:n,dataset:i},initialValue:[],reducer:RC})}catch(t){throw new RZ({name:e.name,type:"source",causes:[t]})}let r=function(e){let t=(0,om.Fv)(e.types).getTypes(),n=(0,om._T)(t),i=n.some(e=>e.problems.some(fC)),r=of.V.compile({name:e.name,types:i?[]:[...e.types,...f_].filter(Boolean)});return r._validation=n,r.getTypeNames().forEach(e=>{let t=r.get(e);t&&function e(t,n){if(!n.has(t)){if(n.add(t),t.validation=fy(t),"fields"in t)for(let i of t.fields)e(i.type,n);if("of"in t)for(let i of t.of)e(i,n);if(t.annotations)for(let i of t.annotations)e(i,n)}}(t,new Set)}),r}({name:e.name,types:t}),l=r._validation,a=null==l?void 0:l.filter(e=>e.problems.some(RB));if(l&&(null==a?void 0:a.length))throw new RL(r);let o=function(e){var t;if(cg(t=e.auth)&&"state"in t&&cg(t.state)&&"subscribe"in t.state&&"function"==typeof t.state.subscribe)return e.auth;let n=e.unstable_clientFactory||ol.eI,{projectId:i,dataset:r,apiHost:l}=e;return hT({apiHost:l,...e.auth,clientFactory:n,dataset:r,projectId:i})}(e),s=o.state.pipe((0,ag.U)(t=>{let{client:n,authenticated:i,currentUser:l}=t;return function(e){var t,n,i,r;let l,a,o,{config:s,client:d,currentUser:c,schema:u,authenticated:p,auth:h}=e,{dataset:f,projectId:m}=s,g=function(e,t){let{dataset:n,url:i,requestTagPrefix:r="sanity.studio"}=e.withConfig({apiVersion:"2022-06-30"}).config(),l="".concat(i.replace(/\/+$/,""),"/socket/").concat(n).replace(/^http/,"ws"),a="".concat(l,"?tag=").concat(r),o=t.token?{token$:t.token}:{};return(0,oh.W0)(a,o)}(d,h),x=[],v={},b=e=>{if(!e||!e.apiVersion)throw Error("Missing required `apiVersion` option");return v[e.apiVersion]||(v[e.apiVersion]=d.withConfig(e)),v[e.apiVersion]},y={client:d,getClient:b,currentUser:c,dataset:f,projectId:m,schema:u};y.client=[...Object.keys(d),...Object.keys(d.__proto__)].reduce((e,t)=>{let n=Object.hasOwnProperty.call(d,t)?d[t]:d.__proto__[t];return Object.defineProperty(e,t,{get:()=>(console.warn('`configContext.client` is deprecated and will be removed in the next release! Use `context.getClient({apiVersion: "2021-06-07"})` instead'),n)})},{});try{l=RD({config:s,context:y,propertyName:"schema.templates",reducer:RT,initialValue:u.getTypeNames().filter(e=>!/^sanity\./.test(e)).map(e=>u.get(e)).filter(cr).filter(e=>{var t;return(null==(t=e.type)?void 0:t.name)==="document"}).map(e=>({id:e.name,schemaType:e.name,title:e.title||e.name,icon:e.icon,value:e.initialValue||{_type:e.name}}))})}catch(e){throw new RZ({name:s.name,type:"source",causes:[e]})}try{a=RD({config:s,context:y,initialValue:[],propertyName:"tools",reducer:RS})}catch(e){throw new RZ({name:s.name,type:"source",causes:[e]})}if(a.some(e=>{let{name:t}=e;return"tool"===t}))throw Error('A tool cannot have the name "tool". Please enter a different name.');let j=l.filter(e=>{var t;return!(null==(t=e.parameters)?void 0:t.length)}).map(e=>({templateId:e.id,description:e.description,icon:e.icon,title:e.title})),w=l.reduce((e,t)=>(e.set(t.id,t),e),new Map),k=e=>{let{schemaType:t}=e,n=RD({config:s,context:{...y,creationContext:e},initialValue:j,propertyName:"document.resolveNewDocumentOptions",reducer:RA}),i=[];if(i.length)throw new RZ({name:s.name,type:"source",causes:i});return n.map((e,t)=>{let n=w.get(e.templateId);if(!n)throw Error("Could not find template with ID `".concat(e.templateId,"`"));let i=u.get(n.schemaType);if(!i)throw Error("Could not find matching schema type `".concat(n.schemaType,"` for template `").concat(n.id,"`"));let r=e.title||n.title,l=(null==i?void 0:i.title)===r?void 0:null==i?void 0:i.title;return{id:"".concat(e.templateId,"-").concat(t),templateId:e.templateId,type:"initialValueTemplateItem",title:r,subtitle:e.subtitle||l,description:e.description||n.description,icon:e.icon||n.icon||(null==i?void 0:i.icon),initialDocumentId:e.initialDocumentId,parameters:e.parameters,schemaType:n.schemaType}}).filter(n=>{var i;return!t||"document"===e.type||t===(null==(i=w.get(n.templateId))?void 0:i.schemaType)})};try{o=k({type:"global"})}catch(e){x.push(e)}if(x.length)throw new RZ({name:s.name,type:"source",causes:x});return{type:"source",name:s.name,title:s.title||op()(s.name),schema:u,getClient:b,dataset:f,projectId:m,tools:a,currentUser:c,authenticated:p,templates:l,auth:h,document:{actions:e=>RD({config:s,context:{...y,...e},initialValue:Rw,propertyName:"document.actions",reducer:RP}),badges:e=>RD({config:s,context:{...y,...e},initialValue:Rj,propertyName:"document.badges",reducer:RE}),unstable_fieldActions:e=>RD({config:s,context:{...y,...e},initialValue:hN,propertyName:"document.unstable_fieldActions",reducer:hq}),inspectors:e=>RD({config:s,context:{...y,...e},initialValue:ch,propertyName:"document.inspectors",reducer:RI}),resolveProductionUrl:e=>RD({config:s,context:{...y,...e},initialValue:void 0,propertyName:"resolveProductionUrl",asyncReducer:R_}),resolveNewDocumentOptions:k,unstable_languageFilter:e=>RD({config:s,context:{...y,...e},initialValue:Rk,propertyName:"document.unstable_languageFilter",reducer:RM}),unstable_comments:{enabled:e=>RR({context:e,config:s,initialValue:!1})}},form:{file:{assetSources:RD({config:s,context:y,initialValue:[Mj],propertyName:"formBuilder.file.assetSources",reducer:RO}),directUploads:(null==(n=null==(t=s.form)?void 0:t.file)?void 0:n.directUploads)===void 0||s.form.file.directUploads},image:{assetSources:RD({config:s,context:y,initialValue:[Mw],propertyName:"formBuilder.image.assetSources",reducer:Rz}),directUploads:(null==(r=null==(i=s.form)?void 0:i.image)?void 0:r.directUploads)===void 0||s.form.image.directUploads}},search:{filters:Mk,operators:Rv},__internal:{bifur:g,staticInitialValueTemplateItems:o,options:s}}}({config:e,client:n,currentUser:l,schema:r,authenticated:i,auth:o})}),(0,aw.d)(1));return{name:e.name,projectId:e.projectId,dataset:e.dataset,title:e.title||op()(e.name),auth:o,schema:r,source:s}}),l=i.title||op()(i.name),a={type:"workspace-summary",auth:r[0].auth,basePath:function(e,t){let n=[e,t||""].map(e=>e.replace(/^\/+/g,"").replace(/\/+$/g,"")).filter(Boolean).join("/");return"/".concat(n)}(n,i.basePath),dataset:i.dataset,schema:r[0].schema,icon:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return(0,oi.isValidElementType)(e)?(0,lJ.createElement)(e):(0,lJ.isValidElement)(e)?e:function(e,t){let n=RV("".concat(e," ").concat(t)),i=or.mE.filter(e=>"gray"!==e),r=i[Math.floor(n*i.length)],l=["300","400","500","600","700"],a=l[Math.floor(RV(n.toString())*l.length)],o=or.VG[r][a].hex,s=e.split(/\s/g).map(e=>e.replace(/\\W/g,"")).filter(Boolean).slice(0,2).map(e=>e.charAt(0).toUpperCase()),d=(0,db._j)(o,.4),c=(0,db.$n)(o,.4),u=(0,db.WC)(o,"readable",d)?(0,db.WC)(o,"readable",c)?(0,db.XV)(o):c:d;return(0,lG.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32",children:[(0,lG.jsx)("rect",{width:32,height:32,rx:2,fill:o}),(0,lG.jsx)(RU,{x:"50%",y:"50%",textAnchor:"middle",alignmentBaseline:"middle",dominantBaseline:"middle",fill:u,children:s})]})}(t,n)}(i.icon,l,"".concat(i.projectId," ").concat(i.dataset)),name:i.name||"default",projectId:i.projectId,theme:i.theme||l4.Lg,title:l,subtitle:i.subtitle,__internal:{sources:r}};return RK.set(e,a),a})}})(t,{basePath:i}),[t,i]);return(0,lG.jsx)(R7.Provider,{value:r,children:n})}function Ft(e,t){let{name:n,title:i}=e;return"string"==typeof n&&n.trim().length>0?n:Fn(i,t)}function Fn(e,t){let n="string"==typeof e&&e.trim().length>0?' (titled "'.concat(e,'")'):"";return"at index ".concat(t).concat(n)}function Fi(){let e=(0,lJ.useContext)(R7);if(!e)throw Error("Could not find `workspaces` context");return e}class Fr extends Error{constructor(e,t){super(e),this.index=null==t?void 0:t.index,this.identifier=(null==t?void 0:t.workspace)&&Ft(t.workspace,t.index)}}function Fl(e,t){let{name:n,basePath:i}=e;if(i&&"string"==typeof i)return!0;if(void 0===i)throw new Fr("If more than one workspace is defined, every workspace must have a `basePath` defined. "+"Workspace `".concat(n,"` is missing a `basePath`"),{workspace:e,index:t});throw new Fr("If more than one workspace is defined, every workspace must have a `basePath` defined. "+"Workspace `".concat(n,"` has an invalid `basePath` (must be a non-empty string)"),{workspace:e,index:t})}function Fa(e,t){let{name:n,basePath:i}=e;if(i&&"/"!==i&&!/^\/[a-z0-9/_-]*[a-z0-9_-]+$/i.test(i))throw new Fr("All workspace `basePath`s must start with a leading `/`, consist of only URL safe characters, and cannot end with a trailing `/`. "+"Workspace `".concat(n,"`'s basePath is `").concat(i,"`"),{workspace:e,index:t})}function Fo(){return(0,lG.jsx)(l4.Zb,{height:"fill",children:(0,lG.jsx)(l4.kC,{align:"center",height:"fill",justify:"center",padding:4,sizing:"border",children:(0,lG.jsx)(l4.W2,{width:0,children:(0,lG.jsx)(l4.Zb,{padding:4,radius:2,shadow:1,tone:"caution",children:(0,lG.jsxs)(l4.kC,{children:[(0,lG.jsx)(l4.xu,{children:(0,lG.jsx)(l4.xv,{size:1,children:(0,lG.jsx)(a8.foC,{})})}),(0,lG.jsxs)(l4.Kq,{flex:1,marginLeft:3,space:3,children:[(0,lG.jsx)(l4.xv,{as:"h1",size:1,weight:"bold",children:"No configured tools"}),(0,lG.jsx)(l4.xv,{as:"p",muted:!0,size:1,children:"Please configure a tool in your Studio configuration."}),(0,lG.jsx)(l4.xv,{as:"p",muted:!0,size:1,children:(0,lG.jsx)("a",{href:"https://www.sanity.io/docs/studio-tools",rel:"noreferrer",target:"_blank",children:"Learn how to add a tool →"})})]})]})})})})})}function Fs(e){let{reason:t="Redirecting…"}=e;return(0,lG.jsx)(l4.Zb,{height:"fill",children:(0,lG.jsx)(l4.kC,{align:"center",height:"fill",justify:"center",padding:4,sizing:"border",children:(0,lG.jsx)(l4.W2,{width:0,children:(0,lG.jsx)(l4.Zb,{padding:4,radius:2,shadow:1,tone:"primary",children:(0,lG.jsxs)(l4.kC,{children:[(0,lG.jsx)(l4.xu,{children:(0,lG.jsx)(l4.xv,{size:1,children:(0,lG.jsx)(a8.hZl,{})})}),(0,lG.jsx)(l4.Kq,{flex:1,marginLeft:3,space:3,children:(0,lG.jsx)(l4.xv,{as:"h1",size:1,weight:"bold",children:t})})]})})})})})}function Fd(e){let{toolName:t}=e;return(0,lG.jsx)(l4.Zb,{height:"fill",children:(0,lG.jsx)(l4.kC,{align:"center",height:"fill",justify:"center",padding:4,sizing:"border",children:(0,lG.jsx)(l4.W2,{width:0,children:(0,lG.jsx)(l4.Zb,{padding:4,radius:2,shadow:1,tone:"caution",children:(0,lG.jsxs)(l4.kC,{children:[(0,lG.jsx)(l4.xu,{children:(0,lG.jsx)(l4.xv,{size:1,children:(0,lG.jsx)(a8.foC,{})})}),(0,lG.jsx)(l4.Kq,{flex:1,marginLeft:3,space:3,children:(0,lG.jsxs)(l4.xv,{as:"h1",size:1,weight:"bold",children:["Tool not found: ",(0,lG.jsx)("code",{children:t})]})})]})})})})})}function Fc(){return(0,lG.jsxs)(l4.kC,{as:l4.Zb,justify:"center",align:"center",height:"fill",direction:"column",gap:4,children:[(0,lG.jsx)(l4.xv,{muted:!0,children:"Loading…"}),(0,lG.jsx)(l4.$j,{muted:!0})]})}var Fu=Object.freeze,Fp=Object.defineProperty,Fh=(e,t)=>Fu(Fp(e,"raw",{value:Fu(t||e.slice())}));let Ff={error:"critical",warning:"caution"},Fm=a0.ZP.code(rH||(rH=Fh(["\n  && {\n    background: none;\n    color: inherit;\n  }\n"]))),Fg=(0,a0.ZP)(l4.xv)(rW||(rW=Fh(["\n  white-space: pre-line;\n"])));function Fx(e){let{problemGroups:t}=e,n=(0,lJ.useMemo)(()=>{let e=[];for(let n of t)for(let t of n.problems)e.push({group:n,problem:t});return e},[t]);return(0,lG.jsx)(l4.Kq,{as:"ul",space:4,children:n.map((e,t)=>{let{group:n,problem:i}=e,r="error"===i.severity,l="warning"===i.severity,a=function(e){let t=e.path[0];return"type"===t.kind?{name:t.name,type:t.type}:null}(n);return(0,lG.jsxs)(l4.Zb,{border:!0,padding:4,radius:2,tone:Ff[i.severity],children:[(0,lG.jsxs)(l4.kC,{children:[(0,lG.jsx)(l4.xu,{marginRight:3,children:(0,lG.jsxs)(l4.xv,{muted:!0,size:1,children:[r&&(0,lG.jsx)(a8.uIy,{}),l&&(0,lG.jsx)(a8.foC,{})]})}),(0,lG.jsx)(l4.xu,{flex:1,children:(0,lG.jsx)(l4.xv,{size:1,weight:"semibold",children:a?(0,lG.jsxs)(lG.Fragment,{children:[sK()(a.type),' type "',a.name,'"']}):null})})]}),(0,lG.jsx)(l4.xu,{marginTop:4,children:(0,lG.jsx)(l4.Zb,{border:!0,overflow:"auto",padding:2,tone:"inherit",children:(0,lG.jsx)(l4.Oo,{separator:(0,lG.jsx)(l4.xv,{muted:!0,size:1,children:"→"}),children:n.path.map((e,t)=>{if("type"===e.kind){let n="".concat(function(e){if(null==e?void 0:e.startsWith("<unnamed_type_@_index")){let t=e.slice(1,-1).split("_");return"[".concat(t[4],"]")}return e}(e.name),":").concat(e.type);return(0,lG.jsx)(l4.xv,{title:n,size:1,textOverflow:"ellipsis",children:(0,lG.jsx)(Fm,{children:n})},t)}return"property"===e.kind?(0,lG.jsx)(l4.xv,{title:e.name,size:1,textOverflow:"ellipsis",children:(0,lG.jsx)(Fm,{children:e.name})},t):null})})})}),(0,lG.jsx)(l4.xu,{as:"ul",marginTop:4,children:(0,lG.jsx)(l4.xu,{as:"li",children:(0,lG.jsxs)(l4.Kq,{space:3,children:[(0,lG.jsx)(Fg,{muted:!0,size:1,children:i.message}),i.helpId&&(0,lG.jsx)(l4.xv,{muted:!0,size:1,children:(0,lG.jsx)("a",{href:(0,dL.h)(i.helpId),target:"_blank",rel:"noopener noreferrer",children:"View documentation →"})})]})})})]},t)})})}function Fv(e){var t;let{schema:n}=e,i=(null==(t=n._validation)?void 0:t.filter(e=>e.problems.some(e=>"error"===e.severity)))||[];return(0,lJ.useEffect)(()=>(function(e){let t=e._validation,n=null==t?void 0:t.filter(e=>e.problems.some(e=>"warning"===e.severity));(null==n?void 0:n.length)!==0&&(console.groupCollapsed("⚠️ Schema has ".concat(null==n?void 0:n.length," warnings")),null==n||n.forEach(e=>{let t=e.path.map(e=>"type"===e.kind?"".concat(e.name||"<unnamed>","(").concat(e.type,")"):"property"===e.kind?e.name:null).filter(Boolean).join(" > ");console.group("%cAt ".concat(t),"color: #FF7636"),e.problems.forEach(e=>{console.log(e.message)}),console.groupEnd()}),console.groupEnd())})(n),[n]),(0,lG.jsx)(l4.Zb,{height:"fill",overflow:"auto",paddingY:[4,5,6,7],paddingX:4,sizing:"border",children:(0,lG.jsx)(l4.W2,{width:1,children:(0,lG.jsxs)(l4.Kq,{space:5,children:[(0,lG.jsx)(l4.X6,{as:"h1",children:"Schema errors"}),(0,lG.jsx)(Fx,{problemGroups:i})]})})})}function Fb(e){return(0,lG.jsx)(l4.Zb,{height:"fill",sizing:"border",tone:"caution",display:"flex",children:(0,lG.jsx)(l4.kC,{direction:"row",justify:"center",flex:1,align:"center",children:(0,lG.jsxs)(l4.Kq,{space:4,children:[(0,lG.jsx)(l4.X6,{as:"h1",children:"Workspace not found"}),(0,lG.jsx)(l4.gF,{children:(0,lG.jsx)(l4.zx,{text:"Go to default workspace",onClick:e.onNavigateToDefaultWorkspace,mode:"ghost"})})]})})})}let Fy=(0,lJ.createContext)(null),Fj=(0,lJ.createContext)(null);function Fw(e){let{children:t,history:n}=e;return(0,lG.jsx)(Fj.Provider,{value:n,children:t})}let Fk=(0,lJ.memo)(function(e){let{children:t,history:n,activeWorkspace:i,setActiveWorkspace:r}=e,l=(0,lJ.useMemo)(()=>({activeWorkspace:i,setActiveWorkspace:r}),[i,r]);return(0,lG.jsx)(Fy.Provider,{value:l,children:(0,lG.jsx)(Fw,{history:n,children:t})})}),FC=()=>"undefined"==typeof document?(0,dF.PP)():(0,dF.lX)();function F_(e){let{children:t,LoadingComponent:n,NotFoundComponent:i,unstable_history:r}=e,l=Fi(),a=(0,lJ.useMemo)(()=>r||FC(),[r]),o=(0,lJ.useCallback)(e=>{let t=l.find(t=>t.name===e);t&&a.push(t.basePath)},[a,l]),s=(0,lJ.useCallback)(()=>{o(l[0].name)},[o,l]),d=function(e,t){let n=(0,lJ.useMemo)(()=>t.map(e=>{let t=e.basePath||"/";return{workspace:e,name:e.name,basePath:t,basePathRegex:RegExp("^".concat(dZ()(t),"(\\/|$)"),"i")}}),[t]),i=(0,lJ.useMemo)(()=>(function(e){let t=e.map(e=>e.basePath.substring(1).split("/")).reduce((e,t)=>{for(let n=0;n<e.length;n++)if(e[n]!==t[n].toLowerCase())return e.slice(0,n);return e});return RegExp("^".concat(function e(t){let[n,...i]=t;return n?"(\\/".concat(dZ()(n)).concat(e(i),"(\\/|$))?"):""}(t),"$"),"i")})(n),[n]),[r]=(0,lJ.useState)(()=>e.location.pathname),l=(0,lJ.useMemo)(()=>({subscribe:t=>e.listen(t),getSnapshot:()=>e.location.pathname,getServerSnapshot:()=>r,selector:e=>(function(e){let{pathname:t,workspaces:n,basePathRegex:i}=e,[r]=n;for(let{workspace:e,basePath:i,basePathRegex:r}of n)if(r.test(t)||"/"===i)return{type:"match",workspace:e};return"/"===t||i.test(t)?{type:"redirect",pathname:r.basePath}:{type:"not-found"}})({basePathRegex:i,pathname:e,workspaces:n}),isEqual:(e,t)=>{if(e.type!==t.type)return!1;switch(e.type){case"match":return e.workspace===t.workspace;case"redirect":return e.pathname===t.pathname;case"not-found":return!0;default:throw Error("Unknown type: ".concat(e.type))}}}),[i,e,r,n]);return(0,du.useSyncExternalStoreWithSelector)(l.subscribe,l.getSnapshot,l.getServerSnapshot,l.selector,l.isEqual)}(a,l);switch((0,lJ.useEffect)(()=>{"redirect"===d.type&&a.replace(d.pathname)},[a,d]),d.type){case"match":return(0,lG.jsx)(Fk,{activeWorkspace:d.workspace,history:a,setActiveWorkspace:o,children:t});case"redirect":return(0,lG.jsx)(n,{});case"not-found":return(0,lG.jsx)(i,{onNavigateToDefaultWorkspace:s});default:throw Error("Unknown type: ".concat(d.type))}}function FS(){let e=(0,lJ.useContext)(Fy);if(!e)throw Error("Could not find `ActiveWorkspaceMatcher` context");return e}var FT=Object.freeze,FE=Object.defineProperty;let FP={"logged-in":"","logged-out":"Signed out","no-access":""},FA=(0,a0.ZP)(l4.Zb)(r$||(r$=FT(FE(es=["\n  width: 35px;\n  height: 35px;\n\n  svg {\n    width: 100%;\n    height: 100%;\n  }\n"],"raw",{value:FT(es.slice())})))),FO=e=>(0,oi.isValidElementType)(e)?(0,lJ.createElement)(e):(0,lJ.isValidElement)(e)?e:void 0;function Fz(e){let{state:t,subtitle:n,selected:i,title:r,icon:l,iconRight:a}=e,o=(0,lJ.useMemo)(()=>FO(l),[l]),s=(0,lJ.useMemo)(()=>FO(a),[a]);return(0,lG.jsxs)(l4.kC,{align:"center",flex:"none",gap:3,children:[(0,lG.jsx)(FA,{radius:2,tone:"transparent",children:o}),(0,lG.jsxs)(l4.Kq,{flex:1,space:2,children:[(0,lG.jsx)(l4.xv,{textOverflow:"ellipsis",weight:"medium",children:r}),n&&(0,lG.jsx)(l4.xv,{muted:!0,size:1,textOverflow:"ellipsis",children:n})]}),t&&FP[t]&&(0,lG.jsx)(l4.xu,{paddingLeft:1,children:(0,lG.jsx)(l4.xv,{size:1,muted:!0,textOverflow:"ellipsis",children:FP[t]})}),(i||s)&&(0,lG.jsxs)(l4.kC,{align:"center",gap:4,paddingLeft:3,paddingRight:2,children:[i&&(0,lG.jsx)(l4.xv,{children:(0,lG.jsx)(a8.KML,{})}),s&&(0,lG.jsx)(l4.xv,{muted:!0,children:s})]})]})}let FM=ci(e=>(0,ao.a)(e.map(e=>e.auth.state.pipe((0,ag.U)(t=>[e.name,t])))).pipe((0,ag.U)(e=>Object.fromEntries(e))));var FI=Object.freeze,FR=Object.defineProperty;let FF=[{url:"https://slack.sanity.io/",title:"Community"},{url:"https://www.sanity.io/docs",title:"Docs"},{url:"https://www.sanity.io/legal/privacy",title:"Privacy"},{url:"https://www.sanity.io",title:"sanity.io"}],FD=(0,a0.ZP)(l4.xv)(rX||(rX=FI(FR(ed=["\n  a {\n    color: inherit;\n  }\n"],"raw",{value:FI(ed.slice())}))));function FZ(e){let{children:t,footer:n,header:i}=e;return(0,lG.jsxs)(l4.Kq,{space:6,children:[(0,lG.jsx)(l4.Zb,{border:!0,radius:3,overflow:"auto",children:(0,lG.jsxs)(l4.Kq,{children:["object"==typeof i&&(0,lG.jsx)(l4.xu,{children:i}),"string"==typeof i&&(0,lG.jsx)(l4.xu,{paddingY:4,children:(0,lG.jsx)(l4.X6,{align:"center",size:1,children:i})}),(0,lG.jsx)(l4.xu,{paddingX:1,children:(0,lG.jsx)(l4.Zb,{borderTop:!!i,borderBottom:!!n,children:t})}),n&&(0,lG.jsx)(l4.xu,{children:n})]})}),(0,lG.jsxs)(l4.kC,{direction:"column",gap:4,justify:"center",align:"center",paddingBottom:4,children:[(0,lG.jsx)(l4.xv,{size:3,children:(0,lG.jsx)(dq.hn,{})}),(0,lG.jsx)(l4.kC,{align:"center",gap:2,children:FF.map((e,t)=>(0,lG.jsxs)(lJ.Fragment,{children:[(0,lG.jsx)(FD,{muted:!0,size:1,children:(0,lG.jsx)("a",{href:e.url,target:"_blank",rel:"noopener noreferrer",children:e.title})}),t<FF.length-1&&(0,lG.jsx)(l4.xv,{size:1,muted:!0,children:"•"})]},e.title))})]})]})}function FL(){var e;let t=Fi(),{activeWorkspace:n,setActiveWorkspace:i}=FS(),[r]=FM(t),[l,a]=(0,lJ.useState)((null==n?void 0:n.name)||null),o=1===t.length?t[0]:t.find(e=>e.name===l),s=null==(e=null==o?void 0:o.auth)?void 0:e.LoginComponent,d=(0,lJ.useCallback)(()=>a(null),[]);return r?s&&o?(0,lG.jsxs)(l4.Kq,{space:2,children:[t.length>1&&(0,lG.jsx)(l4.kC,{children:(0,lG.jsx)(l4.zx,{fontSize:1,icon:a8.Y4O,mode:"bleed",onClick:d,padding:2,text:"Choose another workspace"})}),(0,lG.jsx)(FZ,{header:(0,lG.jsx)(l4.xu,{padding:3,children:(0,lG.jsx)(Fz,{icon:o.icon,title:o.title,subtitle:null==o?void 0:o.subtitle})}),children:(0,lG.jsx)(l4.Kq,{padding:2,paddingBottom:3,paddingTop:4,children:(0,lJ.createElement)(s,{...sw()(o,["type","__internal"]),key:l})})})]}):(0,lG.jsx)(FZ,{header:"Choose your workspace",footer:(0,lG.jsx)(l4.Kq,{padding:1,children:(0,lG.jsx)(l4.zx,{as:"a",href:"https://beta.sanity.io/docs/platform/studio/config/workspaces",icon:a8.dtP,justify:"flex-start",mode:"bleed",rel:"noopener noreferrer",target:"__blank",text:"Add workspace"})}),children:(0,lG.jsx)(l4.Kq,{space:1,paddingX:1,paddingY:2,children:t.map(e=>{let t=r[e.name].authenticated?"logged-in":e.auth.LoginComponent?"logged-out":"no-access";return(0,lG.jsx)(l4.Zb,{as:"button",radius:2,padding:2,onClick:()=>{"logged-in"===t&&e.name!==n.name&&i(e.name),"logged-out"===t&&a(e.name)},children:(0,lG.jsx)(Fz,{icon:null==e?void 0:e.icon,iconRight:a8.XCv,state:t,subtitle:null==e?void 0:e.subtitle,title:(null==e?void 0:e.title)||e.name})},e.name)})})}):(0,lG.jsx)(Fc,{})}var Fq=Object.freeze,FN=Object.defineProperty;let FV=(0,a0.ZP)(l4.v2)(rG||(rG=Fq(FN(ec=["\n  max-width: 350px;\n  min-width: 250px;\n"],"raw",{value:Fq(ec.slice())})))),FU="Select workspace";function FB(e){let{collapsed:t=!1}=e,[n,i]=(0,lJ.useState)(!1),{scheme:r}=R8(),l=Fi(),{activeWorkspace:a,setActiveWorkspace:o}=FS(),[s]=FM(l),{navigateUrl:d}=(0,a9.tv)(),c=(0,lJ.useCallback)(()=>i(!0),[]),u=(0,lJ.useCallback)(()=>i(!1),[]),p=(0,lJ.useMemo)(()=>({constrainSize:!0,scheme:r,portal:!0}),[r]),h=t?FU:void 0,f=t?void 0:FU;return(0,lG.jsx)(l4.u,{content:(0,lG.jsx)(l4.xu,{padding:2,children:(0,lG.jsx)(l4.xv,{size:1,children:"Select workspace"})}),disabled:n||!t,placement:"bottom",portal:!0,scheme:r,children:(0,lG.jsx)(l4.Kq,{children:(0,lG.jsx)(l4.j2,{button:(0,lG.jsx)(l4.zx,{icon:a8.GVG,mode:"bleed",text:f,disabled:!s,"aria-label":h,justify:t?void 0:"flex-start"}),id:"workspace-menu",menu:(0,lG.jsxs)(FV,{children:[(0,lG.jsx)(l4.xu,{paddingX:3,paddingY:3,children:(0,lG.jsx)(l4.__,{size:1,muted:!0,children:"Workspaces"})}),s&&l.map(e=>{let t=s[e.name].authenticated?"logged-in":e.auth.LoginComponent?"logged-out":"no-access";return(0,lG.jsx)(l4.sN,{onClick:()=>{"logged-in"===t&&e.name!==a.name&&o(e.name),"logged-out"===t&&d({path:e.basePath})},padding:2,pressed:e.name===a.name,children:(0,lG.jsx)(Fz,{icon:null==e?void 0:e.icon,selected:e.name===a.name,state:t,subtitle:null==e?void 0:e.subtitle,title:(null==e?void 0:e.title)||e.name})},e.name)})]}),onClose:u,onOpen:c,popover:p})})})}function FK(){return(0,lG.jsx)(l4.Zb,{height:"fill",overflow:"auto",children:(0,lG.jsx)(l4.kC,{height:"fill",direction:"column",align:"center",justify:"center",paddingTop:4,children:(0,lG.jsx)(l4.W2,{width:0,children:(0,lG.jsx)(FL,{})})})})}function FH(){return(0,lG.jsx)(lG.Fragment,{children:"TODO: implement config errors screen"})}function FW(){let[e,t]=(0,lJ.useState)(null),[n,i]=(0,lJ.useState)(null);if(n)throw n;let{activeWorkspace:r}=FS(),l=(0,lJ.useCallback)(()=>{var e,t;null==(t=(e=r.auth).logout)||t.call(e)},[r]);(0,lJ.useEffect)(()=>{let e=r.auth.state.subscribe({next:e=>{let{currentUser:n}=e;t(n)},error:i});return()=>{e.unsubscribe()}},[r]);let a=hE(null==e?void 0:e.provider);return(0,lG.jsx)(l4.Zb,{height:"fill",children:(0,lG.jsx)(l4.Vq,{id:"not-authorized-dialog",header:"Not authorized",width:1,footer:(0,lG.jsx)(l4.Kq,{paddingX:3,paddingY:2,children:(0,lG.jsx)(l4.zx,{text:"Sign out",onClick:l})}),children:(0,lG.jsxs)(l4.Kq,{paddingX:4,paddingY:5,space:4,children:[(0,lG.jsx)(l4.xv,{children:"You are not authorized to access this studio. Maybe you could ask someone to invite you to collaborate on this project?"}),(0,lG.jsxs)(l4.xv,{children:["If you think this is an error, verify that you are signed in with the correct account. You are currently signed in as"," ",(0,lG.jsxs)("strong",{children:[null==e?void 0:e.name," (",null==e?void 0:e.email,")"]}),a?" through ".concat(a):"","."]})]})})})}var F$=Object.freeze,FX=Object.defineProperty;let FG=a0.ZP.label(rY||(rY=F$(FX(eu=["\n  clip: rect(0 0 0 0);\n  clip-path: inset(50%);\n  height: 1px;\n  overflow: hidden;\n  overflow: clip;\n  position: absolute;\n  white-space: nowrap;\n  width: 1px;\n"],"raw",{value:F$(eu.slice())}))));function FY(e){let{projectId:t}=e,n=window.location.origin,i=(0,lJ.useMemo)(()=>{let e=new URL("https://sanity.io/manage/project/".concat(t,"/api"));return e.searchParams.set("cors","add"),e.searchParams.set("origin",n),e.searchParams.set("credentials",""),e.toString()},[n,t]);return(0,lJ.useEffect)(()=>{let e=()=>{window.location.reload()};return window.addEventListener("focus",e),()=>{window.removeEventListener("focus",e)}},[]),(0,lG.jsx)(l4.Zb,{height:"fill",children:(0,lG.jsx)(l4.Vq,{id:"cors-error-dialog",header:"Before you continue...",width:1,children:(0,lG.jsxs)(l4.Kq,{paddingX:4,paddingY:5,space:4,children:[(0,lG.jsxs)(l4.xv,{children:["To access your content, you need to ",(0,lG.jsx)("b",{children:"add the following URL as a CORS origin"})," to your Sanity project."]}),(0,lG.jsx)(FG,{"aria-hidden":"true",children:"CORS URL to be added"}),(0,lG.jsx)(l4.oi,{value:n,readOnly:!0}),(0,lG.jsx)(l4.zx,{as:"a",href:i,target:"_blank",rel:"noopener noreferrer",tone:"primary",children:(0,lG.jsxs)(l4.kC,{align:"center",justify:"center",gap:3,children:[(0,lG.jsx)(l4.xv,{weight:"medium",children:"Continue"}),(0,lG.jsx)(l4.xv,{weight:"medium",children:(0,lG.jsx)(a8.buG,{})})]})})]})})})}function FJ(e){let{children:t,heading:n="An error occured"}=e,[{error:i},r]=(0,lJ.useState)({error:null}),l=cg(i)&&"string"==typeof i.message&&i.message,a=cg(i)&&"string"==typeof i.stack&&i.stack,o=(0,lJ.useCallback)(()=>r({error:null}),[r]);return((0,dk.H)(o),i instanceof hl)?(0,lG.jsx)(FY,{projectId:null==i?void 0:i.projectId}):i instanceof RL?(0,lG.jsx)(Fv,{schema:i.schema}):i?(0,lG.jsx)(l4.Zb,{height:"fill",overflow:"auto",paddingY:[4,5,6,7],paddingX:4,sizing:"border",tone:"critical",children:(0,lG.jsx)(l4.W2,{width:3,children:(0,lG.jsxs)(l4.Kq,{space:4,children:[(0,lG.jsx)(l4.X6,{children:n}),(0,lG.jsx)("div",{children:(0,lG.jsx)(l4.zx,{onClick:o,text:"Retry",tone:"default"})}),(0,lG.jsx)(l4.Zb,{border:!0,radius:2,overflow:"auto",padding:4,tone:"inherit",children:(0,lG.jsxs)(l4.Kq,{space:4,children:[l&&(0,lG.jsx)(l4.EK,{size:1,children:(0,lG.jsxs)("strong",{children:["Error: ",l]})}),a&&(0,lG.jsx)(l4.EK,{size:1,children:a})]})})]})})}):(0,lG.jsx)(l4.SV,{onCatch:r,children:t})}var FQ=Object.freeze,F0=Object.defineProperty;let F1=(0,a0.ZP)(l4.Zb)(rJ||(rJ=FQ(F0(ep=["\n  height: 100%;\n  left: 0;\n  overflow: hidden;\n  overflow: clip;\n  position: fixed;\n  top: 0;\n  width: 100%;\n  z-index: 200;\n"],"raw",{value:FQ(ep.slice())})))),F2=(0,lJ.createContext)({onSearchFullscreenOpenChange:()=>"",searchFullscreenOpen:!1,searchFullscreenPortalEl:null});function F3(){var e;let{name:t,title:n,tools:i}=Io(),r=(0,a9.tv)(),l=(0,a9.z)((0,lJ.useCallback)(e=>"string"==typeof e.tool?e.tool:void 0,[])),a=(0,lJ.useMemo)(()=>i.find(e=>e.name===l),[l,i]),[o,s]=(0,lJ.useState)(!1),[d,c]=(0,lJ.useState)(null),u=(0,lJ.useMemo)(()=>{let e=n||op()(t);return l?"".concat(op()(l)," | ").concat(e):e},[l,t,n]),p=!!(null==a?void 0:a.controlsDocumentTitle);(0,lJ.useEffect)(()=>{p||(document.title=u)},[u,p]);let h=(0,lJ.useCallback)(e=>{s(e)},[]),f=(0,lJ.useMemo)(()=>({searchFullscreenOpen:o,searchFullscreenPortalEl:d,onSearchFullscreenOpenChange:h}),[o,d,h]),m=fR({defaultComponent:qC,pick:qA}),g=!a&&("desk"===l||!l)&&"undefined"!=typeof window&&/\/desk(\/|$)/.test(window.location.pathname)&&i.some(e=>"structure"===e.name);return(0,lJ.useEffect)(()=>{g&&r.navigateUrl({path:window.location.pathname.replace(/\/desk/,"/structure"),replace:!0})},[g,r]),(0,lG.jsxs)(l4.kC,{"data-ui":"ToolScreen",direction:"column",height:"fill","data-testid":"studio-layout",children:[(0,lG.jsx)(F2.Provider,{value:f,children:(0,lG.jsx)(m,{})}),g&&(0,lG.jsx)(Fs,{}),0===i.length&&(0,lG.jsx)(Fo,{}),i.length>0&&!a&&l&&!g&&(0,lG.jsx)(Fd,{toolName:l}),o&&(0,lG.jsx)(F1,{ref:c,overflow:"auto"}),(0,lG.jsx)(FJ,{heading:"The ".concat(null==a?void 0:a.name," tool crashed"),children:(0,lG.jsx)(l4.Zb,{flex:1,hidden:o,children:a&&l&&(0,lG.jsx)(a9.NZ,{scope:l,__unsafe_disableScopedSearchParams:null==(e=a.router)?void 0:e.__unsafe_disableScopedSearchParams,children:(0,lG.jsx)(lJ.Suspense,{fallback:(0,lG.jsx)(F4,{}),children:(0,lJ.createElement)(a.component,{tool:a})})})})},null==a?void 0:a.name)]})}function F4(){return(0,lG.jsxs)(l4.kC,{justify:"center",align:"center",height:"fill",direction:"column",gap:4,children:[(0,lG.jsx)(l4.xv,{muted:!0,children:"Loading…"}),(0,lG.jsx)(l4.$j,{muted:!0})]})}var F5=Object.freeze,F6=Object.defineProperty;let F8=a0.ZP.div(rQ||(rQ=F5(F6(eh=["\n  position: absolute;\n  width: 18px;\n  height: 18px;\n  background: var(--card-bg-color);\n  bottom: -4px;\n  right: -4px;\n  border-radius: 50%;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  border: 1px solid var(--card-bg-color);\n  box-sizing: content-box;\n\n  svg {\n    box-sizing: content-box;\n    border: 1px solid var(--card-hairline-soft-color);\n    border-radius: 50%;\n    padding: 2px;\n    width: 12px;\n    height: 12px;\n  }\n\n  &[data-logo='github'] {\n    svg {\n      path {\n        fill: var(--card-fg-color);\n      }\n    }\n  }\n\n  &[data-logo='saml'] {\n    svg {\n      path {\n        fill: var(--card-fg-color);\n      }\n    }\n  }\n"],"raw",{value:F5(eh.slice())})))),F9=(0,lG.jsxs)("svg",{width:"12",height:"12",viewBox:"0 0 12 12",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,lG.jsxs)("g",{clipPath:"url(#clip0)",children:[(0,lG.jsx)("path",{d:"M12 6.13764C12 5.72977 11.9663 5.31971 11.8943 4.91846H6.12036V7.22895H9.42684C9.28963 7.97412 8.84876 8.63332 8.20322 9.05221V10.5514H10.1759C11.3342 9.50637 12 7.9631 12 6.13764Z",fill:"#4285F4"}),(0,lG.jsx)("path",{d:"M6.12019 12.0002C7.77118 12.0002 9.16349 11.4688 10.1779 10.5517L8.20529 9.05253C7.65646 9.41851 6.94793 9.62574 6.12244 9.62574C4.52544 9.62574 3.17136 8.56971 2.68552 7.1499H0.649902V8.69537C1.68908 10.7215 3.80567 12.0002 6.12019 12.0002V12.0002Z",fill:"#34A853"}),(0,lG.jsx)("path",{d:"M2.68332 7.14986C2.4269 6.40469 2.4269 5.59778 2.68332 4.8526V3.30713H0.649951C-0.218278 5.00252 -0.218278 6.99995 0.649951 8.69533L2.68332 7.14986V7.14986Z",fill:"#FBBC04"}),(0,lG.jsx)("path",{d:"M6.12019 2.37483C6.99291 2.3616 7.8364 2.68348 8.46845 3.27433L10.2161 1.56131C9.1095 0.542752 7.64071 -0.017233 6.12019 0.000404333C3.80566 0.000404333 1.68908 1.27911 0.649902 3.3074L2.68326 4.85288C3.16686 3.43087 4.52319 2.37483 6.12019 2.37483V2.37483Z",fill:"#EA4335"})]}),(0,lG.jsx)("defs",{children:(0,lG.jsx)("clipPath",{id:"clip0",children:(0,lG.jsx)("rect",{width:"12",height:"12",fill:"white"})})})]}),F7=(0,lG.jsxs)("svg",{width:"12",height:"12",viewBox:"0 0 12 12",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,lG.jsx)("g",{clipPath:"url(#clip0)",children:(0,lG.jsx)("path",{d:"M11.195 3.13503C10.6711 2.22838 9.91808 1.47537 9.01144 0.951471C8.09222 0.414976 7.08837 0.146729 5.99987 0.146729C4.91137 0.146729 3.90752 0.414976 2.98831 0.951471C2.08163 1.47534 1.32862 2.22836 0.804744 3.13503C0.268248 4.05497 0 5.05883 0 6.14659C0 7.45399 0.381531 8.62978 1.14459 9.67394C1.90765 10.7181 2.89327 11.4408 4.10143 11.8419C4.24208 11.868 4.34624 11.8497 4.41392 11.7872C4.44666 11.7577 4.47263 11.7215 4.49006 11.681C4.50749 11.6405 4.51595 11.5967 4.51488 11.5527C4.51488 11.537 4.51361 11.3963 4.51105 11.1307C4.5085 10.8651 4.50722 10.6334 4.50722 10.4355L4.32745 10.4666C4.18407 10.4895 4.03885 10.4986 3.89375 10.494C3.71159 10.4908 3.53001 10.4725 3.35087 10.4393C3.16049 10.4045 2.98119 10.3246 2.82796 10.2064C2.66705 10.0846 2.54715 9.91661 2.48428 9.72484L2.40602 9.54506C2.34022 9.40286 2.25754 9.2691 2.15976 9.14666C2.04775 9.00072 1.93447 8.90176 1.81991 8.84977L1.76518 8.81064C1.72769 8.78356 1.6936 8.75205 1.66367 8.71679C1.63479 8.6841 1.61108 8.64719 1.59334 8.60734C1.57766 8.57085 1.5907 8.54085 1.63247 8.51731C1.67461 8.49405 1.75123 8.48256 1.86068 8.48256L2.01692 8.50582C2.12108 8.52662 2.24996 8.5891 2.40356 8.69326C2.5585 8.79876 2.68797 8.93748 2.78254 9.09932C2.90239 9.31294 3.04695 9.47575 3.21624 9.58775C3.38552 9.69976 3.55609 9.75576 3.72793 9.75576C3.87725 9.7578 4.02641 9.74479 4.17312 9.7169C4.29459 9.69195 4.41264 9.65254 4.52473 9.59952C4.57162 9.25037 4.69931 8.98212 4.90782 8.79477C4.63684 8.76849 4.36827 8.72157 4.10444 8.6544C3.84797 8.58382 3.60133 8.48141 3.37029 8.34958C3.12825 8.218 2.91442 8.04015 2.74095 7.82613C2.57421 7.6178 2.4374 7.34417 2.3305 7.00524C2.2236 6.6663 2.1707 6.27584 2.1718 5.83383C2.1718 5.20357 2.37757 4.66708 2.7891 4.22435C2.59629 3.75006 2.61453 3.21885 2.84383 2.63073C2.99487 2.58385 3.21879 2.61897 3.51559 2.73608C3.81239 2.85319 4.02983 2.95352 4.16792 3.03707C4.30601 3.12025 4.41665 3.19058 4.49983 3.24804C5.48153 2.9773 6.51821 2.9773 7.49991 3.24804L7.79679 3.0606C8.0249 2.92356 8.26549 2.80849 8.51535 2.71693C8.79135 2.61276 9.00231 2.58412 9.14825 2.63101C9.38248 3.21949 9.40327 3.7507 9.21064 4.22462C9.62199 4.66735 9.82776 5.20385 9.82795 5.83411C9.82795 6.27684 9.77459 6.66904 9.66787 7.01071C9.56116 7.35238 9.42325 7.62601 9.25415 7.8316C9.07785 8.04326 8.86311 8.21966 8.62124 8.35149C8.39008 8.48329 8.14337 8.5857 7.88682 8.65632C7.62412 8.72277 7.35674 8.76915 7.087 8.79505C7.35698 9.02927 7.49206 9.3994 7.49225 9.90543V11.5527C7.49115 11.5964 7.49929 11.6398 7.51612 11.6802C7.53295 11.7206 7.5581 11.7569 7.58993 11.7869C7.65505 11.8493 7.75794 11.8675 7.89858 11.8416C9.10693 11.4403 10.0926 10.7177 10.8557 9.67367C11.6188 8.62968 12.0003 7.4539 12.0003 6.14632C11.9997 5.05873 11.7313 4.05497 11.195 3.13503V3.13503Z",fill:"black"})}),(0,lG.jsx)("defs",{children:(0,lG.jsx)("clipPath",{id:"clip0",children:(0,lG.jsx)("rect",{width:"12",height:"12",fill:"white"})})})]}),De=(0,lG.jsxs)("svg",{width:"17",height:"9",viewBox:"0 0 17 9",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,lG.jsx)("path",{d:"M0.0691681 5.98162C0.115833 7.24157 1.07247 8.00221 2.59841 8.00221C4.17102 8.00221 5.12299 7.19957 5.12299 5.86962C5.12299 4.83832 4.55367 4.25501 3.25172 3.96569L2.56108 3.80703C1.8331 3.64837 1.53445 3.38704 1.53445 2.91106C1.53445 2.40708 1.94977 2.09442 2.61708 2.09442C3.27505 2.09442 3.6997 2.43508 3.75103 2.99039H5.00166C4.95966 1.78643 4.01236 0.997795 2.60308 0.997795C1.14713 0.997795 0.218496 1.79577 0.218496 3.05105C0.218496 4.04968 0.815808 4.69366 2.03376 4.96898L2.73374 5.13231C3.51304 5.30497 3.8117 5.54763 3.8117 6.00495C3.8117 6.55093 3.34972 6.90092 2.62174 6.90092C1.85644 6.90092 1.38045 6.56493 1.31979 5.98162H0.0691681Z"}),(0,lG.jsx)("path",{d:"M5.97695 5.98162C6.02362 7.24157 6.98025 8.00221 8.5062 8.00221C10.0788 8.00221 11.0308 7.19957 11.0308 5.86962C11.0308 4.83832 10.4615 4.25501 9.15951 3.96569L8.46886 3.80703C7.74089 3.64837 7.44223 3.38704 7.44223 2.91106C7.44223 2.40708 7.85755 2.09442 8.52486 2.09442C9.18284 2.09442 9.60749 2.43508 9.65882 2.99039H10.9094C10.8674 1.78643 9.92015 0.997795 8.51086 0.997795C7.05492 0.997795 6.12628 1.79577 6.12628 3.05105C6.12628 4.04968 6.72359 4.69366 7.94155 4.96898L8.64153 5.13231C9.42083 5.30497 9.71949 5.54763 9.71949 6.00495C9.71949 6.55093 9.2575 6.90092 8.52953 6.90092C7.76422 6.90092 7.28824 6.56493 7.22758 5.98162H5.97695Z"}),(0,lG.jsx)("path",{d:"M16.9852 5.01565V3.98435C16.9852 2.11309 16.0099 0.997795 14.3953 0.997795C12.7807 0.997795 11.8054 2.11309 11.8054 3.98435V5.01565C11.8054 6.88692 12.7807 8.00221 14.3953 8.00221C16.0099 8.00221 16.9852 6.88692 16.9852 5.01565ZM14.3953 6.82625C13.5833 6.82625 13.154 6.21494 13.154 5.00165V3.99835C13.154 2.78506 13.5833 2.17375 14.3953 2.17375C15.2073 2.17375 15.6366 2.78506 15.6366 3.99835V5.00165C15.6366 6.21494 15.2073 6.82625 14.3953 6.82625Z"})]}),Dt=e=>{let{provider:t}=e,n=null==t?void 0:t.startsWith("saml-");return(0,lG.jsxs)(F8,{"data-logo":n?"saml":t,children:["google"===t&&F9,"github"===t&&F7,"sanity"===t&&(0,lG.jsx)(dq.xN,{}),n&&De]})};var Dn=Object.freeze,Di=Object.defineProperty,Dr=(e,t)=>Dn(Di(e,"raw",{value:Dn(t||e.slice())}));let Dl=(0,a0.ZP)(l4.v2)(r0||(r0=Dr(["\n  min-width: 200px;\n  max-width: 300px;\n"]))),Da=(0,a0.ZP)(l4.xu)(r1||(r1=Dr(["\n  position: relative;\n  min-width: ","px;\n  min-height: ","px;\n"])),e=>{let{theme:t}=e;return t.sanity.avatar.sizes[1].size},e=>{let{theme:t}=e;return t.sanity.avatar.sizes[1].size});function Do(e){let{setScheme:t}=e,n=R9(t);return(0,lG.jsxs)(lG.Fragment,{children:[(0,lG.jsx)(l4.R,{}),(0,lG.jsx)(l4.xu,{padding:2,children:(0,lG.jsx)(l4.__,{size:1,muted:!0,children:"Appearance"})}),n.map(e=>{let{icon:t,label:n,name:i,onSelect:r,selected:l,title:a}=e;return(0,lG.jsx)(l4.sN,{"aria-label":n,icon:t,onClick:r,pressed:l,text:a,iconRight:l&&(0,lG.jsx)(a8.KML,{})},i)})]})}function Ds(){let{currentUser:e,projectId:t,auth:n}=Io(),i=R6(),r=R4(),l=!!(e&&cz(e,"administrator")),a=hE(null==e?void 0:e.provider),o=(0,lJ.useMemo)(()=>({placement:"bottom-end",portal:!0,preventOverflow:!0,scheme:i,constrainSize:!0}),[i]);return(0,lG.jsx)(l4.j2,{button:(0,lG.jsx)(l4.zx,{mode:"bleed",padding:0,paddingX:1,children:(0,lG.jsxs)(l4.kC,{align:"center",gap:1,children:[(0,lG.jsx)(UP,{user:"me",size:1}),(0,lG.jsx)(l4.xv,{size:1,muted:!0,children:(0,lG.jsx)(a8.v4q,{})})]})}),id:"user-menu",menu:(0,lG.jsxs)(Dl,{children:[(0,lG.jsx)(l4.Zb,{padding:2,children:(0,lG.jsxs)(l4.kC,{align:"center",children:[(0,lG.jsx)(l4.u,{disabled:!a,portal:!0,content:a&&(0,lG.jsx)(l4.xu,{padding:2,children:(0,lG.jsxs)(l4.xv,{size:1,children:["Signed in with ",a]})}),children:(0,lG.jsxs)(Da,{marginRight:3,children:[(0,lG.jsx)(UP,{size:1,user:"me"}),(null==e?void 0:e.provider)&&(0,lG.jsx)(Dt,{provider:e.provider})]})}),(0,lG.jsxs)(l4.Kq,{space:2,flex:1,children:[(0,lG.jsx)(l4.xv,{size:2,weight:"medium",textOverflow:"ellipsis",children:null==e?void 0:e.name}),(0,lG.jsx)(l4.xv,{size:1,muted:!0,textOverflow:"ellipsis",children:null==e?void 0:e.email})]})]})}),r&&(0,lG.jsx)(Do,{setScheme:r}),(0,lG.jsx)(l4.R,{}),(0,lG.jsx)(l4.sN,{as:"a","aria-label":"Manage project",href:"https://sanity.io/manage/project/".concat(t),target:"_blank",text:"Manage project",icon:a8.IEm}),l&&(0,lG.jsx)(l4.sN,{as:"a","aria-label":"Invite members",href:"https://sanity.io/manage/project/".concat(t,"/members"),target:"_blank",text:"Invite members",icon:a8.oyc}),n.logout&&(0,lG.jsxs)(lG.Fragment,{children:[(0,lG.jsx)(l4.R,{}),(0,lG.jsx)(l4.sN,{iconRight:a8.Ow9,text:"Sign out",disabled:!n.logout,...n.logout&&{onClick:n.logout}})]})]}),popover:o})}var Dd=Object.freeze,Dc=Object.defineProperty;let Du=(0,a0.ZP)(l4.xu)(r2||(r2=Dd(Dc(ef=["\n  max-width: 300px;\n"],"raw",{value:Dd(ef.slice())}))));function Dp(e){let{option:t,currentUser:n,onClick:i,preview:r}=e,l=(0,lJ.useMemo)(()=>({template:t.templateId,type:t.schemaType}),[t.schemaType,t.templateId]),{onClick:a,href:o}=(0,a9.PM)({intent:"create",params:l}),s=(0,lJ.useCallback)(e=>{a(e),i(t)},[a,i,t]);return(0,lG.jsx)(l4.u,{disabled:t.hasPermission,portal:!0,content:(0,lG.jsx)(Du,{padding:2,children:(0,lG.jsx)(uP,{currentUser:n,operationLabel:"create this document"})}),children:(0,lG.jsx)("div",{children:(0,lG.jsx)(l4.Zb,{as:t.hasPermission?"a":"button",disabled:!t.hasPermission,href:o,marginBottom:1,onClick:s,padding:"inline"===r?3:4,radius:2,children:(0,lG.jsx)(l4.xv,{size:"inline"===r?1:void 0,children:t.title})})})},t.id)}var Dh=Object.freeze,Df=Object.defineProperty,Dm=(e,t)=>Dh(Df(e,"raw",{value:Dh(t||e.slice())}));let Dg=(0,a0.ZP)(l4.kC)(r3||(r3=Dm(["\n  min-height: 100px;\n"]))),Dx=a0.ZP.strong(r4||(r4=Dm(["\n  word-break: break-all;\n"])));function Dv(e){let{currentUser:t,loading:n,onDocumentClick:i,options:r,preview:l,searchQuery:a,textInputElement:o}=e,s=r.length>0&&!n,d=(0,lJ.useCallback)(()=>{i()},[i]),c=(0,lJ.useCallback)(e=>{var t;return(null==(t=r[e])?void 0:t.hasPermission)===!1},[r]),u=(0,lJ.useCallback)(e=>(0,lG.jsx)(Dp,{currentUser:t,onClick:d,option:e,preview:l},e.id),[t,d,l]);return n?(0,lG.jsx)(Dg,{align:"center",flex:1,height:"fill",justify:"center",padding:4,sizing:"border",children:(0,lG.jsxs)(l4.gF,{space:2,children:[(0,lG.jsx)(l4.$j,{muted:!0,size:1}),(0,lG.jsx)(l4.xv,{muted:!0,size:1,children:"Loading…"})]})}):!s&&a?(0,lG.jsx)(Dg,{align:"center",flex:1,height:"fill",justify:"center",padding:4,sizing:"border",children:(0,lG.jsxs)(l4.xv,{align:"center",muted:!0,size:1,children:["No results found for ",(0,lG.jsxs)(Dx,{children:["“",a,"”"]})]})}):s?(0,lG.jsx)(ug,{activeItemDataAttr:"data-hovered",ariaLabel:"New document",autoFocus:cP?void 0:"input",getItemDisabled:c,inputElement:o,itemHeight:33,items:r,overscan:5,padding:"inline"===l?1:2,paddingBottom:0,renderItem:u}):(0,lG.jsx)(Dg,{align:"center",flex:1,height:"fill",justify:"center",padding:4,sizing:"border",children:(0,lG.jsx)(l4.xv,{align:"center",muted:!0,size:1,children:"No documents found"})})}var Db=Object.freeze,Dy=Object.defineProperty,Dj=(e,t)=>Db(Dy(e,"raw",{value:Db(t||e.slice())}));let Dw=(0,a0.ZP)(l4.J2)(()=>(0,a0.iv)(r5||(r5=Dj(["\n    [data-ui='Popover__wrapper'] {\n      width: 320px;\n      display: flex;\n      flex-direction: column;\n      border-radius: ","px;\n      position: relative;\n      overflow: hidden;\n      overflow: clip;\n    }\n  "])),e=>{let{theme:t}=e;return t.sanity.radius[3]})),Dk=(0,a0.ZP)(l4.Vq)(()=>(0,a0.iv)(r6||(r6=Dj(["\n    [data-ui='DialogCard'] {\n      justify-content: flex-start;\n    }\n  "])))),DC=(0,a0.ZP)(l4.xu)(r8||(r8=Dj(["\n  max-width: 300px;\n"]))),D_=(0,a0.ZP)(l4.kC)(r9||(r9=Dj([""]))),DS=(0,a0.ZP)(l4.Zb)(r7||(r7=Dj(["\n  min-height: max-content;\n"]))),DT=(0,a0.ZP)(l4.Zb)(le||(le=Dj(["\n  min-height: max-content;\n"]))),DE=(0,a0.ZP)(l4.kC)(e=>{let{$maxDisplayedItems:t,$itemHeight:n}=e;return(0,a0.iv)(lt||(lt=Dj(["\n    --item-height: ","px;\n    --max-items: ",";\n    --list-padding: 0.5rem;\n\n    position: relative;\n    max-height: calc(var(--item-height) * var(--max-items) + var(--list-padding));\n    min-height: calc((var(--item-height) * 1));\n  "])),n,t)});function DP(e){let{canCreateDocument:t,modal:n="popover",loading:i,options:r}=e,[l,a]=(0,lJ.useState)(!1),[o,s]=(0,lJ.useState)(""),[d,c]=(0,lJ.useState)(null),[u,p]=(0,lJ.useState)(null),[h,f]=(0,lJ.useState)(null),[m,g]=(0,lJ.useState)(null),{scheme:x}=R8(),v=Ns(),b=r.length>0,y=!t||!b,j="Search",w="Create new document",k=(0,lJ.useMemo)(()=>r.map(e=>({...e,title:(null==e?void 0:e.title)||e.id})).sort((e,t)=>e.title.localeCompare(t.title)).filter(e=>(function(e,t){let n=t.title.toLowerCase();return e.trim().toLowerCase().split(/[\s\-_]+/).every(e=>n.includes(e))})(o,e)).sort((e,t)=>(function(e,t,n){let i=t.title.toLowerCase(),r=n.title.toLowerCase(),l=e.trim().toLowerCase();return i.startsWith(l)&&!r.startsWith(l)?-1:r.startsWith(l)&&!i.startsWith(l)?1:i.includes(l)&&!r.includes(l)?-1:r.includes(l)&&!i.includes(l)?1:0})(o,e,t)),[r,o]),C=(0,lJ.useCallback)(e=>{s(e.currentTarget.value)},[]),_=(0,lJ.useCallback)(()=>a(e=>!e),[]),S=(0,lJ.useCallback)(()=>{a(!1),s(""),null==h||h.focus()},[h]),T=(0,lJ.useCallback)(e=>{"ArrowDown"!==e.key||l||a(!0)},[l]),E=(0,lJ.useCallback)(e=>{("Escape"===e.key||"Tab"===e.key)&&l&&S()},[S,l]);(0,l4.O8)(()=>{l&&S()},[h,u,d]);let P=(0,lJ.useMemo)(()=>({currentUser:v,loading:i,onDocumentClick:_,options:k,searchQuery:o,preview:"popover"===n?"inline":"default",textInputElement:m}),[v,k,_,i,n,m,o]),A=(0,lJ.useMemo)(()=>({border:!1,defaultValue:o,disabled:i,icon:a8.W1M,onChange:C,placeholder:j,ref:g}),[C,i,j,o]),O=(0,lJ.useMemo)(()=>({"aria-label":w,disabled:y||i,icon:a8.dtP,mode:"bleed",onClick:_,ref:f,selected:l}),[y,_,i,l,w]),z=(0,lJ.useMemo)(()=>b?t?(0,lG.jsx)(l4.xv,{size:1,children:"New document..."}):(0,lG.jsx)(uP,{currentUser:v,operationLabel:"create any document"}):(0,lG.jsx)(l4.xv,{size:1,children:"No document types"}),[t,v,b]),M=(0,lJ.useMemo)(()=>({content:(0,lG.jsx)(DC,{padding:2,children:z}),disabled:i||l,placement:"bottom",portal:!0,scheme:x}),[i,l,x,z]);return"dialog"===n?(0,lG.jsxs)(lG.Fragment,{children:[(0,lG.jsx)(l4.u,{...M,children:(0,lG.jsx)("div",{children:(0,lG.jsx)(l4.zx,{...O})})}),l&&(0,lG.jsx)(Dk,{header:w,id:"create-new-document-dialog",onClickOutside:S,onClose:S,ref:p,scheme:x,width:1,children:(0,lG.jsxs)(D_,{direction:"column",flex:1,height:"fill",children:[(0,lG.jsx)(DT,{padding:2,borderBottom:!0,children:(0,lG.jsx)(l4.oi,{...A})}),(0,lG.jsx)(l4.kC,{direction:"column",overflow:"hidden",children:(0,lG.jsx)(Dv,{...P})})]})})]}):(0,lG.jsx)(Dw,{constrainSize:!0,onKeyDown:E,open:l,portal:!0,radius:3,ref:c,scheme:x,content:(0,lG.jsxs)(D_,{direction:"column",flex:1,forwardedAs:a7.ZP,height:"fill",returnFocus:!0,children:[(0,lG.jsx)(DS,{sizing:"border",children:(0,lG.jsxs)(l4.Kq,{children:[(0,lG.jsx)(l4.xu,{paddingX:3,paddingY:3,children:(0,lG.jsx)(l4.xu,{paddingY:1,children:(0,lG.jsx)(l4.__,{size:1,muted:!0,children:w})})}),(0,lG.jsx)(l4.Zb,{borderTop:!0,borderBottom:!0,padding:1,children:(0,lG.jsx)(l4.oi,{...A,fontSize:1,radius:1})})]})}),(0,lG.jsx)(DE,{$itemHeight:33,$maxDisplayedItems:10,direction:"column",overflow:"hidden",children:(0,lG.jsx)(Dv,{...P})})]}),children:(0,lG.jsx)("div",{children:(0,lG.jsx)(l4.u,{...M,children:(0,lG.jsx)("div",{children:(0,lG.jsx)(l4.zx,{...O,"aria-expanded":l,"aria-haspopup":"true",onKeyDown:T})})})})})}var DA=Object.freeze,DO=Object.defineProperty;let Dz=(0,a0.ZP)(l4.Zb)(ln||(ln=DA(DO(em=["\n  background: transparent;\n  margin: calc((-35px + 11px) / 2);\n"],"raw",{value:DA(em.slice())})))),DM=(0,lJ.memo)(function(e){let{presence:t,focused:n,onFocus:i}=e,[r,l]=(0,lJ.useState)(null),a=sC()(t.locations||[],["lastActiveAt"],["desc"]).find(e=>e.documentId),o=!!(null==a?void 0:a.documentId);(0,lJ.useEffect)(()=>{n&&r&&(r.focus(),r.setAttribute("data-selected","")),n||null==r||r.removeAttribute("data-selected")},[r,n]);let s=(0,lJ.useCallback)(()=>{i(t.user.id)},[i,t.user.id]),d=(0,lJ.useMemo)(()=>(0,lJ.forwardRef)(function(e,t){return(null==a?void 0:a.path)?(0,lG.jsx)(a9.nR,{...e,intent:"edit",params:{id:null==a?void 0:a.documentId,path:lY.BB(null==a?void 0:a.path)},ref:t}):null}),[a]);return(0,lG.jsx)(l4.sN,{as:a?d:"div","data-as":a?"a":"div",onFocus:s,paddingY:o?4:3,paddingLeft:4,paddingRight:3,ref:l,children:(0,lG.jsxs)(l4.kC,{align:"center",children:[(0,lG.jsx)(Dz,{children:(0,lG.jsx)(UP,{size:1,user:t.user,status:o?"editing":"inactive"},t.user.id)}),(0,lG.jsxs)(l4.Kq,{space:2,marginLeft:4,children:[(0,lG.jsx)(l4.xv,{textOverflow:"ellipsis",children:t.user.displayName}),!o&&(0,lG.jsx)(l4.xv,{size:0,muted:!0,textOverflow:"ellipsis",children:"Not in a document"})]})]})})});var DI=Object.freeze,DR=Object.defineProperty,DF=(e,t)=>DI(DR(e,"raw",{value:DI(t||e.slice())}));let DD=(0,a0.ZP)(l4.Zb)(li||(li=DF(["\n  background: transparent;\n"]))),DZ=(0,a0.ZP)(l4.v2)(lr||(lr=DF(["\n  max-width: 350px;\n  min-width: 250px;\n"]))),DL=(0,a0.ZP)(l4.Kq)(ll||(ll=DF(["\n  position: sticky;\n  bottom: 0;\n"])));function Dq(e){let{collapse:t}=e,n=function(){let[e,t]=(0,lJ.useState)([]),n=Uk();return(0,lJ.useEffect)(()=>{let e=n.globalPresence$.subscribe(t);return()=>{e.unsubscribe()}},[n]),e}(),{projectId:i}=Io(),{scheme:r}=R8(),l=n.length>0,[a,o]=(0,lJ.useState)(),s=(0,lJ.useCallback)(e=>{o(e)},[]),d=(0,lJ.useCallback)(()=>{o("")},[]),c=(0,lJ.useMemo)(()=>t?(0,lG.jsx)(p1,{icon:a8.oyc,mode:"bleed",tone:l?"positive":void 0}):(0,lG.jsx)(l4.zx,{mode:"bleed",padding:1,children:(0,lG.jsx)(DD,{children:(0,lG.jsx)(l4.Jh,{maxLength:4,"aria-label":"Who is here",children:n.map(e=>(0,lG.jsx)(UP,{user:e.user},e.user.id))})})}),[t,l,n]),u=(0,lJ.useMemo)(()=>({constrainSize:!0,portal:!0,scheme:r}),[r]);return(0,lG.jsx)(l4.j2,{button:c,id:"global-presence-menu",onClose:d,menu:(0,lG.jsxs)(DZ,{padding:1,children:[l&&(0,lG.jsx)(l4.Kq,{children:n.map(e=>(0,lG.jsx)(DM,{focused:a===e.user.id,onFocus:s,presence:e},e.user.id))}),!l&&(0,lG.jsx)(l4.xu,{paddingX:3,paddingY:4,children:(0,lG.jsxs)(l4.Kq,{space:3,children:[(0,lG.jsx)(l4.xv,{weight:"semibold",size:2,children:"No one else is here"}),(0,lG.jsx)(l4.xv,{size:1,muted:!0,children:"Invite people to the project to see their online status."})]})}),(0,lG.jsxs)(DL,{space:1,children:[(0,lG.jsx)(l4.R,{}),(0,lG.jsx)(l4.sN,{as:"a",href:"https://sanity.io/manage/project/".concat(i),iconRight:a8.IEm,onFocus:d,paddingY:4,rel:"noopener noreferrer",target:"_blank",text:"Manage members"})]})]}),popover:u})}var DN=Object.freeze,DV=Object.defineProperty,DU=(e,t)=>DN(DV(e,"raw",{value:DN(t||e.slice())}));let DB={duration:.2},DK={open:{opacity:1},closed:{opacity:0}},DH={open:{x:"0%"},closed:{x:"-100%"}},DW=(0,a0.ZP)(l4.mh)(la||(la=DU(["\n  position: fixed;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n"]))),D$=(0,a0.ZP)((0,dV.E)(l4.Zb))(lo||(lo=DU(["\n  position: absolute;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  background: var(--card-shadow-penumbra-color);\n"]))),DX=(0,a0.ZP)((0,dV.E)(l4.Zb))(ls||(ls=DU(["\n  position: relative;\n  pointer-events: all;\n  flex-direction: column;\n  height: 100%;\n  min-width: 200px;\n  max-width: 280px;\n  overflow: auto;\n"])));function DG(e){let{setScheme:t}=e,n=R9(t);return(0,lG.jsx)(lG.Fragment,{children:(0,lG.jsxs)(l4.Zb,{borderTop:!0,flex:"none",padding:3,overflow:"auto",children:[(0,lG.jsx)(l4.xu,{padding:2,children:(0,lG.jsx)(l4.__,{size:1,muted:!0,children:"Appearance"})}),(0,lG.jsx)(l4.Kq,{as:"ul",marginTop:1,space:1,children:n.map(e=>{let{icon:t,label:n,name:i,onSelect:r,selected:l,title:a}=e;return(0,lG.jsx)(l4.Kq,{as:"li",children:(0,lG.jsx)(l4.zx,{"aria-label":n,icon:t,iconRight:l&&(0,lG.jsx)(a8.KML,{}),justify:"flex-start",mode:"bleed",onClick:r,selected:l,text:a})},i)})})]})})}let DY=(0,lJ.memo)(function(e){let{activeToolName:t,isOpen:n,onClose:i,tools:r}=e,l=R4(),{auth:a,currentUser:o,projectId:s}=Io(),d=Fi(),c=qM(),u=!!(o&&cz(o,"administrator")),p=(0,lJ.useCallback)(e=>{"Escape"===e.key&&i()},[i]);return(0,lG.jsx)(dU.M,{children:n&&(0,lG.jsx)(a7.ZP,{autoFocus:!0,returnFocus:!0,children:(0,lG.jsxs)(DW,{onKeyDown:p,children:[(0,lG.jsx)(D$,{animate:"open","data-open":n,exit:"closed",initial:"closed",onClick:i,transition:DB,variants:DK}),(0,lG.jsxs)(DX,{animate:"open","data-open":n,display:"flex",exit:"closed",height:"fill",initial:"closed",shadow:1,transition:DB,variants:DH,children:[(0,lG.jsx)(l4.Zb,{borderBottom:!0,children:(0,lG.jsxs)(l4.Kq,{space:3,padding:3,children:[(0,lG.jsxs)(l4.kC,{align:"center",children:[(0,lG.jsx)(l4.kC,{flex:1,align:"center",paddingRight:2,children:(0,lG.jsxs)(l4.kC,{flex:1,align:"center",children:[(0,lG.jsx)(l4.xu,{children:(0,lG.jsx)(UP,{size:1,user:"me"})}),(0,lG.jsx)(l4.xu,{flex:1,marginLeft:2,title:(null==o?void 0:o.name)||(null==o?void 0:o.email),children:(0,lG.jsx)(l4.xv,{textOverflow:"ellipsis",children:(null==o?void 0:o.name)||(null==o?void 0:o.email)})})]})}),(0,lG.jsx)(l4.xu,{children:(0,lG.jsx)(l4.zx,{icon:a8.Two,mode:"bleed",onClick:i,title:"Close menu"})})]}),d.length>1&&(0,lG.jsx)(FB,{})]})}),(0,lG.jsxs)(l4.kC,{direction:"column",flex:1,justify:"space-between",overflow:"auto",children:[(0,lG.jsx)(l4.Zb,{flex:"none",padding:3,children:(0,lG.jsx)(c,{activeToolName:t,closeSidebar:i,context:"sidebar",isSidebarOpen:n,tools:r})}),(0,lG.jsxs)(l4.kC,{direction:"column",children:[l&&(0,lG.jsx)(DG,{setScheme:l}),(0,lG.jsx)(l4.Zb,{borderTop:!0,flex:"none",padding:3,children:(0,lG.jsxs)(l4.Kq,{as:"ul",space:1,children:[(0,lG.jsx)(l4.Kq,{as:"li",children:(0,lG.jsx)(l4.zx,{"aria-label":"Manage project",as:"a",href:"https://sanity.io/manage/project/".concat(s),icon:a8.IEm,justify:"flex-start",mode:"bleed",target:"_blank",text:"Manage project"})}),u&&(0,lG.jsx)(l4.Kq,{as:"li",children:(0,lG.jsx)(l4.zx,{"aria-label":"Invite members",as:"a",href:"https://sanity.io/manage/project/".concat(s,"/members"),icon:a8.oyc,justify:"flex-start",mode:"bleed",target:"_blank",text:"Invite members"})})]})})]})]}),a.logout&&(0,lG.jsx)(l4.Zb,{flex:"none",padding:3,borderTop:!0,children:(0,lG.jsx)(l4.Kq,{children:(0,lG.jsx)(l4.zx,{iconRight:a8.Ow9,justify:"flex-start",mode:"bleed",onClick:a.logout,text:"Sign out"})})})]})]})})})});function DJ(){var e;let t=(null==(e=q6()._validation)?void 0:e.filter(e=>e.problems.some(e=>"warning"===e.severity)))||[],{scheme:n}=R8(),i=(0,lJ.useId)(),[r,l]=(0,lJ.useState)(!1),[a,o]=(0,lJ.useState)(null),s=(0,lJ.useCallback)(()=>l(!0),[]),d=(0,lJ.useCallback)(()=>{l(!1),a&&a.focus()},[a]);return 0===t.length?null:(0,lG.jsxs)(lG.Fragment,{children:[(0,lG.jsx)(p1,{icon:a8.foC,label:"Found configuration issues",mode:"bleed",onClick:s,ref:o,selected:r,tone:"caution",tooltip:{scheme:n}}),r&&(0,lG.jsx)(l4.Vq,{header:(0,lG.jsxs)(l4.Kq,{space:3,children:[(0,lG.jsx)(l4.xv,{weight:"semibold",children:"Configuration issues"}),(0,lG.jsx)(l4.xv,{muted:!0,size:1,children:"Configuration checks are only performed during development and will not be visible in production builds"})]}),width:2,onClickOutside:d,onClose:d,scheme:n,id:i,children:(0,lG.jsxs)(l4.Kq,{space:4,padding:4,children:[(0,lG.jsxs)(l4.X6,{as:"h2",size:1,children:["Found ",t.length," schema warnings"]}),(0,lG.jsx)(Fx,{problemGroups:t})]})})]})}function DQ(e){let{title:t,children:n,href:i,onClick:r}=e;return(0,lG.jsx)(l4.zx,{"aria-label":t,as:"a","data-testid":"logo",href:i,mode:"bleed",onClick:r,padding:0,children:n})}let D0=(0,dy.ZP)("mod+".concat("k")),D1=(0,dy.ZP)("escape");function D2(e){let{children:t,hasValidTerms:n,onClose:i,onOpen:r,open:l}=e,a=(0,lJ.useRef)(!1),{dispatch:o,searchCommandList:s,setOnClose:d,state:{result:c}}=MI(),u=(0,lJ.useCallback)(()=>{var e;o({index:null!=(e=null==s?void 0:s.getTopIndex())?e:-1,type:"LAST_ACTIVE_INDEX_SET"}),i()},[o,i,s]);return(!function(e){let{open:t,onClose:n,onOpen:i}=e,{isTopLayer:r}=(0,l4.sJ)(),l=(0,lJ.useCallback)(()=>{null==n||n()},[n]),a=(0,lJ.useCallback)(e=>{D0(e)&&(e.preventDefault(),t?l():null==i||i()),D1(e)&&t&&r&&l()},[l,r,t,i]);(0,l4.qh)(a)}({onClose:u,onOpen:r,open:l}),(0,lJ.useEffect)(()=>{d(u)},[u,d]),(0,lJ.useEffect)(()=>{(!n||c.loaded)&&a.current&&o({index:0,type:"LAST_ACTIVE_INDEX_SET"})},[o,n,c.loaded]),(0,lJ.useEffect)(()=>{n||!a.current||l||o({type:"ORDERING_RESET"})},[o,n,l]),(0,lJ.useEffect)(()=>{(null==a?void 0:a.current)||(a.current=!0)},[]),l)?(0,lG.jsx)("div",{children:t}):null}function D3(e,t){return t?e[t]:void 0}function D4(e,t){var n;return{fieldId:t,filterName:e.name,operatorType:(null==(n=null==e?void 0:e.operators.find(e=>"item"===e.type))?void 0:n.name)||""}}function D5(e){let{fieldDefinitions:t,filterDefinitions:n,filters:i,operatorDefinitions:r}=e;return i.filter(e=>D7({filter:e,filterDefinitions:n,fieldDefinitions:t,operatorDefinitions:r})).map(e=>{var i;return null==(i=D3(r,e.operatorType))?void 0:i.groqFilter({fieldPath:function(e){let{filter:t,fieldDefinitions:n,filterDefinitions:i}=e,r=D6(n,t),l=i[t.filterName];if(l)switch(l.type){case"field":return null==r?void 0:r.fieldPath;case"pinned":return null==l?void 0:l.fieldPath;default:return}}({filter:e,fieldDefinitions:t,filterDefinitions:n}),value:null==e?void 0:e.value})}).filter(e=>!dw()(e)).filter(cr).join(" && ")}function D6(e,t){return(null==t?void 0:t.fieldId)?e[t.fieldId]:void 0}function D8(e){return[e.filterName,...e.fieldId?[e.fieldId]:[]].join("-")}function D9(e){let{fieldDefinitions:t,filters:n,types:i}=e,r=i.map(e=>e.name),l=Object.values(t).filter(e=>n.map(e=>null==e?void 0:e.fieldId).includes(e.id)).filter(e=>e.documentTypes.length>0).map(e=>e.documentTypes),a=si()(...l),o=[];return r.length>0&&o.push(r),a.length>0&&o.push(a),si()(...o).sort()}function D7(e){let{filter:t,filterDefinitions:n,fieldDefinitions:i,operatorDefinitions:r}=e,l=n[t.filterName],a=D3(r,t.operatorType),o=D6(i,t);return!!(l&&a&&(!t.fieldId||o)&&("field"!==l.type||(null==o?void 0:o.fieldPath)&&t.fieldId&&a.groqFilter({fieldPath:o.fieldPath,value:t.value}))&&("pinned"!==l.type||a.groqFilter({fieldPath:l.fieldPath,value:t.value})))}var Ze=Object.freeze,Zt=Object.defineProperty;let Zn=(0,dy.ZP)("escape"),Zi=a0.ZP.div(ld||(ld=Ze(Zt(eg=["\n  background: transparent;\n  height: 100%;\n  left: 0;\n  position: fixed;\n  top: 0;\n  width: 100%;\n  z-index: -1;\n"],"raw",{value:Ze(eg.slice())}))));function Zr(e){let{anchorElement:t,children:n,onClose:i}=e,{isTopLayer:r}=(0,l4.sJ)(),l=(0,lJ.useCallback)(e=>{Zn(e)&&r&&i()},[r,i]);(0,l4.qh)(l);let a=function(e){let[t,n]=(0,lJ.useState)(e&&Zl(e)),i=(0,lJ.useCallback)(()=>{e&&n(Zl(e))},[e]);return(0,lJ.useEffect)(()=>{e&&n(Zl(e))},[e]),(0,lJ.useEffect)(()=>(window.addEventListener("resize",i),()=>window.removeEventListener("resize",i)),[i]),t}(t||null);return(0,lG.jsxs)(lG.Fragment,{children:[(0,lG.jsx)(Zi,{onClick:i}),(0,lG.jsx)(a7.ZP,{autoFocus:!1,returnFocus:!0,children:(0,lG.jsx)(l4.Zb,{display:"flex",overflow:"hidden",radius:2,style:{maxHeight:"min(calc(100vh - ".concat(a,"px - ").concat(5,"px - ").concat(MH,"px), ").concat(500,"px"),zIndex:1},children:(0,lG.jsx)(l4.kC,{children:n})})})]})}function Zl(e){let t=e.getBoundingClientRect();return t.y+t.height+5}var Za=Object.freeze,Zo=Object.defineProperty,Zs=(e,t)=>Za(Zo(e,"raw",{value:Za(t||e.slice())}));let Zd=(0,a0.ZP)(l4.xu)(lc||(lc=Zs(["\n  border-bottom: 1px solid ",";\n  flex-shrink: 0;\n"])),e=>{let{theme:t}=e;return t.sanity.color.base.border}),Zc=(0,a0.ZP)(l4.kC)(lu||(lu=Zs(["\n  box-sizing: border-box;\n"]))),Zu=(0,lJ.forwardRef)(function(e,t){let{ariaInputLabel:n,onChange:i,onClear:r,typeFilter:l}=e,{state:{fullscreen:a}}=MI();return(0,lG.jsx)(Zd,{children:(0,lG.jsx)(Zc,{align:"center",flex:1,padding:1,children:(0,lG.jsx)(I9,{"aria-label":n,autoComplete:"off",border:!1,clearButton:!!l,fontSize:a?2:1,icon:a8.W1M,muted:!0,onChange:i,onClear:r,placeholder:"Filter",ref:t,smallClearButton:!0,spellCheck:!1,radius:2,value:l})})})});function Zp(e){let{fieldDefinitions:t,filterDefinitions:n,filters:i,id:r,headerTitle:l,tone:a}=e,o=i.map(e=>({fieldDefinition:D6(t,e),filterDefinition:n[e.filterName],filter:e,group:r,tone:a||"default",type:"filter"}));return o.length>0?[...l?[{title:l||"",tone:a||"default",type:"header"}]:[],...o]:[]}function Zh(e,t){return e.title.toLowerCase().includes(t.toLowerCase())}function Zf(e){return"pinned"===e.type&&void 0!==(null==e?void 0:e.group)}function Zm(e){return"pinned"===e.type&&void 0===(null==e?void 0:e.group)}function Zg(e){let{filter:t,maxLength:n}=e,{state:{definitions:i}}=MI(),r=(0,lJ.useMemo)(()=>{let e=i.filters[t.filterName];switch(null==e?void 0:e.type){case"field":{let e=D6(i.fields,t);if(null==e?void 0:e.titlePath)return e.titlePath[e.titlePath.length-1];return null}case"pinned":return e.title;default:return null}},[i,t]);return r?n&&r.length>n?(0,lG.jsxs)("span",{children:[r.slice(0,n),"…"]}):(0,lG.jsx)("span",{children:r}):null}function Zx(e){var t;let{filter:n}=e,{state:{definitions:i}}=MI(),r=null==(t=i.filters[n.filterName])?void 0:t.icon;return r?(0,lJ.createElement)(r):(0,lG.jsx)(a8.Tzq,{})}function Zv(e){var t;let{filter:n,small:i=!0}=e,{state:{definitions:r}}=MI(),l=D6(r.fields,n);return(0,lG.jsxs)(l4.Kq,{space:i?2:3,children:[(null==l?void 0:l.titlePath)&&(null==(t=l.titlePath)?void 0:t.length)>1&&(0,lG.jsx)(l4.xu,{marginLeft:4,children:(0,lG.jsx)(l4.xv,{muted:!0,size:i?0:1,children:l.titlePath.slice(0,-1).map((e,t)=>(0,lG.jsxs)(lJ.Fragment,{children:[(0,lG.jsx)("span",{children:e}),t!==l.titlePath.length-2&&(0,lG.jsx)("span",{style:{opacity:.75,paddingLeft:"0.25em",paddingRight:"0.25em"},children:(0,lG.jsx)(a8.XCv,{})})]},t))})}),(0,lG.jsxs)(l4.kC,{align:"flex-start",gap:3,children:[(0,lG.jsx)(l4.xu,{style:{flexShrink:0},children:(0,lG.jsx)(l4.xv,{size:i?1:2,children:(0,lG.jsx)(Zx,{filter:n})})}),(0,lG.jsx)(l4.xv,{size:i?1:2,weight:"medium",children:(0,lG.jsx)(Zg,{filter:n})})]})]})}function Zb(e){var t,n;return(0,lJ.isValidElement)(e)?(t=(0,dN.Dq)(e),(null==(n=new DOMParser().parseFromString(t,"text/html"))?void 0:n.body.textContent)||""):"string"==typeof e?e:""}function Zy(e){let{children:t,fieldDefinition:n,filterDefinition:i,visible:r}=e,{state:{documentTypesNarrowed:l}}=MI(),a=q6(),o=(0,lJ.useMemo)(()=>(null==n?void 0:n.documentTypes)?n.documentTypes.map(e=>{let t=a.get(e);return(null==t?void 0:t.title)||op()(null==t?void 0:t.name)}).filter(cr).sort():[],[null==n?void 0:n.documentTypes,a]),s=(0,lJ.useMemo)(()=>{if(null==n?void 0:n.documentTypes){let e=n.documentTypes.map(e=>{let t=a.get(e);if(t){let e=MD(t,n.fieldPath);return(null==e?void 0:e.type.description)&&Zb(null==e?void 0:e.type.description)}return null}).filter(cr).sort(),t=sh()(e);if(1===t.length)return t[0]}},[null==n?void 0:n.documentTypes,null==n?void 0:n.fieldPath,a]);return(0,lG.jsx)(l4.u,{content:(0,lG.jsx)(l4.Zb,{tone:"default",radius:2,style:{maxWidth:"250px"},children:(0,lG.jsxs)(l4.Kq,{padding:3,space:4,children:[n&&(0,lG.jsxs)(l4.Kq,{space:2,children:[(0,lG.jsx)(l4.__,{muted:!0,size:0,children:"Field name"}),(0,lG.jsx)(l4.gF,{children:(0,lG.jsx)(l4.Zb,{tone:"caution",padding:1,radius:2,children:(0,lG.jsx)(l4.EK,{size:0,children:null==n?void 0:n.name})})})]}),s&&(0,lG.jsxs)(l4.Kq,{space:3,children:[(0,lG.jsx)(l4.__,{muted:!0,size:0,children:"Field description"}),(0,lG.jsx)(l4.xv,{muted:!0,size:0,children:Zj(s)})]}),(null==i?void 0:i.description)&&(0,lG.jsx)(l4.xv,{muted:!0,size:0,children:Zj(i.description)}),!l.length&&o.length>0&&(0,lG.jsxs)(l4.Kq,{space:2,children:[(0,lG.jsxs)(l4.kC,{align:"center",gap:1,children:[(0,lG.jsx)(l4.__,{muted:!0,size:0,children:"Used in document types"}),(0,lG.jsx)(l4.Zb,{padding:1,radius:2,tone:"transparent",children:(0,lG.jsx)(l4.xv,{size:0,muted:!0,children:o.length})})]}),(0,lG.jsxs)(l4.xv,{size:0,weight:"regular",muted:!0,children:[o.slice(0,10).join(", "),(null==o?void 0:o.length)>10?" +".concat(o.length-10," more"):""]})]})]})}),disabled:!r,fallbackPlacements:["left"],placement:"right",portal:!0,children:t})}function Zj(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:256;return e.length>t?"".concat(e.slice(0,t-1),"…"):e}let Zw=lJ.memo(function(e){let{item:t,onClose:n,...i}=e,[r,l]=(0,lJ.useState)(!1),{dispatch:a,state:{filters:o}}=MI(),s=(0,lJ.useCallback)(()=>{a({filter:t.filter,type:"TERMS_FILTERS_ADD"}),null==n||n()},[a,t.filter,n]),d=!!o.find(e=>D8(e)===D8(t.filter)),c=(0,lJ.useRef)(),u=(0,lJ.useCallback)(()=>{c.current=setTimeout(()=>l(!0),500)},[]),p=(0,lJ.useCallback)(()=>{l(!1),clearTimeout(c.current)},[]);(0,lJ.useEffect)(()=>()=>clearTimeout(c.current),[]);let h=!!(t.fieldDefinition||t.filterDefinition.description);return(0,lG.jsx)(l4.xu,{...i,children:(0,lG.jsx)(l4.zx,{disabled:d,fontSize:1,justify:"flex-start",mode:"bleed",onClick:d?void 0:s,onMouseEnter:u,onMouseLeave:p,padding:0,style:{position:"relative",whiteSpace:"normal",width:"100%"},tabIndex:-1,tone:null==t?void 0:t.tone,children:(0,lG.jsx)(Zy,{fieldDefinition:t.fieldDefinition,filterDefinition:t.filterDefinition,visible:h&&r,children:(0,lG.jsx)(l4.xu,{padding:3,children:(0,lG.jsx)(Zv,{filter:t.filter})})})})})}),Zk=lJ.memo(function(e){let{item:t}=e;return(0,lG.jsx)(l4.xu,{paddingTop:1,children:(0,lG.jsx)(l4.Zb,{borderBottom:!0,padding:3,tone:null==t?void 0:t.tone,children:(0,lG.jsx)(l4.__,{muted:!0,size:0,textOverflow:"ellipsis",children:t.title})})})});function ZC(e){let{onClose:t}=e,[n,i]=(0,lJ.useState)(null),[r,l]=(0,lJ.useState)(""),a=(0,lJ.useCallback)(e=>l(e.currentTarget.value),[l]),o=(0,lJ.useCallback)(()=>l(""),[]),s=q6(),{state:{documentTypesNarrowed:d,definitions:c,filters:u,terms:{types:p}}}=MI(),h=(0,lJ.useMemo)(()=>(function(e){let{documentTypesNarrowed:t,fieldDefinitions:n,filterDefinitions:i,schema:r,titleFilter:l,types:a}=e,o=Object.values(n).filter(e=>e.titlePath.join("/").toLowerCase().includes(l.toLowerCase())).map(e=>{let t=i[e.filterName];return t?D4(t,e.id):null}).filter(cr),s=function(e){let{fieldDefinitions:t,filterDefinitions:n,titleFilter:i}=e,r=Object.values(n).filter(Zm).filter(e=>Zh(e,i)).map(e=>D4(e)),l=Object.values(n).filter(Zf).filter(e=>Zh(e,i)).reduce((e,t)=>(e[t.group]=e[t.group]||[],e[t.group].push(D4(t)),e),{});return[...Zp({fieldDefinitions:t,filterDefinitions:n,filters:r,id:"pinned-ungrouped",tone:"primary"}),...Object.entries(l).flatMap(e=>{let[i,r]=e;return Zp({fieldDefinitions:t,filterDefinitions:n,filters:r,headerTitle:i,id:i,tone:"primary"})})]}({fieldDefinitions:n,filterDefinitions:i,titleFilter:l});return 0===t.length?[...s,...Zp({fieldDefinitions:n,filterDefinitions:i,filters:o,headerTitle:"All fields",id:"field"})]:[...s,...function(e){let{documentTypesNarrowed:t,fieldDefinitions:n,filterDefinitions:i,filters:r,schema:l,types:a}=e,o=r.filter(e=>{var i;return i=D6(n,e),0===s3()(t,(null==i?void 0:i.documentTypes)||[]).length});return[...t.length>1&&a.length>1?Zp({fieldDefinitions:n,filterDefinitions:i,filters:o,headerTitle:"Shared fields",id:"shared",tone:"primary"}):[],...t.map(e=>{let t=l.get(e);return{title:(null==t?void 0:t.title)||op()(null==t?void 0:t.name)||"(Unknown type)",documentType:e}}).sort((e,t)=>e.title.localeCompare(t.title)).map(e=>{let{documentType:t,title:l}=e,a=r.filter(e=>{var i,r;return i=[t],null==(r=D6(n,e))?void 0:r.documentTypes.some(e=>i.includes(e))});return Zp({fieldDefinitions:n,filterDefinitions:i,filters:a,id:l,headerTitle:l})}).flat()]}({documentTypesNarrowed:t,fieldDefinitions:n,filterDefinitions:i,filters:o,schema:r,types:a})]})({documentTypesNarrowed:d,fieldDefinitions:c.fields,filterDefinitions:c.filters,schema:s,titleFilter:r,types:p}),[d,c.fields,c.filters,s,r,p]),f=(0,lJ.useCallback)(e=>"filter"===e.type?(0,lG.jsx)(Zw,{item:e,onClose:t,paddingBottom:1}):"header"===e.type?(0,lG.jsx)(Zk,{item:e}):null,[t]),m=(0,lJ.useCallback)(e=>{let t=h[e];return"filter"!==t.type||!!u.find(e=>D8(e)===D8(t.filter))},[h,u]),g=(0,lJ.useCallback)(e=>{let t=h[e];switch(t.type){case"filter":return[...t.group?[t.group]:[],D8(t.filter)].join("-");case"header":return"".concat(t.type,"-").concat(t.title);default:return e}},[h]);return(0,lG.jsxs)(l4.kC,{direction:"column",style:{width:"300px"},children:[(0,lG.jsx)(Zu,{ariaInputLabel:"Filter by title",onChange:a,onClear:o,ref:i,typeFilter:r}),(0,lG.jsxs)(l4.kC,{children:[h.length>0&&(0,lG.jsx)(ug,{activeItemDataAttr:"data-hovered",ariaLabel:"Filters",autoFocus:"input",getItemDisabled:m,getItemKey:g,inputElement:n,itemHeight:45,items:h,overscan:20,padding:1,paddingBottom:0,renderItem:f}),0==h.length&&(0,lG.jsx)(l4.xu,{padding:3,children:(0,lG.jsxs)(l4.xv,{muted:!0,size:1,textOverflow:"ellipsis",children:["No matches for '",r,"'"]})})]})]})}function Z_(){let[e,t]=(0,lJ.useState)(!1),[n,i]=(0,lJ.useState)(null),{state:{fullscreen:r}}=MI(),l=(0,lJ.useCallback)(()=>t(!1),[]),a=(0,lJ.useCallback)(()=>t(!0),[]);return(0,lG.jsx)(l4.J2,{__unstable_margins:[5,0,0,0],content:(0,lG.jsx)(Zr,{anchorElement:n,onClose:l,children:(0,lG.jsx)(ZC,{onClose:l})}),open:e,placement:"bottom-start",radius:2,portal:!0,children:(0,lG.jsx)(l4.zx,{fontSize:1,icon:a8.dtP,mode:"bleed",onClick:a,padding:r?3:2,ref:i,selected:e,space:2,text:"Add filter"})})}let ZS=lJ.memo(function(e){var t,n;let{selected:i,type:r,...l}=e,{dispatch:a}=MI(),o=(0,lJ.useCallback)(()=>{a({type:"TERMS_TYPE_ADD",schemaType:r})},[a,r]),s=(0,lJ.useCallback)(()=>{a({type:"TERMS_TYPE_REMOVE",schemaType:r})},[a,r]),d=(0,lJ.useCallback)(()=>{i?s():o()},[o,s,i]);return(0,lG.jsx)(l4.xu,{...l,children:(0,lG.jsx)(l4.zx,{fontSize:1,iconRight:i&&a8.KML,justify:"flex-start",mode:"bleed",onClick:d,style:{width:"100%"},tabIndex:-1,text:null!=(n=r.title)?n:r.name,tone:i?"primary":"default"},null!=(t=r.title)?t:r.name)})});var ZT=Object.freeze,ZE=Object.defineProperty;let ZP=(0,a0.ZP)(l4.xu)(lp||(lp=ZT(ZE(ex=["\n  border-top: 1px solid ",";\n  flex-shrink: 0;\n"],"raw",{value:ZT(ex.slice())}))),e=>{let{theme:t}=e;return t.sanity.color.base.border});function ZA(){let[e,t]=(0,lJ.useState)(null),[n,i]=(0,lJ.useState)(""),r=(0,lJ.useRef)(null),l=q6(),{dispatch:a,state:{terms:{types:o}}}=MI(),[s,d]=(0,lJ.useState)(o),c=(0,lJ.useMemo)(()=>{let[e,t]=so()(M$(l).filter(e=>{var t;return!n||(null!=(t=e.title)?t:e.name).toLowerCase().includes(null==n?void 0:n.toLowerCase())}).sort(MX),e=>s.includes(e)),i=e.length>0,r=e.length>0,a=[];return i&&a.push({title:"Selected",type:"header"}),e.forEach(e=>a.push({item:e,selected:o.includes(e),type:"item"})),i&&r&&a.push({type:"divider"}),t.forEach(e=>a.push({item:e,selected:o.includes(e),type:"item"})),a},[l,o,s,n]),u=(0,lJ.useCallback)(e=>i(e.currentTarget.value),[i]),p=(0,lJ.useCallback)(()=>i(""),[]),h=(0,lJ.useCallback)(()=>{var e,t;d([]),a({type:"TERMS_TYPES_CLEAR"}),null==(e=null==r?void 0:r.current)||e.focusInputElement(),null==(t=null==r?void 0:r.current)||t.scrollToIndex(0)},[a]),f=(0,lJ.useCallback)(e=>{let t=c[e];switch(t.type){case"divider":return"".concat(t.type,"-").concat(e);case"header":return"".concat(t.type,"-").concat(t.title);case"item":return"".concat(t.type,"-").concat(t.item.name);default:return e}},[c]),m=(0,lJ.useCallback)(e=>"divider"===e.type?(0,lG.jsx)(l4.xu,{paddingY:1,children:(0,lG.jsx)(l4.R,{})}):"header"===e.type?(0,lG.jsx)(l4.xu,{margin:1,paddingBottom:2,paddingTop:3,children:(0,lG.jsx)(l4.__,{muted:!0,size:0,children:e.title})}):"item"===e.type?(0,lG.jsx)(ZS,{paddingBottom:1,selected:e.selected,type:e.item}):null,[]),g=(0,lJ.useCallback)(e=>"item"!==c[e].type,[c]),x=(0,lJ.useCallback)(e=>{let t=c[e];return"item"===t.type&&t.selected},[c]);return(0,lG.jsxs)(l4.kC,{direction:"column",style:{width:"250px"},children:[(0,lG.jsx)(Zu,{ariaInputLabel:"Filter by document type",onChange:u,onClear:p,ref:t,typeFilter:n}),(0,lG.jsxs)(l4.kC,{children:[c.length>0&&(0,lG.jsx)(ug,{activeItemDataAttr:"data-hovered",ariaLabel:"Document types",ariaMultiselectable:!0,autoFocus:"input",getItemDisabled:g,getItemSelected:x,getItemKey:f,inputElement:e,itemHeight:37,items:c,overscan:20,padding:1,paddingBottom:0,ref:r,renderItem:m}),!c.length&&(0,lG.jsx)(l4.xu,{padding:3,children:(0,lG.jsxs)(l4.xv,{muted:!0,size:1,textOverflow:"ellipsis",children:["No matches for '",n,"'"]})})]}),!n&&o.length>0&&(0,lG.jsx)(ZO,{onClick:h,selectedTypes:o})]})}function ZO(e){let{onClick:t,selectedTypes:n}=e;return(0,lG.jsx)(ZP,{padding:1,children:(0,lG.jsx)(l4.Kq,{children:(0,lG.jsx)(l4.zx,{"aria-label":"Clear checked filters","data-name":"type-filter-button",disabled:0===n.length,fontSize:1,mode:"bleed",onClick:t,padding:3,text:"Clear",tone:"primary"})})})}var Zz=Object.freeze,ZM=Object.defineProperty,ZI=(e,t)=>Zz(ZM(e,"raw",{value:Zz(t||e.slice())}));let ZR=(0,a0.ZP)(l4.zx)(e=>{let{theme:t}=e,{regular:n}=t.sanity.fonts.text.weights;return(0,a0.iv)(lh||(lh=ZI(["\n    [data-ui='Text'] {\n      font-weight: ",";\n    }\n  "])),n)}),ZF=["top-start","bottom-start"];function ZD(){let[e,t]=(0,lJ.useState)(!1),[n,i]=(0,lJ.useState)(null),[r,l]=(0,lJ.useState)(null),{state:{fullscreen:a,terms:{types:o}}}=MI(),s=(0,lJ.useCallback)(()=>t(!1),[]),d=(0,lJ.useCallback)(()=>t(!0),[]);(0,l4.O8)(s,[n,r]);let c=(0,lJ.useMemo)(()=>M0({types:o}),[o]);return(0,lG.jsx)(l4.J2,{__unstable_margins:[5,0,0,0],content:(0,lG.jsx)(Zr,{anchorElement:n,onClose:s,children:(0,lG.jsx)(ZA,{})}),open:e,placement:"bottom-start",fallbackPlacements:ZF,portal:!0,radius:2,ref:l,children:(0,lG.jsx)(ZR,{fontSize:1,iconRight:a8.GVG,mode:"ghost",onClick:d,padding:a?3:2,ref:i,selected:e,style:{maxWidth:"100%"},text:c,tone:"default"})})}var ZZ=Object.freeze,ZL=Object.defineProperty;let Zq=(0,a0.ZP)(l4.xu)(lf||(lf=ZZ(ZL(ev=["\n  flex-shrink: ",";\n"],"raw",{value:ZZ(ev.slice())}))),e=>{let{$flexShrink:t=0}=e;return t});function ZN(e){let{filter:t,fontSize:n=1,showContent:i=!0}=e,{state:{definitions:r,fullscreen:l}}=MI(),a=D3(r.operators,t.operatorType),o=null==a?void 0:a.buttonValueComponent;return(0,lG.jsxs)(l4.kC,{align:"center",gap:1,children:[(0,lG.jsx)(Zq,{$flexShrink:l?1:0,children:(0,lG.jsx)(p6,{tone:"default",size:n,textOverflow:"ellipsis",weight:"semibold",children:(0,lG.jsx)(Zg,{filter:t,maxLength:l?25:40})})}),i&&(null==a?void 0:a.buttonLabel)&&(0,lG.jsx)(Zq,{$flexShrink:0,children:(0,lG.jsx)(p6,{tone:"default",size:n,textOverflow:"ellipsis",weight:"regular",children:a.buttonLabel})}),i&&o&&(0,lG.jsx)(Zq,{$flexShrink:1,children:(0,lG.jsx)(p6,{tone:"default",size:n,textOverflow:"ellipsis",weight:"semibold",children:(0,lG.jsx)(o,{value:null==t?void 0:t.value})})})]})}function ZV(e){return(0,lG.jsx)(l4.xu,{...e,children:(0,lG.jsxs)(l4.kC,{align:"flex-start",gap:3,children:[(0,lG.jsx)(p6,{tone:"critical",children:(0,lG.jsx)(a8.uIy,{})}),(0,lG.jsxs)(l4.Kq,{space:4,children:[(0,lG.jsx)(p6,{size:1,tone:"critical",weight:"semibold",children:"An error occurred whilst displaying this filter."}),(0,lG.jsx)(p6,{size:1,tone:"critical",children:"This may indicate invalid options defined in your schema."})]})]})})}function ZU(e){let{onClick:t,operator:n,selected:i}=e,r=(0,lJ.useCallback)(()=>t(n.type),[t,n.type]);return(0,lG.jsx)(l4.sN,{onClick:r,padding:3,pressed:i,tone:"default",children:(0,lG.jsxs)(l4.kC,{align:"center",justify:"space-between",gap:3,children:[(0,lG.jsx)(l4.xu,{paddingRight:2,children:(0,lG.jsx)(l4.xv,{size:1,weight:"regular",children:n.label})}),(null==n?void 0:n.icon)&&(0,lG.jsx)(l4.xv,{muted:!0,size:1,children:(0,lJ.createElement)(n.icon)})]})})}function ZB(e){var t;let{filter:n,operator:i}=e,r=(0,lJ.useId)(),{dispatch:l,state:a}=MI(),o=null==(t=a.definitions.filters[n.filterName])?void 0:t.operators,s=(0,lJ.useCallback)(e=>{l({filterKey:D8(n),operatorType:e,type:"TERMS_FILTERS_SET_OPERATOR"})},[l,n]);return i&&o&&!(o.length<=1)?(0,lG.jsx)(l4.gF,{children:(0,lG.jsx)(l4.j2,{button:(0,lG.jsx)(l4.zx,{mode:"ghost",padding:3,children:(0,lG.jsxs)(l4.kC,{align:"center",gap:2,justify:"space-between",children:[(0,lG.jsx)(l4.xv,{size:a.fullscreen?2:1,weight:"regular",children:i.label}),(0,lG.jsx)(l4.xu,{marginLeft:1,children:(0,lG.jsx)(l4.xv,{size:1,children:(0,lG.jsx)(a8.GVG,{})})})]})}),id:r||"",menu:(0,lG.jsx)(l4.v2,{children:o.map((e,t)=>{if("item"===e.type){let n=D3(a.definitions.operators,e.name);return n?(0,lG.jsx)(ZU,{onClick:s,operator:n,selected:i.type===e.name},t):null}return"divider"===e.type?(0,lG.jsx)(l4.R,{},t):null})}),placement:"bottom-start",popover:{constrainSize:!0,portal:!1,radius:2}})}):null}function ZK(e){let{filter:t}=e,[n,i]=(0,lJ.useState)(null),{dispatch:r,state:{definitions:l,fullscreen:a}}=MI(),o=l.filters[t.filterName],s=D3(l.operators,t.operatorType),d=D6(l.fields,t),c=D8(t),u=(0,lJ.useCallback)(()=>{r({filterKey:D8(t),type:"TERMS_FILTERS_REMOVE"})},[r,t]),p=(0,lJ.useCallback)(e=>{r({filterKey:c,type:"TERMS_FILTERS_SET_VALUE",value:e})},[r,c]),h=(0,lJ.useCallback)(e=>{i(e)},[]),f=null==s?void 0:s.inputComponent;return n?(0,lG.jsx)(ZV,{padding:4}):(0,lG.jsx)(l4.SV,{onCatch:h,children:(0,lG.jsx)(a7.ZP,{autoFocus:!cP,returnFocus:!0,children:(0,lG.jsxs)(l4.kC,{direction:"column-reverse",children:[f&&(0,lG.jsx)(l4.Zb,{borderTop:!0,padding:3,children:(0,lG.jsx)(f,{fieldDefinition:d,onChange:p,value:t.value},t.operatorType)}),(0,lG.jsx)(l4.Zb,{padding:3,children:(0,lG.jsxs)(l4.Kq,{space:3,children:[(0,lG.jsxs)(l4.kC,{align:"flex-start",gap:3,justify:"space-between",children:[(0,lG.jsx)(l4.xu,{paddingBottom:1,paddingLeft:1,paddingRight:2,paddingTop:a?2:1,children:(0,lG.jsx)(Zv,{filter:t,small:!a})}),a&&(0,lG.jsx)(l4.zx,{fontSize:2,icon:a8.XHJ,mode:"bleed",onClick:u,padding:2,tone:"critical"})]}),(null==o?void 0:o.description)&&(0,lG.jsx)(l4.Zb,{border:!0,padding:3,radius:2,tone:"transparent",children:(0,lG.jsx)(l4.xv,{muted:!0,size:1,children:o.description})}),(0,lG.jsx)(ZB,{filter:t,operator:s})]})})]})})})}var ZH=Object.freeze,ZW=Object.defineProperty;let Z$=(0,a0.ZP)(l4.kC)(lm||(lm=ZH(ZW(eb=["\n  max-width: 480px;\n  min-width: 150px;\n  overflow: hidden;\n  overflow: clip;\n  width: 100%;\n"],"raw",{value:ZH(eb.slice())}))));function ZX(e){let{filter:t}=e;return(0,lG.jsxs)(Z$,{direction:"column",children:[(0,lG.jsx)(ZK,{filter:t}),!1]})}var ZG=Object.freeze,ZY=Object.defineProperty,ZJ=(e,t)=>ZG(ZY(e,"raw",{value:ZG(t||e.slice())}));let ZQ=(0,a0.ZP)(l4.zx)(lg||(lg=ZJ(["\n  border-radius: ",";\n"])),e=>{let{theme:t}=e;return"0 ".concat((0,l4.hO)(t.sanity.radius[2])," ").concat((0,l4.hO)(t.sanity.radius[2])," 0")}),Z0=(0,a0.ZP)(l4.Zb)(lx||(lx=ZJ(["\n  position: absolute;\n  right: 0;\n"]))),Z1=a0.ZP.div(lv||(lv=ZJ(["\n  align-items: center;\n  display: inline-flex;\n  max-width: 100%;\n  position: relative;\n"]))),Z2=(0,a0.ZP)(l4.zx)(lb||(lb=ZJ(["\n  border: none;\n  width: 100%;\n"])));function Z3(e){let{filter:t,initialOpen:n}=e,[i,r]=(0,lJ.useState)(n),{dispatch:l,state:{definitions:a,fullscreen:o}}=MI(),s=(0,lJ.useCallback)(()=>r(!1),[]),d=(0,lJ.useCallback)(()=>r(!0),[]),c=(0,lJ.useCallback)(()=>l({filterKey:D8(t),type:"TERMS_FILTERS_REMOVE"}),[l,t]),u=(0,lJ.useCallback)(e=>{["Backspace","Delete"].includes(e.key)&&c()},[c]),p=D7({fieldDefinitions:a.fields,filter:t,filterDefinitions:a.filters,operatorDefinitions:a.operators});return(0,lG.jsx)(l4.J2,{__unstable_margins:[5,0,0,0],content:(0,lG.jsx)(Zr,{onClose:s,children:(0,lG.jsx)(ZX,{filter:t})}),constrainSize:!0,open:i,overflow:"auto",placement:"bottom-start",portal:!0,radius:2,children:(0,lG.jsxs)(Z1,{children:[(0,lG.jsx)(l4.Zb,{__unstable_focusRing:!0,display:"flex",radius:2,tone:p?"primary":"transparent",children:(0,lG.jsx)(Z2,{mode:"bleed",onClick:d,onKeyDown:u,paddingLeft:o?3:2,paddingRight:o?3:5,paddingY:o?3:2,children:(0,lG.jsx)(ZN,{filter:t,showContent:p})})}),!o&&(0,lG.jsx)(Z0,{__unstable_focusRing:!0,display:"flex",radius:2,tone:p?"primary":"transparent",children:(0,lG.jsx)(ZQ,{"aria-label":"Delete filter",fontSize:1,icon:a8.Two,mode:"bleed",onClick:c,onKeyDown:u,padding:2,radius:2})})]})})}function Z4(){let{dispatch:e,state:{filters:t,fullscreen:n,lastAddedFilter:i,terms:{types:r}}}=MI(),l=(0,lJ.useRef)(!1),a=(0,lJ.useCallback)(()=>{e({type:"TERMS_FILTERS_CLEAR"}),e({type:"TERMS_TYPES_CLEAR"})},[e]),o=t.length>0||r.length>0;(0,lJ.useEffect)(()=>{l.current=!0},[]);let s=i&&D8(i),d=()=>(0,lG.jsx)(l4.zx,{fontSize:1,mode:"bleed",onClick:a,padding:n?3:2,text:"Clear filters",tone:"critical"});return(0,lG.jsxs)(lG.Fragment,{children:[(0,lG.jsxs)(l4.kC,{align:"flex-start",gap:3,justify:"space-between",padding:2,children:[(0,lG.jsxs)(l4.kC,{flex:1,gap:2,wrap:"wrap",children:[(0,lG.jsx)(ZD,{}),null==t?void 0:t.map(e=>{let t=D8(e);return(0,lG.jsx)(Z3,{filter:e,initialOpen:l.current&&s===t},t)}),!n&&(0,lG.jsx)(Z_,{})]}),o&&!n&&(0,lG.jsx)(d,{})]}),n&&(0,lG.jsxs)(l4.kC,{justify:"space-between",paddingBottom:2,paddingX:2,children:[(0,lG.jsx)(Z_,{}),o&&(0,lG.jsx)(d,{})]}),!1]})}function Z5(){return(0,lG.jsx)(l4.kC,{align:"center",direction:"column",gap:4,paddingX:4,paddingY:5,children:(0,lG.jsxs)(l4.gF,{space:3,children:[(0,lG.jsx)(l4.xv,{muted:!0,children:"Use"}),(0,lG.jsx)(l4.xv,{muted:!0,children:(0,lG.jsx)(a8.d$S,{})}),(0,lG.jsx)(l4.xv,{muted:!0,children:"to refine your search"})]})})}function Z6(e){let{availableCharacters:t,types:n}=e,i=(0,lJ.useMemo)(()=>M0({availableCharacters:t,types:n}),[t,n]);return(0,lG.jsx)(l4.Zb,{border:!0,padding:2,radius:2,children:(0,lG.jsx)(l4.xv,{muted:!0,size:1,children:i})})}var Z8=Object.freeze,Z9=Object.defineProperty;let Z7=(0,a0.ZP)(l4.Zb)(ly||(ly=Z8(Z9(ey=["\n  cursor: default;\n"],"raw",{value:Z8(ey.slice())}))));function Le(e){let{filter:t}=e;return(0,lG.jsx)(Z7,{border:!0,padding:2,radius:2,tone:"primary",children:(0,lG.jsx)(ZN,{filter:t})})}var Lt=Object.freeze,Ln=Object.defineProperty,Li=(e,t)=>Lt(Ln(e,"raw",{value:Lt(t||e.slice())}));let Lr=(0,a0.ZP)(l4.zx)(lj||(lj=Li(["\n  border-radius: ",";\n  cursor: default;\n  width: 100%;\n"])),e=>{let{theme:t}=e;return(0,l4.hO)(t.sanity.radius[2])}),Ll=(0,a0.ZP)(l4.xu)(lw||(lw=Li(["\n  flex-shrink: 3;\n"]))),La=(0,a0.ZP)(l4.xu)(lk||(lk=Li(["\n  flex-shrink: 2;\n"]))),Lo=a0.ZP.div(lC||(lC=Li(["\n  opacity: 0.8;\n  visibility: hidden;\n\n  @media (hover: hover) {\n    ",":hover & {\n      visibility: visible;\n    }\n    &:hover {\n      opacity: 0.4;\n    }\n  }\n"])),Lr);function Ls(e){var t;let{index:n,maxVisibleTypePillChars:i=40,value:r,...l}=e,{dispatch:a,recentSearchesStore:o}=MI(),s=i-r.query.length,d=(0,lJ.useCallback)(()=>{a({type:"TERMS_SET",filters:null==r?void 0:r.filters,terms:r}),o&&a({recentSearches:null==o?void 0:o.addSearch(r,null==r?void 0:r.filters),type:"RECENT_SEARCHES_SET"})},[a,o,r]),c=(0,lJ.useCallback)(e=>{e.stopPropagation(),o&&a({recentSearches:null==o?void 0:o.removeSearchAtIndex(n),type:"RECENT_SEARCHES_SET"})},[a,n,o]);return(0,lG.jsx)(l4.xu,{...l,children:(0,lG.jsx)(Lr,{mode:"bleed",onClick:d,paddingLeft:3,paddingRight:1,paddingY:1,tabIndex:-1,children:(0,lG.jsxs)(l4.kC,{align:"stretch",children:[(0,lG.jsxs)(l4.gF,{paddingY:2,children:[(0,lG.jsx)(l4.xv,{muted:!0,size:1,children:(0,lG.jsx)(a8.T39,{})}),(0,lG.jsx)(l4.xv,{children:"​"})]}),(0,lG.jsxs)(l4.kC,{align:"stretch",flex:1,gap:2,justify:"flex-start",marginLeft:3,wrap:"wrap",children:[r.query&&(0,lG.jsx)(La,{paddingY:2,children:(0,lG.jsx)(l4.xv,{muted:!0,textOverflow:"ellipsis",children:r.query})}),r.types.length>0&&(0,lG.jsx)(Ll,{children:(0,lG.jsx)(Z6,{availableCharacters:s,types:r.types})}),null==(t=null==r?void 0:r.filters)?void 0:t.map((e,t)=>(0,lG.jsx)(Le,{filter:e},t))]}),(0,lG.jsx)(l4.kC,{align:"center",children:(0,lG.jsx)(Lo,{onClick:c,children:(0,lG.jsx)(l4.kC,{padding:2,children:(0,lG.jsx)(l4.xv,{size:1,children:(0,lG.jsx)(a8.Two,{})})})})})]})})})}var Ld=Object.freeze,Lc=Object.defineProperty;let Lu=(0,a0.ZP)(l4.Zb)(l_||(l_=Ld(Lc(ej=["\n  overflow-x: hidden;\n  overflow-y: auto;\n  position: relative;\n"],"raw",{value:Ld(ej.slice())}))));function Lp(e){let{inputElement:t}=e,{dispatch:n,recentSearchesStore:i,state:{filtersVisible:r,fullscreen:l,recentSearches:a}}=MI(),o=(0,lJ.useRef)(null),s=(0,lJ.useCallback)(()=>{var e;i&&n({recentSearches:i.removeSearch(),type:"RECENT_SEARCHES_SET"}),null==(e=null==o?void 0:o.current)||e.focusInputElement()},[n,i]),d=(0,l4.d2)(),c=(0,lJ.useMemo)(()=>d<2?20:40,[d]),u=(0,lJ.useCallback)((e,t)=>{let{virtualIndex:n}=t;return(0,lG.jsx)(Ls,{index:n,maxVisibleTypePillChars:c,paddingBottom:1,value:e})},[c]),p=!!a.length;return(0,lG.jsx)(Lu,{borderTop:p||!p&&!r&&l,flex:1,children:a.length?(0,lG.jsxs)(lG.Fragment,{children:[(0,lG.jsx)(l4.xu,{paddingBottom:2,paddingTop:4,paddingX:3,children:(0,lG.jsx)(l4.__,{muted:!0,size:1,children:"Recent searches"})}),(0,lG.jsx)(l4.xu,{children:(0,lG.jsx)(ug,{activeItemDataAttr:"data-hovered",ariaLabel:"Recent searches",inputElement:t,initialIndex:0,itemHeight:36,items:a,paddingX:2,paddingY:1,renderItem:u})}),(0,lG.jsx)(l4.xu,{paddingBottom:2,paddingTop:1,paddingX:2,children:(0,lG.jsx)(l4.zx,{fontSize:1,justify:"flex-start",mode:"bleed",onClick:s,padding:2,tone:"default",children:(0,lG.jsx)(l4.xv,{muted:!0,size:1,children:"Clear recent searches"})})})]}):!r&&l&&(0,lG.jsx)(Z5,{})})}var Lh=Object.freeze,Lf=Object.defineProperty,Lm=(e,t)=>Lh(Lf(e,"raw",{value:Lh(t||e.slice())}));let Lg=(0,a0.F4)(lS||(lS=Lm(["\n  from {\n    transform: rotate(0deg);\n  }\n  to {\n    transform: rotate(360deg);\n  }\n"]))),Lx=(0,a0.ZP)(a8.L4p)(lT||(lT=Lm(["\n  animation: "," 500ms linear infinite;\n"])),Lg),Lv=(0,a0.ZP)(l4.xu)(lE||(lE=Lm(["\n  position: relative;\n"]))),Lb=a0.ZP.div(lP||(lP=Lm(["\n  background: ",";\n  border-radius: 100%;\n  height: 6px;\n  position: absolute;\n  right: 2px;\n  top: 2px;\n  width: 6px;\n"])),e=>{var t;let{theme:n}=e;return null==(t=n.sanity.color.selectable)?void 0:t.primary.enabled.fg}),Ly=(0,lJ.forwardRef)(function(e,t){let{ariaInputLabel:n,onClose:i}=e,r=(0,lJ.useRef)(!1),{dispatch:l,state:{filters:a,filtersVisible:o,fullscreen:s,result:{loading:d},terms:{types:c,query:u}}}=MI(),p=(0,lJ.useCallback)(()=>l({type:"FILTERS_VISIBLE_SET",visible:!o}),[l,o]),h=(0,lJ.useCallback)(e=>l({type:"TERMS_QUERY_SET",query:e.currentTarget.value}),[l]),f=(0,lJ.useCallback)(()=>{l({type:"TERMS_QUERY_SET",query:""})},[l]);(0,lJ.useEffect)(()=>{s||l({type:"FILTERS_VISIBLE_SET",visible:!0})},[l,s]),(0,lJ.useEffect)(()=>{r.current=!0},[]);let m=a.length>0||c.length>0;return(0,lG.jsx)(l4.Zb,{flex:"none",children:(0,lG.jsxs)(l4.kC,{align:"center",flex:1,gap:s?2:1,padding:s?2:1,children:[s&&(0,lG.jsx)(l4.Zb,{children:(0,lG.jsx)(l4.zx,{"aria-label":"Close search",icon:a8.Y4O,mode:"bleed",onClick:i})}),(0,lG.jsx)(l4.xu,{flex:1,children:(0,lG.jsx)(I9,{"aria-label":n,autoComplete:"off",background:s,border:!1,clearButton:!!u,fontSize:2,icon:d?Lx:a8.W1M,onChange:h,onClear:f,placeholder:"Search",radius:s?2:1,ref:t,smallClearButton:s,spellCheck:!1,value:u})}),s&&(0,lG.jsxs)(Lv,{children:[(0,lG.jsx)(l4.zx,{"aria-expanded":o,"aria-label":"Toggle filters",height:"fill",icon:a8.d$S,mode:"bleed",onClick:p,padding:3,selected:o,tone:"default"}),m&&(0,lG.jsx)(Lb,{})]})]})})});function Lj(){return(0,lG.jsx)(l4.W2,{width:0,children:(0,lG.jsxs)(l4.Kq,{"aria-live":"assertive",space:4,paddingX:4,paddingY:5,children:[(0,lG.jsx)(l4.xv,{align:"center",muted:!0,weight:"semibold",children:"No results found"}),(0,lG.jsx)(l4.xv,{align:"center",muted:!0,size:1,children:"Try another keyword or adjust your filters"})]})})}function Lw(){return(0,lG.jsxs)(l4.kC,{align:"center","aria-live":"assertive",direction:"column",flex:1,gap:3,marginY:2,padding:4,children:[(0,lG.jsx)(l4.xu,{marginBottom:1,children:(0,lG.jsx)(p6,{tone:"critical",children:(0,lG.jsx)(a8.foC,{})})}),(0,lG.jsx)(p6,{size:2,tone:"critical",weight:"semibold",children:"Something went wrong while searching"}),(0,lG.jsx)(p6,{size:1,tone:"critical",children:"Please try again or check your connection"})]})}let Lk={createdAsc:{ignoreScore:!0,sort:{direction:"asc",field:"_createdAt"},title:"Created: Oldest first"},createdDesc:{ignoreScore:!0,sort:{direction:"desc",field:"_createdAt"},title:"Created: Newest first"},relevance:{customMeasurementLabel:"relevance",sort:{direction:"desc",field:"_updatedAt"},title:"Best match"},updatedAsc:{ignoreScore:!0,sort:{direction:"asc",field:"_updatedAt"},title:"Updated: Oldest first"},updatedDesc:{ignoreScore:!0,sort:{direction:"desc",field:"_updatedAt"},title:"Updated: Newest first"}};var LC=Object.freeze,L_=Object.defineProperty;let LS=[Lk.relevance,{type:"divider"},Lk.createdAsc,Lk.createdDesc,{type:"divider"},Lk.updatedAsc,Lk.updatedDesc],LT=(0,a0.ZP)(l4.kC)(lA||(lA=LC(L_(ew=["\n  box-sizing: border-box;\n"],"raw",{value:LC(ew.slice())}))));function LE(e){return"divider"===e.type}function LP(e){let{ordering:t}=e,{dispatch:n,state:{ordering:i}}=MI(),r=(0,lJ.useCallback)(()=>{n({ordering:t,type:"ORDERING_SET"})},[n,t]),l=(0,lJ.useMemo)(()=>aG()(i,t),[i,t]);return(0,lG.jsx)(l4.sN,{onClick:r,padding:3,pressed:l,tone:"default",children:(0,lG.jsx)(l4.kC,{align:"center",justify:"space-between",paddingRight:2,children:(0,lG.jsx)(l4.xv,{size:1,weight:"medium",children:t.title})})})}function LA(){let{state:{ordering:e}}=MI(),t=(0,lJ.useId)(),n=LS.find(t=>aG()(e,t)&&!LE(t));return n?(0,lG.jsx)(l4.Zb,{borderBottom:!0,children:(0,lG.jsx)(LT,{align:"center",flex:1,padding:2,children:(0,lG.jsx)(l4.j2,{button:(0,lG.jsx)(l4.zx,{mode:"bleed",padding:2,children:(0,lG.jsxs)(l4.kC,{align:"center",gap:1,justify:"space-between",children:[(0,lG.jsx)(l4.xu,{marginRight:1,children:(0,lG.jsx)(l4.xv,{size:1,children:(0,lG.jsx)(a8.fzI,{})})}),(0,lG.jsx)(l4.gF,{space:2,children:(0,lG.jsx)(l4.xv,{size:1,weight:"medium",children:n.title})})]})}),id:t||"",menu:(0,lG.jsx)(l4.v2,{children:LS.map((e,t)=>LE(e)?(0,lG.jsx)(l4.R,{},t):(0,lG.jsx)(LP,{ordering:e},t))}),placement:"bottom-start",popover:{portal:!0,radius:2}})})}):null}var LO=Object.freeze,Lz=Object.defineProperty;let LM=(0,a0.ZP)(l4.Zb)(lO||(lO=LO(Lz(ek=["\n  cursor: help;\n  left: 0;\n  position: absolute;\n  top: 0;\n"],"raw",{value:LO(ek.slice())}))));function LI(e){let{data:t}=e,{score:n}=t,i="default";n<=.1?i="critical":n>=.5&&(i="primary");let r=t.stories.filter(e=>e.score>0);return(0,lG.jsx)(lG.Fragment,{children:(0,lG.jsx)(l4.u,{content:(0,lG.jsx)(l4.xu,{padding:2,children:(0,lG.jsx)(l4.Kq,{space:2,children:r.length?(0,lG.jsx)(lG.Fragment,{children:r.map(e=>(0,lG.jsxs)(l4.gF,{space:3,children:[(0,lG.jsx)(l4.EK,{size:0,weight:"semibold",children:e.path}),(0,lG.jsx)(l4.EK,{size:0,children:e.why})]},e.path))}):(0,lG.jsx)(l4.EK,{size:0,children:"No matches"})})}),placement:"bottom-start",portal:!0,children:(0,lG.jsx)(LM,{padding:1,shadow:1,tone:i,children:(0,lG.jsxs)(l4.EK,{size:0,children:["score: ",n]})})})})}var LR=Object.freeze,LF=Object.defineProperty;let LD=(0,a0.ZP)(l4.kC)(lz||(lz=LR(LF(eC=["\n  opacity: ",";\n  overflow-x: hidden;\n  overflow-y: auto;\n  position: relative;\n  transition: 300ms opacity;\n  width: 100%;\n"],"raw",{value:LR(eC.slice())}))),e=>{let{$loading:t}=e;return t?.5:1});function LZ(e){let{inputElement:t}=e,{dispatch:n,onClose:i,recentSearchesStore:r,setSearchCommandList:l,state:{debug:a,filters:o,fullscreen:s,lastActiveIndex:d,result:c,terms:u}}=MI(),p=!!c.hits.length,h=!c.hits.length&&c.loaded,f=c.error,m=(0,lJ.useCallback)(()=>{r&&n({recentSearches:r.addSearch(u,o),type:"RECENT_SEARCHES_SET"}),null==i||i()},[n,o,i,r,u]),g=(0,lJ.useCallback)(e=>(0,lG.jsxs)(lG.Fragment,{children:[(0,lG.jsx)(MB,{documentId:cd(e.hit._id)||"",documentType:e.hit._type,onClick:m,paddingBottom:2}),a&&(0,lG.jsx)(LI,{data:e})]}),[a,m]);return(0,lG.jsx)(l4.kC,{children:(0,lG.jsx)(l4.Zb,{borderTop:s||!!(f||p||h),flex:1,children:(0,lG.jsxs)(l4.kC,{direction:"column",height:"fill",children:[p&&(0,lG.jsx)(LA,{}),(0,lG.jsx)(LD,{$loading:c.loading,"aria-busy":c.loading,flex:1,children:f?(0,lG.jsx)(Lw,{}):(0,lG.jsxs)(lG.Fragment,{children:[p&&(0,lG.jsx)(ug,{activeItemDataAttr:"data-hovered",ariaLabel:"Search results",fixedHeight:!0,initialIndex:d,inputElement:t,itemHeight:59,items:c.hits,overscan:4,padding:2,paddingBottom:0,ref:l,renderItem:g}),h&&(0,lG.jsx)(Lj,{})]})})]})})})}var LL=Object.freeze,Lq=Object.defineProperty,LN=(e,t)=>LL(Lq(e,"raw",{value:LL(t||e.slice())}));let LV=(0,a0.ZP)(l4.Zb)(lM||(lM=LN(["\n  flex-direction: column;\n  overflow: hidden;\n  overflow: clip;\n  pointer-events: all;\n  position: relative;\n"]))),LU=(0,a0.ZP)(l4.xu)(lI||(lI=LN(["\n  height: 100%;\n  left: 0;\n  overflow: hidden;\n  overflow: clip;\n  pointer-events: none;\n  position: fixed;\n  top: 0;\n  width: 100%;\n  z-index: 1;\n"])));function LB(e){let{onClose:t,onOpen:n,open:i}=e,[r,l]=(0,lJ.useState)(null),{scheme:a}=R8(),{state:{filtersVisible:o,terms:s}}=MI(),d=MW({terms:s});return(0,lG.jsx)(D2,{hasValidTerms:d,onClose:t,onOpen:n,open:i,children:(0,lG.jsx)(l4.h_,{children:(0,lG.jsx)(a7.ZP,{autoFocus:!cP,returnFocus:!0,children:(0,lG.jsx)(LU,{children:(0,lG.jsxs)(LV,{display:"flex",height:"fill",scheme:a,tone:"default",children:[(0,lG.jsx)(Ly,{ariaInputLabel:d?"Search results":"Recent searches",onClose:t,ref:l}),o&&(0,lG.jsx)(l4.Zb,{borderTop:!0,flex:"none",children:(0,lG.jsx)(Z4,{})}),d?(0,lG.jsx)(LZ,{inputElement:r}):(0,lG.jsx)(Lp,{inputElement:r})]})})})})})}var LK=Object.freeze,LH=Object.defineProperty,LW=(e,t)=>LK(LH(e,"raw",{value:LK(t||e.slice())}));let L$=(0,a0.ZP)(l4.kC)(lR||(lR=LW(["\n  position: absolute;\n  right: 0;\n  top: 0;\n\n  & > :first-child {\n    margin-right: 1px;\n  }\n"]))),LX=(0,a0.ZP)(l4.kC)(lF||(lF=LW(["\n  min-width: 253px;\n  max-width: 350px;\n  position: relative;\n"]))),LG=(0,a0.ZP)(l4.oi)(lD||(lD=LW(["\n  padding-right: 60px;\n"]))),LY=(0,lJ.forwardRef)(function(e,t){let{onOpen:n}=e,{dispatch:i,state:{terms:r}}=MI(),l=(0,lJ.useCallback)(e=>{i({type:"TERMS_QUERY_SET",query:e.currentTarget.value}),n()},[i,n]),a=(0,lJ.useCallback)(e=>{"Enter"===e.key&&n()},[n]);return(0,lG.jsxs)(LX,{align:"center",children:[(0,lG.jsx)(LG,{"aria-autocomplete":"list","aria-expanded":"false",autoComplete:"off",icon:a8.W1M,"data-testid":"studio-search",onChange:l,onClick:n,onKeyDown:a,placeholder:"Search",radius:2,ref:t,role:"combobox",value:r.query}),(0,lG.jsxs)(L$,{align:"center",height:"fill",marginRight:2,children:[(0,lG.jsx)(l4.WB,{children:MK}),(0,lG.jsx)(l4.WB,{children:"K"})]})]})});var LJ=Object.freeze,LQ=Object.defineProperty,L0=(e,t)=>LJ(LQ(e,"raw",{value:LJ(t||e.slice())}));let L1=a0.ZP.div(lZ||(lZ=L0(["\n  background-color: ",";\n  bottom: 0;\n  left: 0;\n  position: absolute;\n  right: 0;\n  top: 0;\n"])),e=>{let{theme:t}=e;return t.sanity.color.base.shadow.ambient}),L2=(0,a0.ZP)(l4.Zb)(lN||(lN=L0(["\n  ","\n  display: flex !important;\n  flex-direction: column;\n  max-height: ",";\n  position: absolute;\n  top: ","px;\n  width: min(calc(100vw - ","px), ","px);\n"])),e=>{let{$position:t}=e;return t.x?(0,a0.iv)(lL||(lL=L0(["\n          left: ","px;\n        "])),t.x):(0,a0.iv)(lq||(lq=L0(["\n          left: 50%;\n          transform: translateX(-50%);\n        "])))},e=>{let{$position:t}=e;return"min(calc(100vh - ".concat(t.y,"px - ").concat(MH,"px), ").concat(735,"px)")},e=>{let{$position:t}=e;return t.y},2*MH,800);function L3(e){let{disableFocusLock:t,onClose:n,onOpen:i,open:r,position:l}=e,[a,o]=(0,lJ.useState)(null),[s,d]=(0,lJ.useState)(null),{isTopLayer:c,zIndex:u}=(0,l4.sJ)(),{scheme:p}=R8(),{onClose:h,state:{filtersVisible:f,terms:m}}=MI(),g=MW({terms:m}),x=(0,lJ.useCallback)(()=>{c&&h&&r&&h()},[c,h,r]);return(0,l4.O8)(x,[a]),(0,lG.jsx)(D2,{hasValidTerms:g,onClose:n,onOpen:i,open:r,children:(0,lG.jsx)(l4.h_,{children:(0,lG.jsxs)(a7.ZP,{autoFocus:!cP,disabled:t,returnFocus:!0,children:[(0,lG.jsx)(L1,{style:{zIndex:u}}),(0,lG.jsxs)(L2,{$position:l,overflow:"hidden",radius:2,ref:o,scheme:p,shadow:2,style:{zIndex:u},children:[(0,lG.jsx)(Ly,{ariaInputLabel:g?"Search results":"Recent searches",onClose:n,ref:d}),f&&(0,lG.jsx)(l4.Zb,{borderTop:!0,flex:"none",children:(0,lG.jsx)(Z4,{})}),g?(0,lG.jsx)(LZ,{inputElement:s}):(0,lG.jsx)(Lp,{inputElement:s})]})]})})})}function L4(){let[e,t]=(0,lJ.useState)(null),[n,i]=(0,lJ.useState)(!1),r=(0,lJ.useCallback)(()=>i(!1),[]),l=(0,lJ.useCallback)(()=>i(!0),[]),a=function(e){let[t,n]=(0,lJ.useState)(null),i=(0,lJ.useCallback)(()=>{e&&n(L5(e))},[e]);return(0,lJ.useEffect)(()=>{e&&n(L5(e))},[e]),(0,lJ.useEffect)(()=>(window.addEventListener("resize",i),()=>window.removeEventListener("resize",i)),[i]),t}(e);return(0,lG.jsxs)(lG.Fragment,{children:[(0,lG.jsx)(LY,{onOpen:l,ref:t}),a&&(0,lG.jsx)(L3,{onClose:r,onOpen:l,open:n,position:a})]})}function L5(e){let t=e.getBoundingClientRect();return{x:window.innerWidth-t.x>800?t.x-MH:null,y:t.y-MH}}function L6(e,t){let n=L9?window.localStorage.getItem(e):void 0;return n?JSON.parse(n):{version:t,recentSearches:[]}}function L8(e){let{lsKey:t,schema:n,fieldDefinitions:i,filterDefinitions:r,operatorDefinitions:l,version:a}=e;return(function(e){let{fieldDefinitions:t,filterDefinitions:n,lsKey:i,operatorDefinitions:r,storedSearch:l,studioSchema:a,version:o}=e,s=M$(a).map(e=>e.name),d={version:2,recentSearches:l.recentSearches.filter(e=>e.terms.typeNames.every(e=>s.includes(e))&&e.filters.every(e=>D7({fieldDefinitions:t,filter:e,filterDefinitions:n,operatorDefinitions:r})))};return d.recentSearches.length<l.recentSearches.length&&window.localStorage.setItem(i,JSON.stringify(d)),L6(i,o)})({studioSchema:n,storedSearch:function(e){let{lsKey:t,storedSearch:n}=e;if(2!==n.version){let e={version:2,recentSearches:[]};return window.localStorage.setItem(t,JSON.stringify(e)),e}return n}({lsKey:t,storedSearch:L6(t,a)}),lsKey:t,filterDefinitions:r,fieldDefinitions:i,operatorDefinitions:l,version:a}).recentSearches.filter(e=>!!e.terms).map((e,t)=>({__recent:{index:t,timestamp:new Date(e.created).getTime()},filters:e.filters,query:e.terms.query,types:e.terms.typeNames.map(e=>n.get(e)).filter(e=>!!(e&&"object"===e.jsonType))}))}let L9=(()=>{let e="__tmp__can_use";try{if("undefined"==typeof localStorage)return!1;return localStorage.setItem(e,"---"),localStorage.removeItem(e),!0}catch(e){return!1}})();function L7(e){return{...e,id:[e.type,e.fieldPath,e.filterName,e.documentTypes.join(",")].join("-")}}function qe(e){return"array"===e.type}function qt(e){return"document"===e.type}function qn(e){return"object"===e.type}function qi(e,t){let n=e.titlePath.slice(0,-1).join("/"),i=t.titlePath.slice(0,-1).join("/");return e.title.localeCompare(t.title)||n.localeCompare(i)||e.fieldPath.localeCompare(t.fieldPath)}function qr(e){return void 0!==e.__recent}let ql="core:studio:navbar:search:";sX()(ql);let qa=function(e){let t="".concat(ql).concat(e);return sX()&&sX().enabled(t)?sX()(t):sX()(ql)}("reducer");function qo(e,t){let n="\uD83D\uDD0D";switch(t.type.startsWith("SEARCH_REQUEST")&&(n="\uD83D\uDEA8"),t.type.startsWith("RECENT_SEARCHES")&&(n="\uD83D\uDCBE"),qa(n,t),t.type){case"FILTERS_VISIBLE_SET":return{...e,filtersVisible:t.visible};case"LAST_ACTIVE_INDEX_SET":return{...e,lastActiveIndex:t.index};case"ORDERING_RESET":return{...e,ordering:Lk.relevance,terms:qs(e.terms)};case"ORDERING_SET":return{...e,ordering:t.ordering,terms:qs(e.terms)};case"PAGE_INCREMENT":return{...e,pageIndex:e.pageIndex+1,terms:qs(e.terms)};case"RECENT_SEARCHES_SET":return{...e,recentSearches:t.recentSearches};case"SEARCH_CLEAR":return{...e,pageIndex:0,result:{...e.result,hasMore:null,hits:[]}};case"SEARCH_REQUEST_COMPLETE":return{...e,result:{...e.result,error:null,hasMore:t.hits.length>0,hits:e.pageIndex>0?[...e.result.hits,...t.hits]:t.hits,loaded:!0,loading:!1}};case"SEARCH_REQUEST_ERROR":return{...e,result:{...e.result,error:t.error,loaded:!1,loading:!1}};case"SEARCH_REQUEST_START":return{...e,result:{...e.result,loaded:!1,loading:!0}};case"TERMS_FILTERS_ADD":{var i;let n={...t.filter,value:null==(i=D3(e.definitions.operators,t.filter.operatorType))?void 0:i.initialValue},r=[...e.filters,n];return{...e,documentTypesNarrowed:D9({fieldDefinitions:e.definitions.fields,filters:r,types:e.terms.types}),filters:r,lastAddedFilter:n,terms:{...e.terms,filter:D5({fieldDefinitions:e.definitions.fields,filterDefinitions:e.definitions.filters,filters:r,operatorDefinitions:e.definitions.operators})}}}case"TERMS_FILTERS_CLEAR":{let t=[];return{...e,documentTypesNarrowed:D9({fieldDefinitions:e.definitions.fields,filters:t,types:e.terms.types}),filters:t,terms:{...e.terms,filter:D5({fieldDefinitions:e.definitions.fields,filterDefinitions:e.definitions.filters,filters:t,operatorDefinitions:e.definitions.operators})}}}case"TERMS_FILTERS_REMOVE":{let n=e.filters.findIndex(e=>D8(e)===t.filterKey),i=[...e.filters.slice(0,n),...e.filters.slice(n+1)];return{...e,documentTypesNarrowed:D9({fieldDefinitions:e.definitions.fields,filters:i,types:e.terms.types}),filters:i,terms:{...e.terms,filter:D5({fieldDefinitions:e.definitions.fields,filterDefinitions:e.definitions.filters,filters:i,operatorDefinitions:e.definitions.operators})}}}case"TERMS_FILTERS_SET_OPERATOR":{let n=e.filters.find(e=>D8(e)===t.filterKey),i=D3(e.definitions.operators,null==n?void 0:n.operatorType),r=D3(e.definitions.operators,t.operatorType),l=null==r?void 0:r.initialValue,a=(null==i?void 0:i.inputComponent)!=(null==r?void 0:r.inputComponent),o=e.filters.map(e=>D8(e)===t.filterKey?{...e,operatorType:t.operatorType,...a?{value:l}:{}}:e);return{...e,filters:o,terms:{...e.terms,filter:D5({fieldDefinitions:e.definitions.fields,filterDefinitions:e.definitions.filters,filters:o,operatorDefinitions:e.definitions.operators})}}}case"TERMS_FILTERS_SET_VALUE":{let n=e.filters.map(e=>D8(e)===t.filterKey?{...e,value:t.value}:e);return{...e,filters:n,terms:{...e.terms,filter:D5({fieldDefinitions:e.definitions.fields,filterDefinitions:e.definitions.filters,filters:n,operatorDefinitions:e.definitions.operators})}}}case"TERMS_QUERY_SET":return{...e,pageIndex:0,result:{...e.result,loaded:!1},terms:qs({...e.terms,query:t.query})};case"TERMS_SET":{let n=t.filters||[],i=[...e.terms.types||[],...t.terms.types].sort(MX);return{...e,documentTypesNarrowed:D9({fieldDefinitions:e.definitions.fields,filters:n,types:i}),filters:n,lastAddedFilter:null,pageIndex:0,result:{...e.result,loaded:!1},terms:{...t.terms,filter:D5({fieldDefinitions:e.definitions.fields,filterDefinitions:e.definitions.filters,filters:n,operatorDefinitions:e.definitions.operators})}}}case"TERMS_TYPE_ADD":{let n=[...e.terms.types||[],t.schemaType].sort(MX),i=D9({fieldDefinitions:e.definitions.fields,filters:[],types:n}),r=e.filters.filter(t=>{let n=D6(e.definitions.fields,t);return!n||0===n.documentTypes.length||i.every(e=>n.documentTypes.findIndex(t=>t===e)>-1)});return{...e,documentTypesNarrowed:i,filters:r,pageIndex:0,result:{...e.result,loaded:!1},terms:qs({...e.terms,filter:D5({fieldDefinitions:e.definitions.fields,filterDefinitions:e.definitions.filters,operatorDefinitions:e.definitions.operators,filters:r}),types:n})}}case"TERMS_TYPE_REMOVE":{let n=(e.terms.types||[]).filter(e=>e!==t.schemaType);return{...e,documentTypesNarrowed:D9({fieldDefinitions:e.definitions.fields,filters:e.filters,types:n}),pageIndex:0,result:{...e.result,loaded:!1},terms:qs({...e.terms,types:n})}}case"TERMS_TYPES_CLEAR":return{...e,documentTypesNarrowed:D9({fieldDefinitions:e.definitions.fields,filters:e.filters,types:[]}),pageIndex:0,result:{...e.result,loaded:!1},terms:qs({...e.terms,types:[]})};default:return e}}function qs(e){if(qr(e)){let{__recent:t,...n}=e;return n}return e}function qd(e){let{children:t,fullscreen:n}=e,i=(0,lJ.useRef)(null),[r,l]=(0,lJ.useState)(null),a=qJ(fT),o=q6(),s=Ns(),{search:{operators:d,filters:c}}=Ic(),{dataset:u,projectId:p}=a.config(),{fieldDefinitions:h,filterDefinitions:f,operatorDefinitions:m}=(0,lJ.useMemo)(()=>({fieldDefinitions:(function(e,t){var n,i;let r=M$(e).map(e=>e.name),{documentTypes:l,objectTypes:a}=((null==(n=e._original)?void 0:n.types)||[]).filter(e=>!qt(e)||r.includes(e.name)).filter(e=>"slug"!==e.name).filter(e=>!e.name.startsWith("sanity.")).reduce((e,t)=>(qt(t)&&(e.documentTypes[t.name]=t),qn(t)&&(e.objectTypes[t.name]=t),e),{documentTypes:{},objectTypes:{}})||{documentTypes:{},objectTypes:{}};return i=t.reduce((e,t)=>("field"===t.type&&e.push(t.fieldType),e),[]),Object.values(l).reduce((e,t)=>{let n=t.fields.reduce((e,n)=>((function e(t){var n;let{acc:r,defType:o,depth:s=0,documentType:d,prevFieldPath:c,prevTitlePath:u}=t,p=o.name.startsWith("_"),h=(null==o?void 0:o.title)?Zb(o.title):op()(o.name),f=c?"".concat(c,".").concat(o.name):o.name,m=u?[...u,h]:[h];if(!(s<=3))return;let g=a[o.type],x=l[o.type],v=qn(o)?o:null,b=x||g||v;if(b){null==(n=null==b?void 0:b.fields)||n.forEach(t=>e({acc:r,defType:t,depth:s+1,documentType:d,prevFieldPath:f,prevTitlePath:m}));return}i.includes(o.type)&&r.push({documentTypes:d&&!p?[d]:[],fieldPath:f,filterName:function(e){var t,n;if("string"===e.type&&null!=(t=e.options)&&t.list&&e.options.list.length>0)return"stringList";if(qe(e)){if(e.of.some(e=>"reference"===e.type))return"arrayReferences";if(e.of.find(e=>"block"===e.type))return"portableText";if(qe(e)&&e.of.every(e=>["boolean","number","string"].includes(e.type))&&null!=(n=e.options)&&n.list&&e.options.list.length>0)return"arrayList"}return e.type}(o),id:"",name:o.name,titlePath:m,title:h,type:o.type})})({acc:e,defType:n,documentType:t.name}),e),[]);return e.push(...n),e},[]).reduce((e,t)=>{let n=e.findIndex(e=>e.fieldPath===t.fieldPath&&e.title===t.title&&e.type===t.type);return n>-1?e[n]={...e[n],documentTypes:[...e[n].documentTypes,...t.documentTypes]}:e.push(t),e},[]).map(L7).sort(qi)})(o,c).reduce((e,t)=>(e[t.id]=t,e),{}),filterDefinitions:c.reduce((e,t)=>(e[t.name]=t,e),{}),operatorDefinitions:d.reduce((e,t)=>(e[t.type]=t,e),{})}),[c,d,o]),g=(0,lJ.useMemo)(()=>(function(e){let{dataset:t,fieldDefinitions:n,filterDefinitions:i,operatorDefinitions:r,projectId:l,schema:a,user:o,version:s=2}=e;if(!t||!l||!L9||!o)return;let d="".concat("search::recent","__").concat(l,":").concat(t,":").concat(o.id);return{addSearch:(e,t)=>{let l=(t||[]).map(e=>({fieldId:e.fieldId,filterName:e.filterName,operatorType:e.operatorType,value:e.value})).filter(e=>D7({fieldDefinitions:n,filter:e,filterDefinitions:i,operatorDefinitions:r})),o={created:new Date().toISOString(),filters:l,terms:{query:e.query.trim(),typeNames:e.types.map(e=>e.name)}},c=JSON.stringify(sw()(o,"created")),u={version:s,recentSearches:[o,...L6(d,s).recentSearches.filter(e=>JSON.stringify(sw()(e,"created"))!==c)].slice(0,5)};return window.localStorage.setItem(d,JSON.stringify(u)),L8({fieldDefinitions:n,filterDefinitions:i,lsKey:d,operatorDefinitions:r,schema:a,version:s})},getRecentSearches:()=>L8({fieldDefinitions:n,filterDefinitions:i,lsKey:d,operatorDefinitions:r,schema:a,version:s}),removeSearch:()=>{let e={...L6(d,s),recentSearches:[]};return window.localStorage.setItem(d,JSON.stringify(e)),L8({fieldDefinitions:n,filterDefinitions:i,lsKey:d,operatorDefinitions:r,schema:a,version:s})},removeSearchAtIndex:e=>{let t=L6(d,s);if(e<0||e>t.recentSearches.length)return L8({fieldDefinitions:n,filterDefinitions:i,lsKey:d,operatorDefinitions:r,schema:a,version:s});let l={...t,recentSearches:[...t.recentSearches.slice(0,e),...t.recentSearches.slice(e+1)]};return window.localStorage.setItem(d,JSON.stringify(l)),L8({fieldDefinitions:n,filterDefinitions:i,lsKey:d,operatorDefinitions:r,schema:a,version:s})}}})({dataset:u,fieldDefinitions:h,filterDefinitions:f,operatorDefinitions:m,projectId:p,schema:o,user:s,version:2}),[s,u,h,f,m,p,o]),x=(0,lJ.useMemo)(()=>null==g?void 0:g.getRecentSearches(),[g]),v=(0,lJ.useMemo)(()=>(function(e){let{currentUser:t,fullscreen:n,recentSearches:i=[],definitions:r}=e;return{currentUser:t,debug:"undefined"!=typeof window&&window.location.hash.slice(1).split(";").includes("_debug_search_score"),documentTypesNarrowed:[],filters:[],filtersVisible:!0,fullscreen:n,lastActiveIndex:-1,ordering:Lk.relevance,pageIndex:0,recentSearches:i,result:{error:null,hasMore:null,hits:[],loaded:!1,loading:!1},terms:{query:"",types:[]},definitions:r}})({currentUser:s,fullscreen:n,recentSearches:x,definitions:{fields:h,operators:m,filters:f}}),[s,h,f,n,m,x]),[b,y]=(0,lJ.useReducer)(qo,v),{documentTypesNarrowed:j,filters:w,ordering:k,pageIndex:C,result:_,terms:S}=b,T=(0,lJ.useRef)(!1),E=(0,lJ.useRef)(v.ordering),P=(0,lJ.useRef)(v.pageIndex),A=(0,lJ.useRef)(v.terms),{handleSearch:O,searchState:z}=MQ({initialState:{..._,terms:S},onComplete:e=>y({hits:e,type:"SEARCH_REQUEST_COMPLETE"}),onError:e=>y({error:e,type:"SEARCH_REQUEST_ERROR"}),onStart:()=>y({type:"SEARCH_REQUEST_START"}),schema:o}),M=MW({terms:S}),I=j.map(e=>o.get(e)),R=w.filter(e=>D7({fieldDefinitions:h,filter:e,filterDefinitions:f,operatorDefinitions:m})),F=(0,lJ.useCallback)(e=>{i.current=e},[]);return(0,lJ.useEffect)(()=>{let e=!aG()(k,E.current),t=C!==P.current,n=!aG()(S,A.current);if(e||t||n){let e=(null==k?void 0:k.customMeasurementLabel)||"".concat(k.sort.field," ").concat(k.sort.direction);O({options:{comments:[...qr(S)?["findability-recent-search:".concat(S.__recent.index)]:[],"findability-selected-types:".concat(S.types.length),"findability-sort:".concat(e),"findability-source: global","findability-filter-count:".concat(R.length)],limit:1e3,offset:1e3*C,skipSortByScore:k.ignoreScore,sort:[k.sort]},terms:{...S,...I?{types:I}:{}}}),P.current=C}E.current=k,A.current=S},[R.length,w,I,O,M,k,C,z.terms,S]),(0,lJ.useEffect)(()=>{!M&&(null==T?void 0:T.current)&&_.hits.length>0&&y({type:"SEARCH_CLEAR"}),T.current=!0},[y,M,_.hits,S.query,S.types]),(0,lG.jsx)(MM.Provider,{value:{dispatch:y,onClose:null==i?void 0:i.current,recentSearchesStore:g,searchCommandList:r,setSearchCommandList:l,setOnClose:F,state:{...b,fullscreen:n}},children:t})}let qc="3.20.1";function qu(e){var t;let{error:n,isLoading:i,value:r}=e,l=null==(t=null==r?void 0:r.resources)?void 0:t.sectionArray,a=null==r?void 0:r.latestVersion;return i?(0,lG.jsx)(l4.kC,{align:"center",justify:"center",padding:3,children:(0,lG.jsx)(l4.$j,{})}):(0,lG.jsxs)(lG.Fragment,{children:[(void 0===r||n)&&(0,lG.jsx)("div",{children:qp}),!n&&(null==l?void 0:l.map(e=>e?(0,lG.jsx)(qh,{subSection:e},e._key):null)),(0,lG.jsxs)(l4.xu,{padding:3,children:[(0,lG.jsxs)(l4.xv,{size:1,muted:!0,weight:"medium",textOverflow:"ellipsis",children:["Sanity Studio version ",qc]}),!n&&a&&(0,lG.jsx)(l4.xu,{paddingTop:2,children:(0,lG.jsxs)(l4.xv,{size:1,muted:!0,textOverflow:"ellipsis",children:["Latest version is ",a]})})]})]})}let qp=(0,lG.jsxs)(lG.Fragment,{children:[(0,lG.jsx)(l4.sN,{as:"a",text:"Join our community",size:0,href:"https://www.sanity.io/exchange/community",target:"_blank",muted:!1}),(0,lG.jsx)(l4.sN,{as:"a",text:"Help and support",size:0,href:"https://www.sanity.io/contact/support",target:"_blank",muted:!1}),(0,lG.jsx)(l4.sN,{as:"a",text:"Contact sales",size:0,href:"https://www.sanity.io/contact/sales?ref=studio",target:"_blank",muted:!1}),(0,lG.jsx)(l4.R,{})]});function qh(e){var t;let{subSection:n}=e;return(0,lG.jsxs)(lG.Fragment,{children:[n.sectionTitle&&(0,lG.jsx)(l4.Zb,{padding:2,paddingTop:3,marginLeft:1,children:(0,lG.jsx)(l4.__,{muted:!0,size:1,children:n.sectionTitle})}),null==(t=null==n?void 0:n.items)?void 0:t.map(e=>{if(!e||!e.title)return null;switch(e._type){case"externalLink":if(!e.url)return null;return(0,lG.jsx)(l4.sN,{as:"a",tone:"default",text:e.title,size:0,href:e.url,target:"_blank"},e._key);case"internalAction":if(!e.type)return null;return"show-welcome-modal"===e.type&&(0,lG.jsx)(l4.sN,{text:e.title,size:0},e._key);default:return null}}),(0,lG.jsx)(l4.R,{})]})}var qf=Object.freeze,qm=Object.defineProperty;let qg=(0,a0.ZP)(l4.v2)(lV||(lV=qf(qm(e_=["\n  max-width: 300px;\n  min-width: 200px;\n"],"raw",{value:qf(e_.slice())}))));function qx(){let{scheme:e}=R8(),[t,n]=(0,lJ.useState)(!1),{value:i,error:r,isLoading:l}=function(){let e=qJ({apiVersion:"1"});return cO((0,lJ.useMemo)(()=>e.withConfig({apiVersion:"1"}).observable.request({url:"/help",query:{m:["sanity@".concat(qc)]},tag:"module.version-check",json:!0}).pipe((0,ag.U)(e=>({...e}))),[e]))}(),a=(0,lJ.useCallback)(()=>n(!0),[]),o=(0,lJ.useCallback)(()=>n(!1),[]);return(0,lG.jsx)(l4.kC,{children:(0,lG.jsx)(l4.u,{content:(0,lG.jsx)(l4.xu,{padding:2,children:(0,lG.jsx)(l4.xv,{size:1,children:"Help and resources "})}),scheme:e,placement:"bottom",portal:!0,disabled:t,children:(0,lG.jsx)("div",{children:(0,lG.jsx)(l4.j2,{button:(0,lG.jsx)(l4.zx,{"aria-label":"Help and resources",icon:a8.BHU,mode:"bleed",fontSize:2}),id:"menu-button-resources",menu:(0,lG.jsx)(qg,{children:(0,lG.jsx)(qu,{error:r,isLoading:l,value:i})}),popover:{constrainSize:!0,placement:"bottom",portal:!0,scheme:e},onClose:o,onOpen:a})})})})}var qv=Object.freeze,qb=Object.defineProperty,qy=(e,t)=>qv(qb(e,"raw",{value:qv(t||e.slice())}));let qj=(0,a0.ZP)(l4.mh)(lU||(lU=qy(["\n  min-height: auto;\n  position: relative;\n\n  &[data-search-open='true'] {\n    top: 0;\n    position: sticky;\n  }\n"]))),qw=(0,a0.ZP)(l4.Zb)(lB||(lB=qy(["\n  line-height: 0;\n"]))),qk=(0,a0.ZP)(l4.kC)(lK||(lK=qy(["\n  width: max-content;\n"])));function qC(){let{name:e,tools:t,...n}=Io(),i=(0,l4.Ur)().theme,r=Fi(),l=(0,a9.z)(),{scheme:a}=R8(),{href:o,onClick:s}=(0,a9.rJ)({state:{}}),d=(0,l4.d2)(),c="string"==typeof l.tool?l.tool:void 0,u=function(){let{__internal:{staticInitialValueTemplateItems:e}}=Ic(),[t,n]=Vk({templateItems:e});return{canCreateDocument:(null==t?void 0:t.some(t=>e.some(e=>e.id===t.id)))||!1,loading:n,options:(0,lJ.useMemo)(()=>e.map(e=>{var n;return{...e,title:(null==e?void 0:e.title)||e.id,hasPermission:(null==(n=null==t?void 0:t.find(t=>t.id===e.id))?void 0:n.granted)||!1}}),[t,e])}}(),{onSearchFullscreenOpenChange:p,searchFullscreenOpen:h,searchFullscreenPortalEl:f}=(0,lJ.useContext)(F2),m=fR({defaultComponent:R$,pick:qz}),g=qM(),[x,v]=(0,lJ.useState)(!1),b=(0,lJ.useRef)(l),y=(0,lJ.useRef)(e);(0,lJ.useEffect)(()=>{(b.current.tool!==l.tool||e!==y.current)&&v(!1),b.current=l,y.current=e},[e,l]);let[j,w]=(0,lJ.useState)(null),[k,C]=(0,lJ.useState)(null),_=(0,lJ.useMemo)(()=>({brandingCenter:d<=1,resources:d>1,collapsedPresenceMenu:d<=1,loginStatus:d>1,searchFullscreen:d<=1,configIssues:d>1&&v5,workspaces:d>=3&&r.length>1,tools:d>=3}),[d,r.length]),S="string"==typeof e&&"root"!==e?op()(e):null,T=n.title||S||"Studio";(0,lJ.useEffect)(()=>{p(h)},[h,p]),(0,lJ.useEffect)(()=>{p&&!_.searchFullscreen&&p(!1)},[p,_.searchFullscreen]);let E=(0,lJ.useCallback)(()=>{p(!0)},[p]),P=(0,lJ.useCallback)(()=>{p(!1),null==k||k.focus()},[p,k]),A=(0,lJ.useCallback)(()=>{v(!1),null==j||j.focus()},[j]),O=(0,lJ.useCallback)(()=>{v(!0)},[]);return(0,lG.jsxs)(qj,{zOffset:100,"data-search-open":h,children:[(0,lG.jsx)(qw,{"data-testid":"navbar","data-ui":"Navbar",padding:2,scheme:"dark",shadow:i.__legacy||"dark"===a?1:void 0,sizing:"border",children:(0,lG.jsxs)(l4.kC,{align:"center",justify:"space-between",children:[(0,lG.jsxs)(qk,{align:"center",flex:_.brandingCenter?void 0:1,children:[!_.tools&&(0,lG.jsx)(l4.xu,{marginRight:1,children:(0,lG.jsx)(l4.zx,{mode:"bleed",icon:a8.Oqj,onClick:O,ref:w})}),!_.brandingCenter&&(0,lG.jsx)(l4.xu,{marginRight:1,children:(0,lG.jsx)(DQ,{href:o,onClick:s,title:T,children:(0,lG.jsx)(m,{title:T})})}),_.workspaces&&(0,lG.jsx)(l4.xu,{marginRight:2,children:(0,lG.jsx)(FB,{collapsed:!0})}),(0,lG.jsx)(l4.xu,{marginRight:_.brandingCenter?void 0:2,children:(0,lG.jsx)(DP,{...u,modal:_.brandingCenter?"dialog":"popover"})}),(0,lG.jsx)(l4.li,{children:(0,lG.jsx)(qd,{fullscreen:_.searchFullscreen,children:(0,lG.jsxs)(l4.NM,{element:document.body,children:[(0,lG.jsx)(l4.Xp,{element:f,children:_.searchFullscreen&&(0,lG.jsx)(LB,{onClose:P,onOpen:E,open:h})}),!_.searchFullscreen&&(0,lG.jsx)(L4,{})]})})}),_.tools&&(0,lG.jsx)(l4.Zb,{flex:1,marginX:2,overflow:"visible",paddingRight:1,children:(0,lG.jsx)(g,{activeToolName:c,closeSidebar:A,context:"topbar",isSidebarOpen:!1,tools:t})})]}),_.brandingCenter&&(0,lG.jsx)(l4.xu,{marginX:1,children:(0,lG.jsx)(DQ,{href:o,onClick:s,title:T,children:(0,lG.jsx)(m,{title:T})})}),(0,lG.jsxs)(l4.kC,{gap:2,children:[(_.configIssues||_.resources)&&(0,lG.jsx)(l4.Zb,{borderRight:!0,children:(0,lG.jsxs)(l4.kC,{gap:1,paddingX:2,children:[_.configIssues&&(0,lG.jsx)(DJ,{}),_.resources&&(0,lG.jsx)(qx,{})]})}),(0,lG.jsxs)(l4.kC,{align:"center",gap:1,children:[(0,lG.jsx)(Dq,{collapse:_.collapsedPresenceMenu}),_.tools&&(0,lG.jsx)(Ds,{}),_.searchFullscreen&&(0,lG.jsx)(l4.zx,{"aria-label":"Open search",icon:a8.W1M,mode:"bleed",onClick:E,ref:C})]})]})]})}),!_.tools&&(0,lG.jsx)(DY,{activeToolName:c,isOpen:x,onClose:A,tools:t})]})}let q_=(0,lJ.forwardRef)(function(e,t){let{name:n,...i}=e,r=(0,a9.z)((0,lJ.useCallback)(()=>({tool:n,[n]:void 0}),[n]));return(0,lG.jsx)(a9.Px,{state:r,...i,ref:t})});function qS(e){let{activeToolName:t,tools:n}=e,{scheme:i}=R8(),[r,l]=(0,lJ.useState)(null);pJ({rootElement:r,navigation:["arrows"]});let a=(0,lJ.useMemo)(()=>({popover:{constrainSize:!0,portal:!0,scheme:i}}),[i]),o=(0,lJ.useMemo)(()=>n.map((e,n)=>{let r=(null==e?void 0:e.title)||op()(e.name)||void 0,l=(0,lJ.forwardRef)(function(t,n){return(0,lG.jsx)(q_,{...t,ref:n,name:e.name})});return(0,lG.jsx)(PP,{as:l,"data-as":"a",collapsedProps:{tooltipText:e.title},icon:e.icon||a8.Tzq,mode:"bleed",selected:t===e.name,text:r,tooltipProps:{scheme:i}},"".concat(e.name,"-").concat(n))}),[t,i,n]);return(0,lG.jsx)(PS,{"data-testid":"tool-collapse-menu",gap:1,menuButtonProps:a,ref:l,children:o})}function qT(e){let{activeToolName:t,isVisible:n,tools:i}=e;return(0,lJ.useMemo)(()=>(0,lG.jsx)(l4.Kq,{as:"ul",space:1,children:i.map(e=>{let i=(null==e?void 0:e.title)||op()(e.name)||void 0,r=(0,lJ.forwardRef)(function(t,n){return(0,lG.jsx)(q_,{...t,ref:n,name:e.name})});return(0,lG.jsx)(l4.Kq,{as:"li",children:(0,lG.jsx)(l4.zx,{as:r,icon:e.icon||a8.BWR,justify:"flex-start",mode:"bleed",selected:t===e.name,tabIndex:n?0:-1,text:i})},e.name)})}),[t,n,i])}function qE(e){let{context:t,isSidebarOpen:n,...i}=e;return"sidebar"===t?(0,lG.jsx)(qT,{isVisible:n,...i}):(0,lG.jsx)(qS,{...i})}function qP(e){var t,n;return null==(n=null==(t=e.studio)?void 0:t.components)?void 0:n.toolMenu}function qA(e){var t,n;return null==(n=null==(t=e.studio)?void 0:t.components)?void 0:n.navbar}function qO(e){var t,n;return null==(n=null==(t=e.studio)?void 0:t.components)?void 0:n.layout}function qz(e){var t,n;return null==(n=null==(t=e.studio)?void 0:t.components)?void 0:n.logo}function qM(){return fR({defaultComponent:qE,pick:qP})}let qI=cf.__sanityErrorChannel;function qR(){let{push:e}=(0,l4.pm)();return(0,lJ.useEffect)(()=>{if(qI)return qI.subscribe(t=>{var n;!(!t.error||(n=t.error)instanceof RL||n instanceof hl||n instanceof RZ)&&(console.error(t.error),e({id:t.error.message,closable:!0,description:t.error.message,duration:5e3,title:"Uncaught error",status:"error"}))})},[e]),null}function qF(e){let{children:t,AuthenticateComponent:n=FK,LoadingComponent:i=Fc,NotAuthenticatedComponent:r=FW}=e,[l,a]=(0,lJ.useState)(null);if(l)throw l;let[o,s]=(0,lJ.useState)("loading"),{activeWorkspace:d}=FS();return((0,lJ.useEffect)(()=>{var e,t;null==(t=(e=d.auth).handleCallbackUrl)||t.call(e).catch(a)},[d.auth]),(0,lJ.useEffect)(()=>{let e=d.auth.state.subscribe({next:e=>{var t;let{authenticated:n,currentUser:i}=e;if((null==(t=null==i?void 0:i.roles)?void 0:t.length)===0){s("unauthorized");return}s(n?"logged-in":"logged-out")},error:a});return()=>{e.unsubscribe()}},[d]),"loading"===o)?(0,lG.jsx)(i,{}):"unauthorized"===o?(0,lG.jsx)(r,{}):"logged-out"===o?(0,lG.jsx)(n,{}):(0,lG.jsx)(lG.Fragment,{children:t})}function qD(e){let{children:t}=e,n=FS().activeWorkspace.theme;if(n.__legacy){let e=n.__dark?"dark":"light";return(0,lG.jsx)(RG.Provider,{value:!1,children:(0,lG.jsx)(RX.Provider,{value:e,children:(0,lG.jsx)(l4.f6,{scheme:e,theme:n,tone:"transparent",children:(0,lG.jsx)(l4.li,{children:t})})})})}return(0,lG.jsx)(l4.f6,{theme:n,tone:"transparent",children:(0,lG.jsx)(l4.li,{children:t})})}let qZ={toast:[100,11e3]};var qL=Object.freeze,qq=Object.defineProperty,qN=(e,t)=>qL(qq(e,"raw",{value:qL(t||e.slice())}));function qV(e){let t={}.toolSwitcher||{},n=t.order||[],i=t.hidden||[];if(!n.length&&!i.length)return e;let r=e.reduce((e,t)=>{let i=t.title||"<unknown>";if(!t.name)return console.warn('Tool "'.concat(i,'" does not have the required "name" property')),e;if(e[t.name]){let n=e[t.name].tool.title;return console.warn('Tools with duplicate name "'.concat(t.name,'" found ("').concat(i,'" and "').concat(n,'")')),e}let r=n.indexOf(t.name);return e[t.name]={tool:t,index:-1===r?1/0:r},e},{}),l=e.filter(e=>-1===i.indexOf(e.name));return l.sort((e,t)=>{let n=r[e.name],i=r[t.name],l=n?n.index:1/0,a=i?i.index:1/0;return l===a?0:l-a}),l}(0,a0.ZP)(l4.kC)(lH||(lH=qN([""]))),(0,a0.ZP)(l4.xu).attrs({padding:4})(lW||(lW=qN([""])));let qU=["template"],qB=["mode"];function qK(e){let{children:t,LoadingComponent:n,workspace:i}=e,{basePath:r,tools:l}=i,a=function(){let e=(0,lJ.useContext)(Fj);if(!e)throw Error("Could not find `RouterHistoryProvider` context");return e}(),o=(0,lJ.useMemo)(()=>(function(e){let{basePath:t="/",tools:n}=e,i=a9.BC.create("/:tool",e=>{let t=n.find(t=>t.name===e.tool);return t||"desk"!==e.tool||(t=n.find(e=>"structure"===e.name)),t?a9.BC.scope(t.name,"/",t.router):a9.BC.create("/")});return a9.BC.create(t,[a9.BC.intents("/intent"),i])})({basePath:r,tools:l}),[r,l]),[s,d]=function(e,t,n){var i;let r=(0,lJ.useMemo)(()=>{let n=t.getBasePath(),i=RegExp("^".concat(dZ()(n),"(\\/|$)"),"i"),r=e=>"/"===n||i.test(e);return{subscribe:t=>e.listen(t),getSnapshot:()=>e.location.pathname+e.location.search,getServerSnapshot:()=>null,selector:e=>"string"==typeof e&&r(e)?{type:"state",state:t.decode(e)||{},isNotFound:t.isNotFound(e)}:null}},[e,t]),l=(0,du.useSyncExternalStoreWithSelector)(r.subscribe,r.getSnapshot,r.getServerSnapshot,r.selector,aG()),a=(0,lJ.useRef)(l);(0,lJ.useEffect)(()=>{var i,r;if((null==l?void 0:l.type)==="state"&&!(null==(i=l.state)?void 0:i.intent)){let i=function(e,t){let n=qV(e)[0];return t&&!t.tool&&n?Object.assign({},t,{tool:n.name}):t}(n,(r=l.state)&&qV(n).find(e=>e.name===r.space)?{...r,tool:r.space,space:void 0}:r);i&&i!==l.state&&e.replace(t.encode(i))}},[null==l?void 0:l.state,null==l?void 0:l.type,e,t,n]),(0,lJ.useEffect)(()=>{let i=qH(l,t,n,a);i?e.replace(i):a.current=l},[l,e,t,n]);let o=(0,lJ.useMemo)(()=>i=>{let{path:l,replace:o}=i,s=qH(r.selector(l),t,n,a),d="string"==typeof s?s:l;o?e.replace(d):e.push(d)},[e,t,r,n]);return[null!=(i=null==l?void 0:l.state)?i:null,o]}(a,o,l);return s?(0,lG.jsx)(a9.pG,{onNavigate:d,router:o,state:s,children:t}):(0,lG.jsx)(n,{})}function qH(e,t,n,i){var r,l;if((null==e?void 0:e.type)==="state"&&(null==(r=e.state)?void 0:r.intent)){let r=function(e,t,n){var i;let{intent:r,params:l,payload:a}=n;if("string"!=typeof r)throw Error("intent must be a string");if(!cg(l))throw Error("intent params must be a string");let o=qV(e),s=(null==t?void 0:t.tool)?o.find(e=>e.name===t.tool):null,d=s?o.filter(e=>e!==s):o,c=[];"create"===r?c=qU:"edit"===r&&(c=qB);let{tool:u}=(s?[s,...d]:o).reduce((e,n)=>{if(!n||"function"!=typeof n.canHandleIntent)return e;let i=n.canHandleIntent(r,l,t&&t[n.name]);if("boolean"==typeof i)return i&&e.score<0?{score:0,tool:n}:e;if(!cg(i))return e;let a=c.reduce((e,t)=>t in l&&!0===i[t]?e+1:e,0);return a>e.score?{score:a,tool:n}:e},{score:-1,tool:null});if(null==u?void 0:u.getIntentState){let{_searchParams:e,...n}=u.getIntentState(r,l,t&&t[u.name],a),o={...t,tool:u.name,[u.name]:n};return(null==(i=u.router)?void 0:i.__unsafe_disableScopedSearchParams)?o._searchParams=e:n._searchParams=e,{type:"state",isNotFound:!1,state:o}}return{type:"intent",isNotFound:!0,intent:{name:r,params:l}}}(n,(null==(l=i.current)?void 0:l.type)==="state"?i.current.state:{},e.state);if((null==r?void 0:r.type)==="state")return t.encode(r.state)}return null}function qW(e){let{children:t,LoadingComponent:n}=e,[i,r]=(0,lJ.useState)(null);if(i)throw i;let{activeWorkspace:l}=FS(),[a,o]=(0,lJ.useState)(null);return((0,lJ.useEffect)(()=>{let e=(0,ao.a)(l.__internal.sources.map(e=>{let{source:t}=e;return t.pipe((0,av.K)(e=>{if(e instanceof RZ)return(0,l6.of)(e);throw e}))})).pipe((0,ag.U)(e=>{let t=e.filter(e=>e instanceof RZ);if(t.length)throw new RZ({name:l.name,causes:t,type:"workspace"});return e}),(0,ag.U)(e=>{let[t,...n]=e;return{...l,...t,unstable_sources:[t,...n],type:"workspace"}})).subscribe({next:o,error:r});return()=>e.unsubscribe()},[l]),a)?(0,lG.jsx)(Ia,{workspace:a,children:(0,lG.jsx)(Id,{source:a.unstable_sources[0],children:(0,lG.jsx)(qK,{LoadingComponent:n,workspace:a,children:t})})}):(0,lG.jsx)(n,{})}function q$(e){let{ConfigErrorsComponent:t,...n}=e,[{error:i},r]=(0,lJ.useState)({error:null});if(i)throw i;return(0,lG.jsx)(l4.SV,{onCatch:r,children:(0,lG.jsx)(qW,{...n})})}function qX(e){let{children:t,config:n,basePath:i,onSchemeChange:r,scheme:l,unstable_history:a,unstable_noAuthBoundary:o}=e,s=(0,lG.jsx)(q$,{LoadingComponent:Fc,ConfigErrorsComponent:FH,children:(0,lG.jsx)(hi,{children:t})});return(0,lG.jsx)(R0,{onSchemeChange:r,scheme:l,children:(0,lG.jsxs)(l4.VW,{paddingY:7,zOffset:qZ.toast,children:[(0,lG.jsx)(qR,{}),(0,lG.jsx)(FJ,{children:(0,lG.jsx)(Fe,{config:n,basePath:i,children:(0,lG.jsx)(F_,{unstable_history:a,NotFoundComponent:Fb,LoadingComponent:Fc,children:(0,lG.jsx)(qD,{children:(0,lG.jsx)(gS,{children:o?s:(0,lG.jsx)(qF,{LoadingComponent:Fc,AuthenticateComponent:FK,NotAuthenticatedComponent:FW,children:s})})})})})})]})})}function qG(){let e=fR({defaultComponent:F3,pick:qO});return(0,lG.jsx)(e,{})}function qY(e){let{basePath:t,config:n,onSchemeChange:i,scheme:r,unstable_globalStyles:l,unstable_history:a,unstable_noAuthBoundary:o}=e;return(0,lG.jsxs)(qX,{basePath:t,config:n,onSchemeChange:i,scheme:r,unstable_history:a,unstable_noAuthBoundary:o,children:[l&&(0,lG.jsx)(hF,{}),(0,lG.jsx)(qG,{})]})}function qJ(e){let t=Ic();return e?t.getClient(e):(console.warn('Calling `useClient()` without specifying an API version is deprecated and will stop working in the next dev-preview release - please migrate to use `useClient({apiVersion: "2021-06-07"})`.'),t.getClient({apiVersion:"2021-06-07"}))}d_().registerLanguage(dT()),d_().registerLanguage(dP()),d_().registerLanguage(dO()),d_().registerLanguage(dM()),d_().registerLanguage(dR());let qQ="connecting";function q0(e,t){let n=Uw();return(0,l5.m2)(()=>n.pair.documentEvents(e,t).pipe((0,ag.U)(e=>e.type),(0,ag.U)(e=>"reconnect"!==e),(0,ab.w)(e=>e?(0,l6.of)("connected"):(0,ai.H)(200).pipe((0,aF.h)("reconnecting"))),(0,ak.O)(qQ),(0,ax.x)()),[n.pair,e,t],qQ)}function q1(){return Ic().dataset}function q2(e,t){let n=Uw();return(0,l5.m2)(()=>n.pair.editOperations(e,t),[t,n.pair,e])}function q3(e,t){let n=Uw();return(0,l5.m2)(()=>n.pair.operationEvents(e,t),[n.pair,e,t])}function q4(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"default",i=Uw();return(0,l5.m2)(()=>{let r=i.pair.editState(e,t).pipe((0,az.B)());return"low"===n?(0,ae.T)(r.pipe((0,aS.q)(1)),r.pipe((0,aD.T)(1),(0,aR.D)(()=>(0,ai.H)(1e3)))):i.pair.editState(e,t)},[i.pair,e,t,n])}function q5(){return Ic().projectId}function q6(){return Ic().schema}let q8={isSyncing:!0},q9={isSyncing:!1};function q7(e,t){let n=Uw();return(0,l5.m2)(()=>n.pair.consistencyStatus(e,t).pipe((0,ag.U)(e=>e?q9:q8)),[n.pair,t,e],q9)}function Ne(){return Ic().templates}function Nt(e){let{minimal:t,agoSuffix:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e instanceof Date?e:new Date(e);if(!n.getTime())return{timestamp:"",refreshInterval:null};let i=Date.now(),r=(0,oQ.Z)(i,n),l=(0,o0.Z)(i,n);if(r||l)return t.minimal&&0===l?{timestamp:(0,oy.Z)(n,"MMM d"),refreshInterval:null}:t.minimal?{timestamp:(0,oy.Z)(n,"MMM d, yyyy"),refreshInterval:null}:{timestamp:(0,oy.Z)(n,"MMM d, yyyy, hh:mm a"),refreshInterval:null};let a=(0,o1.Z)(i,n),o=(0,o6.Z)("week",a);if(a)return t.minimal?{timestamp:t.agoSuffix?"".concat(a,"w ago"):"".concat(a,"w"),refreshInterval:36e5}:{timestamp:t.agoSuffix?"".concat(a," ").concat(o," ago"):"".concat(a," ").concat(o),refreshInterval:36e5};let s=(0,o2.Z)(i,n),d=(0,o6.Z)("days",s);if(s){if(t.minimal){let e=t.agoSuffix?"".concat(s,"d ago"):"".concat(s,"d");return{timestamp:1===s?"yesterday":e,refreshInterval:36e5}}let e=t.agoSuffix?"".concat(s," ").concat(d," ago"):"".concat(s," ").concat(d);return{timestamp:1===s?"yesterday":e,refreshInterval:36e5}}let c=(0,o3.Z)(i,n),u=(0,o6.Z)("hour",c);if(c)return t.minimal?{timestamp:t.agoSuffix?"".concat(c,"h ago"):"".concat(c,"h"),refreshInterval:6e4}:{timestamp:t.agoSuffix?"".concat(c," ").concat(u," ago"):"".concat(c," ").concat(u),refreshInterval:6e4};let p=(0,o4.Z)(i,n),h=(0,o6.Z)("minute",p);if(p)return t.minimal?{timestamp:t.agoSuffix?"".concat(p,"m ago"):"".concat(p,"m"),refreshInterval:2e4}:{timestamp:t.agoSuffix?"".concat(p," ").concat(h," ago"):"".concat(p," ").concat(h),refreshInterval:2e4};let f=(0,o5.Z)(i,n),m=(0,o6.Z)("second",f);return f>10?t.minimal?{timestamp:t.agoSuffix?"".concat(f,"s ago"):"".concat(f,"s"),refreshInterval:5e3}:{timestamp:t.agoSuffix?"".concat(f," ").concat(m," ago"):"".concat(f," ").concat(m),refreshInterval:5e3}:{timestamp:"just now",refreshInterval:5e3}}(e,{minimal:t,agoSuffix:n}),[,r]=(0,lJ.useReducer)(e=>e+1,0);return(0,lJ.useEffect)(()=>{let e;return null!==i.refreshInterval&&function t(n){e=window.setTimeout(()=>{r(),e=window.setTimeout(()=>t(n),n)},n)}(i.refreshInterval),()=>{null!==e&&clearTimeout(e)}},[r,i.refreshInterval]),i.timestamp}let Nn={validation:[],isValidating:!1};function Ni(e,t){let n=Uw();return(0,l5.m2)(()=>n.pair.validation(e,t),[n.pair,e,t],Nn)}let Nr={isLoading:!0,enabled:!0,features:[]};function Nl(e){let t=qJ(fT);return i||(i=(function(e){let{versionedClient:t}=e;return t.observable.request({uri:"/features",tag:"features"})})({versionedClient:t}).pipe((0,aw.d)())),(0,l5.m2)(()=>i.pipe((0,ag.U)(function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return{isLoading:!1,enabled:!!(null==t?void 0:t.includes(e)),features:t}}),(0,ak.O)(Nr),(0,av.K)(e=>(console.error(e),(0,l6.of)({isLoading:!1,enabled:!0,features:[]})))),[e],Nr)}let Na=ci(e=>{let[t,n]=e;return(0,as.D)(t.getUser(n).catch(e=>(console.error(e),null)))});function No(e){let t=Uv();return Na((0,lJ.useMemo)(()=>[t,e],[e,t]))}function Ns(){let{currentUser:e}=Ic();return e}let Nd=e=>{let t=e.LOCAL,n=e.document.HEAD;return t?{...t,_type:(n||t)._type,_rev:(n||t)._rev,_updatedAt:new Date().toISOString()}:t},Nc=e=>({type:"snapshot",document:e}),Nu=e=>e.document,Np=e=>{let t=new l7.x,n=new au.X(!0),i=new l7.x,r=new l7.x,l=new l7.x,a=new l7.x,o=e=>{let t=new sN.W6(e);return t.onMutation=e=>{let{mutation:n,remote:r}=e;i.next({type:"mutation",document:Nd(t),mutations:n.mutations,origin:r?"remote":"local"})},t.onRemoteMutation=e=>{l.next({type:"remoteMutation",head:t.document.HEAD,transactionId:e.transactionId,timestamp:e.timestamp,author:e.identity,effects:e.effects})},t.onRebase=(e,t,n)=>{r.next({type:"rebase",document:e,remoteMutations:t,localMutations:n})},t.onConsistencyChanged=e=>{n.next(e)},t.commitHandler=e=>a.next(e),t},s=e.pipe((0,ay.R)((e,t)=>"snapshot"===t.type?(e&&e.commit(),o(t.document||null)):null===e?(console.warn('Ignoring event of type "%s" since buffered document has not yet been set up with snapshot',t.type),null):e,null),(0,aj.h)(e=>null!==e),(0,ax.x)(),(0,aZ._)(1),(0,aL.x)()),d=e.pipe((0,aj.h)(e=>"mutation"===e.type),(0,aq.M)(s),(0,ag.U)(e=>{let[t,n]=e;return n.arrive(new sN.mm(t)),Nd(n)})),c=t.pipe((0,aq.M)(s),(0,am.b)(e=>{let[t,n]=e;"mutation"===t.type&&n.add(new sN.mm({mutations:t.mutations})),"commit"===t.type&&n.commit()}),(0,aC.j)(aa.E),(0,az.B)()),u=e=>t.next(e),p=e=>u({type:"mutation",mutations:e}),h=(0,ae.T)(s.pipe((0,ag.U)(e=>e.LOCAL)),i.pipe((0,ag.U)(Nu)),r.pipe((0,ag.U)(Nu)),d).pipe((0,ag.U)(Nc),(0,aZ._)(1),(0,aL.x)()),f=(0,ae.T)(s.pipe((0,ag.U)(e=>e.document.HEAD),(0,ag.U)(Nc)),l).pipe((0,aZ._)(1),(0,aL.x)());return{updates$:(0,ae.T)(h,c,i,r),consistency$:n.pipe((0,ax.x)(),(0,aZ._)(1),(0,aL.x)()),remoteSnapshot$:f,commitRequest$:a,addMutation:e=>p([e]),addMutations:p,commit:()=>{s.pipe((0,aS.q)(1),(0,am.b)(e=>e.commit())).subscribe()}}},Nh=e=>t=>{let{_id:n,_rev:i,_updatedAt:r,...l}=t;return{_id:e,...l}},Nf=(e,t)=>{let n=Np(t),i=Nh(e),r={delete:{id:e}};return{events:n.updates$,consistency$:n.consistency$,remoteSnapshot$:n.remoteSnapshot$,commitRequest$:n.commitRequest$,patch:t=>t.map(t=>({patch:{...t,id:e}})),create:e=>({create:i(e)}),createIfNotExists:e=>({createIfNotExists:i(e)}),createOrReplace:e=>({createOrReplace:i(e)}),delete:()=>r,mutate:e=>n.addMutations(e),commit:()=>n.commit()}},Nm={type:"pending",phase:"begin"},Ng={type:"pending",phase:"end"};function Nx(e,t){return{type:"snapshot",documentId:e,document:t}}let Nv=e=>t=>"reconnect"!==t.type&&"pending"!==t.type&&t.documentId===e;function Nb(e){return t=>({...t,version:e})}function Ny(e,t){let{publishedId:n,draftId:i}=t,r=(function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},{publishedId:i,draftId:r}=t;return(0,at.P)(()=>e.observable.listen("*[_id == $publishedId || _id == $draftId]",{publishedId:i,draftId:r},{includeResult:!1,events:["welcome","mutation","reconnect"],effectFormat:"mendoza",tag:n.tag||"document.pair-listener"})).pipe((0,aM.b)(t=>"welcome"===t.type?e.observable.getDocuments([r,i],{tag:"document.snapshots"}).pipe((0,ag.U)(e=>{let[t,n]=e;return{draft:t,published:n}})).pipe((0,aM.b)(e=>[Nx(r,e.draft),Nx(i,e.published)])):(0,l6.of)(t)),(0,ay.R)((e,t)=>{if("mutation"!==t.type)return{next:[t],buffer:[]};let n=e.buffer.length>0,i=t.transactionTotalEvents>1;if(!i&&!n)return{next:[t],buffer:[]};if(!i)return{next:[],buffer:e.buffer.concat(t)};let r=e.buffer.concat(t);return Object.values(sI()(r.filter(e=>"mutation"===e.type),e=>e.transactionId)).every(e=>e.length===e[0].transactionTotalEvents)?{next:r.concat(Ng),buffer:[]}:{next:1===r.length?[Nm]:[],buffer:r}},{next:[],buffer:[]}),(0,aT.z)(e=>e.next))})(e,t).pipe((0,az.B)()),l=r.pipe((0,aj.h)(e=>"reconnect"===e.type)),a=Nf(i,r.pipe((0,aj.h)(Nv(i)))),o=Nf(n,r.pipe((0,aj.h)(Nv(n)))),s=r.pipe((0,aj.h)(e=>"pending"===e.type)),d=(0,ae.T)(a.commitRequest$,o.commitRequest$).pipe((0,aT.z)(t=>(0,as.D)(function(e,t){let{resultRev:n,...i}=t;return e.dataRequest("mutate",i,{visibility:"async",returnDocuments:!1,tag:"document.commit",skipCrossDatasetReferenceValidation:!0})}(e,t.mutation.params)).pipe((0,am.b)({error:e=>{"statusCode"in e&&"number"==typeof e.statusCode&&e.statusCode>=400&&e.statusCode<=500?t.cancel(e):t.failure(e)},next:()=>t.success()}))),(0,aC.j)(aa.E),(0,az.B)());return{transactionsPendingEvents$:s,draft:{...a,events:(0,ae.T)(d,l,a.events).pipe((0,ag.U)(Nb("draft"))),consistency$:a.consistency$,remoteSnapshot$:a.remoteSnapshot$.pipe((0,ag.U)(Nb("draft")))},published:{...o,events:(0,ae.T)(d,l,o.events).pipe((0,ag.U)(Nb("published"))),consistency$:o.consistency$,remoteSnapshot$:o.remoteSnapshot$.pipe((0,ag.U)(Nb("published")))}}}function Nj(e,t){let n=Object.create(null);return function(){let i=t(...arguments);return i in n||(n[i]=e(...arguments)),n[i]}}let Nw=(e,t)=>{var n;return(null==(n=e.get(t))?void 0:n.liveEdit)===!0};function Nk(e,t,n){var i,r;let l=e.config();return"".concat(null!=(i=l.dataset)?i:"","-").concat(null!=(r=l.projectId)?r:"","-").concat(t.publishedId,"-").concat(n)}let NC=Nj((e,t,n)=>new al.y(n=>{n.next(Ny(e,t))}).pipe((0,aZ._)(1),(0,aL.x)()),Nk);function N_(e){return"snapshot"===e.type}function NS(e){return{snapshots$:e.events.pipe((0,aj.h)(N_),(0,ag.U)(e=>e.document),(0,aZ._)(1),(0,aL.x)()),patch:e.patch,create:e.create,createIfNotExists:e.createIfNotExists,createOrReplace:e.createOrReplace,delete:e.delete,mutate:e.mutate,commit:e.commit}}let NT=Nj((e,t,n)=>NC(e,t,n).pipe((0,ag.U)(e=>{let{published:t,draft:n,transactionsPendingEvents$:i}=e;return{transactionsPendingEvents$:i,published:NS(t),draft:NS(n)}}),(0,aZ._)(1),(0,aL.x)()),(e,t,n)=>{var i,r;let l=e.config();return"".concat(null!=(i=l.dataset)?i:"","-").concat(null!=(r=l.projectId)?r:"","-").concat(t.publishedId,"-").concat(n)}),NE={enabled:!0},NP={enabled:!1},NA=Nj((e,t,n)=>{let i=Nw(e.schema,n);return NT(e.client,t,n).pipe((0,ab.w)(e=>(0,ao.a)([e.draft.snapshots$,e.published.snapshots$,e.transactionsPendingEvents$.pipe((0,ag.U)(e=>"begin"===e.phase?NE:NP),(0,ak.O)(NP))])),(0,ag.U)(e=>{let[r,l,a]=e;return{id:t.publishedId,type:n,draft:r,published:l,liveEdit:i,ready:!0,transactionSyncLock:a}}),(0,ak.O)({id:t.publishedId,type:n,draft:null,published:null,liveEdit:i,ready:!1,transactionSyncLock:null}),(0,aZ._)(1),(0,aL.x)())},(e,t,n)=>Nk(e.client,t,n)),NO=Nj((e,t,n)=>NT(e.client,t,n).pipe((0,ab.w)(i=>(0,ao.a)([i.draft.snapshots$,i.published.snapshots$]).pipe((0,ag.U)(r=>{let[l,a]=r;return{...e,idPair:t,typeName:n,snapshots:{draft:l,published:a},draft:i.draft,published:i.published}}))),(0,aZ._)(1),(0,aL.x)()),(e,t,n)=>{var i,r;let l=e.client.config();return"".concat(null!=(i=l.dataset)?i:"","-").concat(null!=(r=l.projectId)?r:"","-").concat(t.publishedId,"-").concat(n)}),Nz={disabled:e=>{let{snapshots:t}=e;return!t.draft&&!t.published&&"NOTHING_TO_DELETE"},execute:e=>{let{client:t,schema:n,idPair:i,typeName:r}=e,l=t.observable.transaction().delete(i.publishedId);return Nw(n,r)?l.commit({tag:"document.delete"}):l.delete(i.draftId).commit({tag:"document.delete",skipCrossDatasetReferenceValidation:!0})}},NM={disabled:e=>{let{schema:t,typeName:n,snapshots:i}=e;return Nw(t,n)?"LIVE_EDIT_ENABLED":!i.draft&&(i.published?"ALREADY_PUBLISHED":"NO_CHANGES")},execute:e=>{let{client:t,idPair:n,snapshots:i}=e;if(!i.draft)throw Error('cannot execute "publish" when draft is missing');let r=function e(t){return(0,lX.Yk)(t)?t._strengthenOnPublish?sw()(t,["_strengthenOnPublish"].concat(t._strengthenOnPublish.weak?[]:["_weak"])):t:"object"==typeof t&&t?Array.isArray(t)?t.map(e):Object.fromEntries(Object.entries(t).map(t=>{let[n,i]=t;return[n,e(i)]})):t}(sw()(i.draft,"_updatedAt")),l=t.observable.transaction();if(!i.draft)throw Error('cannot execute "publish" when draft is missing');return i.published?(l.patch(n.publishedId,{unset:["_revision_lock_pseudo_field_"],ifRevisionID:i.published._rev}),l.createOrReplace({...r,_id:n.publishedId,_type:i.draft._type})):l.create({...r,_id:n.publishedId,_type:i.draft._type}),l.delete(n.draftId),l.commit({tag:"document.publish",visibility:"async"})}},NI={disabled:()=>!1,execute:function(e){let{schema:t,snapshots:n,idPair:i,draft:r,published:l,typeName:a}=e,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],s=arguments.length>2?arguments[2]:void 0;Nw(t,a)?l.mutate([l.createIfNotExists({_type:a,...s}),...l.patch(o)]):r.mutate([r.createIfNotExists({...s,...n.published,_id:i.draftId,_type:a}),...r.patch(o)])}},NR={disabled:()=>!1,execute:e=>{let{draft:t,published:n}=e;return t.commit(),n.commit(),aa.E}},NF={disabled:e=>{let{snapshots:t}=e;return t.draft?!t.published&&"NOT_PUBLISHED":"NO_CHANGES"},execute:e=>{let{client:t,idPair:n}=e;return t.observable.transaction().delete(n.draftId).commit({tag:"document.discard-changes"})}},ND={disabled:e=>{let{schema:t,snapshots:n,typeName:i}=e;return Nw(t,i)?"LIVE_EDIT_ENABLED":!n.published&&"NOT_PUBLISHED"},execute:e=>{let{client:t,idPair:n,snapshots:i}=e,r=t.observable.transaction().delete(n.publishedId);return i.published&&(r=r.createIfNotExists({...sw()(i.published,"_updatedAt"),_id:n.draftId,_type:i.published._type})),r.commit({tag:"document.unpublish",visibility:"async",skipCrossDatasetReferenceValidation:!0})}},NZ=["_createdAt","_updatedAt"],NL={disabled:e=>{let{snapshots:t}=e;return!t.published&&!t.draft&&"NOTHING_TO_DUPLICATE"},execute:(e,t)=>{let{schema:n,client:i,snapshots:r,typeName:l}=e,a=r.draft||r.published;if(!a)throw Error("cannot execute on empty document");return i.observable.create({...sw()(a,NZ),_id:Nw(n,l)?t:cs(t),_type:a._type},{tag:"document.duplicate"})}},Nq={disabled:()=>!1,execute:(e,t)=>{let{historyStore:n,schema:i,idPair:r,typeName:l}=e,a=Nw(i,l)?r.publishedId:r.draftId;return n.restore(r.publishedId,a,t)}},NN=Nj((e,t,n)=>NC(e,t,n).pipe((0,ab.w)(e=>{let{draft:t,published:n}=e;return(0,ao.a)([t.consistency$,n.consistency$])}),(0,ag.U)(e=>{let[t,n]=e;return t&&n}),(0,ax.x)(),(0,aZ._)(1),(0,aL.x)()),(e,t,n)=>{var i,r;let l=e.config();return"".concat(null!=(i=l.dataset)?i:"","-").concat(null!=(r=l.projectId)?r:"","-").concat(t.publishedId,"-").concat(n)}),NV={del:Nz,delete:Nz,publish:NM,patch:NI,commit:NR,discardChanges:NF,unpublish:ND,duplicate:NL,restore:Nq},NU=(e,t,n)=>{let i=NV[e];return(0,at.P)(()=>{var e;return(0,ae.T)((0,l6.of)(null),void 0===(e=i.execute(t,...n))?(0,l6.of)(null):e)}).pipe((0,aN.Z)())},NB=new l7.x;function NK(e,t,n,i){NB.next({operationName:e,idPair:t,typeName:n,extraArgs:i})}let NH=["publish","unpublish","discardChanges","delete"],NW=Nj(e=>{let t=NB.pipe((0,aV.v)(e=>e.idPair.publishedId),(0,aT.z)(t=>t.pipe((0,ab.w)(t=>NO(e,t.idPair,t.typeName).pipe((0,aS.q)(1),(0,ab.w)(n=>{let i=NH.includes(t.operationName);i&&(n.published.commit(),n.draft.commit());let r=NN(e.client,t.idPair,t.typeName).pipe((0,aj.h)(Boolean));return(i?r.pipe((0,aS.q)(1)):(0,l6.of)(!0)).pipe((0,ab.w)(()=>NU(t.operationName,n,t.extraArgs)))}),(0,ag.U)(()=>({type:"success",args:t})),(0,av.K)(e=>(0,l6.of)({type:"error",args:t,error:e})))))),(0,az.B)()),n=t.pipe((0,aj.h)(e=>"success"===e.type&&"patch"===e.args.operationName),(0,aU.p)(1e3,ap.z,{leading:!0,trailing:!0}),(0,am.b)(e=>{NK("commit",e.args.idPair,e.args.typeName,[])}));return(0,ae.T)(t,n.pipe((0,aC.j)(aa.E)))},e=>{var t,n;let i=e.client.config();return"".concat(null!=(t=i.dataset)?t:"","-").concat(null!=(n=i.projectId)?n:"")}),N$=Nj((e,t,n)=>NC(e,t,n).pipe((0,ab.w)(e=>{let{published:t,draft:n}=e;return(0,ae.T)(t.remoteSnapshot$,n.remoteSnapshot$)})),Nk),NX={isValidating:!0,validation:[]},NG=[],NY=(e,t)=>e(t).pipe((0,ag.U)(e=>{let{published:t}=e;return t.available}));function NJ(){return(0,aw.d)({bufferSize:1,refCount:!0})}let NQ=Nj((e,t,n)=>{let{draftId:i,publishedId:r}=t,l=NA(e,{draftId:i,publishedId:r},n).pipe((0,ag.U)(e=>{let{draft:t,published:n}=e;return t||n}),(0,aU.p)(200,ap.z,{trailing:!0}),(0,ax.x)((e,t)=>(null==e?void 0:e._rev)===(null==t?void 0:t._rev)||a6()(sw()(e,"_rev","_updatedAt"),sw()(t,"_rev","_updatedAt"))),NJ()),a=l.pipe((0,ag.U)(e=>(0,dr.u4)(e,(e,t)=>((0,lX.Yk)(t)&&e.add(t._ref),e),new Set)),(0,aT.z)(e=>(0,as.D)(e))).pipe((0,aV.v)(e=>e,{duration:()=>(0,ai.H)(18e5)}),(0,aT.z)(t=>t.pipe((0,aB.E)(),(0,aT.z)(t=>NY(e.observeDocumentPairAvailability,t).pipe((0,ag.U)(e=>[t,e]))))),(0,ay.R)((e,t)=>{let[n,i]=t;return e[n]===i?e:{...e,[n]:i}},{}),(0,ax.x)(a6()),NJ()),o=e=>{let{id:t}=e;return(0,ah.n)(a.pipe((0,aI.P)(e=>t in e),(0,ag.U)(e=>e[t])))},s=a.pipe((0,aD.T)(1),(0,aU.p)(1e3,ap.z,{leading:!0,trailing:!0}));return(0,ao.a)([l,(0,l8.z)((0,l6.of)(null),s)]).pipe((0,ag.U)(e=>{let[t]=e;return t}),(0,dl.q)(t=>(0,at.P)(()=>(null==t?void 0:t._type)?(0,l8.z)((0,l6.of)({isValidating:!0,revision:t._rev}),(function(e,t,n,i){let r=n.get(t._type);return r?(function e(t){let{value:n,type:i,path:r=[],parent:l,...a}=t,o=fy(i),s=o.map(e=>(0,at.P)(()=>e.validate(n,{...a,parent:l,path:r,type:i}))),d=[],c=o.some(e=>e.isRequired());if((null==i?void 0:i.jsonType)==="object"&&(n||null==n&&c)){let t=i.fields.reduce((e,t)=>(e[t.name]=t.type,e),{});d=(d=d.concat(o.map(e=>e._fieldRules).filter(fw).flatMap(e=>Object.entries(e)).flatMap(e=>{let[i,l]=e,o=t[i];return fy({...o,validation:l}).map(e=>{let t=fj(n)?n[i]:void 0;return(0,at.P)(()=>e.validate(t,{...a,parent:n,path:r.concat(i),type:o}))})}))).concat(i.fields.map(t=>e({...a,parent:n,value:fj(n)?n[t.name]:void 0,path:r.concat(t.name),type:t.type})))}return(null==i?void 0:i.jsonType)==="array"&&Array.isArray(n)&&(d=d.concat(n.map((t,l)=>e({...a,parent:n,value:t,path:r.concat((0,lX.fU)(t)?{_key:t._key}:l),type:function(e,t){if(1===t.length)return t[0];let n=(0,lX.ay)(e)&&e._type,i=null==e||!n&&hX(e).toLowerCase();return i&&"object"!==i?t.find(e=>e.jsonType===i):t.find(e=>{var t;return(null==(t=e.type)?void 0:t.name)===n})||t.find(e=>e.name===n)||t.find(e=>"object"===e.name&&"object"===i)}(t,i.of)})))),(0,at.P)(()=>(0,ae.T)([...s,...d])).pipe((0,aT.z)(e=>{var t;return(0,l8.z)(new al.y(e=>{let n=fu(()=>{e.complete()},t?{timeout:t}:void 0);return()=>fp(n)}),e)},40),(0,aE.J)(),(0,aP.q)(),(0,ag.U)(ow()),(0,ag.U)(e=>o.some(e=>e._fieldRules)?oC()(e,e=>JSON.stringify(e)):e))})({getClient:e,schema:n,parent:void 0,value:t,path:[],document:t,type:r,getDocumentExists:null==i?void 0:i.getDocumentExists}).pipe((0,av.K)(e=>(console.error(e),(0,l6.of)([{type:"validation",level:"error",path:[],item:new hU(null==e?void 0:e.message)}])))):(console.warn('Schema type for object type "%s" not found, skipping validation',t._type),(0,l6.of)(fk))})(e.getClient,t,e.schema,{getDocumentExists:o}).pipe((0,ag.U)(e=>({validation:e,isValidating:!1})))):(0,l6.of)({validation:NG,isValidating:!1}))),(0,ay.R)((e,t)=>({...e,...t}),NX),NJ())},(e,t,n)=>{var i,r;let l=e.client.config();return"".concat(null!=(i=l.dataset)?i:"","-").concat(null!=(r=l.projectId)?r:"","-").concat(t.publishedId,"-").concat(n)}),N0=Nj((e,t,n)=>NC(e,t,n).pipe((0,ab.w)(e=>{let{draft:t,published:n}=e;return(0,ae.T)(t.events,n.events)})),Nk);function N1(e){return{disabled:"NOT_READY",execute:()=>{throw Error("Called ".concat(e," before it was ready."))}}}let N2={commit:N1("commit"),delete:N1("delete"),del:N1("del"),publish:N1("publish"),patch:N1("patch"),discardChanges:N1("discardChanges"),unpublish:N1("unpublish"),duplicate:N1("duplicate"),restore:N1("restore")},N3=(e,t,n)=>function(){for(var i=arguments.length,r=Array(i),l=0;l<i;l++)r[l]=arguments[l];return NK(e,t,n,r)};function N4(e,t,n){return{disabled:t.disabled(n),execute:N3(e,n.idPair,n.typeName)}}function N5(e){return{commit:N4("commit",NR,e),delete:N4("delete",Nz,e),del:N4("delete",Nz,e),publish:N4("publish",NM,e),patch:N4("patch",NI,e),discardChanges:N4("discardChanges",NF,e),unpublish:N4("unpublish",ND,e),duplicate:N4("duplicate",NL,e),restore:N4("restore",Nq,e)}}let N6=Nj((e,t,n)=>{let i=NW(e),r=NO(e,t,n).pipe((0,ag.U)(N5));return(0,l8.z)((0,l6.of)(N2),(0,ae.T)(i.pipe((0,aT.z)(()=>aa.E)),r)).pipe((0,aw.d)({refCount:!0,bufferSize:1}))},(e,t,n)=>Nk(e.client,t,n)),N8=(e,t,n,i)=>(0,at.P)(()=>e.observable.fetch(t,n,{tag:i.tag,filterResponse:!0,perspective:i.perspective})),N9=(e,t,n,i)=>(0,at.P)(()=>e.listen(t,n,{events:["welcome","mutation","reconnect"],includeResult:!1,visibility:"query",tag:i.tag}));function N7(e){return"welcome"===e.type}let Ve=["_key","_ref","_weak","_type"];function Vt(e){return e&&e.length>0?'"'.concat(e,'"'):e}function Vn(e,t){let n=e=>'Template "'.concat(t.id,'" initial value: ').concat(e);if(!sU()(e))throw Error(n("resolved to a non-object"));if(e._type&&t.schemaType!==e._type)throw Error(n('includes "_type"-property ('.concat(e._type,") that does not match template (").concat(t.schemaType,")")));try{return function e(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(Array.isArray(t))return t.map((t,i)=>{if(Array.isArray(t))throw Error('multidimensional arrays are not supported (at path "'.concat((0,lY.BB)(n),'")'));return e(t,n.concat(i),!0)});if(!sU()(t))return t;let r=i&&!t._key?{_key:(0,sT.E2)()}:{};return n.length>0&&!t._type&&t._ref&&(r._type="reference"),t._ref&&function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(!e._type&&e.type)throw Error('Reference is missing "_type", but has a "type" property at path "'.concat((0,lY.BB)(t),'"'));let n=Object.keys(e).filter(e=>!Ve.includes(e));if(n.length>0){let e=n.length>1?"properties":"property";throw Error("Disallowed ".concat(e," found in reference: ").concat(n.map(Vt).join(", "),' at path "').concat((0,lY.BB)(t),'"'))}}(t,n),Object.keys(t).reduce((i,r)=>(i[r]=e(t[r],n.concat([r])),i),r)}(e)}catch(e){throw e.message=n(e.message),e}}function Vi(e,t){let n={...e,...t};return Object.keys(n).forEach(i=>{let r=t[i],l=e[i];sU()(r)&&sU()(l)&&(n[i]=Vi(l,r))}),n}async function Vr(e,t,n){return"function"==typeof e?e(t,n):e}async function Vl(e,t){var n,i;let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},l=arguments.length>3?arguments[3]:void 0;if(sU()(t)&&"function"==typeof t.serialize)return Vl(e,t.serialize(),r,l);let{id:a,schemaType:o,value:s}=t;if(!s)throw Error('Template "'.concat(a,'" has invalid "value" property'));let d=await Vr(s,r,l);if(n=d,!sU()(n))throw Error('Template "'.concat(a,'" has invalid "value" property - must be a plain object or a resolver function returning a plain object'));i=d,sU()(i)&&!Object.keys(d).length&&(d={_type:o}),d=Vn(d,t);let c=e.get(o);if(!c)throw Error('Could not find schema type with name "'.concat(o,'".'));return Vn(Vi(await Vo(c,r,Va,l)||{},d),t)}let Va=10;function Vo(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Va,i=arguments.length>3?arguments[3]:void 0;return n<=0?Promise.resolve(void 0):(0,lX.m$)(e)?Vd(e,t,n,i):(0,lX.jB)(e)?Vs(e,t,n,i):Vr(e.initialValue,t,i)}async function Vs(e,t,n,i){let r=await Vr(e.initialValue,void 0,i);if(Array.isArray(r))return Promise.all(r.map(async r=>{let l=function(e,t){let n=(0,sT.wq)(t);return"object"===n&&1===e.of.length?e.of[0]:e.of.find(e=>e.name===n)}(e,r);return(0,lX.m$)(l)?{...r,...await Vo(l,t,n-1,i),_key:(0,sT.E2)()}:r}))}async function Vd(e,t,n,i){let r={...await Vr(e.initialValue,t,i)||{}},l={};await Promise.all(e.fields.map(async e=>{let r=await Vo(e.type,t,n-1,i);null!=r&&(l[e.name]=r)}));let a=Vi(l,r);if(!(0,sT.Ru)(a))return"object"!==e.name&&(a._type=e.name),a}let Vc={type:"loading"};function Vu(e){if(ca(e))throw Error("editOpsOf does not expect a draft id.");return{publishedId:e,draftId:cs(e)}}let Vp={isLoaded:!1,documentType:void 0};function Vh(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"*",n=Uw(),i=cd(e),r=!!(t&&"*"!==t),l=(0,lJ.useMemo)(()=>({documentType:t,isLoaded:!0}),[t]),[a,o]=(0,lJ.useState)(r?l:Vp);return(0,lJ.useEffect)(()=>o(Vp),[i,t]),(0,lJ.useEffect)(()=>{if(r)return;let e=n.resolveTypeForDocument(i,t).subscribe(e=>o({documentType:e,isLoaded:!0}));return()=>e.unsubscribe()},[n,i,t,r]),r?l:a}function Vf(e){let{documentId:t,documentType:n,templateName:i,templateParams:r}=e,l=cn(r),a=Uw(),o=Vm(),s=(0,lJ.useMemo)(()=>({_id:t,_type:n}),[t,n]),[d,c]=(0,lJ.useState)({loading:!1,error:null,value:s});return(0,lJ.useEffect)(()=>{if(!i){c({loading:!0,error:null,value:s});return}let e=a.initialValue({documentId:t,documentType:n,templateName:i,templateParams:l},o).subscribe(e=>{"loading"===e.type&&c({loading:!0,error:null,value:s}),"success"===e.type&&c({loading:!1,error:null,value:e.value?{...s,...e.value}:s}),"error"===e.type&&c({loading:!1,error:e.error,value:s})});return c({loading:!0,error:null,value:s}),()=>e.unsubscribe()},[s,t,a,n,i,l,o]),d}function Vm(){let e=Ic(),t=q6(),n=Ns(),i=q5(),r=q1(),l=e.getClient;return(0,lJ.useMemo)(()=>({projectId:i,dataset:r,getClient:l,schema:t,currentUser:n}),[l,t,n,i,r])}function Vg(){let e=Vm();return(0,lJ.useCallback)((t,n)=>Vo(t,n,Va,e),[e])}let Vx=ci(function(e){let{client:t,grantsStore:n,schema:i,id:r,permission:l,type:a}=e;if("*"===a)return(0,l6.of)({granted:!1,reason:"Type specified was `*`"});let o=!!function(e,t){let n=e.get(t);if(!n)throw Error("No such schema type: ".concat(t));return n}(i,a).liveEdit;return NT(t,{draftId:cs(r),publishedId:cd(r)},a).pipe((0,ab.w)(e=>(0,ao.a)([e.draft.snapshots$,e.published.snapshots$]).pipe((0,ag.U)(e=>{let[t,n]=e;return{draft:t,published:n}}))),(0,ab.w)(e=>{let{draft:t,published:i}=e,r=(function(e){let{grantsStore:t,permission:n,draft:i,published:r,liveEdit:l}=e,a=i||r,o=a===i?"draft":"published",{checkDocumentPermission:s}=t;switch(n){case"delete":if(l)return[["delete published document (live-edit)",s("update",r)]];return[["delete draft document",s("update",i)],["delete published document",s("update",r)]];case"discardDraft":if(l)return[];return[["delete draft document",s("update",i)]];case"publish":if(l)return[];return[["update published document at its current state",s("update",r)],["delete draft document",s("update",i)],["create published document from draft",s("create",i&&{...i,_id:cd(i._id)})]];case"unpublish":if(l)return[];return[["update draft document at its current state",s("create",i)],["delete published document",s("update",r)],["create draft document from published version",s("create",r&&{...r,_id:cs(r._id)})]];case"update":if(l)return[["update published document (live-edit)",s("update",r)]];return[["update ".concat(o," document"),s("update",a)]];case"duplicate":if(l)return[["create new published document from existing document (live-edit)",s("create",{...r,_id:"dummy-id"})]];return[["create new draft document from existing ".concat(o," document"),s("create",{...a,_id:cs("dummy-id")})]];default:throw Error("Could not match permission: ".concat(n))}})({grantsStore:n,permission:l,draft:t,published:i,liveEdit:o}).map(e=>{let[t,n]=e;return n.pipe((0,ag.U)(e=>{let{granted:n,reason:i}=e;return{granted:n,reason:n?"":"not allowed to ".concat(t,": ").concat(i),label:t,permission:l}}))});return r.length?(0,ao.a)(r).pipe((0,ag.U)(e=>{let t=e.every(e=>e.granted),n=t?"":"Unable to ".concat(l,":\n	").concat(e.filter(e=>!e.granted).map(e=>e.reason).join("\n	"));return{granted:t,reason:n}})):(0,l6.of)({granted:!0,reason:""})}))});function Vv(e){let{id:t,type:n,permission:i,client:r,schema:l,grantsStore:a}=e,o=qJ(fT),s=q6(),d=Ub(),c=(0,lJ.useMemo)(()=>r||o,[o,r]),u=(0,lJ.useMemo)(()=>l||s,[s,l]),p=(0,lJ.useMemo)(()=>a||d,[d,a]);return Vx((0,lJ.useMemo)(()=>({client:c,schema:u,grantsStore:p,id:t,permission:i,type:n}),[c,p,t,i,u,n]))}function Vb(e){let{grantsStore:t,document:n,permission:i}=e,{checkDocumentPermission:r}=t;return r(i,n)}let Vy=ci(Vb);function Vj(e){let{document:t,permission:n,...i}=e,r=Ub();return Vy({grantsStore:i.grantsStore||r,document:t,permission:n})}let Vw=ci(function(e){let{grantsStore:t,templateItems:n,templates:i,schema:r,context:l}=e;return(null==n?void 0:n.length)?(0,ao.a)(n.map(function e(t){return"object"==typeof t&&null!==t&&"serialize"in t?e(t.serialize()):t}).map(async e=>{let t=i.find(t=>t.id===e.templateId);if(!t)throw Error('template not found: "'.concat(e.templateId,'"'));let n=await Vl(r,t,e.parameters,l);return{template:t,item:e,resolvedInitialValue:n}}).map(e=>(0,as.D)(e).pipe((0,ab.w)(e=>{let{item:n,resolvedInitialValue:i,template:l}=e,a=r.get(l.schemaType);if(!a)throw Error('schema type not found: "'.concat(l.schemaType,'"'));let o=null==a?void 0:a.liveEdit,{initialDocumentId:s="dummy-id"}=n;return Vb({grantsStore:t,permission:"create",document:{_id:o?cd(s):cs(s),...i}}).pipe((0,ag.U)(e=>{let{granted:t,reason:r}=e,o=n.title||l.title;return{...n,granted:t,reason:r,resolvedInitialValue:i,template:l,title:o,subtitle:a.title===o?void 0:a.title,description:n.description||l.description,icon:n.icon||l.icon}}))})))):(0,l6.of)([])});function Vk(e){let{templateItems:t,...n}=e,i=q6(),r=Ne(),l=Ub(),a=Vm();return Vw({templateItems:t,grantsStore:n.grantsStore||l,schema:n.schema||i,templates:n.templates||r,context:a})}let VC="_debug_",V_="undefined"==typeof window?(0,l6.of)({}):(0,l9.R)(window,"hashchange"),VS=(0,l8.z)((0,l6.of)(0),V_).pipe((0,ag.U)(()=>"undefined"==typeof document?"#":document.location.hash),(0,ax.x)(),(0,ag.U)(e=>e.substring(1).split(";").filter(e=>e.toLowerCase().startsWith(VC)).map(e=>e.substring(VC.length)))),VT=VS.pipe((0,ag.U)(e=>e.find(e=>e.startsWith("roles="))),(0,ag.U)(e=>(null==e?void 0:e.split("roles=")[1].split(",").map(e=>e.trim()))||[])),VE=[{filter:'_id in path("**")',permissions:["read","create","history","update"]}],VP=[{filter:'_id in path("**")',permissions:["read","history"]}],VA={administrator:[{filter:'_id in path("**")',permissions:["read","create","history","update"]}],editor:VE,developer:[{filter:'_id in path("**")',permissions:["read","create","history","update"]}],contributor:[{filter:'_id in path("**")',permissions:["read"]},{filter:'_id in path("drafts.**")',permissions:["create","history","update"]}],viewer:VP,restricted:[{filter:'_id in path("drafts.**") && _type in ["stringsTest", "book", "author", "referenceTest"]',permissions:["read","create","history","update"]},{filter:'_id in path("**")',permissions:["read"]}],requiresApproval:[{filter:"!locked",permissions:["read","create","update"]}],read:VP,write:VE},VO=VT.pipe((0,ag.U)(e=>e.length?e.filter(e=>!!e&&e in VA).flatMap(e=>VA[e]||[]):null));async function Vz(e,t,n){return await e.request({uri:"/projects/".concat(t,"/datasets/").concat(n,"/acl"),tag:"acl.get",withCredentials:!0})}let VM=new Map;async function VI(e,t,n){VM.has(t)||VM.set(t,(0,da.Qc)("*[".concat(t,"]")));let i=VM.get(t),r=function(e){let t={};return null!==e&&(t.identity=e.id),t}(e),{identity:l}=r,a={...r},o=await (await (0,da.ku)(i,{dataset:[n],identity:l,params:a})).get();return(null==o?void 0:o.length)===1}async function VR(e,t,n,i){if(!i)return{granted:!0,reason:"Null document, nothing to check"};if(!t.length)return{granted:!1,reason:"No document grants"};let r=[];for(let n of t)await VI(e,n.filter,i)&&r.push(n);let l=r.some(e=>e.permissions.some(e=>e===n));return{granted:l,reason:l?"Matching grant":"No matching grants found"}}async function VF(e,t){return function(e){let t;let n=e.body;if(!n)throw Error("Failed to read body from response");let i=!1;return new ReadableStream({start(e){t=n.getReader();let r=new TextDecoder,l="";t.read().then(function n(a){if(a.done){if(i)return;if(0===(l=l.trim()).length){e.close();return}e.enqueue(JSON.parse(l)),e.close();return}let o=(l+=r.decode(a.value,{stream:!0})).split("\n");for(let n=0;n<o.length-1;++n){let r=o[n].trim();if(0!==r.length)try{e.enqueue(JSON.parse(r))}catch(n){e.error(n),i=!0,t.cancel();return}}return l=o[o.length-1],t.read().then(n).catch(t=>e.error(t))}).catch(t=>e.error(t))},cancel(){i=!0,t.cancel()}})}(await fetch(e,t?{headers:{Authorization:"Bearer ".concat(t)}}:{credentials:"include"}))}function VD(e){return{id:e,hasAttrs:!1,attrs:null,rev:null,events:[],aligned:!1}}function VZ(e,t){if(e.hasAttrs=!0,t){if(e.attrs={...t},"string"!=typeof e.attrs._rev)throw Error("snapshot has no _rev");e.rev=e.attrs._rev,delete e.attrs._rev}else e.attrs=null,e.rev=null;e.events=[]}class VL{constructor(e){this.earliestTransactionId=null,this.timeline=e,this._states={draft:VD(e.draftId),published:VD(e.publishedId)}}appendRemoteSnapshotEvent(e){let t=this._states[e.version];if("snapshot"===e.type){this._maybeInvalidateHistory(),VZ(t,e.document);return}"remoteMutation"===e.type&&(t.aligned?(this._apply(t,e),this.timeline.addRemoteMutation(e)):t.hasAttrs?t.events.push(e):VZ(t,e.head))}prependHistoryEvent(e){if(!this.acceptsHistory)throw Error("cannot prepend history at this point");for(let t of Object.values(this._states))if(!t.aligned){let n=function(e,t){let n=t.events.findIndex(t=>e.id===t.transactionId);return n>=0?n+1:t.rev?t.rev===e.id?0:-1:0}(e,t);n>=0&&this._alignAtIndex(t,n)}this.timeline.addTranslogEntry(e),this.earliestTransactionId=e.id}didReachEarliestEntry(){for(let e of Object.values(this._states))if(!e.aligned){if(null!==e.attrs)throw Error("unable to find translog entry to align to");this._alignAtIndex(e,0)}this.timeline.didReachEarliestEntry()}get isAligned(){return Object.values(this._states).every(e=>e.aligned)}get acceptsHistory(){return this._isComplete}get currentDocument(){return{draft:this._states.draft.attrs,published:this._states.published.attrs}}_alignAtIndex(e,t){for(let n of e.events.slice(0,t))this._apply(e,n);for(let n of e.events.slice(t))this._apply(e,n),this.timeline.addRemoteMutation(n);e.events=[],e.aligned=!0}get _isComplete(){return Object.values(this._states).every(e=>e.hasAttrs)}_apply(e,t){e.attrs=(0,dd.a)(e.attrs,t.effects.apply),e.rev=t.transactionId}_maybeInvalidateHistory(){if(this._isComplete){for(let e of Object.values(this._states))e.aligned=!1;this.earliestTransactionId=null,this.timeline.reset()}}}class Vq{constructor(e,t,n,i){this.timeline=e,this.start=n,this.end=i,this.doc=t}same(e,t){return this.start===e&&this.end===t}endAttributes(){return VN(this.endDocument())}endDocument(){return this._endDocument||(this._endDocument=this.timeline.replayBackwardsUntil(this.end.end,this.doc)),this._endDocument}startAttributes(){return VN(this.startDocument())}startDocument(){if(!this.start)throw Error("start required");return this._startDocument||(this._startDocument=this.timeline.replayBackwardsBetween(this.start.end,this.end.end-1,this.endDocument())),this._startDocument}diff(){if(!this._diff){if(!this.start)throw Error("start required");this._diff=this.timeline.calculateDiff(this.startDocument(),this.endDocument(),this.start.index+1,this.end.index)}return this._diff}}function VN(e){return e.draft||e.published}class VV{constructor(e){this.version=0,this.selectionState="inactive",this._fetchMore=!1,this._fetchAtLeast=0,this._isRunning=!1,this._isSuspended=!1,this._didErr=!1,this._since=null,this._sinceTime=null,this._rev=null,this._revTime=null,this.timeline=e.timeline,this.client=e.client,this.handler=e.handler,this._aligner=new VL(this.timeline),this.markChange()}clearRange(){this.setRange(null,null)}setRange(e,t){t!==this._rev&&this.setRevTime(t),e!==this._since&&this.setSinceTime(e);let n=10;if("loading"!==this._sinceTime&&"loading"!==this._revTime&&this._aligner.isAligned){if("invalid"===this._sinceTime||"invalid"===this._revTime)this.selectionState="invalid";else if(this._sinceTime){this.selectionState="range";let e=this._revTime||this.timeline.lastChunk();this._sinceTime.index>e.index?(this._revTime="invalid",this.selectionState="invalid"):this.setReconstruction(this._sinceTime,e)}else this._revTime?(this.selectionState="rev",this.setReconstruction(null,this._revTime)):(this.selectionState="inactive",n=0)}else this.selectionState="loading";this._fetchAtLeast=n,this.start()}setLoadMore(e){this._fetchMore=e,this.start()}get sinceTime(){return this._sinceTime&&"object"==typeof this._sinceTime?this._sinceTime:null}get revTime(){return this._revTime&&"object"==typeof this._revTime?this._revTime:null}get realRevChunk(){return this.revTime||this.timeline.lastChunk()}onOlderRevision(){return!!this._rev&&("range"===this.selectionState||"rev"===this.selectionState)}findRangeForNewRev(e){let t=this.timeline.isLatestChunk(e)?null:this.timeline.createTimeId(e);if(!this._since)return[null,t];let n=this.sinceTime;return n&&n.index<e.index?[this._since,t]:["@lastPublished",t]}findRangeForNewSince(e){let t=this.revTime;return t&&e.index<t.index?[this.timeline.createTimeId(e),this._rev]:[this.timeline.createTimeId(e),null]}setRevTime(e){this._rev=e,this._revTime=e?this.timeline.parseTimeId(e):null,"@lastPublished"===this._since&&(this._since=null,this._sinceTime=null)}setSinceTime(e){"@lastPublished"===e?"string"==typeof this._revTime?this._sinceTime=this._revTime:this._sinceTime=this.timeline.findLastPublishedBefore(this._revTime):this._sinceTime=e?this.timeline.parseTimeId(e):null,this._since=e}sinceAttributes(){return this._sinceTime&&this._reconstruction?this._reconstruction.startAttributes():null}displayed(){return this._revTime&&this._reconstruction?this._reconstruction.endAttributes():null}setReconstruction(e,t){this._reconstruction&&this._reconstruction.same(e,t)||(this._reconstruction=new Vq(this.timeline,this._aligner.currentDocument,e,t))}currentDiff(){return this._reconstruction?this._reconstruction.diff():null}currentObjectDiff(){let e=this.currentDiff();if(e){if("null"===e.type)return null;if("object"!==e.type)throw Error("ObjectDiff expected, got ".concat(e.type))}return e}handleRemoteMutation(e){this._aligner.appendRemoteSnapshotEvent(e),this.markChange(),this._aligner.acceptsHistory&&this.start()}start(){this._didErr||this._isRunning||(this._isRunning=!0,this.tick().then(()=>{this._isRunning=!1}))}resume(){this._isSuspended=!1}suspend(){this._isSuspended=!0}async tick(){var e;if(this._aligner.acceptsHistory&&!this.timeline.reachedEarliestEntry&&("loading"===this.selectionState||this._fetchMore||this.timeline.chunkCount<=this._fetchAtLeast)&&!this._isSuspended){try{await this.fetchMoreTransactions()}catch(t){this._didErr=!0,null==(e=this.handler)||e.call(this,t,this);return}await this.tick()}}async fetchMoreTransactions(){let e=this.timeline.publishedId,t=this.timeline.draftId,n=this.client.config(),i="tag=sanity.studio.desk.history&effectFormat=mendoza&excludeContent=true&excludeMutations=true&includeIdentifiedDocumentsOnly=true&reverse=true&limit=".concat(50),r=this._aligner.earliestTransactionId;r&&(i+="&toTransaction=".concat(r));let l=this.client.getUrl("/data/history/".concat(n.dataset,"/transactions/").concat(e,",").concat(t,"?").concat(i)),a=(await VF(l,n.token)).getReader(),o=0;for(;;){let e=await a.read();if(e.done)break;if("error"in e.value)throw Error(e.value.error.description||e.value.error.type);if(o++,e.value.id!==r){if(this._aligner.earliestTransactionId!==r||!this._aligner.acceptsHistory)return;this._aligner.prependHistoryEvent(e.value),r=this._aligner.earliestTransactionId}}this._aligner.earliestTransactionId===r&&this._aligner.acceptsHistory&&(o<50&&this._aligner.didReachEarliestEntry(),this.markChange())}markChange(){var e;this.timeline.updateChunks(),this.setRevTime(this._rev),this.setSinceTime(this._rev),this.version++,null==(e=this.handler)||e.call(this,null,this)}}function VU(e){return e.draft||e.published}class VB{constructor(e,t,n,i){this.type="array",this.elements=[],this.content=e,this.value=t,this.annotation=n,this.extractor=i,this.length=e.elements.length}at(e){if(e>=this.length)throw Error("out of bounds");return this.elements[e]||(this.elements[e]=VW(this.content.elements[e],this.value[e],this.extractor))}annotationAt(e){let t=this.content.metas[e];return this.extractor.fromMeta(t)}}class VK{constructor(e,t,n,i){this.type="object",this.fields={},this.content=e,this.value=t,this.annotation=n,this.extractor=i,this.keys=Object.keys(e.fields)}get(e){let t=this.fields[e];if(t)return t;let n=this.content.fields[e];if(n)return this.fields[e]=VW(n,this.value[e],this.extractor)}}class VH{constructor(e,t,n,i){this.type="string",this.content=e,this.value=t,this.annotation=n,this.extractor=i}sliceAnnotation(e,t){let n=[],i=0;for(let r of this.content.parts){let l=r.value.length,a=Math.max(0,e-i);if(a<l){let e=Math.min(l,t-i);if(e<=0)break;!function(e,t){if(n.length>0){var i;let r=n[n.length-1];if((i=r.annotation)&&t?i.author===t.author&&i.chunk===t.chunk:!i&&!t){r.text+=e;return}}n.push({text:e,annotation:t})}(r.value.slice(a,e),this.extractor.fromValue(r))}i+=l}return n}}function VW(e,t,n){let i=n.fromValue(e);if(e.content)switch(e.content.type){case"array":return new VB(e.content,t,i,n);case"object":return new VK(e.content,t,i,n);case"string":return new VH(e.content,t,i,n)}return(0,dc.r)(t,i)}function V$(e,t,n){return n?VG(e,n.transactionIndex+1,n.chunk.index):t?VG(e,t.start,t.index):null}function VX(e,t){return t?VG(e,t.transactionIndex,t.chunk.index):null}function VG(e,t,n){let i=e.transactionByIndex(t);if(!i)return null;let r=e.chunkByTransactionIndex(t,n);return r?{chunk:r,timestamp:i.timestamp,author:i.author}:null}class VY{constructor(){this._postive=[],this._negative=[]}addToEnd(e){e.index=this._postive.length,this._postive.push(e)}addToBeginning(e){if(0==this.length){this.addToEnd(e);return}e.index=-(this._negative.length+1),this._negative.push(e)}mergeAtEnd(e,t){if(0===this.length){this.addToEnd(e);return}let n=this.lastIdx,i=t(this.get(n),e);Array.isArray(i)?(this.set(n,i[0]),this.addToEnd(i[1])):this.set(n,i)}mergeAtBeginning(e,t){if(0===this.length){this.addToEnd(e);return}let n=this.firstIdx,i=t(e,this.get(n));Array.isArray(i)?(this.set(n,i[1]),this.addToBeginning(i[0])):this.set(n,i)}removeFromEnd(){0===this._postive.length?this._negative.shift():this._postive.pop()}has(e){return e>=0?e<this._postive.length:-(e+1)<this._negative.length}get(e){return e>=0?this._postive[e]:this._negative[-(e+1)]}set(e,t){e>=0?(t.index=e,this._postive[e]=t):(t.index=e,this._negative[-(e+1)]=t)}get lastIdx(){return this._postive.length-1}get last(){return this.get(this.lastIdx)}get firstIdx(){return-this._negative.length}get first(){return this.get(this.firstIdx)}get length(){return this._postive.length+this._negative.length}}function VJ(e,t){var n,i;if(e.end!==t.start)throw Error("chunks are not next to each other");let r=V1(e.draftState,t.draftState),l=V1(e.publishedState,t.publishedState);if("delete"===e.type&&"editDraft"===t.type)return[e,{...t,type:"create",draftState:r,publishedState:l}];if("delete"===t.type){if("missing"===r&&"present"===l)return[e,{...t,type:"discardDraft",draftState:r,publishedState:l}];if("present"===r&&"missing"===l)return[e,{...t,type:"unpublish",draftState:r,publishedState:l}]}if(("create"===(n=e.type)||"editDraft"===n)&&"editDraft"===t.type&&(i=e.endTimestamp,Date.parse(t.startTimestamp)-Date.parse(i)<3e5)){let n=new Set;for(let t of e.authors)n.add(t);for(let e of t.authors)n.add(e);return{index:0,id:t.id,type:e.type,start:e.start,end:t.end,startTimestamp:e.startTimestamp,endTimestamp:t.endTimestamp,authors:n,draftState:r,publishedState:l}}return[e,{...t,draftState:r,publishedState:l}]}function VQ(e){return e&&V2(null==e?void 0:e.apply)?"deleted":e?"upsert":"unedited"}function V0(e){let t=!!e.draftEffect,n=!!e.publishedEffect,i=e.draftEffect&&V2(e.draftEffect.apply),r=e.publishedEffect&&V2(e.publishedEffect.apply),l=function(e){let t=VQ(e.draftEffect),n=VQ(e.publishedEffect);if("unedited"===n){if("deleted"===t)return"delete";if("upsert"===t)return"editDraft"}if("deleted"===n)return"delete";if("upsert"===n){if("unedited"===t)return"editLive";if("deleted"===t)return"publish"}return"editLive"}(e);return{index:0,id:e.id,type:l,start:e.index,end:e.index+1,startTimestamp:e.timestamp,endTimestamp:e.timestamp,authors:new Set([e.author]),draftState:t?i?"missing":"present":"unknown",publishedState:n?r?"missing":"present":"unknown"}}function V1(e,t){return"unknown"===t?e:t}function V2(e){return 0===e[0]&&null===e[1]}class V3{constructor(e){this.reachedEarliestEntry=!1,this._transactions=new VY,this._chunks=new VY,this._possiblePendingTransactions=new Map,this.publishedId=e.publishedId,this.draftId="drafts.".concat(e.publishedId),e.enableTrace&&(this._trace=[],this._trace.push({type:"initial",publishedId:e.publishedId}),window.__sanityTimelineTrace=this._trace)}get chunkCount(){return this._chunks.length}mapChunks(e){let t=[],n=this._chunks.firstIdx,i=this._chunks.lastIdx;for(let r=i;r>=n;r--)t.push(e(this._chunks.get(r),r));return t}reset(){this._transactions=new VY,this._chunks=new VY,this._possiblePendingTransactions=new Map,this._recreateTransactionsFrom=void 0,this.reachedEarliestEntry=!1}addRemoteMutation(e){this._trace&&this._trace.push({type:"addRemoteMutation",event:e});let t=this._possiblePendingTransactions.get(e.transactionId),n=t?t.transaction:{index:0,id:e.transactionId,timestamp:e.timestamp.toISOString(),author:e.author};"draft"===e.version?n.draftEffect=e.effects:n.publishedEffect=e.effects,t?(this._possiblePendingTransactions.delete(e.transactionId),this._invalidateTransactionFrom(t.idx)):(this._transactions.addToEnd(n),this._possiblePendingTransactions.set(e.transactionId,{transaction:n,idx:this._transactions.lastIdx}))}addTranslogEntry(e){this._trace&&this._trace.push({type:"addTranslogEntry",event:e}),this._transactions.addToBeginning({index:0,id:e.id,author:e.author,timestamp:e.timestamp,draftEffect:e.effects[this.draftId],publishedEffect:e.effects[this.publishedId]})}didReachEarliestEntry(){this._trace&&this._trace.push({type:"didReachEarliestEntry"}),this.reachedEarliestEntry=!0}updateChunks(){this._trace&&this._trace.push({type:"updateChunks"}),this._removeInvalidatedChunks(),this._addChunksFromTransactions(),this._createInitialChunk()}_removeInvalidatedChunks(){if(this._recreateTransactionsFrom){for(;this._chunks.length>0;){let e=this._chunks.last;if(this._recreateTransactionsFrom<e.end)this._chunks.removeFromEnd();else break}this._recreateTransactionsFrom=void 0}}_addChunksFromTransactions(){let e=this._transactions.firstIdx,t=this._transactions.lastIdx,n=this._chunks.length>0?this._chunks.last.end:e;for(let e=n;e<=t;e++){let t=this._transactions.get(e);this._chunks.mergeAtEnd(V0(t),VJ)}if(0==this._chunks.length)return;let i=this._chunks.first.start;for(let t=i-1;t>=e;t--){let e=this._transactions.get(t);this._chunks.mergeAtBeginning(V0(e),VJ)}}_invalidateTransactionFrom(e){(void 0===this._recreateTransactionsFrom||e<this._recreateTransactionsFrom)&&(this._recreateTransactionsFrom=e)}_createInitialChunk(){var e;if(this.reachedEarliestEntry){if((null==(e=this._chunks.first)?void 0:e.type)==="initial")return;let t=this._transactions.first;if(!t)return;let n=V0(t);n.type="initial",n.id="@initial",n.end=n.start,this._chunks.addToBeginning(n)}}parseTimeId(e){if(0===this._chunks.length)return this.reachedEarliestEntry?"invalid":"loading";let t=e.split("/",3),n=t.shift(),i=t.shift(),r=Number(n);for(let e=this._chunks.lastIdx;e>=this._chunks.firstIdx;e--){let t=this._chunks.get(e);if(t.id===i)return t;if(Date.parse(t.endTimestamp)+36e5<r)return"invalid"}return this.reachedEarliestEntry?"invalid":"loading"}findLastPublishedBefore(e){for(let t=e?e.index-1:this._chunks.lastIdx;t>=this._chunks.firstIdx;t--){let e=this._chunks.get(t);if("publish"===e.type||"initial"===e.type)return e}return this.reachedEarliestEntry?this._chunks.first:"loading"}isLatestChunk(e){return e===this._chunks.last}createTimeId(e){return"".concat(e.endTimestamp.valueOf(),"/").concat(e.id)}lastChunk(){return this._chunks.last}transactionByIndex(e){return this._transactions.has(e)?this._transactions.get(e):null}chunkByTransactionIndex(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=t;for(;;){let t=this._chunks.get(n);if(!t)throw Error("transaction does not belong in any chunk");if(e>=t.end)n++;else{if(!(e<t.start))return t;n--}}}replayBackwardsBetween(e,t,n){let i=n.draft,r=n.published;for(let n=t;n>=e;n--){let e=this._transactions.get(n);e.draftEffect&&(i=(0,dd.a)(i,e.draftEffect.revert)),e.publishedEffect&&(r=(0,dd.a)(r,e.publishedEffect.revert))}return{draft:i,published:r}}replayBackwardsUntil(e,t){return this.replayBackwardsBetween(e,this._transactions.lastIdx,t)}calculateDiff(e,t,n,i){var r,l;let a=dd.v.wrap(e.draft,null),o=dd.v.wrap(e.published,null),s=(r=a,l=o,"null"===dd.v.getType(r)?l:r),d=VU(e),c=null;for(let e=n;e<=i;e++){let t=this._chunks.get(e);c||(c=t);for(let e=t.start;e<t.end;e++){let n=this._transactions.get(e),i={chunk:t,transactionIndex:e},r=a,l=o;n.draftEffect&&(a=dd.v.applyPatch(a,n.draftEffect.apply,i)),n.publishedEffect&&(o=dd.v.applyPatch(o,n.publishedEffect.apply,i));let s="null"!==dd.v.getType(r),d="null"!==dd.v.getType(a);"null"===dd.v.getType(o)||d||(o=dd.v.rebaseValue(r,o)),d&&!s&&(a=dd.v.rebaseValue(l,a))}}return function(e,t,n,i,r,l){let a=VW(n,i,{fromValue:n=>V$(e,t,n.endMeta),fromMeta:n=>V$(e,t,n)}),o=VW(r,l,{fromValue:t=>VX(e,t.startMeta),fromMeta:t=>VX(e,t)});return(0,dc.t)(a,o)}(this,c,s,d,"null"===dd.v.getType(a)?o:a,VU(t))}}let V4=Object.create(null),V5=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=Array.isArray(t)?t:[t],{time:r,revision:l}=n;if(r&&l)throw Error("getHistory can't handle both time and revision parameters");let a=e.config().dataset,o="/data/history/".concat(a,"/documents/").concat(i.join(","));if(l)o="".concat(o,"?revision=").concat(l);else{let e=r||new Date().toISOString();o="".concat(o,"?time=").concat(e)}return e.request({url:o})},V6=(e,t,n)=>{let i=cd(t),r=cs(t),l="".concat(i,"@").concat(n),a=V4[l];if(a)return a;let o=e.config().dataset,s="/data/history/".concat(o,"/documents/").concat(i,",").concat(r,"?revision=").concat(n),d=e.request({url:s}).then(e=>{let t=e.documents||[],n=t.find(e=>e._id===i);return t.find(e=>e._id===r)||n});return V4[l]=d,d},V8=e=>{let{client:t,documentId:n,documentType:i}=e,r=new V3({enableTrace:v5,publishedId:n});return new VV({client:t,documentId:n,documentType:i,timeline:r})},V9=async(e,t)=>{let n=Array.isArray(t)?t:[t],i=e.config().dataset,r="/data/history/".concat(i,"/transactions/").concat(n.join(","));return(await e.request({url:r,query:{excludeContent:"true",includeIdentifiedDocumentsOnly:"true"}})).toString("utf8").split("\n").filter(Boolean).map(e=>JSON.parse(e))},V7=e=>(0,dr.u4)(e,(e,t)=>(0,lX.Yk)(t)&&!e.includes(t._ref)?[...e,t._ref]:e,[]),Ue=(e,t)=>(function e(t,n){return Array.isArray(t)?n(t.map(t=>e(t,n)).filter(e=>void 0!==e)):cg(t)?n(Object.keys(t).reduce((i,r)=>{let l=e(t[r],n);return void 0!==l&&(i[r]=l),i},{})):n(t)})(e,e=>(0,lX.Yk)(e)?t(e):e),Ut=(e,t)=>Ue(e,e=>t[e._ref]?e:void 0),Un={chunks:[],diff:null,hasMoreChunks:null,isLoading:!1,isPristine:null,lastNonDeletedRevId:null,onOlderRevision:!1,realRevChunk:null,revTime:null,selectionState:"inactive",sinceAttributes:null,sinceTime:null,timelineDisplayed:null,timelineReady:!1};function Ui(e){let{documentId:t,documentType:n,onError:i,rev:r,since:l}=e,a=Uy(),o=(0,lJ.useRef)(null),s=(0,lJ.useRef)(Un),d=qJ(fT),c=(0,lJ.useMemo)(()=>a.getTimelineController({client:d,documentId:t,documentType:n}),[d,t,n,a]),u=(0,lJ.useMemo)(()=>new au.X(c),[c]);return(0,lJ.useEffect)(()=>(c.setRange(l||null,r||null),u.next(c),c.handler=(e,t)=>{e?u.error(e):setTimeout(()=>{t.setRange(l||null,r||null),u.next(t)},0)},c.resume(),()=>c.suspend()),[r,l,c,u]),(0,lJ.useEffect)(()=>(o.current||(o.current=N$(d,{draftId:"drafts.".concat(t),publishedId:t},n).subscribe(e=>{c.handleRemoteMutation(e)})),()=>{o.current&&(o.current.unsubscribe(),o.current=null)}),[d,c,t,n]),(0,lJ.useMemo)(()=>({findRangeForRev:e=>c.findRangeForNewRev(e),findRangeForSince:e=>c.findRangeForNewSince(e),loadMore:()=>{c.setLoadMore(!0),s.current.isLoading=!0},getSnapshot:()=>s.current,subscribe:e=>{let t=u.pipe((0,am.b)(e=>e.setLoadMore(!1)),(0,ag.U)(e=>{var t;let n=e.timeline.mapChunks(e=>e),i=n.filter(e=>!["delete","initial"].includes(e.type)),r=!e.timeline.reachedEarliestEntry,l=!["invalid","loading"].includes(e.selectionState);return{chunks:n,diff:e.sinceTime?e.currentObjectDiff():null,isLoading:!1,isPristine:l?0===n.length&&!1===r:null,hasMoreChunks:!e.timeline.reachedEarliestEntry,lastNonDeletedRevId:null==(t=null==i?void 0:i[0])?void 0:t.id,onOlderRevision:e.onOlderRevision(),realRevChunk:e.realRevChunk,revTime:e.revTime,selectionState:e.selectionState,sinceAttributes:e.sinceAttributes(),sinceTime:e.sinceTime,timelineDisplayed:e.displayed(),timelineReady:l}}),(0,ax.x)(l0()),(0,av.K)(e=>(null==i||i(e),(0,l6.of)(Un))),(0,am.b)(e=>{s.current=e}),(0,am.b)(e)).subscribe();return()=>t.unsubscribe()}}),[c,i,u])}function Ur(e,t){return(0,du.useSyncExternalStoreWithSelector)(e.subscribe,e.getSnapshot,null,t)}let Ul=[["nested","first"],["nested","second"],["nestedArray",{_key:"565c867c8dac"},"arrayNo1",{_key:"a645548a8f01"},"arrayNo1",{_key:"1685e372c40f"},"fieldNo0"],["nestedArray",{_key:"565c867c8dac"},"fieldNo0"],["nestedArray",{_key:"565c867c8dac"},"arrayNo19",{_key:"a02e7a93e2a2"},"fieldNo0"],["nestedArray",{_key:"565c867c8dac"},"arrayNo19",{_key:"a02e7a93e2a2"},"fieldNo19"],["address","country"],["address","street"],["customInputWithDefaultPresence","row3","cell3"]],Ua=(0,at.P)(()=>(0,ai.H)(0,1e4)).pipe((0,aC.j)(["pqSMwf6hH","pnLYqNfv5","priDVVmy8","p0NFOU0j8","pTDl2jw8d","pHMeQnTse","pDQYzJbyS","pZyoPHKUs","p4Tyi2Be5","pb9vii060","pE8yhOisw","p7Fd2C6Cj","p3exSgYCx","pbIQRYViC","p8GJaTEhN","p27ewL8aM","pYg97z75S","pdLr4quHv","pkJXiDgg6","pkl4UAKcA","pNoExists"]),(0,ag.U)((e,t)=>({type:"state",userId:e,sessionId:e+t,timestamp:new Date().toISOString(),locations:[{type:"document",documentId:"presence-debug",lastActiveAt:new Date().toISOString(),path:df()(Ul)}]})),(0,aw.d)()),Uo=e=>{if("rollCall"===e.type)return{type:"rollCall",userId:e.i,sessionId:e.session};if("state"===e.type){let{sessionId:t,locations:n}=e.m;return{type:"state",userId:e.i,sessionId:t,timestamp:new Date().toISOString(),locations:n}}if("disconnect"===e.type)return{type:"disconnect",userId:e.i,sessionId:e.m.session,timestamp:new Date().toISOString()};throw Error("Got unknown presence event: ".concat(JSON.stringify(e)))},Us=(e,t)=>[e.request("presence").pipe((0,ag.U)(Uo)).pipe((0,az.B)()),n=>"rollCall"===n.type?e.request("presence_rollcall",{session:t}):"state"===n.type?e.request("presence_announce",{data:{locations:n.locations,sessionId:t}}):"disconnect"===n.type?e.request("presence_disconnect",{session:t}):aa.E],Ud="presence_session_id",Uc=function(){try{return window.sessionStorage.getItem(Ud)}catch(e){}return null}()||function(e){try{window.sessionStorage.setItem(Ud,e)}catch(e){}return e}((0,dp.x0)(16));function Uu(e){let t=Uk(),[n,i]=(0,lJ.useState)([]);return(0,lJ.useEffect)(()=>{let n=t.documentPresence(e).subscribe(i);return()=>{n.unsubscribe()}},[e,t]),n}let Up=(e,t)=>{try{return JSON.parse(e)}catch(e){return console.warn("Failed to parse settings: ".concat(e.message)),t}},Uh={get:(e,t)=>{let n=localStorage.getItem(e);return(0,l6.of)(null===n?t:Up(n,t))},set:(e,t)=>(null==t?localStorage.removeItem(e):localStorage.setItem(e,JSON.stringify(t)),(0,l6.of)(t))},Uf=Object.create(null),Um={get:(e,t)=>(0,l6.of)(e in Uf?Uf[e]:t),set:(e,t)=>(null==t?delete Uf[e]:Uf[e]=t,(0,l6.of)(t))},Ug=null,Ux=[{id:"<system>",displayName:"Sanity",imageUrl:"https://public.sanity.io/logos/favicon-192.png"}];function Uv(){let{getClient:e,currentUser:t}=Ic(),n=hr(),i=e(fT);return(0,lJ.useMemo)(()=>{let e=n.get({namespace:"userStore",dependencies:[i,t]})||function(e){let{client:t,currentUser:n}=e,i=t.withConfig({apiVersion:"2021-06-07"}),r=new(dg())(async e=>{let t=await i.request({uri:"/users/".concat(e.join(",")),withCredentials:!0,tag:"users.get"}),n=(Array.isArray(t)?t:[t]).reduce((e,t)=>((null==t?void 0:t.id)&&(e[t.id]=t),e),{});return e.map(e=>n[e]||null)},{batchScheduleFn:e=>dv()(e)}),l=n&&{id:n.id,displayName:n.name,imageUrl:n.profileImage};return r.prime("me",l),(null==l?void 0:l.id)&&r.prime(l.id,l),Ux.forEach(e=>r.prime(e.id,e)),{getUser:async e=>{try{return await r.load(e)}catch(e){if(403===e.statusCode)return Promise.resolve(null);throw e}},getUsers:async e=>(await r.loadMany(e)).filter(e=>cg(e)&&"string"==typeof e.id)}}({client:i,currentUser:t});return n.set({namespace:"userStore",dependencies:[i,t],value:e}),e},[i,t,n])}function Ub(){let{getClient:e}=Ic(),t=e(fT),n=Ns(),i=hr();return(0,lJ.useMemo)(()=>{let e=i.get({namespace:"grantsStore",dependencies:[t,n]})||function(e){let{client:t,currentUser:n}=e,i=t.withConfig({apiVersion:"2021-06-07"}),r=(0,at.P)(()=>(0,l6.of)(i.config())).pipe((0,ab.w)(e=>{let{projectId:t,dataset:n}=e;if(!t||!n)throw Error("Missing projectId or dataset");return Vz(i,t,n)})),l=VO.pipe((0,ab.w)(e=>e?(0,l6.of)(e):r),(0,aZ._)(1),(0,ds.f)(1e3));return{checkDocumentPermission:(e,t)=>l.pipe((0,ab.w)(i=>VR(n,i,e,t)),(0,ax.x)(a6()))}}({client:t,currentUser:n});return i.set({namespace:"grantsStore",dependencies:[t,n],value:e}),e},[t,n,i])}function Uy(){let e=qJ(fT),t=hr();return(0,lJ.useMemo)(()=>{let n=t.get({namespace:"historyStore",dependencies:[e]})||function(e){let{client:t}=e;return{getDocumentAtRevision:(e,n)=>V6(t,e,n),getHistory:(e,n)=>V5(t,e,n),getTransactions:e=>V9(t,e),restore:(e,n,i)=>(0,as.D)(V6(t,e,i)).pipe((0,aT.z)(n=>{if(!n)throw Error("Unable to find document with ID ".concat(e," at revision ").concat(i));let r=V7(n).map(e=>'"'.concat(e,'": defined(*[_id=="').concat(e,'"]._id)')).join(",");return t.observable.fetch("{".concat(r,"}")).pipe((0,ag.U)(e=>Ut(n,e)))}),(0,ag.U)(e=>{let{_updatedAt:t,...i}=e;return{...i,_id:n}}),(0,aT.z)(e=>t.observable.createOrReplace(e,{visibility:"async"}))),getTimelineController:V8}}({client:e});return t.set({namespace:"historyStore",dependencies:[e],value:n}),n},[e,t])}function Uj(){let e=qJ(fT),t=hr();return(0,lJ.useMemo)(()=>{let n=t.get({namespace:"documentPreviewStore",dependencies:[e]})||function(e){let{client:t}=e,n=t.withConfig({apiVersion:"1"}),{observeFields:i}=function(e){let t;let{observePaths:n,versionedClient:i}=e,r=()=>{if(!t){let e=(0,as.D)(i.listen('*[!(_id in path("_.**"))]',{},{events:["welcome","mutation"],includeResult:!1,visibility:"query",tag:"preview.global"})).pipe((0,az.B)()),n=e.pipe((0,aj.h)(e=>"welcome"===e.type),(0,aw.d)({refCount:!0,bufferSize:1}));n.subscribe(),t={welcome$:n,mutations$:e.pipe((0,aj.h)(e=>"mutation"===e.type))}}return t};function l(e){return function(t){let n=di()(t.reduce((e,t,n)=>{let[i,r]=t,l=a2()(r.join(","),dt()).join(".");e[l]||(e[l]={fields:r,ids:[],map:[]});let a=e[l].ids.length;return e[l].ids[a]=i,e[l].map[a]=n,e},{}));return e.observable.fetch("[".concat(n.map(mf).join(","),"][0...").concat(n.length,"]"),{},{tag:"preview.document-paths"}).pipe((0,ag.U)(e=>e.reduce((e,t,i)=>(n[i].map.forEach((r,l)=>{let a=n[i].ids[l],o=t.find(e=>e._id===a);e[r]=o||null}),e),[])))}}let a=md(l(i),100),o=md(l(i),1e3),s={},d=oo()(function(e){return md(l(i.withConfig(e)),10)},e=>e.dataset+e.projectId),c=(0,l9.R)(document,"visibilitychange").pipe((0,ak.O)(0),(0,ag.U)(()=>"visible"===document.visibilityState),(0,ab.w)(e=>e?(0,ai.H)(0,1e4):aa.E),(0,az.B)());return{observeFields:function(e,t,n){let i=n?"".concat(n.projectId,":").concat(n.dataset,":").concat(e):"$current$-".concat(e);i in s||(s[i]=[]);let l=s[i];s3()(t,ow()(l.map(e=>e.fields))).length>0&&l.push(function(e,t,n){let i=null,l=(0,ae.T)((0,at.P)(()=>null===i?aa.E:(0,l6.of)(i)),n?c.pipe((0,ak.O)(0)).pipe((0,ab.w)(()=>d(n)(e,t))):(function(e){let t=r();return(0,ae.T)(t.welcome$,t.mutations$.pipe((0,aj.h)(t=>t.documentId===e)))})(e).pipe((0,ab.w)(n=>"welcome"===n.type||"query"===n.visibility?a(e,t).pipe((0,aT.z)(n=>(0,l8.z)((0,l6.of)(n),void 0===n?o(e,t):[]))):o(e,t)))).pipe((0,am.b)(e=>i=e),(0,aw.d)({refCount:!0,bufferSize:1}));return{id:e,fields:t,changes$:l}}(e,t,n));let u=l.filter(e=>e.fields.some(e=>t.includes(e))).map(e=>e.changes$);return(0,ao.a)(u).pipe((0,ag.U)(e=>e.filter(Boolean)),(0,aj.h)(e=>(function(e){let t,n,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:mm;for(let r=0;r<e.length;r++){if(0===r){t=i(e[r]);continue}if(t!==(n=i(e[r])))return!1;t=n}return!0})(e,e=>e._rev)),(0,ag.U)(e=>0===e.length?null:[...f2,...t].reduce((t,n)=>{let i;let r=(e.some(e=>n in e&&(i=e[n],!0)),i);return void 0!==r&&(t[n]=r),t},{})),(0,ax.x)((e,n)=>e===n||!!e&&!!n&&"object"==typeof e&&"object"==typeof n&&t.every(t=>e[t]===n[t])))}}}({observePaths:(e,t,n)=>r(e,t,n),versionedClient:n}),{observePaths:r}=function(e){let{observeFields:t}=e;return{observePaths:(e,n,i)=>(function e(t,n,i,r){if(!t||"object"!=typeof t)return(0,l6.of)(t);let l=(0,lX.Yk)(t)?t._ref:"_id"in t?t._id:void 0,a=l?{...t,_id:l}:{...t};"reference"===a._type&&(delete a._type,delete a._ref,delete a._weak,delete a._dataset,delete a._projectId,delete a._strengthenOnPublish);let o=n.filter(e=>!(e[0]in a));if(l&&o.length>0){let a=sh()(o.map(e=>e[0])),s=(0,lX.Yz)(t)?{projectId:t._projectId,dataset:t._dataset}:r;return i(l,a,s).pipe((0,ab.w)(r=>null===r?(0,l6.of)(null):e({...a.reduce((e,t)=>(e[t]=void 0,e),{}),...(0,lX.Yk)(t)?{...t,...s}:t,...r},n,i,s)))}let s={};n.forEach(e=>{let[t,...n]=e;s[t]||(s[t]=[]),s[t].push(n)});let d=Object.keys(s).reduce((n,l)=>{let a=s[l].filter(e=>e.length>0);return 0===a.length?n[l]=cg(t)?t[l]:void 0:n[l]=e(t[l],a,i,r),n},a);return(0,l6.of)(d).pipe(function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return t=>new al.y(e=>t.subscribe(e)).pipe((0,ab.w)(t=>{let n=f8(t).map(e=>{let n=t[e];return(0,ad.b)(n)?(0,as.D)(n).pipe((0,ag.U)(t=>[e,t])):(0,l6.of)([e,n])});return e.wait?(0,ao.a)(n).pipe((0,ag.U)(e=>e.reduce((e,t)=>{let[n,i]=t;return{...e,[n]:i}},{}))):(0,as.D)(n).pipe((0,aE.J)(),(0,ay.R)((e,t)=>{let[n,i]=t;return{...e,[n]:i}},{}))}))}({wait:!0}))})(e,n.map(e=>"string"==typeof e?e.split("."):e),t,i)}}({observeFields:i});function l(e,t){return r({_type:"reference",_ref:e},["_type"],t).pipe((0,ag.U)(e=>cg(e)&&"string"==typeof e._type?e._type:void 0),(0,ax.x)())}let a=function(e){let{observeDocumentTypeFromId:t,observePaths:n}=e;return function e(i,r,l,a){if((0,lX.mz)(r)){if(!(0,lX.Yz)(i))return(0,l6.of)({snapshot:void 0});let n={projectId:i._projectId,dataset:i._dataset};return t(i._ref,n).pipe((0,ab.w)(t=>t?e(i,r.to.find(e=>e.type===t),{},n):(0,l6.of)({snapshot:void 0})))}if((0,lX.dD)(r))return sU()(i)?t(i._ref).pipe((0,ab.w)(t=>t?e(i,r.to.find(e=>e.name===t)):(0,l6.of)({snapshot:void 0}))):(0,l6.of)({snapshot:void 0});let o=fG(r.preview);return o?n(i,o,a).pipe((0,ag.U)(e=>({type:r,snapshot:e&&ms(e,r,l)}))):(0,l6.of)({type:r,snapshot:i&&sU()(i)?ma(r,i,l).returnValue:null})}}({observeDocumentTypeFromId:l,observePaths:r}),{observeDocumentPairAvailability:o}=mu(n,r),{observePathsDocumentPair:s}=function(e,t){let{observeDocumentPairAvailability:n}=mu(e,t),i=[["_updatedAt"],["_createdAt"],["_type"]];return{observePathsDocumentPair:function(e,r){let{draftId:l,publishedId:a}=co(e);return n(l).pipe((0,ab.w)(e=>{if(!e.draft.available&&!e.published.available)return(0,l6.of)({id:a,type:null,draft:{availability:e.draft,snapshot:void 0},published:{availability:e.published,snapshot:void 0}});let n=[...r,...i];return(0,ao.a)([t({_type:"reference",_ref:l},n),t({_type:"reference",_ref:a},n)]).pipe((0,ag.U)(t=>{let[n,i]=t,r=cg(n)&&"_type"in n&&n._type||cg(i)&&"_type"in i&&i._type||null;return{id:a,type:"string"==typeof r?r:null,draft:{availability:e.draft,snapshot:n},published:{availability:e.published,snapshot:i}}}))}))}}}(n,r);return{observePaths:r,observeForPreview:a,observeDocumentTypeFromId:l,unstable_observeDocumentPairAvailability:o,unstable_observePathsDocumentPair:s}}({client:e});return t.set({namespace:"documentPreviewStore",dependencies:[e],value:n}),n},[e,t])}function Uw(){let e=Ic().getClient,t=q6(),n=Ne(),i=hr(),r=Uy(),l=Uj();return(0,lJ.useMemo)(()=>{let a=i.get({namespace:"documentStore",dependencies:[e,l,r,t]})||function(e){let{getClient:t,documentPreviewStore:n,historyStore:i,initialValueTemplates:r,schema:l}=e,a=n.unstable_observeDocumentPairAvailability,o=t(fT),s={client:o,getClient:t,observeDocumentPairAvailability:a,historyStore:i,schema:l};return{checkoutPair:e=>Ny(o,e),initialValue:(e,t)=>(function(e,t,n,i,r){let l=n.observePaths({_type:"reference",_ref:cs(i.documentId)},["_type"]),a=n.observePaths({_type:"reference",_ref:cd(i.documentId)},["_type"]);return(0,ae.T)(l.pipe((0,ag.U)(e=>({draft:e}))),a.pipe((0,ag.U)(e=>({published:e})))).pipe((0,ay.R)((e,t)=>({...e,...t}),{}),(0,aj.h)(e=>"draft"in e&&"published"in e),(0,ag.U)(e=>e.draft||e.published),(0,ax.x)((e,t)=>!!e!=!!t),(0,aK.b)(25)).pipe((0,ab.w)(n=>{if(n)return(0,l6.of)({type:"success",value:null});if(!i.templateName)return(0,l6.of)({isResolving:!1,initialValue:void 0});let l=t.find(e=>e.id===i.templateName);if(!l)return console.warn('Template "%s" not defined, using empty initial value',i.templateName),(0,l6.of)({isResolving:!1,initialValue:void 0});let a=(0,as.D)(Vl(e,l,i.templateParams,r)).pipe((0,ag.U)(e=>({isResolving:!1,initialValue:e}))).pipe((0,av.K)(e=>(console.group("Failed to resolve initial value"),console.error(e),console.error("Template ID: %s",i.templateName),console.error("Parameters: %o",i.templateParams),console.groupEnd(),(0,l6.of)({type:"error",error:e}))));return(0,ae.T)((0,l6.of)({isResolving:!0}),a).pipe((0,ab.w)(e=>{let{isResolving:t,initialValue:n,resolveError:i}=e;return i?(0,l6.of)({type:"error",message:"Failed to resolve initial value"}):t?(0,l6.of)(Vc):(0,l6.of)({type:"success",value:n})}))}),(0,ak.O)(Vc),(0,ax.x)())})(l,r,n,e,t),listenQuery:(e,t,n)=>(function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},r="string"==typeof t?t:t.fetch,l=N9(e,"string"==typeof t?t:t.listen,n,i).pipe((0,aT.z)((e,t)=>0!==t||N7(e)?(0,l6.of)(e):(0,an._)(()=>Error("reconnect"===e.type?"Could not establish EventSource connection":'Received unexpected type of first event "'.concat(e.type,'"')))),(0,az.B)()),[a,o]=(0,af.u)(l,N7),s=()=>N8(e,r,n,i);return(0,ae.T)(a.pipe((0,aS.q)(1)),o.pipe((0,aj.h)(e=>!i.transitions||"mutation"!==e.type||i.transitions.includes(e.transition)),(0,aU.p)(i.throttleTime||1e3,ap.z,{leading:!0,trailing:!0}))).pipe((0,dl.q)(e=>"mutation"===e.type&&"query"!==e.visibility?(0,ai.H)(1200).pipe((0,aT.z)(s)):s()))})(o,e,t,n),resolveTypeForDocument:(e,t)=>(function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"*";if(n&&"*"!==n)return(0,l6.of)(n);let i=cd(t),r=cs(i);return e.observable.fetch("*[_id in [$documentId, $draftId]]._type",{documentId:i,draftId:r}).pipe((0,ag.U)(e=>e[0]))})(o,e,t),pair:{consistencyStatus:(e,t)=>NN(s.client,Vu(e),t),documentEvents:(e,t)=>N0(s.client,Vu(e),t),editOperations:(e,t)=>N6(s,Vu(e),t),editState:(e,t)=>NA(s,Vu(e),t),operationEvents:(e,t)=>NW({client:o,historyStore:i,schema:l}).pipe((0,aj.h)(n=>n.args.idPair.publishedId===e&&n.args.typeName===t),(0,ag.U)(e=>{let{operationName:t,idPair:n}=e.args;return"success"===e.type?{type:"success",op:t,id:n.publishedId}:{type:"error",op:t,id:n.publishedId,error:e.error}})),validation:(e,t)=>NQ(s,Vu(e),t)}}}({getClient:e,documentPreviewStore:l,historyStore:r,initialValueTemplates:n,schema:t});return i.set({namespace:"documentStore",dependencies:[e,l,r,t],value:a}),a},[e,l,r,i,t,n])}function Uk(){let{__internal:{bifur:e}}=Ic(),t=hr(),n=Uv(),i=function(){let{bifur:e}=Ic().__internal,t=hr();return(0,lJ.useMemo)(()=>{let n=t.get({namespace:"connectionStatusStore",dependencies:[e]})||function(e){var t;let{bifur:n}=e;return{connectionStatus$:(0,ae.T)(n.heartbeats,hA.pipe((0,aC.j)((0,an._)(Error("The browser went offline"))))).pipe((0,ag.U)(e=>({type:"connected",lastHeartbeat:e})),(t=(e,t,n)=>{let i=Math.min(24e4,hO(t)),r=new Date(new Date().getTime()+i),l=(0,ai.H)(r),a=!navigator.onLine,o=hR({error:e,retryAt:r,isOffline:a,attemptNo:t}),s=ar.C.pipe((0,a_.R)(a?hP:(0,ae.T)(l,hP,hI)));return(0,l8.z)((0,l6.of)(o),s.pipe((0,aS.q)(1)),n)},e=>{let n=[],i=(0,av.K)((e,r)=>(n.push(e),t(e,n.length,r).pipe(i)));return e.pipe((0,am.b)(()=>{n=[]}),i)}),(0,ak.O)(hz))}}({bifur:e});return t.set({namespace:"connectionStatusStore",dependencies:[e],value:n}),n},[e,t])}();return(0,lJ.useMemo)(()=>{let r=t.get({namespace:"presenceStore",dependencies:[e,i,n]})||function(e){let{bifur:t,connectionStatusStore:n,userStore:i}=e,[r,l]=Us(t,Uc),a=new au.X([]),o=a.pipe((0,ax.x)()),s=e=>l({type:"state",locations:e}),d=()=>l({type:"rollCall"}),c=r.pipe((0,aj.h)(e=>"rollCall"===e.type),(0,aj.h)(e=>e.sessionId!==Uc)),u=(0,ai.H)(0,3e4),p=(0,at.P)(()=>(0,ae.T)(o,c)).pipe((0,ab.w)(()=>u),(0,aq.M)(a),(0,ag.U)(e=>{let[,t]=e;return t}),(0,aH.e)(200),(0,ab.w)(e=>s(e)),(0,aC.j)(aa.E),(0,az.B)()),h=(0,at.P)(()=>d()).pipe((0,aC.j)(aa.E)),f=n.connectionStatus$.pipe((0,ag.U)(e=>e.type),(0,aj.h)(e=>"connected"===e||"error"===e),(0,ax.x)()),m=VS.pipe((0,ag.U)(e=>e.find(e=>e.startsWith("presence="))),(0,ag.U)(e=>(null==e?void 0:e.split("presence=")[1].split(",").map(e=>e.trim()))||[])),g=m.pipe((0,aj.h)(e=>e.includes("fake_others")),(0,am.b)(()=>{console.log('Faking other users present in the studio. They will hang out in the document with _type: "presence" and _id: "presence-debug"')}),(0,aW.c)(Ua)),x=m.pipe((0,ag.U)(e=>e.includes("show_own"))),v=(0,ae.T)(h,r).pipe((0,aj.h)(e=>"state"===e.type||"disconnect"===e.type)),b=e=>({lastActiveAt:e.timestamp,locations:e.locations,sessionId:e.sessionId,userId:e.userId}),y=(0,ae.T)(v,g).pipe((0,ay.R)((e,t)=>"disconnect"===t.type?sw()(e,t.sessionId):{...e,[t.sessionId]:b(t)},{})),j=f.pipe((0,ab.w)(e=>"connected"===e?(0,ae.T)(y,p):ar.C),(0,ag.U)(e=>Object.values(e)),(0,ab.w)(e=>{let t=sh()(e.map(e=>e.userId));return(0,as.D)(i.getUsers(t)).pipe((0,ag.U)(t=>e.map(e=>({user:t.find(t=>t.id===e.userId),session:e})).filter(w)))}),(0,a_.R)((0,l9.R)(window,"beforeunload").pipe((0,ab.w)(()=>l({type:"disconnect"})))),(0,aw.d)({refCount:!0,bufferSize:1}));function w(e){return!!(e.user&&e.session)}return{setLocation:e=>{a.next(e)},reportLocations:s,debugPresenceParam$:m,globalPresence$:j.pipe((0,ag.U)(e=>{let t=sI()(e.map(e=>e.session),e=>e.userId);return Object.keys(t).map(n=>{var i;return{user:null==(i=e.find(e=>e.user.id===n))?void 0:i.user,sessions:t[n]}})}),(0,aq.M)(x),(0,ag.U)(e=>{let[t,n]=e;return t.filter(e=>!!n||!e.sessions.some(e=>e.sessionId===Uc))}),(0,ag.U)(e=>e.map(e=>{var t;return{user:e.user,status:"online",lastActiveAt:null==(t=e.sessions.sort()[0])?void 0:t.lastActiveAt,locations:ow()((e.sessions||[]).map(e=>e.locations||[])).map(e=>({type:e.type,documentId:e.documentId,path:e.path,lastActiveAt:e.lastActiveAt})).reduce((e,t)=>e.concat(t),[])}}))),documentPresence:e=>j.pipe((0,aq.M)(x),(0,ab.w)(t=>{let[n,i]=t;return(0,as.D)(n).pipe((0,aj.h)(e=>i||e.session.sessionId!==Uc),(0,a$.V)(t=>(t.session.locations||[]).filter(t=>t.documentId===e).map(e=>({user:t.user,lastActiveAt:t.session.lastActiveAt,path:e.path||[],sessionId:t.session.sessionId}))),(0,aP.q)())}))}}({bifur:e,connectionStatusStore:i,userStore:n});return t.set({namespace:"presenceStore",dependencies:[e,i,n],value:r}),r},[e,i,t,n])}function UC(){let e=qJ(fT),t=hr();return(0,lJ.useMemo)(()=>{let n=t.get({namespace:"projectStore",dependencies:[e]})||function(e){let{client:t}=e,n=t.config().projectId,i=t.withConfig({apiVersion:"2021-12-15"});return{get:function(){return i.observable.request({url:"/projects/".concat(n)})},getDatasets:function(){return i.observable.request({url:"/projects/".concat(n,"/datasets")})}}}({client:e});return t.set({namespace:"projectStore",dependencies:[e],value:n}),n},[e,t])}function U_(){let e=hr(),t=Io();return(0,lJ.useMemo)(()=>{let n=e.get({dependencies:[t],namespace:"settingsStore"})||function(){let e=!function(){if(null!==Ug)return Ug;let e="__test__";try{localStorage.setItem(e,e),localStorage.removeItem(e),Ug=!0}catch(e){Ug=!1}return Ug}()?Um:Uh,t=new l7.x,n=(e,t)=>"".concat(e,"::").concat(t),i=t.pipe((0,ab.w)(t=>e.set(t.key,t.value).pipe((0,ag.U)(e=>({key:t.key,value:e}))))),r=(t,n)=>(0,ae.T)(e.get(t,n),i.pipe((0,aj.h)(e=>e.key===t),(0,ag.U)(e=>e.value))),l=(e,n)=>{t.next({key:e,value:n})},a=e=>({forKey:t=>{let i=n(e,t);return{listen:e=>r(i,e),set:e=>l(i,e),del:()=>l(i,void 0)}},listen:(t,i)=>r(n(e,t),i),set:(t,i)=>l(n(e,t),i),del:t=>l(n(e,t),void 0),forNamespace:t=>a(n(e,t))});return{forNamespace:a}}();return e.set({dependencies:[t],namespace:"settingsStore",value:n}),n},[e,t])}let US=/[^\p{Alpha}\p{White_Space}]/gu,UT=RegExp("\\p{White_Space}+","u"),UE={small:0,medium:1,large:2};function UP(e){let{user:t,...n}=e;return cg(t)?n.withTooltip?(0,lG.jsx)(UA,{...n,user:t}):(0,lG.jsx)(UO,{...n,user:t}):(0,lG.jsx)(Uz,{...e,user:t})}function UA(e){let{user:{displayName:t}}=e;return(0,lG.jsx)(l4.u,{content:(0,lG.jsx)(l4.xu,{padding:2,children:(0,lG.jsx)(l4.xv,{size:1,children:t})}),placement:"top",portal:!0,children:(0,lG.jsx)("div",{style:{display:"inline-block"},children:(0,lG.jsx)(UO,{...e})})})}let UO=(0,lJ.forwardRef)(function(e,t){let{user:n,animateArrowFrom:i,position:r,size:l,status:a,tone:o,...s}=e,[d,c]=(0,lJ.useState)(null),u=function(e){let t=gy();return(0,l5.m2)(e?t.listen(e):(0,aa.c)(),[e],t.get(null))}(n.id),p=d?void 0:null==n?void 0:n.imageUrl;return(0,lG.jsx)(l4.qE,{animateArrowFrom:i,arrowPosition:r,color:u.name,"data-legacy-tone":o,initials:(null==n?void 0:n.displayName)&&function(e){let t=e.replace(US,"").split(UT);return 1===t.length?"".concat(t[0].charAt(0)).toUpperCase():"".concat(t[0].charAt(0)).concat(t[t.length-1].charAt(0))}(n.displayName),src:p,onImageLoadError:c,ref:t,size:"string"==typeof l?UE[l]:l,status:a,title:null==n?void 0:n.displayName,...s})});function Uz(e){let{user:t,...n}=e,[i]=No(t);return i?(0,lG.jsx)(UP,{...n,user:i}):null}var UM=Object.freeze,UI=Object.defineProperty,UR=(e,t)=>UM(UI(e,"raw",{value:UM(t||e.slice())}));let UF=(0,a0.ZP)(l4.Ct)(e=>{let{theme:t}=e,n=t.sanity.color.dark?50:700,i=t.sanity.color.dark?700:100,r=or.VG.purple[i].hex,l=or.VG.purple[n].hex;return(0,a0.iv)(l$||(l$=UR(["\n    background-color: ",";\n    box-shadow: inset 0 0 0 1px ",";\n    color: ",";\n  "])),r,r,l)});function UD(e){let{fontSize:t=1,children:n="Beta",...i}=e;return(0,lG.jsx)(UF,{...i,fontSize:t,children:n})}let UZ={name:"all-fields",title:"All fields",hidden:!1};function UL(e,t){return[...t.map((e,n)=>({type:"expandPath",path:t.slice(0,n+1)})),...Uq(e,t)]}function Uq(e,t){return 0===t.length?[]:(0,lX.m$)(e.schemaType)?function e(t,n){var i,r;if(0===n.length)return[];let[l,...a]=n,o=t._allMembers.find(e=>"fieldSet"===e.kind&&e.fieldSet.members.some(e=>"field"===e.kind&&e.name===l)),s=(o?o.fieldSet.members:t._allMembers).find(e=>null!==e&&"field"===e.kind&&e.name===l),d=t.schemaType.fields.find(e=>e.name===l),c=null==(i=t.groups.find(e=>e.selected))?void 0:i.name,u=null==(r=(t.schemaType.groups||[]).find(e=>e.default))?void 0:r.name,p=c&&(c===UZ.name||d&&s5()(d.group).includes(c)),h=[];return p||h.push({type:"setSelectedGroup",path:t.path,groupName:u||UZ.name}),o&&h.push({type:"expandFieldSet",path:o.fieldSet.path}),s&&(ks(s)?h.push(...UN(s.field,a)):ko(s)&&h.push(...e(s.field,a))),h}(e,t):(0,lX.M1)(e.schemaType)?UN(e,t):[]}function UN(e,t){if(0===t.length)return[];let[n,...i]=t;if(!(0,lX.Fd)(n))throw Error("Expected path segment to be an object with a _key property");let r=e.members.find(e=>e.key===n._key);return r?Uq(r.item,i):[]}function UV(e,t){let{currentUser:n,document:i,parent:r,value:l}=t;return"boolean"==typeof e||void 0===e?!!e:!0===e({document:i,parent:r,value:l,currentUser:n})}function UU(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;if((null==e?void 0:e.collapsible)===!1||(null==e?void 0:e.collapsable)===!1)return{collapsible:!1,collapsed:!1};let n="boolean"==typeof(null==e?void 0:e.collapsed)?e.collapsed:t>=3||void 0;return{collapsible:(null==e?void 0:e.collapsible)===!0||(null==e?void 0:e.collapsable)===!0||!0===n||void 0,collapsed:n}}function UB(e,t,n){return n.name===UZ.name||void 0!==t&&(0===e.length&&n.name===UZ.name||s5()(t).includes(n.name))}function UK(e){return void 0===e||cg(e)}function UH(e,t){return!(Array.isArray(e)&&void 0===t||Array.isArray(t)&&void 0===e)&&(!!e&&!t||!aG()(e,t))}function UW(e){var t,n,i,r,l,a,o,s,d,c,u,p,h,f,m,g,x,v,b,y;let{parent:j,field:w,index:k}=e,C=(0,lY.s6)([...j.path,w.name]),_=(b=w.type,y=j.level+1,(0,lX.jB)(b)?function(e,t){var n;let{options:i}=e,r=(null==(n=(null==i?void 0:i.list)||[])?void 0:n.length)>0,l=k0.includes((null==i?void 0:i.layout)||"");return r&&!l?t:0}(b,y):function(e,t){var n,i,r;let{type:l,options:a}=e,o=function e(t,n){return(null==t?void 0:t.name)&&n.includes(null==t?void 0:t.name)?t:t?e(t.type,n):void 0}(l,kJ),s=(null==e?void 0:e.jsonType)==="object"?e.fields:void 0,d=(null==o?void 0:o.name)||"";if(k1.includes(d))return 0;let c=kJ.includes(d),u=(null!=(n=null==s?void 0:s.filter(e=>!kQ.includes(e.name)).length)?n:0)>0,p=(null!=(r=null==(i=null==a?void 0:a.list)?void 0:i.length)?r:0)>0;return u||p||!c?t:0}(b,y)),S=j.value,T=j.comparisonValue;if(!UK(S))throw Error("Unexpected non-object value");let E=w.group?s5()(w.group):[],P=UB(j.groups,w.group,j.selectedGroup);if((0,lX.m$)(w.type)){let e=null==S?void 0:S[w.name],o=cg(T)?null==T?void 0:T[w.name]:void 0;if(!UK(e))return{kind:"error",key:w.name,fieldName:w.name,error:{type:"INCOMPATIBLE_TYPE",expectedSchemaType:w.type,resolvedValueType:(0,sT.wq)(e),value:e}};let s={value:e,parent:j.value,document:j.document,currentUser:j.currentUser};if(UV(w.type.hidden,s))return{kind:"hidden",key:"field-".concat(w.name),name:w.name,index:k};let d=j.readOnly||UV(w.type.readOnly,s),c=null==(n=null==(t=j.fieldGroupState)?void 0:t.children)?void 0:n[w.name],u=null==(r=null==(i=j.collapsedPaths)?void 0:i.children)?void 0:r[w.name],p=null==(a=null==(l=j.collapsedFieldSets)?void 0:l.children)?void 0:a[w.name],h=U$({schemaType:w.type,currentUser:j.currentUser,parent:j.value,document:j.document,value:e,changed:UH(e,o),comparisonValue:o,presence:j.presence,validation:j.validation,fieldGroupState:c,path:C,level:_,focusPath:j.focusPath,openPath:j.openPath,collapsedPaths:u,collapsedFieldSets:p,readOnly:d,changesOpen:j.changesOpen});if(null===h)return null;let f=UU(w.type.options,_),m=u?u.value:f.collapsed;return{kind:"field",key:"field-".concat(w.name),name:w.name,index:k,inSelectedGroup:P,groups:E,open:(0,lY.Ny)(C,j.openPath),field:h,collapsed:m,collapsible:f.collapsible}}if((0,lX.jB)(w.type)){let e=null==S?void 0:S[w.name],t=cg(T)?null==T?void 0:T[w.name]:void 0;if((0,lX.M1)(w.type)){let n=void 0!==e;if(n&&!(void 0===e||Array.isArray(e))){let t=(0,sT.wq)(e);return{kind:"error",key:w.name,fieldName:w.name,error:{type:"INCOMPATIBLE_TYPE",expectedSchemaType:w.type,resolvedValueType:t,value:e}}}if(n&&!(0===e.length||e.every(e=>cg(e))))return{kind:"error",key:w.name,fieldName:w.name,error:{type:"MIXED_ARRAY",schemaType:w.type,value:e}};if(n&&!(null==e?void 0:e.every(e=>cg(e)&&"_key"in e)))return{kind:"error",key:w.name,fieldName:w.name,error:{type:"MISSING_KEYS",value:e,schemaType:w.type}};let i=n?function(e){let t=new Set;return e.reduce((e,n,i)=>(t.has(n._key)&&e.push([i,n._key]),t.add(n._key),e),[])}(e):[];if(i.length>0)return{kind:"error",key:w.name,fieldName:w.name,error:{type:"DUPLICATE_KEYS",duplicates:i,schemaType:w.type}};let r=null==(s=null==(o=j.fieldGroupState)?void 0:o.children)?void 0:s[w.name],l=null==(c=null==(d=j.collapsedPaths)?void 0:d.children)?void 0:c[w.name],a=null==(p=null==(u=j.collapsedFieldSets)?void 0:u.children)?void 0:p[w.name],h=j.readOnly||UV(w.type.readOnly,{value:e,parent:j.value,document:j.document,currentUser:j.currentUser}),f=function(e){if(20===e.level)return null;let t={value:e.value,parent:e.parent,document:e.document,currentUser:e.currentUser};if(UV(e.schemaType.hidden,t))return null;let n=e.readOnly||UV(e.schemaType.readOnly,t),i=Array.isArray(e.value)?e.value:[],r=e.presence.filter(t=>(0,lY.Xy)(t.path,e.path)),l=r.length?r:ch,a=e.validation.filter(t=>(0,lY.Xy)(t.path,e.path)).map(e=>({level:e.level,message:e.item.message,path:e.path})),o=i.flatMap((t,n)=>(function(e){var t,n,i,r,l,a,o;let{arrayItem:s,parent:d,index:c}=e,u=function(e,t){let n=(0,sT.wq)(t);return"object"===n&&1===e.of.length?e.of[0]:e.of.find(e=>e.name===n)}(d.schemaType,s),p=s._key;if(!u)return{kind:"error",key:p,index:c,error:{type:"INVALID_ITEM_TYPE",resolvedValueType:(0,sT.wq)(s),value:s,validTypes:d.schemaType.of}};let h=(0,lY.s6)([...d.path,{_key:p}]),f=d.level+1,m={value:d.value,parent:e.parent,document:d.document,currentUser:d.currentUser},g=d.readOnly||UV(d.schemaType.readOnly,m),x=null==(n=null==(t=d.fieldGroupState)?void 0:t.children)?void 0:n[p],v=null==(r=null==(i=d.collapsedPaths)?void 0:i.children)?void 0:r[p],b=null==(a=null==(l=d.collapsedFieldSets)?void 0:l.children)?void 0:a[p],y=Array.isArray(d.comparisonValue)&&d.comparisonValue.find(e=>e._key===s._key)||void 0,j=U$({schemaType:u,level:f,document:d.document,value:s,comparisonValue:y,changed:UH(s,y),path:h,focusPath:d.focusPath,openPath:d.openPath,currentUser:d.currentUser,collapsedPaths:v,collapsedFieldSets:b,presence:d.presence,validation:d.validation,fieldGroupState:x,readOnly:g},!1),w=UU(u.options,f),k=null!=(o=null==v?void 0:v.value)?o:w.collapsed;return{kind:"item",key:p,index:c,open:(0,lY.Ny)(h,d.openPath),collapsed:k,collapsible:!0,parentSchemaType:d.schemaType,item:j}})({arrayItem:t,parent:e,index:n}));return{changed:e.changed||o.some(e=>"item"===e.kind&&e.item.changed),value:e.value,readOnly:n,schemaType:e.schemaType,focused:(0,lY.Xy)(e.path,e.focusPath),focusPath:(0,lY.vC)(e.path,e.focusPath),path:e.path,id:(0,lY.BB)(e.path),level:e.level,validation:a,presence:l,members:o}}({schemaType:w.type,parent:j.value,currentUser:j.currentUser,document:j.document,value:e,changed:UH(e,t),comparisonValue:t,fieldGroupState:r,focusPath:j.focusPath,openPath:j.openPath,presence:j.presence,validation:j.validation,collapsedPaths:l,collapsedFieldSets:a,level:_,path:C,readOnly:h});return null===f?null:{kind:"field",key:"field-".concat(w.name),name:w.name,index:k,open:(0,lY.Ny)(C,j.openPath),inSelectedGroup:P,groups:E,collapsible:!1,collapsed:!1,field:f}}{if(!(void 0===e||Array.isArray(e))){let t=(0,sT.wq)(e);return{kind:"error",key:w.name,fieldName:w.name,error:{type:"INCOMPATIBLE_TYPE",expectedSchemaType:w.type,resolvedValueType:t,value:e}}}let n=null==(f=null==(h=j.fieldGroupState)?void 0:h.children)?void 0:f[w.name],i=null==(g=null==(m=j.collapsedPaths)?void 0:m.children)?void 0:g[w.name],r=null==(v=null==(x=j.collapsedFieldSets)?void 0:x.children)?void 0:v[w.name],l=j.readOnly||UV(w.type.readOnly,{value:e,parent:j.value,document:j.document,currentUser:j.currentUser}),a=function(e){if(20===e.level)return null;let t={comparisonValue:e.comparisonValue,value:e.value,parent:e.parent,document:e.document,currentUser:e.currentUser};if(UV(e.schemaType.hidden,t))return null;let n=e.readOnly||UV(e.schemaType.readOnly,t),i=Array.isArray(e.value)?e.value:[],r=e.presence.filter(t=>(0,lY.Xy)(t.path,e.path)),l=r.length?r:ch,a=e.validation.filter(t=>(0,lY.Xy)(t.path,e.path)).map(e=>({level:e.level,message:e.item.message,path:e.path})),o=i.flatMap((t,n)=>(function(e){var t,n;let{arrayItem:i,parent:r,index:l}=e,a=function(e,t){let n=(0,sT.wq)(t);return null==e?void 0:e.of.find(e=>e.name===n||e.jsonType===n)}(r.schemaType,i),o=(0,lY.s6)([...r.path,l]),s=null==(t=r.value)?void 0:t[l],d=null==(n=r.comparisonValue)?void 0:n[l],c=r.level+1,u="".concat((null==a?void 0:a.name)||"invalid-type","-").concat(String(l));if(!a)return{kind:"error",key:u,index:l,error:{type:"INVALID_ITEM_TYPE",validTypes:r.schemaType.of,resolvedValueType:(0,sT.wq)(a),value:s}};let p=r.readOnly||UV(a.readOnly,{value:s,parent:r.value,document:r.document,currentUser:r.currentUser}),h=UX({...r,path:o,schemaType:a,level:c,value:s,comparisonValue:d,readOnly:p});return{kind:"item",key:u,index:l,parentSchemaType:r.schemaType,open:(0,lY.Xy)(o,r.openPath),item:h}})({arrayItem:t,parent:e,index:n}));return{changed:e.changed||o.some(e=>"item"===e.kind&&e.item.changed),value:e.value,readOnly:n,schemaType:e.schemaType,focused:(0,lY.Xy)(e.path,e.focusPath),focusPath:(0,lY.vC)(e.path,e.focusPath),path:e.path,id:(0,lY.BB)(e.path),level:e.level,validation:a,presence:l,members:o}}({changed:UH(e,t),comparisonValue:t,schemaType:w.type,parent:j.value,currentUser:j.currentUser,document:j.document,value:e,fieldGroupState:n,focusPath:j.focusPath,openPath:j.openPath,presence:j.presence,validation:j.validation,collapsedPaths:i,collapsedFieldSets:r,level:_,path:C,readOnly:l});return null===a?null:{kind:"field",key:"field-".concat(w.name),name:w.name,index:k,inSelectedGroup:P,groups:E,open:(0,lY.Ny)(C,j.openPath),collapsible:!1,collapsed:!1,field:a}}}{let e=null==S?void 0:S[w.name],t=cg(T)?null==T?void 0:T[w.name]:void 0,n={value:e,parent:j.value,document:j.document,currentUser:j.currentUser};if(UV(w.type.hidden,n))return null;let i=j.readOnly||UV(w.type.readOnly,n),r=UX({...j,comparisonValue:t,value:e,schemaType:w.type,path:C,readOnly:i});return{kind:"field",key:"field-".concat(w.name),name:w.name,index:k,open:(0,lY.Ny)(C,j.openPath),inSelectedGroup:P,groups:E,collapsible:!1,collapsed:!1,field:r}}}function U$(e){var t;let n=!(arguments.length>1)||void 0===arguments[1]||arguments[1];if(20===e.level)return null;let i={value:e.value,parent:e.parent,document:e.document,currentUser:e.currentUser},r=e.readOnly||UV(e.schemaType.readOnly,i),l=e.schemaType.groups||[],a=null==(t=l.find(e=>e.default)||UZ)?void 0:t.name,o=[UZ,...l].flatMap(t=>{var n;let r=UV(t.hidden,i),l=t.name===((null==(n=e.fieldGroupState)?void 0:n.value)||a),o=e.changesOpen?t.name===UZ.name:l,s=!!e.changesOpen&&!o;return r?[]:[{disabled:s,icon:null==t?void 0:t.icon,name:t.name,selected:o,title:t.title}]}),s=o.find(e=>e.selected),d=(e.schemaType.fieldsets?e.schemaType.fieldsets:e.schemaType.fields.map(e=>({single:!0,field:e}))).flatMap((t,n)=>{var i,l,a,d;if(t.single){let i=UW({field:t.field,parent:{...e,readOnly:r,groups:o,selectedGroup:s},index:n});return i?[i]:[]}let c=t.fields.map(e=>e.name),u=UV(t.hidden,{currentUser:e.currentUser,document:e.document,parent:e.value,value:s8()(e.value,c)}),p=UV(t.readOnly,{currentUser:e.currentUser,document:e.document,parent:e.value,value:s8()(e.value,c)}),h=t.fields.flatMap(t=>{if(u)return[{kind:"hidden",key:"field-".concat(t.name),name:t.name,index:n}];let i=UW({field:t,parent:{...e,readOnly:r||p,groups:o,selectedGroup:s},index:n});return i?[i]:[]}),f=UU(t.options,e.level),m=null!=(a=null==(l=((null==(i=e.collapsedFieldSets)?void 0:i.children)||{})[t.name])?void 0:l.value)?a:f.collapsed;return[{kind:"fieldSet",key:"fieldset-".concat(t.name),_inSelectedGroup:UB(o,t.group,s),groups:t.group?s5()(t.group):[],fieldSet:{path:(0,lY.s6)(e.path.concat(t.name)),name:t.name,title:t.title,description:t.description,hidden:!1,level:e.level+1,members:h.filter(e=>"hidden"!==e.kind),collapsible:null==f?void 0:f.collapsible,collapsed:m,columns:null==(d=null==t?void 0:t.options)?void 0:d.columns}}]}),c=l.length>0,u=e.presence.filter(t=>(0,lY.Xy)(t.path,e.path)),p=u.length?u:ch,h=e.validation.filter(t=>(0,lY.Xy)(t.path,e.path)).map(e=>({level:e.level,message:e.item.message,path:e.path})),f=d.filter(e=>"hidden"!==e.kind);if(0===f.length&&n)return null;let m=c?o.flatMap(e=>e.name===UZ.name?e:f.some(t=>"error"!==t.kind&&("field"===t.kind?t.groups.includes(e.name):t.groups.includes(e.name)||t.fieldSet.members.some(t=>"error"!==t.kind&&t.groups.includes(e.name))))?e:[]):[],g=f.flatMap(e=>{if("error"===e.kind)return[e];if("field"===e.kind)return e.inSelectedGroup?[e]:[];let t=e.fieldSet.members.filter(e=>"field"!==e.kind||e.inSelectedGroup);return t.length>0?[{...e,fieldSet:{...e.fieldSet,members:t}}]:[]});return{value:e.value,changed:UH(e.value,e.comparisonValue),schemaType:e.schemaType,readOnly:r,path:e.path,id:(0,lY.BB)(e.path),level:e.level,focused:(0,lY.Xy)(e.path,e.focusPath),focusPath:(0,lY.vC)(e.path,e.focusPath),presence:p,validation:h,_allMembers:d,members:g,groups:m}}function UX(e){let t=e.presence.filter(t=>(0,lY.Xy)(t.path,e.path)),n=t.length?t:ch,i=e.validation.filter(t=>(0,lY.Xy)(t.path,e.path)).map(e=>({level:e.level,message:e.item.message,path:e.path}));return{schemaType:e.schemaType,changed:UH(e.value,e.comparisonValue),value:e.value,level:e.level,id:(0,lY.BB)(e.path),readOnly:e.readOnly,focused:(0,lY.Xy)(e.path,e.focusPath),path:e.path,presence:n,validation:i}}function UG(e,t){let{comparisonValue:n,value:i,fieldGroupState:r,collapsedFieldSets:l,collapsedPaths:a,focusPath:o,openPath:s,presence:d,validation:c,readOnly:u,changesOpen:p}=t,h=Ns(),f=(0,lJ.useRef)(null);return(0,lJ.useLayoutEffect)(()=>{f.current=null},[e]),(0,lJ.useMemo)(()=>{let t=U$({schemaType:e,document:i,fieldGroupState:r,collapsedFieldSets:l,collapsedPaths:a,value:i,comparisonValue:n,focusPath:o,openPath:s,readOnly:u,path:(0,lY.s6)([]),level:0,currentUser:h,presence:d,validation:c,changesOpen:p}),m=ge(f.current,t);return f.current=m,m},[e,i,r,l,a,n,o,s,u,h,d,c,p])}function UY(e){return e.map(U0)}function UJ(e,t){return ow()(t.map(t=>ow()(Object.keys(t).filter(UQ(["id","ifRevisionID","query"])).map(n=>{if("unset"===n)return t.unset.map(t=>({type:"unset",path:_$(t),origin:e}));if("insert"===n){let n="before"in t.insert?"before":"after";return{type:"insert",position:n,path:_$(t.insert[n]),items:t.insert.items,origin:e}}return Object.keys(t[n]).map(i=>"set"===n?{type:"set",path:_$(i),value:t[n][i],origin:e}:"inc"===n||"dec"===n?{type:n,path:_$(i),value:t[n][i],origin:e}:"setIfMissing"===n?{type:"setIfMissing",path:_$(i),value:t[n][i],origin:e}:"diffMatchPatch"===n?{type:n,path:_$(i),value:t[n][i],origin:e}:(console.warn(Error("Unsupported patch type: ".concat(n))),null)).filter(Boolean)}))))}let UQ=e=>t=>!e.includes(t);function U0(e){if(e.patchType!==mF&&e.type)throw Error('Patch is missing "patchType" - import and use "'.concat(e.type,'()" from "sanity/form"'));if(e.patchType!==mF)throw Error('Patch is missing "patchType" - import and use the patch method helpers from "sanity/form"');let t=(0,sN.kC)(e.path||[]);if("insert"===e.type){let{position:n,items:i}=e;return{insert:{[n]:t,items:i}}}if("unset"===e.type)return{unset:[t]};if(!e.type)throw Error("Missing patch type in patch ".concat(JSON.stringify(e)));return t?{[e.type]:{[t]:e.value}}:{[e.type]:e.value}}(0,lJ.memo)(function(e){let{transform:t}=e,n=m7(),i=(0,lJ.useCallback)(e=>{let i=t(e.patches);n.onChange(mN.from(i))},[n,t]),r=(0,lJ.useMemo)(()=>({...n,onChange:i}),[n,i]);return(0,lG.jsx)(m8.Provider,{value:r,children:e.children})}),l4.Lg.fonts.code.family,l4.Lg.fonts.text.family,or.Sn.hex,or.ix.hex,or.iN[500].hex,or.ix.hex,or.Sn.hex,or.MA[500].hex,or.MA[500].hex,or.MA[500].hex,or.Q6[500].hex,or.iN[500].hex,or.ek[500].hex,or.er[500].hex,or.iN[500].hex,or.iN[500].hex,or.ek[500].hex,or.er[500].hex,or.Q6[500].hex,or.Sn.hex,or.ix.hex,l4.Lg}}]);