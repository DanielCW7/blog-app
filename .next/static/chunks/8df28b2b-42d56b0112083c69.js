"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[810],{51568:function(e,t,n){let i,r,l,a,s,o;n.d(t,{Bh:function(){return iq},Cc:function(){return n8},HZ:function(){return n9},K4:function(){return pC},Ok:function(){return rb},Oo:function(){return rR},P0:function(){return hM},PF:function(){return rA},Sg:function(){return pb},V$:function(){return n7},X6:function(){return iN},YL:function(){return fw},aL:function(){return n4},aR:function(){return rN},cp:function(){return rf},ec:function(){return iZ},hL:function(){return rr},hX:function(){return i6},hb:function(){return n3},q5:function(){return m6},ud:function(){return n5},xu:function(){return uK},zc:function(){return hR}});var d,c,u,h,p,m,f,x,g,v,b,y,j,w,_,k,C,z,E,I,S,P,T,M,R,O,A,D,L,N,Z,U,B,F,q,H,V,W,K,$,Y,X,G,Q,J,ee,et,en,ei,er,el,ea,es,eo,ed,ec,eu,eh,ep,em,ef,ex,eg,ev,eb,ey,ej,ew,e_,ek,eC,ez,eE,eI,eS,eP,eT,eM,eR,eO,eA,eD,eL,eN,eZ,eU,eB,eF,eq,eH,eV,eW,eK,e$,eY,eX,eG,eQ,eJ,e0,e1,e2,e5,e3,e6,e8,e4,e9,e7,te,tt,tn,ti,tr,tl,ta,ts,to=n(40168),td=n(67294),tc=n(85893),tu=n(32932),th=n(42930),tp=n(11636),tm=n(68458),tf=n(22401),tx=n(6222),tg=n(1545),tv=n(32817),tb=n(29127),ty=n(34978),tj=n(52277),tw=n(5014),t_=n(69243),tk=n(79878),tC=n(23071),tz=n(40052),tE=n(19917),tI=n(83610),tS=n(65583),tP=n(30743),tT=n(74727),tM=n(9132),tR=n(37991),tO=n(82649),tA=n(42006),tD=n(92574),tL=n(98430),tN=n(53741),tZ=n(68515),tU=n(93833),tB=n(46297),tF=n(42965),tq=n(56542),tH=n(74855),tV=n.n(tH),tW=n(81763),tK=n.n(tW),t$=n(47037),tY=n.n(t$),tX=n(28440),tG=n(933),tQ=n(57557),tJ=n.n(tQ),t0=n(66996),t1=n(45578),t2=n.n(t1),t5=n(94885),t3=n.n(t5),t6=n(25934),t8=n(5814),t4=n(60814),t9=n(42076),t7=n(18446),ne=n.n(t7),nt=n(53816),nn=n.n(nt),ni=n(55379),nr=n(42298);n(20745);var nl=n(23279),na=n.n(nl),ns=n(75472),no=n.n(ns),nd=n(89734),nc=n.n(nd),nu=n(34167),nh=n(30998),np=n.n(nh),nm=n(18029),nf=n.n(nm),nx=n(17423),ng=n(12023),nv=n(51526),nb=n(38063),ny=n(11700),nj=n.n(ny),nw=n(68929),n_=n.n(nw),nk=n(989),nC=n.n(nk),nz=n(44908),nE=n.n(nz),nI=n(21804),nS=n.n(nI),nP=n(13311),nT=n.n(nP),nM=n(73955),nR=n.n(nM),nO=n(59864),nA=n(18156),nD=n(30222),nL=n(34391),nN=n.n(nL),nZ=n(70248),nU=n.n(nZ),nB=n(38993),nF=n.n(nB),nq=n(85092),nH=n(48764).lW,nV=n(34155);function nW(e){let{children:t,ms:n=0}=e,[i,r]=(0,td.useState)(n<=0);return((0,td.useEffect)(()=>{if(n<=0)return;let e=setTimeout(()=>r(!0),n);return()=>{clearTimeout(e)}},[n]),i&&t)?"function"==typeof t?t():t:(0,tc.jsx)(tc.Fragment,{})}function nK(e){let{document:t}=e,n=(0,tu.I_y)().get(t._type),{error:i,value:r}=(0,tu._2T)({schemaType:n,value:t});return n?i?(0,tc.jsxs)(tc.Fragment,{children:["Error: ",i.message]}):(0,tc.jsx)(tc.Fragment,{children:(null==r?void 0:r.title)||(0,tc.jsx)("span",{style:{color:"var(--card-muted-fg-color)"},children:"Untitled"})}):(0,tc.jsxs)("code",{children:["Unknown schema type: ",t._type]})}let n$=e=>{let{actions:t,children:n,actionProps:i,onActionComplete:r}=e;return(0,tc.jsx)(tu.duV,{onReset:r,hooks:t,args:i,children:n})},nY=e=>{let{badges:t,children:n,badgeProps:i,...r}=e;return(0,tc.jsx)(tu.duV,{...r,hooks:t,args:i,children:n})},nX=()=>(i||(i=(0,tf.R)(document,"visibilitychange").pipe((0,tL.O)(null),(0,tb.U)(()=>"visible"===document.visibilityState),(0,tN.x)(),(0,ty.w)(e=>e?(0,tx.H)(0,5e3):tg.E),(0,tZ.d)({refCount:!0,bufferSize:1}))),i),nG=(0,tu.ek8)(e=>{let[t,n]=e,i='{"references":'.concat("*[references($documentId)][0...100]{_id,_type}",',"totalCount":').concat("count(*[references($documentId)])","}");return n.listenQuery({fetch:i,listen:"*[references($documentId)]"},{documentId:t},{tag:"use-referring-documents",transitions:["appear","disappear"],throttleTime:5e3})}),nQ=(0,tu.ek8)(e=>{let[t,n]=e;return nX().pipe((0,ty.w)(()=>(function(e,t){let{versionedClient:n}=t;return nX().pipe((0,ty.w)(()=>(function(e,t){let{versionedClient:n}=t,i=(0,tu.qyu)(e),r=(0,tu.vsM)(e),l={uri:n.getDataUrl("doc","".concat(i,",").concat(r)),json:!0,query:{excludeContent:"true"},tag:"use-referring-documents.document-existence"};return n.observable.request(l).pipe((0,tb.U)(e=>{let{omitted:t}=e,n=t.filter(e=>"existence"===e.reason);return 2===n.length?void 0:0===n.length?r:n.some(e=>e.id===i)?r:i}))})(e,t)),(0,ty.w)(e=>{if(!e)return(0,tv.of)({totalCount:0,references:[]});let t=n.config().dataset;return n.observable.request({url:"/data/references/".concat(t,"/documents/").concat(e,"/to?excludeInternalReferences=true&excludePaths=true"),tag:"use-referring-documents.external"}).pipe((0,tk.K)(e=>{if("object"==typeof e&&e&&"statusCode"in e&&"response"in e&&404===e.statusCode)return(0,tv.of)({totalCount:0,references:[]});throw e}))}))})(t,{versionedClient:n})))});function nJ(e){let{document:t}=e,n=t&&"_updatedAt"in t&&t._updatedAt,i=(0,tu.INm)(n||"",{minimal:!0,agoSuffix:!0});return(0,tc.jsx)(tp.u,{portal:!0,content:(0,tc.jsx)(tp.xu,{padding:2,children:(0,tc.jsx)(tp.xv,{size:1,children:t?"Published ".concat(i):"Not published"})}),children:(0,tc.jsx)(tu.LPT,{tone:"positive",dimmed:!t,muted:!t,size:1,children:(0,tc.jsx)(to.EI4,{"aria-label":t?"Published":"Not published"})})})}function n0(e){let{document:t}=e,n=t&&"_updatedAt"in t&&t._updatedAt,i=(0,tu.INm)(n||"",{minimal:!0,agoSuffix:!0});return(0,tc.jsx)(tp.u,{portal:!0,content:(0,tc.jsx)(tp.xu,{padding:2,children:(0,tc.jsx)(tp.xv,{size:1,children:t?"Edited ".concat(i):"No unpublished edits"})}),children:(0,tc.jsx)(tu.LPT,{tone:"caution",dimmed:!t,muted:!t,size:1,children:(0,tc.jsx)(to.dY8,{})})})}function n1(e){let{icon:t,layout:n,presence:i,schemaType:r,value:l}=e,a=(0,tu.Uy$)(l.title)&&(0,td.isValidElement)(l.title)||tY()(l.title)||tK()(l.title)?l.title:null,{draft:s,published:o,isLoading:d}=(0,tX.m2)(()=>(0,tu.eLL)(e.documentPreviewStore,r,l._id,a),[e.documentPreviewStore,r,l._id,a]),c=d?null:(0,tc.jsxs)(tp.gF,{space:4,children:[i&&i.length>0&&(0,tc.jsx)(tu.mEJ,{presence:i}),(0,tc.jsx)(nJ,{document:o}),(0,tc.jsx)(n0,{document:s})]});return(0,tc.jsx)(tu.ogX,{...(0,tu.L_b)({value:l,draft:s,published:o}),isPlaceholder:d,icon:t,layout:n,status:c})}function n2(){throw Error("Pane is missing router context")}let n5=(0,td.createContext)({index:0,groupIndex:0,siblingIndex:0,payload:void 0,params:{},hasGroupSiblings:!1,groupLength:0,routerPanesState:[],BackLink:()=>n2(),ChildLink:()=>n2(),ReferenceChildLink:()=>n2(),handleEditReference:()=>n2(),ParameterizedLink:()=>n2(),replaceCurrent:()=>n2(),closeCurrentAndAfter:()=>n2(),closeCurrent:()=>n2(),duplicateCurrent:()=>n2(),setView:()=>n2(),setParams:()=>n2(),setPayload:()=>n2(),navigateIntent:()=>n2(),createPathWithParams:()=>n2()}),n3=(0,td.forwardRef)(function(e,t){let{routerPanesState:n,groupIndex:i}=(0,td.useContext)(n5),r=(0,td.useMemo)(()=>n.slice(0,i),[i,n]),l=(0,td.useMemo)(()=>({panes:r}),[r]);return(0,tc.jsx)(tG.Px,{...e,ref:t,state:l})}),n6=(0,td.createContext)(null);function n8(){let e=(0,td.useContext)(n6);if(!e)throw Error("PaneLayout: missing context value");return e}let n4=(0,td.forwardRef)(function(e,t){let{childId:n,childPayload:i,childParameters:r,...l}=e,{routerPanesState:a,groupIndex:s}=(0,td.useContext)(n5);return(0,tc.jsx)(tG.Px,{...l,ref:t,state:{panes:[...a.slice(0,s+1),[{id:n,params:r,payload:i}]]}})}),n9=(0,td.forwardRef)(function(e,t){let{documentId:n,documentType:i,parentRefPath:r,children:l,template:a,...s}=e;return(0,tc.jsx)(n4,{...s,ref:t,childId:n,childPayload:null==a?void 0:a.params,childParameters:{type:i,parentRefPath:(0,t0.BB)(r),...a&&{template:null==a?void 0:a.id}},children:l})}),n7=(0,td.forwardRef)(function(e,t){let{routerPanesState:n,groupIndex:i,siblingIndex:r}=(0,td.useContext)(n5),{params:l,payload:a,...s}=e,o=(0,tu.BoV)(l),d=(0,tu.BoV)(a),c=(0,td.useMemo)(()=>{let e=n[i],t=e[r],l={...t,params:null!=o?o:t.params,payload:null!=d?d:t.payload},a=[...e.slice(0,r),l,...e.slice(r+1)];return{panes:[...n.slice(0,i),a,...n.slice(i+1)]}},[n,i,o,d,r]);return(0,tc.jsx)(tG.Px,{ref:t,...s,state:c})});function ie(){return(0,td.useContext)(n5)}let it=[];function ii(e){let{onClick:t,type:n,value:i}=e,r=(0,tu.vsM)(null==i?void 0:i._id),l=(0,tu.Dqo)(r),a=(0,tu.rq_)(),{ReferenceChildLink:s}=ie(),o=(0,td.useCallback)(function(e){return(0,tc.jsx)(s,{documentId:null==i?void 0:i._id,documentType:null==n?void 0:n.name,parentRefPath:it,...e})},[s,null==n?void 0:n.name,null==i?void 0:i._id]);return(0,tc.jsx)(tu.oUE,{__unstable_focusRing:!0,as:o,"data-as":"a",onClick:t,padding:2,radius:2,children:(0,tc.jsx)(n1,{documentPreviewStore:a,icon:null==n?void 0:n.icon,layout:"default",presence:(null==l?void 0:l.length)>0?l:it,schemaType:n,value:i})})}var ir=Object.freeze,il=Object.defineProperty,ia=(e,t)=>ir(il(e,"raw",{value:ir(t||e.slice())}));let is=(0,tm.ZP)(tp.xu)(A||(A=ia(["\n  margin-left: auto;\n"]))),io=tm.ZP.details(D||(D=ia(["\n  flex: none;\n\n  &[open] "," {\n    transform: rotate(180deg);\n  }\n"])),is),id=tm.ZP.summary(L||(L=ia(["\n  list-style: none;\n\n  &::-webkit-details-marker {\n    display: none;\n  }\n"]))),ic=tm.ZP.table(N||(N=ia(["\n  width: 100%;\n  text-align: left;\n  padding: 0 ",";\n  border-collapse: collapse;\n\n  th {\n    padding: ",";\n  }\n\n  td {\n    padding: 0 ",";\n  }\n\n  tr > *:last-child {\n    text-align: right;\n  }\n"])),e=>{let{theme:t}=e;return(0,tp.hO)(t.sanity.space[2])},e=>{let{theme:t}=e;return(0,tp.hO)(t.sanity.space[1])},e=>{let{theme:t}=e;return(0,tp.hO)(t.sanity.space[1])}),iu=(0,tm.ZP)(tp.kC)(Z||(Z=ia(["\n  min-height: 35px;\n"]))),ih=e=>{let t=e.totalCount-e.references.length;return t?(0,tc.jsxs)(tp.gF,{space:2,children:[(0,tc.jsxs)(tp.xv,{size:1,muted:!0,children:[t," other reference",1===t?"":"s"," not shown"," "]}),(0,tc.jsx)(tp.u,{portal:!0,placement:"top",content:(0,tc.jsx)(tp.W2,{width:0,children:(0,tc.jsx)(tp.xu,{padding:2,children:(0,tc.jsx)(tp.xv,{size:1,children:"We can't show metadata about these references because no token with access to the datasets they are in was found."})})}),children:(0,tc.jsx)(tp.xv,{size:1,muted:!0,children:(0,tc.jsx)(to.hQ6,{})})})]}):null};function ip(e){let{crossDatasetReferences:t,internalReferences:n,documentTitle:i,totalCount:r,action:l,datasetNames:a,hasUnknownDatasetNames:s,onReferenceLinkClick:o}=e,d=(0,tu.I_y)(),c=(0,tp.pm)(),u=(0,td.useCallback)(e=>{let t=d.get(e._type);return t?(0,tc.jsx)(ii,{type:t,value:e,onClick:o}):(0,tc.jsx)(tp.xu,{padding:2,children:(0,tc.jsx)(tu.ogX,{icon:to.Tzq,title:"Preview Unavailable",subtitle:"ID: ".concat(e._id),layout:"default"})})},[d,o]);if((null==n?void 0:n.totalCount)===0&&(null==t?void 0:t.totalCount)===0)return(0,tc.jsxs)(tp.xv,{as:"p",children:["Are you sure you want to ",l," ",(0,tc.jsxs)("strong",{children:["“",i,"”"]}),"?"]});let h=1===t.totalCount?"1 document":"".concat(t.totalCount.toLocaleString()," documents"),p=[...a,...s?["unavailable"]:[]],m=1===p.length?"another dataset":"".concat(p.length," datasets"),f="Dataset".concat(1===p.length?"":"s",": ").concat(p.join(", "));return s&&1===p.length&&(f="Unavailable dataset"),(0,tc.jsxs)(tp.Zb,{children:[(0,tc.jsx)(tp.Zb,{padding:3,radius:2,tone:"caution",marginBottom:4,flex:"none",children:(0,tc.jsxs)(tp.kC,{children:[(0,tc.jsx)(tp.xv,{"aria-hidden":"true",size:1,children:(0,tc.jsx)(to.foC,{})}),(0,tc.jsx)(tp.xu,{flex:1,marginLeft:3,children:(0,tc.jsx)(tp.xv,{size:1,children:1===r?(0,tc.jsxs)(tc.Fragment,{children:["1 document refers to “",i,"”"]}):(0,tc.jsxs)(tc.Fragment,{children:[r.toLocaleString()," documents refer to “",i,"”"]})})})]})}),(0,tc.jsx)(tp.xu,{flex:"none",marginBottom:4,children:(0,tc.jsxs)(tp.xv,{children:["You may not be able to ",l," “",i,"” because the following documents refer to it:"]})}),(0,tc.jsx)(tp.Zb,{radius:2,shadow:1,marginBottom:4,flex:"auto",children:(0,tc.jsxs)(tp.kC,{direction:"column",children:[n.totalCount>0&&(0,tc.jsxs)(tp.Kq,{as:"ul",padding:2,space:3,"data-testid":"internal-references",children:[null==n?void 0:n.references.map(e=>(0,tc.jsx)(tp.xu,{as:"li",children:u(e)},e._id)),n.totalCount>n.references.length&&(0,tc.jsx)(tp.xu,{as:"li",padding:3,children:(0,tc.jsx)(ih,{...n})})]}),t.totalCount>0&&(0,tc.jsxs)(io,{"data-testid":"cross-dataset-references",style:{borderTop:n.totalCount>0?"1px solid var(--card-shadow-outline-color)":void 0},children:[(0,tc.jsx)(id,{children:(0,tc.jsx)(tp.Zb,{as:"a",margin:2,radius:2,shadow:1,paddingY:1,children:(0,tc.jsxs)(tp.kC,{align:"center",margin:2,children:[(0,tc.jsx)(tp.xu,{marginLeft:3,marginRight:4,children:(0,tc.jsx)(tp.xv,{size:3,children:(0,tc.jsx)(to.TAM,{})})}),(0,tc.jsxs)(tp.kC,{marginRight:4,direction:"column",children:[(0,tc.jsx)(tp.xu,{marginBottom:2,children:(0,tc.jsxs)(tp.xv,{children:[h," in ",m]})}),(0,tc.jsx)(tp.xu,{children:(0,tc.jsx)(tp.xv,{title:f,textOverflow:"ellipsis",size:1,muted:!0,children:f})})]}),(0,tc.jsx)(is,{children:(0,tc.jsx)(tp.xv,{muted:!0,children:(0,tc.jsx)(to.v4q,{})})})]})})}),(0,tc.jsxs)(tp.xu,{overflow:"auto",paddingBottom:2,paddingX:2,children:[(0,tc.jsxs)(ic,{children:[(0,tc.jsx)("thead",{children:(0,tc.jsxs)("tr",{children:[(0,tc.jsx)("th",{children:(0,tc.jsx)(tp.__,{muted:!0,size:0,style:{minWidth:"5rem"},children:"Project ID"})}),(0,tc.jsx)("th",{children:(0,tc.jsx)(tp.__,{muted:!0,size:0,children:"Dataset"})}),(0,tc.jsx)("th",{children:(0,tc.jsx)(tp.__,{muted:!0,size:0,children:"Document ID"})})]})}),(0,tc.jsx)("tbody",{children:t.references.filter(e=>"projectId"in e).map((e,t)=>{let{projectId:n,datasetName:i,documentId:r}=e;return(0,tc.jsxs)("tr",{children:[(0,tc.jsx)("td",{children:(0,tc.jsx)(tp.xv,{size:1,children:n})}),(0,tc.jsx)("td",{children:(0,tc.jsx)(tp.xv,{size:1,children:i||"unavailable"})}),(0,tc.jsx)("td",{children:(0,tc.jsxs)(iu,{align:"center",gap:2,justify:"flex-end",children:[(0,tc.jsx)(tp.xv,{textOverflow:"ellipsis",size:1,children:r||"unavailable"}),r&&(0,tc.jsx)(tV(),{text:r,onCopy:()=>{c.push({title:"Copied document ID to clipboard!",status:"success"})},children:(0,tc.jsx)(tp.zx,{title:"Copy ID to clipboard",mode:"bleed",icon:to.TIy,fontSize:0})})]})})]},"".concat(r,"-").concat(t))})})]}),(0,tc.jsx)(tp.xu,{padding:2,children:(0,tc.jsx)(ih,{...t})})]})]})]})}),(0,tc.jsx)(tp.xu,{flex:"none",children:(0,tc.jsxs)(tp.xv,{children:["If you ",l," this document, documents that refer to it will no longer be able to access it."]})})]})}var im=Object.freeze,ix=Object.defineProperty,ig=(e,t)=>im(ix(e,"raw",{value:im(t||e.slice())}));let iv=(0,tm.ZP)(tp.xu).attrs({padding:4})(U||(U=ig(["\n  box-sizing: border-box;\n"]))),ib=(0,tm.ZP)(tp.kC).attrs({align:"center",direction:"column",justify:"center"})(B||(B=ig(["\n  height: 300px;\n"])));function iy(e){let{id:t,type:n,action:i="delete",onCancel:r,onConfirm:l}=e,a="deletion-confirmation-".concat((0,td.useId)()),{internalReferences:s,crossDatasetReferences:o,isLoading:d,totalCount:c,projectIds:u,datasetNames:h,hasUnknownDatasetNames:p}=function(e){let t=(0,tu.m85)(tu.Dr7),n=(0,tu.H__)(),i=(0,tu.vsM)(e),[r,l]=nG((0,td.useMemo)(()=>[i,n],[n,i])),[a,s]=nQ((0,td.useMemo)(()=>[i,t],[i,t])),o=(0,td.useMemo)(()=>Array.from(new Set(null==a?void 0:a.references.map(e=>e.projectId).filter(Boolean))).sort(),[null==a?void 0:a.references]),d=(0,td.useMemo)(()=>Array.from(new Set(null==a?void 0:a.references.map(e=>(null==e?void 0:e.datasetName)||"").filter(e=>!!e&&""!==e))).sort(),[null==a?void 0:a.references]),c=(0,td.useMemo)(()=>!!(null==a?void 0:a.references.some(e=>"string"!=typeof e.datasetName)),[null==a?void 0:a.references]);return{totalCount:((null==r?void 0:r.totalCount)||0)+((null==a?void 0:a.totalCount)||0),projectIds:o,datasetNames:d,hasUnknownDatasetNames:c,internalReferences:r,crossDatasetReferences:a,isLoading:l||s}}(t),m="".concat(i.substring(0,1).toUpperCase()).concat(i.substring(1)),f=(0,tc.jsx)(nK,{document:(0,td.useMemo)(()=>({_id:t,_type:n}),[t,n])}),x=!d;return(0,tc.jsx)(tp.Vq,{width:1,id:a,header:"".concat(m," document?"),footer:(0,tc.jsxs)(tp.rj,{columns:x?2:1,gap:2,paddingX:4,paddingY:3,children:[(0,tc.jsx)(tp.zx,{mode:"ghost",onClick:r,text:"Cancel"}),x&&(0,tc.jsx)(tp.zx,{"data-testid":"confirm-delete-button",text:c>0?"".concat(m," anyway"):"".concat(m," now"),tone:"critical",onClick:l})]}),onClose:r,onClickOutside:r,children:(0,tc.jsx)(iv,{children:o&&s&&!d?(0,tc.jsx)(ip,{crossDatasetReferences:o,internalReferences:s,documentTitle:f,isLoading:d,totalCount:c,action:i,projectIds:u,datasetNames:h,hasUnknownDatasetNames:p,onReferenceLinkClick:r}):(0,tc.jsxs)(ib,{"data-testid":"loading-container",children:[(0,tc.jsx)(tp.$j,{muted:!0}),(0,tc.jsx)(tp.xu,{marginTop:3,children:(0,tc.jsx)(tp.xv,{align:"center",muted:!0,size:1,children:"Looking for referring documents…"})})]})})})}function ij(e){let t=(0,td.useId)(),[n,i]=(0,td.useState)(null),r=(0,td.useCallback)(()=>i(null),[]);return n?(0,tc.jsx)(tp.Vq,{id:"dialog-error-".concat(t),"data-testid":"confirm-delete-error-dialog",header:"Error",footer:(0,tc.jsx)(tp.kC,{paddingX:4,paddingY:3,direction:"column",children:(0,tc.jsx)(tp.zx,{mode:"ghost",text:"Retry",onClick:r})}),onClose:e.onCancel,children:(0,tc.jsx)(tp.xu,{padding:4,children:(0,tc.jsx)(tp.xv,{children:"An error occurred while loading referencing documents."})})}):(0,tc.jsx)(tp.SV,{onCatch:i,children:(0,tc.jsx)(iy,{...e})})}let iw={constrainSize:!0,placement:"left-start",portal:!0};function i_(e){let{disabled:t,isAfterGroup:n,node:i}=e;return"divider"===i.type?(0,tc.jsx)(tp.R,{}):"group"===i.type?0===i.children.length?null:i.expanded?(0,tc.jsxs)(tc.Fragment,{children:[n&&(0,tc.jsx)(tp.R,{}),i.title&&(0,tc.jsx)(tp.xu,{padding:2,paddingBottom:1,children:(0,tc.jsx)(tp.__,{muted:!0,size:0,children:i.title})}),i.children.map((e,n)=>{var r;return(0,tc.jsx)(i_,{disabled:t||!!i.disabled,isAfterGroup:(null==(r=i.children[n-1])?void 0:r.type)==="group",node:e},e.key)})]}):(0,tc.jsxs)(tc.Fragment,{children:[n&&(0,tc.jsx)(tp.R,{}),(0,tc.jsx)(tp.kS,{disabled:t,icon:i.icon,popover:iw,text:i.title,children:i.children.map((e,n)=>{var r;return(0,tc.jsx)(i_,{disabled:t||!!i.disabled,isAfterGroup:(null==(r=i.children[n-1])?void 0:r.type)==="group",node:e},e.key)})})]}):(0,tc.jsxs)(tc.Fragment,{children:[n&&(0,tc.jsx)(tp.R,{}),(0,tc.jsx)(ik,{disabled:t,node:i})]})}function ik(e){let{node:t}=e;return t.intent?(0,tc.jsx)(iz,{...e,intent:t.intent}):(0,tc.jsx)(iC,{...e})}function iC(e){var t;let{disabled:n,node:i}=e,r="object"==typeof i.disabled&&(0,tc.jsx)(tp.xv,{size:1,children:i.disabled.reason});return(0,tc.jsx)(tu.xMr,{content:r,placement:"left",children:(0,tc.jsx)(tp.sN,{disabled:n||!!i.disabled,hotkeys:null==(t=i.hotkey)?void 0:t.split("+"),icon:i.icon,iconRight:i.iconRight||i.selected&&to.KML,onClick:i.onAction,pressed:i.selected,text:i.title,tone:i.tone})})}function iz(e){var t;let{disabled:n,intent:i,node:r}=e,l="object"==typeof r.disabled&&(0,tc.jsx)(tp.xv,{size:1,children:r.disabled.reason}),a=(0,tG.PM)({intent:i.type,params:i.params}),s=(0,td.useCallback)(e=>{a.onClick(e),r.onAction()},[a,r]);return(0,tc.jsx)(tu.xMr,{content:l,placement:"left",children:(0,tc.jsx)(tp.sN,{as:"a",disabled:n||!!r.disabled,hotkeys:null==(t=r.hotkey)?void 0:t.split("+"),href:a.href,icon:r.icon,iconRight:r.selected?to.KML:void 0,onClick:s,pressed:r.selected,text:r.title,tone:r.tone})})}let iE={constrainSize:!0,placement:"bottom",portal:!0};function iI(e,t){return e.some(e=>"item"===e.type&&e.tone===t||"group"===e.type&&iI(e.children,t))}function iS(e){let{nodes:t}=e,n=(0,td.useId)(),i=iI(t,"critical"),r=iI(t,"caution");return(0,tc.jsx)(tp.j2,{button:(0,tc.jsx)(tu.YG6,{icon:to.zGg,mode:"bleed",title:"Show menu",tone:i?"critical":r?"caution":void 0}),id:n,menu:(0,tc.jsx)(tp.v2,{children:t.map((e,n)=>{var i;let r=(null==(i=t[n-1])?void 0:i.type)==="group";return(0,tc.jsx)(i_,{isAfterGroup:r,node:e},e.key)})}),popover:iE})}let iP=(0,td.createContext)(null);var iT=Object.freeze,iM=Object.defineProperty;let iR=(0,tm.ZP)(tp.mh)(F||(F=iT(iM(d=["\n  position: relative;\n  width: 1px;\n  min-width: 1px;\n\n  &:before {\n    content: '';\n    display: block;\n    position: absolute;\n    top: 0;\n    left: 0;\n    bottom: 0;\n    width: 1px;\n    background-color: var(--card-border-color);\n  }\n\n  &:not([data-disabled]) {\n    cursor: ew-resize;\n    width: 9px;\n    min-width: 9px;\n    margin: 0 -4px;\n\n    &:before {\n      left: 4px;\n    }\n\n    &:after {\n      content: '';\n      display: block;\n      position: absolute;\n      top: 0;\n      left: 0;\n      width: 9px;\n      bottom: 0;\n      background-color: var(--card-border-color);\n      opacity: 0;\n      transition: opacity 150ms;\n    }\n\n    &[data-dragging]:after,\n    &:hover:after {\n      opacity: 0.2;\n    }\n  }\n"],"raw",{value:iT(d.slice())}))));function iO(e){let{disabled:t,element:n}=e,{resize:i}=n8(),[r,l]=(0,td.useState)(!1),a=(0,td.useCallback)(e=>{if(!n)return;l(!0),e.preventDefault();let t=e.pageX;i("start",n,0);let r=e=>{e.preventDefault(),i("move",n,e.pageX-t)},a=e=>{e.preventDefault(),l(!1),window.removeEventListener("mousemove",r),window.removeEventListener("mouseup",a),i("end",n,0)};window.addEventListener("mousemove",r),window.addEventListener("mouseup",a)},[n,i]);return(0,tc.jsx)(iR,{"data-disabled":t?"":void 0,"data-dragging":r?"":void 0,onMouseDown:a})}var iA=Object.freeze,iD=Object.defineProperty;let iL=(0,tm.ZP)(tp.Zb)(q||(q=iA(iD(c=["\n  outline: none;\n\n  // NOTE: This will render a border to the right side of each pane\n  // without taking up physical space.\n  box-shadow: 1px 0 0 var(--card-border-color);\n"],"raw",{value:iA(c.slice())})))),iN=(0,td.forwardRef)(function(e,t){var n,i,r;let{children:l,currentMinWidth:a,currentMaxWidth:s,flex:o=1,id:d,minWidth:c,maxWidth:u,selected:h=!1,...p}=e,[m,f]=(0,td.useState)(null),{collapse:x,collapsed:g,expand:v,expandedElement:b,mount:y,panes:j}=n8(),w=j.find(e=>e.element===m),_=w&&j.indexOf(w),k="number"==typeof _?j[_+1]:void 0,C=_===j.length-1,z=!g&&((null==w?void 0:w.collapsed)||!1),E=(null==k?void 0:k.collapsed)||!1,I=(0,tp.ts)(t),S=null!=(n=null==w?void 0:w.flex)?n:o,P=null!=(i=null==w?void 0:w.currentMinWidth)?i:a,T=null!=(r=null==w?void 0:w.currentMaxWidth)?r:s,M=(0,td.useCallback)(e=>{f(e),I.current=e},[I]);(0,td.useEffect)(()=>{if(m)return y(m,{currentMinWidth:a,currentMaxWidth:s,flex:o,id:d,minWidth:c,maxWidth:u})},[a,s,o,d,c,u,y,m]);let R=(0,td.useCallback)(()=>{m&&x(m)},[x,m]),O=(0,td.useCallback)(()=>{m&&v(m)},[v,m]),A=(0,td.useMemo)(()=>({collapse:R,collapsed:!g&&z,expand:O,index:_,isLast:C,rootElement:m}),[z,R,O,C,g,_,m]),D=(0,td.useMemo)(()=>g?void 0:z?51:0===P||C?c||204:P||c||204,[z,P,C,g,c]),L=(0,td.useMemo)(()=>z?51:g&&C?void 0:C?u?null!=T?T:u:void 0:null!=T?T:u,[z,T,C,g,u]),N=g&&!C,Z=(0,td.useMemo)(()=>!C&&!g&&(0,tc.jsx)(tu.jr5,{zOffset:"paneResizer",children:(0,tc.jsx)(iO,{disabled:z||E,element:m})}),[z,C,g,E,m]),U=(0,td.useMemo)(()=>({flex:S,minWidth:D,maxWidth:L===1/0?void 0:L}),[S,D,L]);return(0,tc.jsxs)(tc.Fragment,{children:[(0,tc.jsx)(tu.jr5,{zOffset:"pane",children:(0,tc.jsx)(iP.Provider,{value:A,children:(0,tc.jsxs)(iL,{"data-testid":"pane","data-ui":"Pane",tone:"inherit",hidden:N,id:d,overflow:g?void 0:"hidden",...p,"data-pane-collapsed":z?"":void 0,"data-pane-index":_,"data-pane-selected":h?"":void 0,ref:M,style:U,children:[!1,(0,tc.jsx)(tp.NM,{element:m,children:!N&&(0,tc.jsx)(tp.kC,{direction:"column",height:"fill",children:l})})]})})}),Z]})});function iZ(){let e=(0,td.useContext)(iP);if(!e)throw Error("Pane: missing context value");return e}var iU=Object.freeze,iB=Object.defineProperty;let iF=(0,tm.ZP)(tp.Zb)(H||(H=iU(iB(u=["\n  position: relative;\n  outline: none;\n"],"raw",{value:iU(u.slice())}))));iF.displayName="PaneContent__root";let iq=(0,td.forwardRef)(function(e,t){let{as:n,children:i,overflow:r,padding:l,...a}=e,{collapsed:s}=iZ(),{collapsed:o}=n8();return(0,tc.jsx)(iF,{"data-testid":"pane-content",forwardedAs:n,...a,flex:1,hidden:s,overflow:o?void 0:r,padding:l,ref:t,tone:"inherit",children:i})});var iH=Object.freeze,iV=Object.defineProperty,iW=(e,t)=>iH(iV(e,"raw",{value:iH(t||e.slice())}));let iK=(0,tm.ZP)(tp.mh)(V||(V=iW(["\n  position: sticky;\n  bottom: 0;\n\n  &:before {\n    content: '';\n    display: block;\n    position: absolute;\n    left: 0;\n    right: 0;\n    top: -1px;\n    border-bottom: 1px solid var(--card-shadow-outline-color);\n  }\n"]))),i$=(0,tm.ZP)(tp.Zb)(W||(W=iW(["\n  padding-bottom: env(safe-area-inset-bottom);\n"]))),iY=(0,td.forwardRef)(function(e,t){let{children:n,padding:i}=e,{collapsed:r}=iZ();return(0,tc.jsx)(tu.jr5,{zOffset:"paneFooter",children:(0,tc.jsx)(iK,{"data-testid":"pane-footer",hidden:r,ref:t,children:(0,tc.jsx)(i$,{tone:"inherit",children:(0,tc.jsx)(tp.xu,{padding:i,children:n})})})})});var iX=Object.freeze,iG=Object.defineProperty,iQ=(e,t)=>iX(iG(e,"raw",{value:iX(t||e.slice())}));let iJ=(0,tm.ZP)(tp.mh)(K||(K=iQ(["\n  line-height: 0;\n  position: sticky;\n  top: 0;\n\n  &:not([data-collapsed]):after {\n    content: '';\n    display: block;\n    position: absolute;\n    left: 0;\n    right: 0;\n    bottom: -1px;\n    border-bottom: 1px solid var(--card-shadow-outline-color);\n  }\n"]))),i0=(0,tm.ZP)(tp.kC)($||($=iQ(["\n  transform-origin: calc(51px / 2);\n\n  [data-collapsed] > div > & {\n    transform: rotate(90deg);\n  }\n"]))),i1=(0,tm.ZP)(tp.Zb)(e=>{let{theme:t}=e,{fg:n,bg:i}=t.sanity.color.card.enabled;return(0,tm.iv)(Y||(Y=iQ(["\n    background-color: ",";\n\n    [data-ui='Text'] {\n      color: ",";\n    }\n  "])),i,n)}),i2=(0,tm.ZP)(tp.Qr)(X||(X=iQ(["\n  width: 66%;\n  max-width: 175px;\n"]))),i5=(0,tm.ZP)(tp.xv)(G||(G=iQ(["\n  cursor: default;\n  outline: none;\n"]))),i3=(0,tm.ZP)(tp.xu)(e=>{let{theme:t}=e,{color:n,space:i}=t.sanity;return(0,tm.iv)(Q||(Q=iQ(["\n    overflow: hidden;\n    overflow: clip;\n    position: relative;\n\n    & > div {\n      white-space: nowrap;\n      overflow: auto;\n      /* Hide scrollbars */\n      scrollbar-width: none;\n      &::-webkit-scrollbar {\n        width: 0;\n        height: 0;\n      }\n    }\n\n    /* right padding */\n    & > div:after {\n      content: '';\n      display: inline-block;\n      top: 0;\n      right: 0;\n      bottom: 0;\n      width: ","px;\n      height: 1px;\n    }\n\n    /* Gradient that makes it look like tabs disappear into nothing (looks nicer) */\n    &:after {\n      content: '';\n      display: block;\n      position: absolute;\n      top: 0;\n      right: 0;\n      bottom: 0;\n      background: linear-gradient(to right, ",", var(--card-bg-color));\n      width: ","px;\n      pointer-events: none;\n    }\n  "])),i[3],(0,tp.m4)(n.base.bg,0),i[3])}),i6=(0,td.forwardRef)(function(e,t){let{actions:n,backButton:i,contentAfter:r,loading:l,subActions:a,tabs:s,tabIndex:o,title:d}=e,{collapse:c,collapsed:u,expand:h,rootElement:p}=iZ(),m=(0,tp.XL)(p||null),f=(0,td.useMemo)(()=>({width:u?(null==m?void 0:m.height)||window.innerHeight:void 0}),[u,m]),x=(0,td.useCallback)(()=>{u||c()},[c,u]),g=(0,td.useCallback)(()=>{u&&h()},[u,h]),v=!!(!u&&(s||a));return(0,tc.jsx)(tp.li,{zOffset:100,children:(0,tc.jsx)(iJ,{"data-collapsed":u?"":void 0,"data-testid":"pane-header",ref:t,children:(0,tc.jsx)(tu.jr5,{zOffset:"paneHeader",children:(0,tc.jsxs)(tp.Zb,{"data-collapsed":u?"":void 0,tone:"inherit",children:[(0,tc.jsxs)(i0,{onClick:g,padding:2,sizing:"border",style:f,children:[i&&(0,tc.jsx)(tp.xu,{flex:"none",padding:1,children:i}),(0,tc.jsxs)(i1,{__unstable_focusRing:!0,flex:1,forwardedAs:"button",marginRight:n?1:0,onClick:x,paddingLeft:i?1:3,paddingY:3,tabIndex:o,children:[l&&(0,tc.jsx)(i2,{animated:!0,radius:1}),!l&&(0,tc.jsx)(i5,{textOverflow:"ellipsis",weight:"semibold",children:d})]}),n&&(0,tc.jsx)(tp.kC,{align:"center",hidden:u,children:(0,tc.jsx)(tu.jr5,{zOffset:"paneHeader",children:n})})]}),v&&(0,tc.jsxs)(tp.kC,{align:"center",hidden:u,overflow:"auto",paddingBottom:3,paddingX:3,paddingTop:1,children:[(0,tc.jsx)(i3,{flex:1,marginRight:a?3:0,children:s}),a&&a]}),!u&&r&&r]})})})})});function i8(e){let{node:t,padding:n}=e;return"item"===t.type?(0,tc.jsx)(i4,{node:t,padding:n}):"group"===t.type?(0,tc.jsx)(i7,{node:t,padding:n}):(console.warn('unknown menu node (expected `type: "item" | "group"`):',t),null)}function i4(e){var t;let{node:n,padding:i}=e;if(n.intent)return(0,tc.jsx)(i9,{...e,intent:n.intent});let r="object"==typeof n.disabled&&(0,tc.jsx)(tp.xv,{size:1,children:n.disabled.reason});return(0,tc.jsx)(tu.xMr,{content:r,placement:"bottom",children:(0,tc.jsx)(tu.YG6,{disabled:!!n.disabled,hotkey:null==(t=n.hotkey)?void 0:t.split("+"),icon:n.icon,label:r?void 0:n.title,onClick:n.onAction,padding:i,selected:n.selected,tone:n.tone})})}function i9(e){var t;let{intent:n,node:i,padding:r}=e,l="object"==typeof i.disabled&&(0,tc.jsx)(tp.xv,{size:1,children:i.disabled.reason}),a=(0,tG.PM)({intent:n.type,params:n.params}),s=(0,td.useCallback)(e=>{a.onClick(e),i.onAction()},[a,i]);return(0,tc.jsx)(tu.xMr,{content:l,placement:"bottom",children:(0,tc.jsx)(tu.YG6,{as:"a",disabled:!!i.disabled,hotkey:null==(t=i.hotkey)?void 0:t.split("+"),href:a.href,icon:i.icon,label:l?void 0:i.title,onClick:s,padding:r,selected:i.selected,tone:i.tone})})}function i7(e){var t;let{node:n,padding:i}=e;return(0,tc.jsx)(tp.j2,{button:(0,tc.jsx)(tu.YG6,{disabled:n.disabled,icon:null!=(t=n.icon)?t:to.Tzq,label:n.title,padding:i}),id:(0,td.useId)(),menu:(0,tc.jsx)(tp.v2,{children:n.children.map((e,t)=>{var i;return(0,tc.jsx)(i_,{disabled:!!n.disabled,isAfterGroup:(null==(i=n.children[t-1])?void 0:i.type)==="group",node:e},e.key)})})})}var re=Object.freeze,rt=Object.defineProperty;let rn=(0,tm.ZP)(tp.Zb)(J||(J=re(rt(h=["\n  transition: opacity 200ms;\n  position: relative;\n  z-index: 1;\n  padding-left: env(safe-area-inset-left);\n  padding-right: env(safe-area-inset-right);\n  opacity: 0;\n\n  &:not([hidden]) {\n    display: flex;\n  }\n\n  &:not([data-collapsed]) {\n    overflow: auto;\n  }\n\n  &[data-mounted] {\n    opacity: 1;\n  }\n\n  &[data-resizing] {\n    pointer-events: none;\n  }\n"],"raw",{value:re(h.slice())})))),ri=[];function rr(e){let{children:t,minWidth:n,onCollapse:i,onExpand:r,...l}=e,a=(0,td.useMemo)(()=>(function(){let e=[],t=[],n=new WeakMap,i=new Set,r={},l=null,a=0,s=null,o=new Map,d=!1;function c(e){i.delete(e),s=e,u()}return{collapse:function(e){i.add(e),s===e&&(s=null),u()},expand:c,mount:function(e,i){return n.set(e,{...i,original:i}),t.push(e),l&&function(e,t){let n=new WeakMap;for(let i of t)n.set(i,function(e,t){let n=[],i=t;for(;i!==e;){let t=i.parentElement;if(!t)break;let r=Array.from(t.childNodes).indexOf(i);if(n.unshift(r),t===e)break;i=t}return n}(e,i));t.sort((e,t)=>{let i=n.get(e)||ri,r=n.get(t)||ri,l=Math.max(i.length,r.length);for(let e=0;e<l;e+=1){let t=i[e]||-1,n=r[e]||-1;if(t!==n)return t-n}return 0})}(l,t),c(e),()=>{let i=t.indexOf(e);i>-1&&t.splice(i,1),n.delete(e),u()}},resize:function(e,i,l){var a,s,c,h;let p=t.indexOf(i),m=n.get(i);if(!m)return;let f=t[p+1],x=n.get(f);if(x){if("start"===e&&(d=!0,r.left={element:i,flex:m.flex||1,width:i.offsetWidth},r.right={element:f,flex:x.flex||1,width:f.offsetWidth},u()),"move"===e&&r.left&&r.right){o=new Map;let{leftW:e,rightW:t,leftFlex:n,rightFlex:a}=function(e,t,n,i){var r,l;let a={flex:e.left.flex+e.right.flex,width:e.left.width+e.right.width},s=null!=(r=t.minWidth)?r:204,o=null!=(l=n.minWidth)?l:204,d=Math.min(t.maxWidth||1/0,a.width-o),c=Math.min(n.maxWidth||1/0,a.width-s),u=s-e.left.width,h=e.right.width-c;u<h&&(u=h);let p=e.right.width-o,m=d-e.left.width;p>m&&(p=m);let f=Math.min(Math.max(i,u),p),x=e.left.width+f,g=e.right.width-f;return{leftFlex:x/a.width*a.flex,leftW:x,rightFlex:g/a.width*a.flex,rightW:g}}(r,m,x,l);o.set(i,{flex:n,width:e}),o.set(f,{flex:a,width:t}),u()}if("end"===e){d=!1;let e=o.get(i),t=o.get(f);n.set(i,{...m,currentMinWidth:0,currentMaxWidth:null!=(a=m.maxWidth)?a:1/0,flex:null!=(s=null==e?void 0:e.flex)?s:m.flex}),n.set(f,{...x,currentMinWidth:0,currentMaxWidth:null!=(c=m.maxWidth)?c:1/0,flex:null!=(h=null==t?void 0:t.flex)?h:x.flex}),o=new Map,delete r.left,delete r.right,u()}}},setRootElement:function(e){l=e},setRootWidth:function(e){a=e,u()},subscribe:function(t){return e.push(t),()=>{let n=e.push(t);n>-1&&e.splice(n,1)}}};function u(){var r,l,c,u;if(!a)return;let h=[];for(let e of t)e!==s&&h.unshift(e);s&&h.unshift(s);let p=new WeakMap,m=h.length,f=h[0],x=a-(m-1)*51;for(let e of h){let t=n.get(e);if(!t)continue;let a=t.currentMinWidth||t.minWidth||204,s=e===f,d=i.has(e),h=a>x,m=!s&&(d||h),g=o.get(e);p.set(e,{element:e,collapsed:m,currentMinWidth:null!=(r=null==g?void 0:g.width)?r:t.currentMinWidth,currentMaxWidth:null!=(l=null==g?void 0:g.width)?l:t.currentMaxWidth,flex:null!=(u=null!=(c=null==g?void 0:g.flex)?c:t.flex)?u:1}),m?x-=51:x-=a-51}let g=[];for(let e of t){let t=p.get(e);t&&g.push(t)}for(let n of e)n({expandedElement:s||t[t.length-1]||null,panes:g,resizing:d})}})(),[]),[s,o]=(0,td.useState)(null),d=(0,tp.XL)(s),c=(null==d?void 0:d.width)||0,u=void 0!==c&&n?c<n:void 0,[h,p]=(0,td.useState)({expandedElement:null,panes:[],resizing:!1});(0,td.useEffect)(()=>a.setRootElement(s),[a,s]),(0,td.useEffect)(()=>a.setRootWidth(c),[a,c]),(0,td.useEffect)(()=>a.subscribe(p),[a]),(0,td.useEffect)(()=>{void 0!==u&&(u&&i&&i(),!u&&r&&r())},[u,i,r]);let m=(0,td.useMemo)(()=>({collapse:a.collapse,collapsed:u,expand:a.expand,expandedElement:h.expandedElement,mount:a.mount,panes:h.panes,resize:a.resize,resizing:h.resizing}),[u,a,h.expandedElement,h.panes,h.resizing]);return(0,tc.jsx)(n6.Provider,{value:m,children:(0,tc.jsx)(rn,{"data-ui":"PaneLayout",...l,"data-collapsed":u?"":void 0,"data-resizing":h.resizing?"":void 0,"data-mounted":c?"":void 0,ref:o,children:t})})}function rl(e){return("item"===e.type||"group"===e.type)&&e.renderAsButton}let ra=t3()(rl);function rs(e){var t,n;let{fieldActions:i=[],menuItems:r,menuItemGroups:l}=e,a=[],s=0;for(let e=0;e<i.length;e+=1){let t=i[e];a.push(function e(t,n){var i,r,l;return"divider"===t.type?{type:"divider",key:n}:"group"===t.type?{type:"group",key:n,children:t.children.map((t,i)=>e(t,"".concat(n,"-").concat(i,"-").concat(t.type))),disabled:t.disabled,expanded:null==(i=t.expanded)||i,icon:t.icon,title:t.title,renderAsButton:null!=(r=t.renderAsButton)&&r}:{type:"item",key:n,intent:t.intent,disabled:t.disabled,icon:t.icon,iconRight:t.iconRight,onAction:t.onAction,renderAsButton:null!=(l=t.renderAsButton)&&l,selected:t.selected,title:t.title,tone:t.tone}}(t,"".concat(e,"-").concat(t.type)))}s+=a.length;let o=[];for(let e of l)o.find(t=>t.key===e.id)||o.push({type:"group",key:e.id,children:[],expanded:!0,renderAsButton:!1,title:e.title});let d=[];for(let i=0;i<r.length;i+=1){let l=r[i],a=l.group&&o.find(e=>e.key===l.group);l.group&&!a&&(a={type:"group",key:l.group,expanded:!0,icon:l.icon,title:l.group,children:[],renderAsButton:!1},o.push(a)),a?a.children.push({type:"item",key:"".concat(s+i,"-item"),hotkey:l.shortcut,icon:l.icon,onAction:()=>e.actionHandler(l),renderAsButton:null!=(t=l.showAsAction)&&t,selected:l.selected,title:l.title,tone:l.tone}):d.push({type:"item",key:"".concat(s+i,"-item"),hotkey:l.shortcut,icon:l.icon,onAction:()=>e.actionHandler(l),renderAsButton:null!=(n=l.showAsAction)&&n,selected:l.selected,title:l.title,tone:l.tone})}return[...d,...o,...a]}let ro=(0,td.forwardRef)(function(e,t){let{intent:n,...i}=e,r=(0,td.useMemo)(()=>(0,td.forwardRef)(function(e,t){return(0,tc.jsx)(tG.nR,{...e,intent:n.type,params:n.params,ref:t})}),[n]);return e.disabled?(0,tc.jsx)(tp.zx,{...e,as:"a",role:"link","aria-disabled":"true"}):(0,tc.jsx)(tp.zx,{...i,as:r,"data-as":"a",ref:t})});function rd(e){let{reveal:t,loading:n,children:i}=e,r=(0,tu.xJ)();return t?(0,tc.jsx)(tp.u,{content:n?(0,tc.jsx)(tp.xu,{padding:2,children:(0,tc.jsx)(tp.xv,{children:"Loading…"})}):(0,tc.jsx)(tu.FMn,{currentUser:r}),portal:!0,children:(0,tc.jsx)("div",{children:i})}):(0,tc.jsx)(tc.Fragment,{children:i})}let rc={constrainSize:!0,placement:"bottom",portal:!0},ru=(e,t,n)=>{var i;let r=null==(i=t.find(e=>e.id===n.templateId))?void 0:i.schemaType;if(!r)return null;let l={template:n.templateId,type:r,id:n.initialDocumentId};return{type:"create",params:n.parameters?[l,n.parameters]:l}};function rh(e){let{templateItems:t}=e,n=(0,tu.I_y)(),i=(0,tu.zEW)(),[r,l]=(0,tu.UMU)({templateItems:t}),a=(0,td.useMemo)(()=>!l&&(null==r?void 0:r.every(e=>!e.granted)),[l,r]),s=(0,td.useMemo)(()=>r?r.reduce((e,t)=>(e[t.id]=t,e),{}):{},[r]);if(a)return(0,tc.jsx)(rd,{reveal:!0,loading:l,children:(0,tc.jsx)(tp.zx,{"aria-label":"Insufficient permissions",icon:to.dtP,mode:"bleed",disabled:!0,"data-testid":"action-intent-button"})});if(1===t.length){let e=t[0],r=s[e.id],a=!(null==r?void 0:r.granted),o=ru(n,i,e);return o?(0,tc.jsx)(rd,{reveal:a,loading:l,children:(0,tc.jsx)(ro,{"aria-label":e.title,icon:e.icon||to.dtP,intent:o,mode:"bleed",disabled:a,"data-testid":"action-intent-button"})}):null}return(0,tc.jsx)(tp.j2,{button:(0,tc.jsx)(tp.zx,{icon:to.dtP,mode:"bleed","data-testid":"multi-action-intent-button"}),id:"create-menu",menu:(0,tc.jsxs)(tp.v2,{children:[(0,tc.jsx)(tp.xu,{paddingX:3,paddingTop:3,paddingBottom:2,children:(0,tc.jsx)(tp.__,{muted:!0,children:"Create"})}),t.map((e,t)=>{let r=s[e.id],a=!(null==r?void 0:r.granted),o=ru(n,i,e),d=i.find(t=>t.id===e.templateId);if(!d||!o)return null;let c=(0,td.forwardRef)((e,t)=>a?(0,tc.jsx)("button",{type:"button",disabled:!0,...e,ref:t}):(0,tc.jsx)(tG.nR,{...e,intent:o.type,params:o.params,ref:t}));return c.displayName="Link",(0,tc.jsx)(rd,{reveal:a,loading:l,children:(0,tc.jsx)(tp.sN,{as:c,"data-as":a?"button":"a",text:e.title||d.title,"aria-label":a?"Insufficient permissions":e.title||d.title,disabled:a,"data-testid":"action-intent-button-".concat(t)})},e.id)})]}),popover:rc})}function rp(e){return null!=e}let rm=e=>{let t=e=>"object"==typeof e&&e?Array.isArray(e)?e.map(t):Object.entries(e).sort((e,t)=>{let[n]=e,[i]=t;return n.localeCompare(i,"en")}):e;return JSON.stringify(t(JSON.parse(JSON.stringify(e))))},rf=(0,td.memo)(function(e){let{initialValueTemplateItems:t=tu.LZ8,menuItems:n=tu.LZ8,menuItemGroups:i=tu.LZ8,actionHandlers:r=tu.NuZ}=e,l=(0,tu.zEW)(),a=(0,td.useCallback)(e=>{if("string"==typeof e.action&&!(e.action in r))return console.warn("No handler for action:",e.action),!1;let t="function"==typeof e.action?e.action:"string"==typeof e.action?r[e.action]:null;return!!t&&(t(e.params),!0)},[r]),s=(0,td.useMemo)(()=>rs({actionHandler:a,menuItemGroups:i,menuItems:n.filter(e=>{var t;return(null==(t=e.intent)?void 0:t.type)!=="create"})}),[a,i,n]),o=(0,td.useMemo)(()=>s.filter(rl),[s]),d=(0,td.useMemo)(()=>s.filter(ra),[s]),c=(0,td.useMemo)(()=>n.map((e,t)=>{var n;if((null==(n=e.intent)?void 0:n.type)!=="create")return null;let{params:i}=e.intent;if(!i)return null;let r=Array.isArray(i)?i[0]:i,a=Array.isArray(i)?i[1]:void 0,s=r.template||r.type;if(!s)return null;let o=l.find(e=>e.id===s);return o?{item:e,template:o,templateParams:a,menuItemIndex:t,initialDocumentId:r.id}:null}).filter(rp).map(e=>{let{initialDocumentId:t,item:n,template:i,menuItemIndex:r,templateParams:l}=e;return{id:"menuItem".concat(r),initialDocumentId:t,templateId:i.id,type:"initialValueTemplateItem",title:n.title||i.title,icon:n.icon,description:i.description,parameters:l,schemaType:i.schemaType}}),[n,l]),u=(0,td.useMemo)(()=>t2()([...c,...t],e=>rm([e.initialDocumentId,e.templateId,e.parameters])),[c,t]);return(0,tc.jsxs)(tp.kC,{gap:1,children:[u.length>0&&(0,tc.jsx)(rh,{templateItems:u}),o.map(e=>(0,tc.jsx)(i8,{node:e},e.key)),d.length>0&&(0,tc.jsx)(iS,{nodes:d})]})}),rx=(e,t)=>({title:(0,tc.jsxs)("em",{children:["No schema found for type ",(0,tc.jsx)("code",{children:t})]}),subtitle:(0,tc.jsxs)("em",{children:["Document: ",(0,tc.jsx)("code",{children:e})]}),media:()=>(0,tc.jsx)(to.foC,{})});function rg(e){let{layout:t,value:n}=e;return(0,tc.jsx)(tu.ogX,{...rx(n._id,n._type),layout:t})}function rv(e,t,n){return!1!==e&&(e||t&&t.icon||n||!1)}function rb(e){let{icon:t,id:n,layout:i="default",pressed:r,schemaType:l,selected:a,title:s,value:o,margin:d,marginBottom:c,marginTop:u}=e,h=(0,tu.I_y)(),p=(0,tu.rq_)(),{ChildLink:m}=ie(),f=(0,tu.Dqo)(n),x=!!(l&&l.name&&h.get(l.name)),[g,v]=(0,td.useState)(!1),b=(0,td.useMemo)(()=>o&&(0,th.Si)(o)?l&&x?(0,tc.jsx)(n1,{documentPreviewStore:p,icon:rv(t,l,to.$lS),layout:i,schemaType:l,value:o,presence:f}):(0,tc.jsx)(rg,{value:o}):(0,tc.jsx)(tu.ogX,{status:(0,tc.jsx)(tp.xv,{muted:!0,children:(0,tc.jsx)(to.XCv,{})}),icon:rv(t,l,to.ROc),layout:i,title:s}),[p,x,t,i,l,s,o,f]),y=(0,td.useMemo)(()=>function(e){return(0,tc.jsx)(m,{...e,childId:n})},[m,n]),j=(0,td.useCallback)(e=>{if(e.metaKey){v(!1);return}v(!0)},[]);return(0,td.useEffect)(()=>v(!1),[a]),(0,tc.jsx)(tu.oUE,{__unstable_focusRing:!0,as:y,"data-as":"a","data-ui":"PaneItem",margin:d,marginBottom:c,marginTop:u,onClick:j,padding:2,pressed:r,radius:2,selected:a||g,sizing:"border",tabIndex:-1,tone:"inherit",children:b})}let ry=(0,td.createContext)(null);function rj(){let e=(0,td.useContext)(ry);if(!e)throw Error("DocumentPane: missing context value");return e}let rw={NOTHING_TO_DELETE:"This document doesn’t yet exist or is already deleted"},r_=e=>{let{id:t,type:n,draft:i,onComplete:r}=e,{setIsDeleting:l}=rj(),{delete:a}=(0,tu.d9t)(t,n),[s,o]=(0,td.useState)(!1),[d,c]=(0,td.useState)(!1),u=(0,td.useCallback)(()=>{c(!1),r()},[r]),h=(0,td.useCallback)(()=>{o(!0),c(!1),l(!0),a.execute(),r()},[a,r,l]),p=(0,td.useCallback)(()=>{c(!0)},[]),[m,f]=(0,tu.hHf)({id:t,type:n,permission:"delete"}),x=(0,tu.xJ)();return f||(null==m?void 0:m.granted)?{tone:"critical",icon:to.XHJ,disabled:s||!!a.disabled||f,title:a.disabled&&rw[a.disabled]||"",label:s?"Deleting…":"Delete",shortcut:"Ctrl+Alt+D",onHandle:p,dialog:d&&{type:"custom",component:(0,tc.jsx)(ij,{action:"delete",id:(null==i?void 0:i._id)||t,type:n,onCancel:u,onConfirm:h})}}:{tone:"critical",icon:to.XHJ,disabled:!0,label:"Delete",title:(0,tc.jsx)(tu.FMn,{operationLabel:"delete this document",currentUser:x})}};r_.action="delete";let rk={NO_CHANGES:"This document has no unpublished changes",NOT_PUBLISHED:"This document is not published"},rC=e=>{let{id:t,type:n,published:i,liveEdit:r,onComplete:l}=e,{discardChanges:a}=(0,tu.d9t)(t,n),[s,o]=(0,td.useState)(!1),[d,c]=(0,tu.hHf)({id:t,type:n,permission:"discardDraft"}),u=(0,tu.xJ)(),h=(0,td.useCallback)(()=>{a.execute(),l()},[a,l]),p=(0,td.useCallback)(()=>{o(!0)},[]),m=(0,td.useMemo)(()=>s&&{type:"confirm",tone:"critical",onCancel:l,onConfirm:h,message:(0,tc.jsx)(tc.Fragment,{children:"Are you sure you want to discard all changes since last published?"})},[h,s,l]);return!i||r?null:c||(null==d?void 0:d.granted)?{tone:"critical",icon:to.X5P,disabled:!!a.disabled||c,title:a.disabled&&rk[a.disabled]||"",label:"Discard changes",onHandle:p,dialog:m}:{tone:"critical",icon:to.X5P,disabled:!0,label:"Discard changes",title:(0,tc.jsx)(tu.FMn,{operationLabel:"discard changes in this document",currentUser:u})}};rC.action="discardChanges";let rz={NOTHING_TO_DUPLICATE:"This document doesn’t yet exist so there‘s nothing to duplicate"},rE=e=>{let{id:t,type:n,onComplete:i}=e,{duplicate:r}=(0,tu.d9t)(t,n),{navigateIntent:l}=(0,tG.tv)(),[a,s]=(0,td.useState)(!1),[o,d]=(0,tu.hHf)({id:t,type:n,permission:"duplicate"}),c=(0,tu.xJ)(),u=(0,td.useCallback)(()=>{let e=(0,t6.Z)();s(!0),r.execute(e),l("edit",{id:e,type:n}),i()},[r,l,i,n]);return d||(null==o?void 0:o.granted)?{icon:to.TIy,disabled:a||!!r.disabled||d,label:a?"Duplicating…":"Duplicate",title:r.disabled&&rz[r.disabled]||"",onHandle:u}:{icon:to.TIy,disabled:!0,label:"Duplicate",title:(0,tc.jsx)(tu.FMn,{operationLabel:"duplicate this document",currentUser:c})}};rE.action="duplicate";let rI=e=>{let{id:t,type:n,revision:i,onComplete:r}=e,{restore:l}=(0,tu.d9t)(t,n),a=(0,tu.E6V)(t,n),{navigateIntent:s}=(0,tG.tv)(),o=(0,td.useRef)(a),[d,c]=(0,td.useState)(!1),u=(0,td.useCallback)(()=>{l.execute(i),r()},[l,i,r]);(0,td.useEffect)(()=>{a&&a!==o.current&&("success"===a.type&&"restore"===a.op&&s("edit",{id:t,type:n}),o.current=a)},[a,t,s,n]);let h=(0,td.useCallback)(()=>{c(!0)},[]),p=(0,td.useMemo)(()=>d?{type:"confirm",tone:"critical",onCancel:r,onConfirm:u,message:(0,tc.jsx)(tc.Fragment,{children:"Are you sure you want to restore this document?"})}:null,[u,d,r]),m="@initial"===i;return void 0===i?null:{label:"Restore",color:"primary",onHandle:h,title:m?"You can't restore to the initial version":"Restore to this version",icon:to.vaD,dialog:p,disabled:m}};rI.action="restore";let rS={LIVE_EDIT_ENABLED:"Cannot publish since liveEdit is enabled for this document type",ALREADY_PUBLISHED:"Already published",NO_CHANGES:"No unpublished changes",NOT_READY:"Operation not ready"},rP=e=>{var t,n;let{id:i,type:r,liveEdit:l,draft:a,published:s}=e,[o,d]=(0,td.useState)(null),{publish:c}=(0,tu.d9t)(i,r),u=(0,tu.a3k)(i,r),h=(0,tu.nuD)(i,r),{changesOpen:p,onHistoryOpen:m,documentId:f,documentType:x}=rj(),g=(0,tu.iav)(f,x),v=((null==g?void 0:g.draft)||(null==g?void 0:g.published)||{})._rev,b=u.validation.some(th.YN),[y,j]=(0,td.useState)(!1),w=h.isSyncing,_=u.isValidating,[k,C]=(0,tu.hHf)({id:i,type:r,permission:"publish"}),z=(0,tu.xJ)(),E=(0,tu.INm)((null==s?void 0:s._updatedAt)||"",{minimal:!0,agoSuffix:!0}),I=c.disabled?("ALREADY_PUBLISHED"===(n=c.disabled)&&E?(0,tc.jsx)(tc.Fragment,{children:(0,tc.jsxs)("span",{children:["Published ",E]})}):rS[n])||"":b?"There are validation errors that need to be fixed before this document can be published":"",S=!!a,P=(0,td.useCallback)(()=>{c.execute(),d("publishing")},[c]);(0,td.useEffect)(()=>{let e=!1===u.isValidating&&u.revision!==v;y&&!w&&e&&(b||P(),j(!1))},[w,P,b,y,u.revision,v,_,u.isValidating]),(0,td.useEffect)(()=>{let e="publishing"===o&&!S;e&&p&&m();let t=e?"published":null,n=setTimeout(()=>{d(t)},e?200:4e3);return()=>clearTimeout(n)},[p,o,S,m]);let T=(0,td.useCallback)(()=>{h.isSyncing||u.isValidating||u.revision!==v?j(!0):P()},[h.isSyncing,u.isValidating,u.revision,v,P]);if(l)return{tone:"positive",label:"Publish",title:"Live Edit is enabled for this content type and publishing happens automatically as you make changes",disabled:!0};if(!C&&!(null==k?void 0:k.granted))return{tone:"positive",label:"Publish",title:(0,tc.jsx)(tu.FMn,{operationLabel:"publish this document",currentUser:z}),disabled:!0};let M=!!(y||(null==(t=null==g?void 0:g.transactionSyncLock)?void 0:t.enabled)||"publishing"===o||"published"===o||b||c.disabled);return{disabled:M||C,tone:"positive",label:"published"===o?"Published":y||"publishing"===o?"Publishing…":"Publish",icon:"published"===o?to.KML:to.EI4,title:y?"Waiting for tasks to finish before publishing":"published"===o||"publishing"===o?null:I,shortcut:M||y?null:"Ctrl+Alt+P",onHandle:T}};rP.action="publish";let rT={NOT_PUBLISHED:"This document is not published"},rM=e=>{let{id:t,type:n,draft:i,onComplete:r,liveEdit:l}=e,{unpublish:a}=(0,tu.d9t)(t,n),[s,o]=(0,td.useState)(!1),[d,c]=(0,tu.hHf)({id:t,type:n,permission:"unpublish"}),u=(0,tu.xJ)(),h=(0,td.useCallback)(()=>{o(!1),r()},[r]),p=(0,td.useCallback)(()=>{o(!1),a.execute(),r()},[r,a]),m=(0,td.useMemo)(()=>s?{type:"dialog",onClose:r,content:(0,tc.jsx)(ij,{id:(null==i?void 0:i._id)||t,type:n,action:"unpublish",onCancel:h,onConfirm:p})}:null,[i,t,h,p,s,r,n]);return l?null:c||(null==d?void 0:d.granted)?{tone:"critical",icon:to.xEY,disabled:!!a.disabled||c,label:"Unpublish",title:a.disabled?rT[a.disabled]:"",onHandle:()=>o(!0),dialog:m}:{tone:"critical",icon:to.xEY,label:"Unpublish",title:(0,tc.jsx)(tu.FMn,{operationLabel:"unpublish this document",currentUser:u}),disabled:!0}};rM.action="unpublish";let rR=!1,rO={},rA=Symbol("LOADING_PANE"),rD="documentPanelPortalElement",rL={activePanes:[]};function rN(e){rL.activePanes=e}function rZ(e,t,n,i){var r;let l=(null==n?void 0:n.panes)||[],a=rL.activePanes||[],s=t.id||(0,t6.Z)(),o="create"===e&&t.template;for(let n=a.length-1;n>=0;n--){let d=a[n];if("object"==typeof d&&((null==(r=d.canHandleIntent)?void 0:r.call(d,e,t,{pane:d,index:n}))||"documentList"===d.type&&d.schemaTypeName===t.type&&"_type == $type"===d.options.filter)){let e=o?{template:t.template}:rO;return{panes:l.slice(0,n).concat([[{id:s,params:e,payload:i}]])}}}return{intent:e,params:t,payload:i}}let rU={},rB=tG.BC.create("/",[tG.BC.intents("/intent"),tG.BC.create("/edit/:type/:editDocumentId",[tG.BC.create({path:"/:params",transform:{params:{toState:function(e){try{return JSON.parse(decodeURIComponent(e))}catch(e){return console.warn("Failed to parse JSON parameters"),{}}},toPath:function(e){return JSON.stringify(e)}}}})]),tG.BC.create({path:"/:panes",children:[tG.BC.create("/:action",tG.BC.create("/:legacyEditDocumentId"))],transform:{panes:{toState:function(e){var t;return -1!==(t=decodeURIComponent(e)).indexOf(",{")?function(e){let t=[],n=e;for(;n.length;){let[e,i,r]=n.match(rF)||[];if(!e){n=n.slice(1);continue}let l=r&&function(e){try{return JSON.parse(e)}catch(e){console.warn("Failed to parse parameters: ".concat(e.message));return}}(r);t.push({id:i,payload:l}),n=n.slice(e.length)}return[t]}(t):t.split(";").map(e=>{let[t,...n]=e.split("|").map(e=>{let[t,...n]=e.split(",");return function(e,t){let n={...t,params:rU,payload:void 0};return e.reduce((e,t)=>{if(rq(t)){let n=t.slice(0,t.indexOf("=")),i=t.slice(n.length+1);e.params={...e.params,[decodeURIComponent(n)]:decodeURIComponent(i)}}else rH(t)?e.payload=function(e){try{return e?(0,tG.ZB)(e):void 0}catch(e){console.warn("Failed to parse parameters: ".concat(e.message));return}}(t):console.warn("Unknown pane segment: %s - skipping",t);return e},n)}(n,{id:t})});return[t,...n.map(e=>({...t,...e,id:e.id||t.id,params:{...tJ()(t.params,rV),...e.params},payload:e.payload||t.payload}))]}).filter(e=>e.length>0)},toPath:function(e){return(e||[]).map(e=>e.map(rK).join("|")).map(encodeURIComponent).join(";")}}}})]),rF=/^([.a-z0-9_-]+),?({.*?})?(?:(;|$))/i,rq=e=>/^[a-z0-9]+=[^=]+/i.test(e),rH=e=>/^[A-Za-z0-9\-_]+(?:={0,2})$/.test(e),rV=["view","since","rev","inspect","comment"],rW=Boolean;function rK(e,t,n){let{payload:i,params:r={},id:l}=e,[a]=n,s=e===a,o=0!==t&&l===a.id,d=void 0===i?void 0:(0,tG.B8)(i),c=Object.entries(r).filter(e=>{var t;let[n,i]=e;return!!i&&(!!s||!!(i!==(null==(t=a.params)?void 0:t[n])||rV.includes(n)))}).map(e=>{let[t,n]=e;return"".concat(encodeURIComponent(t),"=").concat(encodeURIComponent(n))});return[o?"":l].concat([c.length>0&&c,d].filter(rW).flat()).join(",")||","}let r$={},rY="inspect:",rX=[{id:"inspectors"},{id:"links"}],rG="sanity/desk/history",rQ="sanity/desk/comments";var rJ=Object.freeze,r0=Object.defineProperty;let r1=(0,tm.ZP)(tp.qE)(ee||(ee=rJ(r0(p=["\n  svg > ellipse {\n    stroke: transparent;\n  }\n"],"raw",{value:rJ(p.slice())})))),r2=/[^\p{Alpha}\p{White_Space}]/gu,r5=RegExp("\\p{White_Space}+","u");function r3(e){let{user:t,...n}=e,i=(0,td.useMemo)(()=>(function(e){let t=e.replace(r2,"").split(r5);return 1===t.length?"".concat(t[0].charAt(0)).toUpperCase():"".concat(t[0].charAt(0)).concat(t[t.length-1].charAt(0))})((null==t?void 0:t.displayName)||""),[null==t?void 0:t.displayName]);return t?(0,tc.jsx)(r1,{initials:i,src:null==t?void 0:t.imageUrl,title:null==t?void 0:t.displayName,...n}):(0,tc.jsx)(r1,{...n})}let r6={minWidth:25};function r8(){return(0,tc.jsx)("div",{style:r6})}var r4=Object.freeze,r9=Object.defineProperty,r7=(e,t)=>r4(r9(e,"raw",{value:r4(t||e.slice())}));let le={open:500,close:0},lt=tm.ZP.span(e=>{var t,n,i;let{theme:r}=e,{regular:l}=null==(t=r.sanity.fonts)?void 0:t.text.weights,{hovered:a}=null==(n=r.sanity.color)?void 0:n.card,{bg:s}=(null==(i=r.sanity.color.selectable)?void 0:i.caution.pressed)||{};return(0,tm.iv)(et||(et=r7(["\n    font-weight: ",";\n    color: var(--card-link-fg-color);\n    border-radius: 2px;\n    background-color: ",";\n    padding: 1px;\n    box-sizing: border-box;\n\n    &[data-active='true'] {\n      background-color: ",";\n    }\n  "])),l,a.bg,s)});function ln(e){let{selected:t,userId:n}=e,[i,r]=(0,tu.aFb)(n),l=(0,tu.xJ)();return!i||r?(0,tc.jsx)(lt,{children:"@Loading"}):(0,tc.jsx)(tp.u,{portal:!0,open:t,delay:le,content:(0,tc.jsxs)(tp.kC,{align:"center",padding:2,gap:2,children:[(0,tc.jsx)(tp.kC,{children:(0,tc.jsx)(r3,{user:i})}),(0,tc.jsx)(tp.xv,{size:1,children:i.displayName})]}),children:(0,tc.jsxs)(lt,{"data-selected":t,"data-active":(null==l?void 0:l.id)===n,children:["@",i.displayName]})})}var li=Object.freeze,lr=Object.defineProperty;let ll=(0,tm.ZP)(tp.xv)(en||(en=li(lr(m=["\n  word-break: break-word;\n"],"raw",{value:li(m.slice())}))));function la(e){let{children:t}=e;return(0,tc.jsx)(ll,{size:1,children:t})}var ls=Object.freeze,lo=Object.defineProperty,ld=(e,t)=>ls(lo(e,"raw",{value:ls(t||e.slice())}));let lc=(0,tm.ZP)(tp.Kq)(()=>(0,tm.iv)(ei||(ei=ld(["\n    & > [data-ui='Text']:not(:first-child) {\n      margin-top: 1em; // todo: improve\n    }\n\n    & > [data-ui='Text']:has(> span:empty) {\n      display: none;\n    }\n  "])))),lu=[],lh={block:{normal:e=>{let{children:t}=e;return(0,tc.jsx)(la,{children:t})},h1:e=>{let{children:t}=e;return(0,tc.jsx)(la,{children:t})},h2:e=>{let{children:t}=e;return(0,tc.jsx)(la,{children:t})},h3:e=>{let{children:t}=e;return(0,tc.jsx)(la,{children:t})},h4:e=>{let{children:t}=e;return(0,tc.jsx)(la,{children:t})},h5:e=>{let{children:t}=e;return(0,tc.jsx)(la,{children:t})},h6:e=>{let{children:t}=e;return(0,tc.jsx)(la,{children:t})},blockquote:e=>{let{children:t}=e;return(0,tc.jsx)(la,{children:t})},code:e=>{let{children:t}=e;return(0,tc.jsx)(la,{children:t})}},list:{bullet:e=>{let{children:t}=e;return t},number:e=>{let{children:t}=e;return(0,tc.jsx)(tc.Fragment,{children:t})},checkmarks:e=>{let{children:t}=e;return(0,tc.jsx)(tc.Fragment,{children:t})}},listItem:{bullet:e=>{let{children:t}=e;return(0,tc.jsx)(la,{children:t})},number:e=>{let{children:t}=e;return(0,tc.jsx)(la,{children:t})},checkmarks:e=>{let{children:t}=e;return(0,tc.jsx)(la,{children:t})}},marks:{strong:e=>{let{children:t}=e;return(0,tc.jsx)(tc.Fragment,{children:t})},em:e=>{let{children:t}=e;return(0,tc.jsx)(tc.Fragment,{children:t})},code:e=>{let{children:t}=e;return(0,tc.jsx)(tc.Fragment,{children:t})},underline:e=>{let{children:t}=e;return(0,tc.jsx)(tc.Fragment,{children:t})},strikeThrough:e=>{let{children:t}=e;return(0,tc.jsx)(tc.Fragment,{children:t})},link:e=>{let{children:t}=e;return(0,tc.jsx)(tc.Fragment,{children:t})}},types:{mention:e=>{var t;return(0,tc.jsx)(ln,{userId:null==(t=null==e?void 0:e.value)?void 0:t.userId,selected:!1})}}};function lp(e){let{blocks:t}=e;return(0,tc.jsx)(lc,{children:(0,tc.jsx)(t8.YI,{value:t||lu,components:lh})})}let lm=(0,th.Z2)({name:"mention",type:"object",fields:[{name:"userId",type:"string"}]}),lf=(0,th.Z2)({type:"block",name:"block",of:[lm],marks:{annotations:[]},styles:[{title:"Normal",value:"normal"}],lists:[]}),lx=(0,th.qu)({type:"array",name:"body",of:[lf]}),lg=t9.V.compile({name:"comments",types:[lx]}).get("body"),lv=(0,td.forwardRef)(function(e,t){return(0,tc.jsx)("svg",{"data-sanity-icon":"send",fill:"none",height:"1em",ref:t,viewBox:"0 0 25 25",width:"1em",xmlns:"http://www.w3.org/2000/svg",...e,children:(0,tc.jsx)("path",{clipRule:"evenodd",d:"M21.1602 12.5L7.16016 19.5V14.8765L13.6656 12.4989L7.16016 9.97149L7.16016 5.5L21.1602 12.5Z",stroke:"currentColor",strokeWidth:1.2,strokeLinejoin:"round"})})}),lb=(0,td.forwardRef)(function(e,t){return(0,tc.jsxs)("svg",{"data-sanity-icon":"mention",fill:"none",height:"1em",ref:t,viewBox:"0 0 25 25",width:"1em",xmlns:"http://www.w3.org/2000/svg",...e,children:[(0,tc.jsx)("path",{d:"M16.6633 18.9383C15.539 19.6562 14.2034 20.0723 12.7705 20.0723C8.77022 20.0723 5.52734 16.8294 5.52734 12.8291C5.52734 8.82881 8.77022 5.58594 12.7705 5.58594C16.7708 5.58594 20.0137 8.82881 20.0137 12.8291C20.0137 13.6623 19.8249 14.7093 19.6141 15.2077C19.5578 15.3408 19.479 15.4845 19.3936 15.6238C19.0955 16.1106 18.5507 16.3721 17.9807 16.4018V16.4018C16.8271 16.462 15.8588 15.5428 15.8588 14.3877V9.27302",stroke:"currentColor",strokeWidth:1.2,strokeLinejoin:"round"}),(0,tc.jsx)("circle",{cx:"12.5732",cy:"12.8291",r:"3.08691",stroke:"currentColor",strokeWidth:1.2})]})}),ly=(0,td.forwardRef)(function(e,t){return(0,tc.jsxs)("svg",{"data-sanity-icon":"add-comment",fill:"none",height:"1em",ref:t,viewBox:"0 0 25 25",width:"1em",xmlns:"http://www.w3.org/2000/svg",...e,children:[(0,tc.jsx)("path",{d:"M12.3368 5.97917H6.89453C5.78996 5.97917 4.89453 6.8746 4.89453 7.97917V13.4881C4.89453 14.5926 5.78996 15.4881 6.89453 15.4881H8.69808V19.2916L12.5016 15.4881H16.207C17.3115 15.4881 18.207 14.5926 18.207 13.4881V11.7158",stroke:"currentColor",strokeWidth:1.2,strokeLinejoin:"round"}),(0,tc.jsx)("path",{d:"M18.2081 2.08333V9.87058M14.3145 5.97695H22.1017",stroke:"currentColor",strokeWidth:1.2,strokeLinejoin:"round"})]})}),lj=(0,td.forwardRef)(function(e,t){return(0,tc.jsx)("svg",{"data-sanity-icon":"comment",width:"1em",height:"1em",ref:t,viewBox:"0 0 25 25",fill:"none",xmlns:"http://www.w3.org/2000/svg",...e,children:(0,tc.jsx)("path",{d:"M7.5 15.5H9.5V19.5L13.5 15.5H17.5C18.6046 15.5 19.5 14.6046 19.5 13.5V7.5C19.5 6.39543 18.6046 5.5 17.5 5.5H7.5C6.39543 5.5 5.5 6.39543 5.5 7.5V13.5C5.5 14.6046 6.39543 15.5 7.5 15.5Z",stroke:"currentColor",strokeLinejoin:"round",strokeWidth:"1.2"})})});function lw(e){let t=(0,td.useRef)(e);return(0,td.useMemo)(()=>!ne()(t.current,e),[e])}function l_(e){return!!e&&(null==e?void 0:e.some(e=>{var t;return(0,th.DG)(e)&&(null==(t=(null==e?void 0:e.children)||[])?void 0:t.some(e=>(0,th.NG)(e)?e.text:e.userId))}))}let lk=td.createContext(null);function lC(e){let{children:t,expandOnFocus:n=!1,focused:i,focusOnMount:r=!1,mentionOptions:l,onMentionMenuOpenChange:a,value:s,readOnly:o}=e,d=(0,t4._F)(),[c,u]=(0,td.useState)(!1),[h,p]=(0,td.useState)(""),[m,f]=(0,td.useState)(null),x=(0,td.useMemo)(()=>l_(s),[s]),g=lw(s),v=(0,td.useCallback)(()=>{o||t4.q$.focus(d)},[d,o]),b=(0,td.useCallback)(()=>{u(!1),p(""),f(null)},[]),y=(0,td.useCallback)(()=>{u(!0),p(""),u(!0),f(t4.q$.getSelection(d))},[d]),j=(0,td.useCallback)(e=>{let t=t4.q$.getSelection(d),n=t?t.focus.offset:0,i=t4.q$.focusChild(d),r=(0,th.NG)(i)&&i||void 0,l="insertText"===e.inputType,a="deleteContentBackward"===e.inputType,s=l&&"@"===e.data,o=(null==r?void 0:r.text.substring(0,n).lastIndexOf("@"))||0,c=(null==r?void 0:r.text.substring(n-1,n))===" ",u=l&&" "===e.data&&!h;if(s&&(n<1||c)){y();return}if(u||a&&((null==r?void 0:r.text.length)===1||o===((null==r?void 0:r.text.length)||0)-1)){b();return}if((0,th.NG)(i)){let t=i.text.substring(o+1,n);l&&(t+=e.data),a&&(t=t.substring(0,t.length-1)),p(t)}},[b,d,h,y]),w=(0,td.useCallback)(()=>{u(!0),t4.q$.focus(d),t4.q$.insertChild(d,d.schemaTypes.span,{text:"@"}),f(t4.q$.getSelection(d))},[d]);(0,tu.lRb)(c,()=>null==a?void 0:a(c));let _=(0,td.useCallback)(e=>{var t;let n=d.schemaTypes.inlineObjects.find(e=>"mention"===e.name),[i,r]=m&&t4.q$.findByPath(d,m.focus.path)||[];if(i&&(0,th.NG)(i)&&r&&n){t4.q$.focus(d);let l=null==(t=t4.q$.getSelection(d))?void 0:t.focus.offset;void 0!==l&&(t4.q$.delete(d,{anchor:{path:r,offset:i.text.lastIndexOf("@")},focus:{path:r,offset:l}},{mode:"selected"}),t4.q$.insertChild(d,n,{userId:e}),t4.q$.insertChild(d,d.schemaTypes.span,{text:" "}))}},[d,m]),k=(0,td.useMemo)(()=>({canSubmit:x,closeMentions:b,editor:d,expandOnFocus:n,focused:i,focusEditor:v,focusOnMount:r,hasChanges:g,insertAtChar:w,insertMention:_,mentionOptions:l,mentionsMenuOpen:c,mentionsSearchTerm:h,onBeforeInput:j,openMentions:y,readOnly:!!o,value:s}),[x,b,d,n,i,v,r,g,w,_,l,c,h,j,y,o,s]);return(0,tc.jsx)(lk.Provider,{value:k,children:t})}function lz(){let e=(0,td.useContext)(lk);if(!e)throw Error("useCommentInputContext must be used within a CommentInputProvider");return e}var lE=Object.freeze,lI=Object.defineProperty;let lS=(0,tm.ZP)(tp.kC)(er||(er=lE(lI(f=[""],"raw",{value:lE(f.slice())})))),lP={width:"50%"};function lT(e){let{user:t,onSelect:n}=e,[i]=(0,tu.aFb)(t.id),r=(0,tc.jsx)(r3,{user:i,status:t.canBeMentioned?void 0:"inactive"}),l=i?(0,tc.jsx)(tp.xv,{size:1,textOverflow:"ellipsis",title:i.displayName,children:i.displayName}):(0,tc.jsx)(tp.Qr,{size:1,style:lP}),a=(0,td.useCallback)(()=>{n(t.id)},[n,t.id]);return(0,tc.jsx)(tp.Zb,{as:"button",disabled:!t.canBeMentioned,onClick:a,padding:2,radius:2,children:(0,tc.jsxs)(tp.kC,{align:"center",gap:3,children:[(0,tc.jsxs)(lS,{align:"center",gap:2,flex:1,children:[r,(0,tc.jsx)(tp.xu,{children:l})]}),!t.canBeMentioned&&(0,tc.jsx)(tp.Ct,{fontSize:1,mode:"outline",children:"Unauthorized"})]})})}let lM=[],lR=(0,tm.ZP)(tp.Kq)({maxWidth:"220px"}),lO=(0,tm.ZP)(tp.kC)({maxHeight:315.5}),lA=td.forwardRef(function(e,t){let{loading:n,onSelect:i,options:r=[],inputElement:l}=e,[a,s]=(0,td.useState)(""),o=(0,td.useRef)(null);(0,td.useImperativeHandle)(t,()=>({setSearchTerm(e){s(e)}}),[]);let d=(0,td.useCallback)(e=>(0,tc.jsx)(lT,{user:e,onSelect:i}),[i]),c=(0,td.useCallback)(e=>{var t;return!(null==(t=null==r?void 0:r[e])?void 0:t.canBeMentioned)},[r]),u=(0,td.useMemo)(()=>{var e;if(!a)return r||lM;let t=nn()(a).toLocaleLowerCase(),n=null==r?void 0:r.map(e=>({...e,displayName:nn()(e.displayName||"").toLocaleLowerCase()}));return(null==(e=null==n?void 0:n.filter(e=>{var n;return null==(n=null==e?void 0:e.displayName)?void 0:n.includes(t)}))?void 0:e.sort((e,n)=>{var i,r;let l=null==(i=e.displayName)?void 0:i.startsWith(t),a=null==(r=n.displayName)?void 0:r.startsWith(t);return l&&!a?-1:!l&&a?1:0}))||lM},[r,a]);return n?(0,tc.jsx)(lR,{children:(0,tc.jsx)(tp.kC,{align:"center",justify:"center",padding:4,children:(0,tc.jsx)(tp.$j,{muted:!0,size:1})})}):(0,tc.jsxs)(tp.kC,{direction:"column",height:"fill","data-testid":"comments-mentions-menu",children:[0===u.length&&(0,tc.jsx)(tp.xu,{padding:5,children:(0,tc.jsx)(tp.xv,{align:"center",size:1,muted:!0,children:"No users found"})}),u.length>0&&(0,tc.jsx)(lO,{direction:"column",flex:1,overflow:"hidden",children:(0,tc.jsx)(tu.e8h,{activeItemDataAttr:"data-hovered",ariaLabel:"List of users to mention",fixedHeight:!0,getItemDisabled:c,inputElement:l||void 0,itemHeight:41,items:u,padding:1,ref:o,renderItem:d})})]})}),lD=e=>{let{children:t}=e;return(0,tc.jsx)(la,{children:t})},lL=e=>{let{children:t,value:n,selected:i}=e;return"mention"===n._type&&n.userId?(0,tc.jsx)(ln,{selected:i,userId:null==n?void 0:n.userId}):t},lN={passive:!0};var lZ=Object.freeze,lU=Object.defineProperty,lB=(e,t)=>lZ(lU(e,"raw",{value:lZ(t||e.slice())}));let lF=["bottom","top"],lq={outline:"none"},lH=[],lV=tm.ZP.span(()=>(0,tm.iv)(el||(el=lB(["\n    overflow: hidden;\n    text-overflow: ellipsis;\n    text-wrap: nowrap;\n    display: block;\n  "])))),lW=(0,tm.ZP)(tp.J2)(e=>{let{theme:t}=e,{space:n,radius:i}=t.sanity;return(0,tm.iv)(ea||(ea=lB(["\n    &[data-placement='bottom'] {\n      transform: translateY(","px);\n    }\n\n    &[data-placement='top'] {\n      transform: translateY(-","px);\n    }\n\n    [data-ui='Popover__wrapper'] {\n      border-radius: ","px;\n      display: flex;\n      flex-direction: column;\n      overflow: clip;\n      overflow: hidden;\n      position: relative;\n      width: 300px; // todo: improve\n    }\n  "])),n[1],n[1],i[3])});function lK(e){let{focusLock:t,placeholder:n="Create a new comment",onFocus:i,onBlur:r,onKeyDown:l,onSubmit:a}=e,[s,o]=(0,td.useState)(null),d=(0,td.useRef)(null),c=(0,td.useRef)(null),u=(0,td.useRef)(null),h=(0,t4.L9)(),{canSubmit:p,closeMentions:m,insertMention:f,mentionOptions:x,mentionsMenuOpen:g,mentionsSearchTerm:v,onBeforeInput:b,value:y}=lz(),j=function(e){let{disabled:t,rootElement:n}=e,[i,r]=(0,td.useState)(null),l=(0,td.useMemo)(()=>i?{getBoundingClientRect:()=>i}:null,[i]),a=(0,td.useCallback)(()=>{if(t){r(null);return}let e=window.getSelection();if(!e||!e.isCollapsed||0===e.rangeCount)return;let i=e.getRangeAt(0);if(!(null==n?void 0:n.contains(i.commonAncestorContainer))){r(null);return}let l=null==i?void 0:i.getBoundingClientRect();l&&r(l)},[t,n]);return(0,td.useEffect)(()=>(document.addEventListener("selectionchange",a,lN),()=>{document.removeEventListener("selectionchange",a)}),[a]),l}({disabled:!g,rootElement:d.current}),w=(0,td.useCallback)(()=>(0,tc.jsx)(lV,{children:n}),[n]),_=(0,td.useCallback)(()=>{g&&m()},[m,g]);(0,tp.O8)(_,[s]);let k=(0,td.useCallback)(e=>{switch(e.key){case"Enter":if(e.shiftKey)break;if(e.preventDefault(),e.stopPropagation(),g){m();break}a&&p&&a();break;case"Escape":case"ArrowLeft":case"ArrowRight":g&&(e.preventDefault(),e.stopPropagation(),m())}l&&l(e)},[p,m,g,l,a]),C=(0,td.useMemo)(()=>{if(h)return;let e=(y||lH).slice(-1)[0],t=(0,th.DG)(e)?e.children.slice(-1)[0]:void 0;if(!t)return;let n={path:[{_key:e._key},"children",{_key:t._key}],offset:(0,th.NG)(t)?t.text.length:0};return{focus:n,anchor:n}},[y,h]);(0,td.useEffect)(()=>{var e;null==(e=u.current)||e.setSearchTerm(v)},[v]),(0,td.useEffect)(()=>{g&&h&&!ne()(h.anchor,h.focus)&&m()},[g,m,h]);let z=(0,tc.jsx)(lA,{inputElement:c.current,loading:x.loading,onSelect:f,options:x.data||lH,ref:u});return(0,tc.jsxs)("div",{ref:d,children:[(0,tc.jsx)(lW,{arrow:!1,constrainSize:!0,content:z,disabled:!g,fallbackPlacements:lF,open:g,placement:"bottom",ref:o,referenceElement:j}),(0,tc.jsx)(t4.iV,{"data-testid":"comment-input-editable","data-ui":"EditableElement",onBeforeInput:b,onBlur:r,onFocus:i,onKeyDown:k,ref:c,renderBlock:lD,renderChild:lL,renderPlaceholder:w,selection:C,style:lq,tabIndex:t?0:void 0})]})}var l$=Object.freeze,lY=Object.defineProperty,lX=(e,t)=>l$(lY(e,"raw",{value:l$(t||e.slice())}));let lG=(0,tm.ZP)(tp.xu)(es||(es=lX(["\n  max-height: 20vh;\n  overflow-y: auto;\n"]))),lQ=(0,tm.ZP)(tp.R)({height:20,width:1}),lJ=(0,tm.ZP)(tp.zx).attrs({fontSize:1,padding:2})(eo||(eo=lX(["\n  /* border-radius: 50%; */\n"]))),l0=(0,tm.ZP)(tp.Zb)(e=>{let{theme:t}=e,n=t.sanity.radius[2];return(0,tm.iv)(ed||(ed=lX(["\n    border-radius: ","px;\n\n    &:not([data-expand-on-focus='false'], :focus-within) {\n      background: transparent;\n      box-shadow: unset;\n    }\n\n    &[data-focused='true']:focus-within {\n      "," {\n        min-height: 1em;\n      }\n\n      box-shadow:\n        inset 0 0 0 1px var(--card-border-color),\n        0 0 0 1px var(--card-bg-color),\n        0 0 0 3px var(--card-focus-ring-color);\n    }\n\n    &:focus-within {\n      "," {\n        min-height: 1em;\n      }\n    }\n\n    &[data-expand-on-focus='false'] {\n      "," {\n        min-height: 1em;\n      }\n    }\n\n    &[data-expand-on-focus='true'] {\n      [data-ui='CommentInputActions']:not([hidden]) {\n        display: none;\n      }\n\n      &:focus-within {\n        [data-ui='CommentInputActions'] {\n          display: flex;\n        }\n      }\n    }\n  "])),n,lG,lG,lG)});function l1(e){let{currentUser:t,focusLock:n,onBlur:i,onFocus:r,onKeyDown:l,onSubmit:a,placeholder:s,withAvatar:o}=e,[d]=(0,tu.aFb)(t.id),{canSubmit:c,expandOnFocus:u,focused:h,hasChanges:p,insertAtChar:m,openMentions:f,readOnly:x}=lz(),g=o?(0,tc.jsx)(r3,{user:d}):null,v=(0,td.useCallback)(e=>{e.stopPropagation(),m(),f()},[m,f]);return(0,tc.jsxs)(tp.kC,{align:"flex-start",gap:2,children:[g,(0,tc.jsx)(l0,{"data-expand-on-focus":u&&!c?"true":"false","data-focused":h?"true":"false",flex:1,shadow:1,sizing:"border",tone:x?"transparent":"default",children:(0,tc.jsxs)(tp.Kq,{children:[(0,tc.jsx)(lG,{paddingX:1,paddingY:2,sizing:"border",children:(0,tc.jsx)(lK,{focusLock:n,onBlur:i,onFocus:r,onKeyDown:l,onSubmit:a,placeholder:s})}),(0,tc.jsxs)(tp.kC,{align:"center","data-ui":"CommentInputActions",gap:1,justify:"flex-end",padding:1,children:[(0,tc.jsx)(lJ,{"aria-label":"Mention user","data-testid":"comment-mention-button",disabled:x,icon:lb,mode:"bleed",onClick:v}),(0,tc.jsx)(lQ,{}),(0,tc.jsx)(lJ,{"aria-label":"Send comment",disabled:!c||!p||x,icon:lv,mode:p&&c?"default":"bleed",onClick:a,tone:p&&c?"primary":"default"})]})]})})]})}function l2(e){let{onClose:t,onConfirm:n}=e,i=(0,td.useCallback)(e=>{e.stopPropagation(),t()},[t]),r=(0,td.useCallback)(e=>{e.stopPropagation(),n()},[n]);return(0,tc.jsx)(tp.eb,{tone:"default",children:(0,tc.jsx)(tp.Tu,{zOffset:9999999,children:(0,tc.jsx)(tp.Vq,{header:"Discard comment?",id:"discard-comment-dialog",onClose:t,width:0,onClickOutside:t,footer:(0,tc.jsxs)(tp.rj,{columns:2,padding:2,gap:2,children:[(0,tc.jsx)(tp.zx,{text:"Cancel",mode:"ghost",onClick:i}),(0,tc.jsx)(tp.zx,{onClick:r,text:"Discard",tone:"critical"})]}),children:(0,tc.jsx)(tp.Kq,{padding:4,children:(0,tc.jsx)(tp.xv,{children:"Do you want to discard the comment?"})})})})})}let l5=[],l3={behavior:"smooth",block:"center",inline:"center"},l6=(0,td.forwardRef)(function(e,t){let{currentUser:n,expandOnFocus:i,focusLock:r=!1,focusOnMount:l,mentionOptions:a,onBlur:s,onChange:o,onDiscardCancel:d,onDiscardConfirm:c,onFocus:u,onKeyDown:h,onMentionMenuOpenChange:p,onSubmit:m,placeholder:f,readOnly:x,value:g=l5,withAvatar:v=!0}=e,[b,y]=(0,td.useState)(!1),j=(0,td.useRef)(null),w=(0,td.useRef)(null),[_,k]=(0,td.useState)(!1),C=(0,td.useRef)(null),z=(0,td.useRef)(null),E=(0,td.useRef)(null),[I,S]=(0,td.useState)((0,t4.YH)()),P=(0,td.useCallback)(()=>{requestAnimationFrame(()=>{j.current&&t4.q$.focus(j.current)})},[]),T=(0,td.useCallback)(()=>{S((0,t4.YH)())},[]),M=(0,td.useCallback)(e=>{"ready"===e.type&&l&&P(),"focus"===e.type&&y(!0),"blur"===e.type&&y(!1),"patch"===e.type&&j.current&&o(t4.q$.getValue(j.current)||l5)},[l,o,P]),R=(0,td.useCallback)(()=>{var e;null==(e=w.current)||e.scrollIntoView(l3)},[]),O=(0,td.useCallback)(()=>{m(),T(),P(),R()},[m,P,T,R]),A=(0,td.useCallback)(()=>{c(),T()},[c,T]),D=(0,td.useMemo)(()=>({open:()=>{k(!0)},close:()=>{k(!1),P()}}),[P]);(0,td.useImperativeHandle)(t,()=>({focus:P,blur(){j.current&&t4.q$.blur(j.current)},scrollTo:R,reset:T,discardDialogController:D}),[D,P,T,R]);let L=(0,td.useCallback)(e=>{if(!r)return;let t=e.target,n=E.current;if(n&&t===C.current){(0,tp.bg)(n);return}n&&t===z.current&&(0,tp.fo)(n)},[r]);return(0,tc.jsxs)(tc.Fragment,{children:[_&&(0,tc.jsx)(l2,{onClose:d,onConfirm:A}),(0,tc.jsx)(tp.Kq,{ref:w,"data-testid":"comment-input",onFocus:L,children:(0,tc.jsx)(t4.q$,{onChange:M,readOnly:x,ref:j,schemaType:lg,value:g||l5,children:(0,tc.jsxs)(lC,{expandOnFocus:i,focused:b,focusOnMount:l,mentionOptions:a,onMentionMenuOpenChange:p,readOnly:x,value:g,children:[r&&(0,tc.jsx)("div",{ref:C,tabIndex:0}),(0,tc.jsx)(tp.Kq,{ref:E,children:(0,tc.jsx)(l1,{currentUser:n,focusLock:r,onBlur:s,onFocus:u,onKeyDown:h,onSubmit:O,placeholder:f,withAvatar:v})}),r&&(0,tc.jsx)("div",{ref:z,tabIndex:0})]})},I)})]})});var l8=Object.freeze,l4=Object.defineProperty;let l9={open:500},l7=(0,tm.ZP)(tp.xv)(ec||(ec=l8(l4(x=["\n  min-width: max-content;\n"],"raw",{value:l8(x.slice())}))));function ae(e){let{children:t,text:n}=e;return(0,tc.jsx)(tp.u,{delay:l9,portal:!0,placement:"top",content:(0,tc.jsx)(l7,{size:1,children:n}),padding:2,children:(0,tc.jsx)(tp.kC,{children:t})})}var at=Object.freeze,an=Object.defineProperty,ai=(e,t)=>at(an(e,"raw",{value:at(t||e.slice())}));let ar={open:500},al={placement:"bottom-end"},aa=(0,tm.ZP)(tp.Zb)(e=>{let{theme:t}=e,{space:n}=t.sanity;return(0,tm.iv)(eu||(eu=ai(["\n    gap: ","px;\n    padding: ","px;\n\n    &:empty {\n      display: none;\n    }\n  "])),n[1]/2,n[1]/2)});function as(e){let{canDelete:t,canEdit:n,isParent:i,onCopyLink:r,onDeleteStart:l,onEditStart:a,onMenuClose:s,onMenuOpen:o,onStatusChange:d,readOnly:c,status:u}=e,h=!!(r||l||a);return(0,tc.jsx)(tp.uE,{delay:ar,children:(0,tc.jsx)(tp.kC,{children:(0,tc.jsxs)(aa,{display:"flex",shadow:2,padding:1,radius:2,sizing:"border",children:[i&&(0,tc.jsx)(ae,{text:"open"===u?"Mark as resolved":"Re-open",children:(0,tc.jsx)(tp.zx,{"aria-label":"Mark comment as resolved",disabled:c,fontSize:1,icon:"open"===u?to.nSX:to.UEU,mode:"bleed",onClick:d,padding:2})}),(0,tc.jsx)(tp.j2,{id:"comment-actions-menu",button:(0,tc.jsx)(tp.zx,{"aria-label":"Open comment actions menu",disabled:c,fontSize:1,hidden:!h,icon:to.zGg,mode:"bleed",padding:2}),onOpen:o,onClose:s,menu:(0,tc.jsxs)(tp.v2,{children:[(0,tc.jsx)(tp.sN,{fontSize:1,hidden:!n,icon:to.dY8,onClick:a,text:"Edit comment"}),(0,tc.jsx)(tp.sN,{fontSize:1,hidden:!t,icon:to.XHJ,onClick:l,text:"Delete comment",tone:"critical"}),(0,tc.jsx)(tp.R,{hidden:!t&&!n}),(0,tc.jsx)(tp.sN,{fontSize:1,hidden:!r,icon:to.xPt,onClick:r,text:"Copy link to comment"})]}),popover:al})]})})})}var ao=Object.freeze,ad=Object.defineProperty,ac=(e,t)=>ao(ad(e,"raw",{value:ao(t||e.slice())}));let au=(0,tm.ZP)(tp.xu)(eh||(eh=ac([""])));function ah(e){let{children:t,isParent:n}=e,i=(0,td.useCallback)(e=>{e.stopPropagation()},[]);return(0,tc.jsx)(au,{"data-root-menu":n?"true":"false",onClick:i,children:t})}let ap={width:"50%"},am=(0,tm.ZP)(tp.xv)(e=>{let{theme:t}=e,n=t.sanity.color.dark,i=ni.VG.gray[n?200:800].hex;return(0,tm.iv)(ep||(ep=ac(["\n    min-width: max-content;\n    --card-fg-color: ",";\n    color: var(--card-fg-color);\n  "])),i)}),af=(0,tm.ZP)(tp.Kq)(em||(em=ac(["\n  transition: opacity 200ms ease;\n\n  &[data-muted='true'] {\n    transition: unset;\n    opacity: 0.5;\n  }\n"]))),ax=(0,tm.ZP)(tp.kC)(ef||(ef=ac(["\n  min-height: ","px;\n"])),25),ag=(0,tm.ZP)(tp.Zb)(ex||(ex=ac(["\n  // Add not on hover\n  &:not(:hover) {\n    background-color: transparent;\n  }\n"]))),av=(0,tm.ZP)(tp.Kq)(e=>{let{theme:t}=e,{space:n}=t.sanity;return(0,tm.iv)(eg||(eg=ac(["\n    position: relative;\n\n    // Only show the floating layer on hover when hover is supported.\n    // Else, the layer is always visible.\n    @media (hover: hover) {\n      "," {\n        opacity: 0;\n        position: absolute;\n        right: 0;\n        top: 0;\n        transform: translate(","px, -","px);\n      }\n\n      "," {\n        &:focus-within {\n          opacity: 1;\n        }\n      }\n\n      &:hover {\n        "," {\n          opacity: 1;\n        }\n      }\n    }\n\n    &[data-menu-open='true'] {\n      "," {\n        opacity: 1;\n      }\n    }\n  "])),au,n[1],n[1],au,au,au)}),ab={agoSuffix:!0};function ay(e){let{canDelete:t,canEdit:n,comment:i,currentUser:r,hasError:l,isParent:a,isRetrying:s,mentionOptions:o,onCopyLink:d,onCreateRetry:c,onDelete:u,onEdit:h,onInputKeyDown:p,onStatusChange:m,readOnly:f}=e,{_createdAt:x,authorId:g,message:v,_id:b,lastEditedAt:y}=i,[j]=(0,tu.aFb)(g),[w,_]=(0,td.useState)(v),[k,C]=(0,td.useState)(!1),[z,E]=(0,td.useState)(null),I=(0,td.useRef)(v),[S,P]=(0,td.useState)(!1),T=lw(w),M=(0,td.useMemo)(()=>l_(w),[w]),R=(0,td.useRef)(null),O=x?new Date(x):new Date,A=(0,tu.INm)(O,ab),D=(0,nr.Z)(O,"PPPPp"),L=y?(0,nr.Z)(new Date(y),"PPPPp"):null,N=l||s,Z=(0,td.useCallback)(()=>P(!0),[]),U=(0,td.useCallback)(()=>P(!1),[]),B=(0,td.useCallback)(()=>null==d?void 0:d(b),[b,d]),F=(0,td.useCallback)(e=>{e.stopPropagation(),null==c||c(b)},[b,c]),q=(0,td.useCallback)(()=>u(b),[b,u]),H=(0,td.useCallback)(()=>{C(!1),_(I.current)},[]),V=(0,td.useCallback)(()=>{var e;if(!M||!T){H();return}null==(e=R.current)||e.discardDialogController.open()},[H,T,M]),W=(0,td.useCallback)(e=>{!e.isDefaultPrevented()&&("Escape"===e.key&&(e.preventDefault(),e.stopPropagation(),V()),p&&p(e))},[p,V]),K=(0,td.useCallback)(()=>{var e;null==(e=R.current)||e.discardDialogController.close()},[]),$=(0,td.useCallback)(()=>{var e;null==(e=R.current)||e.discardDialogController.close(),H()},[H]),Y=(0,td.useCallback)(()=>{h(b,{message:w}),C(!1)},[b,h,w]),X=(0,td.useCallback)(()=>{null==m||m(b,"open"===i.status?"resolved":"open")},[b,i.status,m]),G=(0,td.useCallback)(()=>{C(e=>!e)},[]),Q=(0,td.useCallback)(()=>P(!1),[]),J=(0,td.useCallback)(()=>{T||H()},[H,T]),ee=(0,td.useCallback)(e=>{"Escape"!==e.key||T||H()},[H,T]);(0,tu.lRb)(k,Q),(0,tp.O8)(J,[z]);let et=(null==j?void 0:j.displayName)?(0,tc.jsx)(tp.xv,{size:1,weight:"semibold",textOverflow:"ellipsis",title:j.displayName,children:j.displayName}):(0,tc.jsx)(tp.Qr,{size:1,style:ap});return(0,tc.jsxs)(av,{"data-menu-open":S?"true":"false",onKeyDown:ee,ref:E,space:4,children:[(0,tc.jsxs)(af,{space:1,"data-muted":N,children:[(0,tc.jsxs)(tp.kC,{align:"center",gap:3,flex:1,children:[(0,tc.jsx)(r3,{user:j}),(0,tc.jsx)(tp.kC,{align:"center",paddingBottom:1,sizing:"border",flex:1,children:(0,tc.jsxs)(tp.kC,{align:"flex-end",gap:2,children:[(0,tc.jsx)(tp.xu,{flex:1,children:et}),!N&&(0,tc.jsxs)(tp.kC,{align:"center",gap:1,children:[(0,tc.jsx)(am,{muted:!0,size:0,title:D,children:A}),L&&(0,tc.jsx)(am,{muted:!0,size:0,title:L,children:"(edited)"})]})]})}),!k&&!N&&(0,tc.jsx)(ah,{isParent:a,children:(0,tc.jsx)(as,{canDelete:t,canEdit:n,isParent:a,onCopyLink:B,onDeleteStart:q,onEditStart:G,onMenuClose:U,onMenuOpen:Z,onStatusChange:X,readOnly:f,status:i.status})})]}),k&&(0,tc.jsxs)(tp.kC,{align:"flex-start",gap:2,children:[(0,tc.jsx)(r8,{}),(0,tc.jsx)(tp.Kq,{flex:1,children:(0,tc.jsx)(l6,{currentUser:r,focusOnMount:!0,mentionOptions:o,onChange:_,onDiscardCancel:K,onDiscardConfirm:$,onKeyDown:W,onSubmit:Y,readOnly:f,ref:R,value:w,withAvatar:!1})})]}),!k&&(0,tc.jsxs)(tp.kC,{gap:3,children:[(0,tc.jsx)(r8,{}),(0,tc.jsx)(lp,{blocks:v})]})]}),N&&(0,tc.jsxs)(ax,{gap:3,children:[(0,tc.jsx)(r8,{}),(0,tc.jsxs)(tp.kC,{align:"center",gap:1,flex:1,children:[(0,tc.jsxs)(tp.xv,{muted:!0,size:1,children:[l&&"Failed to send.",s&&"Posting..."]}),(0,tc.jsx)(tp.kC,{hidden:s,children:(0,tc.jsx)(ag,{__unstable_focusRing:!0,display:"flex",forwardedAs:"button",onClick:F,padding:1,radius:2,tone:"primary",children:(0,tc.jsx)(tp.xv,{size:1,muted:!0,children:"Retry"})})})]})]})]})}var aj=Object.freeze,aw=Object.defineProperty;let a_=(0,tm.ZP)(tp.Zb).attrs(e=>{let{tone:t}=e;return{padding:3,radius:3,sizing:"border",tone:t||"transparent"}})(ev||(ev=aj(aw(g=["\n  // ...\n"],"raw",{value:aj(g.slice())}))));var ak=Object.freeze,aC=Object.defineProperty,az=(e,t)=>ak(aC(e,"raw",{value:ak(t||e.slice())}));let aE=[],aI=(0,tm.ZP)(a_)(e=>{let{theme:t}=e,{hovered:n}=t.sanity.color.button.bleed.default;return(0,tm.iv)(eb||(eb=az(["\n    position: relative;\n\n    &:has(> [data-ui='GhostButton']:focus:focus-visible) {\n      box-shadow:\n        inset 0 0 0 1px var(--card-border-color),\n        0 0 0 1px var(--card-bg-color),\n        0 0 0 3px var(--card-focus-ring-color);\n    }\n\n    // When the comment is not selected, we want to apply hover styles.\n    // The hover styles is managed with the [data-hovered] attribute instead of the :hover pseudo class\n    // since we want to show the hover styles when hovering over the menu items in the context menu as well.\n    // The context menu is rendered using a portal, so the :hover pseudo class won't work when hovering over\n    // the menu items.\n    &:not([data-active='true']) {\n      @media (hover: hover) {\n        &[data-hovered='true'] {\n          --card-bg-color: ",";\n\n          [data-root-menu='true'] {\n            opacity: 1;\n          }\n        }\n      }\n    }\n  "])),n.bg2)}),aS=(0,tm.ZP)(tp.zx)(e=>{let{theme:t}=e,{medium:n}=t.sanity.fonts.text.weights;return(0,tm.iv)(ey||(ey=az(["\n    font-weight: ",";\n  "])),n)}),aP=(0,tm.ZP)(tp.zx)(ej||(ej=az(["\n  opacity: 0;\n  position: absolute;\n  right: 0;\n  top: 0;\n  bottom: 0;\n  left: 0;\n"]))),aT=td.memo(function(e){var t,n;let{canReply:i,currentUser:r,isSelected:l,mentionOptions:a,onCopyLink:s,onCreateRetry:o,onDelete:d,onEdit:c,onKeyDown:u,onPathSelect:h,onReply:p,onStatusChange:m,parentComment:f,readOnly:x,replies:g=aE}=e,[v,b]=(0,td.useState)(aE),[y,j]=(0,td.useState)(!0),w=(0,td.useRef)(!1),_=(0,td.useRef)(null),k=(0,td.useMemo)(()=>l_(v),[v]),[C,z]=(0,td.useState)(!1),E=(0,td.useCallback)(()=>z(!0),[]),I=(0,td.useCallback)(()=>z(!1),[]),S=(0,td.useCallback)(()=>{let e={fieldPath:f.target.path.field,message:v,parentCommentId:f._id,status:(null==f?void 0:f.status)||"open",threadId:f.threadId};null==p||p(e),b(aE)},[p,f._id,null==f?void 0:f.status,f.target.path.field,f.threadId,v]),P=(0,td.useCallback)(()=>{var e;if(!k){b(aE);return}null==(e=_.current)||e.discardDialogController.open()},[k]),T=(0,td.useCallback)(e=>{e.isDefaultPrevented()||"Escape"!==e.key||(e.preventDefault(),e.stopPropagation(),P())},[P]),M=(0,td.useCallback)(()=>{var e;null==(e=_.current)||e.discardDialogController.close()},[]),R=(0,td.useCallback)(()=>{var e,t;b(aE),null==(e=_.current)||e.discardDialogController.close(),null==(t=_.current)||t.focus()},[]),O=(0,td.useCallback)(e=>{e.stopPropagation(),null==h||h({fieldPath:f.target.path.field,origin:"inspector",threadId:f.threadId})},[h,f.target.path.field,f.threadId]),A=(0,td.useCallback)(e=>{e.stopPropagation(),j(!1),w.current=!0},[]),D=(0,td.useMemo)(()=>y?null==g?void 0:g.slice(-5):g,[g,y]),L=(0,td.useMemo)(()=>!!g&&g.length>5,[g]),N=(0,td.useMemo)(()=>"".concat((null==g?void 0:g.length)-5," more ").concat((null==g?void 0:g.length)-5==1?"comment":"comments"),[null==g?void 0:g.length]);(0,td.useEffect)(()=>{g.length>5&&!w.current&&j(!0)},[g]);let Z=(0,td.useMemo)(()=>D.map(e=>{var t,n;return(0,tc.jsx)(tp.Kq,{as:"li","data-comment-id":e._id,children:(0,tc.jsx)(ay,{canDelete:e.authorId===r.id,canEdit:e.authorId===r.id,comment:e,currentUser:r,hasError:(null==(t=e._state)?void 0:t.type)==="createError",isRetrying:(null==(n=e._state)?void 0:n.type)==="createRetrying",mentionOptions:a,onInputKeyDown:T,onCopyLink:s,onCreateRetry:o,onDelete:d,onEdit:c,readOnly:x})},e._id)}),[r,T,a,s,o,d,c,x,D]);return(0,tc.jsx)(tp.Kq,{space:2,children:(0,tc.jsxs)(aI,{"data-active":l?"true":"false","data-hovered":C?"true":"false",onClick:O,onMouseEnter:E,onMouseLeave:I,tone:l?"primary":void 0,children:[(0,tc.jsx)(aP,{"data-ui":"GhostButton","aria-label":"Go to field"}),(0,tc.jsxs)(tp.Kq,{as:"ul",paddingBottom:i?void 0:1,space:4,children:[(0,tc.jsx)(tp.Kq,{as:"li","data-comment-id":f._id,children:(0,tc.jsx)(ay,{canDelete:f.authorId===r.id,canEdit:f.authorId===r.id,comment:f,currentUser:r,hasError:(null==(t=f._state)?void 0:t.type)==="createError",isParent:!0,isRetrying:(null==(n=f._state)?void 0:n.type)==="createRetrying",mentionOptions:a,onCopyLink:s,onCreateRetry:o,onDelete:d,onEdit:c,onInputKeyDown:u,onStatusChange:m,readOnly:x})}),L&&!w.current&&(0,tc.jsxs)(tp.kC,{gap:1,paddingY:1,sizing:"border",children:[(0,tc.jsx)(r8,{}),(0,tc.jsx)(aS,{fontSize:1,iconRight:to.v4q,mode:"bleed",onClick:A,padding:2,space:2,text:N})]}),Z,i&&(0,tc.jsx)(l6,{currentUser:r,expandOnFocus:!0,mentionOptions:a,onChange:b,onDiscardCancel:M,onDiscardConfirm:R,onKeyDown:T,onSubmit:S,placeholder:"Reply",readOnly:x,ref:_,value:v})]})]})})}),aM={close:0,open:500},aR=(0,tc.jsx)(tp.xv,{muted:!0,children:(0,tc.jsx)(to.XCv,{})}),aO=(e,t)=>(0,tc.jsx)(tp.xu,{as:"li",children:(0,tc.jsx)(tp.xv,{textOverflow:"ellipsis",size:1,weight:"semibold",children:e})},"".concat(e,"-").concat(t));function aA(e){let{titlePath:t,maxLength:n}=e,i=(0,td.useMemo)(()=>{let e=t.length,i=Math.ceil(n/2),r=Math.floor(n/2);return n&&e>n?[...t.slice(0,i-1),t.slice(i-1,e-r),...t.slice(e-r)]:t},[n,t]),r=(0,td.useMemo)(()=>i.map((e,t)=>{let n="".concat(e,"-").concat(t),r=t<i.length-1;return Array.isArray(e)?(0,tc.jsxs)(td.Fragment,{children:[(0,tc.jsx)(tp.u,{delay:aM,content:(0,tc.jsx)(tp.Kq,{space:2,padding:2,children:e.map(aO)}),children:(0,tc.jsx)(tp.xu,{children:aO("...",t)})}),r&&aR]},n):(0,tc.jsxs)(td.Fragment,{children:[aO(e,t),r&&aR]},n)}),[i]);return(0,tc.jsx)(tp.kC,{align:"center",as:"ol",gap:2,children:r})}/*! pako 2.1.0 https://github.com/nodeca/pako @license (MIT AND Zlib) */function aD(e){let t=e.length;for(;--t>=0;)e[t]=0}let aL=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),aN=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),aZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),aU=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),aB=Array(576);aD(aB);let aF=Array(60);aD(aF);let aq=Array(512);aD(aq);let aH=Array(256);aD(aH);let aV=Array(29);aD(aV);let aW=Array(30);function aK(e,t,n,i,r){this.static_tree=e,this.extra_bits=t,this.extra_base=n,this.elems=i,this.max_length=r,this.has_stree=e&&e.length}function a$(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}aD(aW);let aY=e=>e<256?aq[e]:aq[256+(e>>>7)],aX=(e,t)=>{e.pending_buf[e.pending++]=255&t,e.pending_buf[e.pending++]=t>>>8&255},aG=(e,t,n)=>{e.bi_valid>16-n?(e.bi_buf|=t<<e.bi_valid&65535,aX(e,e.bi_buf),e.bi_buf=t>>16-e.bi_valid,e.bi_valid+=n-16):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=n)},aQ=(e,t,n)=>{aG(e,n[2*t],n[2*t+1])},aJ=(e,t)=>{let n=0;do n|=1&e,e>>>=1,n<<=1;while(--t>0);return n>>>1},a0=e=>{16===e.bi_valid?(aX(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):e.bi_valid>=8&&(e.pending_buf[e.pending++]=255&e.bi_buf,e.bi_buf>>=8,e.bi_valid-=8)},a1=(e,t)=>{let n,i,r,l,a,s;let o=t.dyn_tree,d=t.max_code,c=t.stat_desc.static_tree,u=t.stat_desc.has_stree,h=t.stat_desc.extra_bits,p=t.stat_desc.extra_base,m=t.stat_desc.max_length,f=0;for(l=0;l<=15;l++)e.bl_count[l]=0;for(o[2*e.heap[e.heap_max]+1]=0,n=e.heap_max+1;n<573;n++)(l=o[2*o[2*(i=e.heap[n])+1]+1]+1)>m&&(l=m,f++),o[2*i+1]=l,!(i>d)&&(e.bl_count[l]++,a=0,i>=p&&(a=h[i-p]),s=o[2*i],e.opt_len+=s*(l+a),u&&(e.static_len+=s*(c[2*i+1]+a)));if(0!==f){do{for(l=m-1;0===e.bl_count[l];)l--;e.bl_count[l]--,e.bl_count[l+1]+=2,e.bl_count[m]--,f-=2}while(f>0);for(l=m;0!==l;l--)for(i=e.bl_count[l];0!==i;)!((r=e.heap[--n])>d)&&(o[2*r+1]!==l&&(e.opt_len+=(l-o[2*r+1])*o[2*r],o[2*r+1]=l),i--)}},a2=(e,t,n)=>{let i,r;let l=Array(16),a=0;for(i=1;i<=15;i++)a=a+n[i-1]<<1,l[i]=a;for(r=0;r<=t;r++){let t=e[2*r+1];0!==t&&(e[2*r]=aJ(l[t]++,t))}},a5=()=>{let e,t,n,i,s;let o=Array(16);for(i=0,n=0;i<28;i++)for(e=0,aV[i]=n;e<1<<aL[i];e++)aH[n++]=i;for(aH[n-1]=i,s=0,i=0;i<16;i++)for(e=0,aW[i]=s;e<1<<aN[i];e++)aq[s++]=i;for(s>>=7;i<30;i++)for(e=0,aW[i]=s<<7;e<1<<aN[i]-7;e++)aq[256+s++]=i;for(t=0;t<=15;t++)o[t]=0;for(e=0;e<=143;)aB[2*e+1]=8,e++,o[8]++;for(;e<=255;)aB[2*e+1]=9,e++,o[9]++;for(;e<=279;)aB[2*e+1]=7,e++,o[7]++;for(;e<=287;)aB[2*e+1]=8,e++,o[8]++;for(a2(aB,287,o),e=0;e<30;e++)aF[2*e+1]=5,aF[2*e]=aJ(e,5);r=new aK(aB,aL,257,286,15),l=new aK(aF,aN,0,30,15),a=new aK([],aZ,0,19,7)},a3=e=>{let t;for(t=0;t<286;t++)e.dyn_ltree[2*t]=0;for(t=0;t<30;t++)e.dyn_dtree[2*t]=0;for(t=0;t<19;t++)e.bl_tree[2*t]=0;e.dyn_ltree[512]=1,e.opt_len=e.static_len=0,e.sym_next=e.matches=0},a6=e=>{e.bi_valid>8?aX(e,e.bi_buf):e.bi_valid>0&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0},a8=(e,t,n,i)=>{let r=2*t,l=2*n;return e[r]<e[l]||e[r]===e[l]&&i[t]<=i[n]},a4=(e,t,n)=>{let i=e.heap[n],r=n<<1;for(;r<=e.heap_len&&(r<e.heap_len&&a8(t,e.heap[r+1],e.heap[r],e.depth)&&r++,!a8(t,i,e.heap[r],e.depth));)e.heap[n]=e.heap[r],n=r,r<<=1;e.heap[n]=i},a9=(e,t,n)=>{let i,r,l,a;let s=0;if(0!==e.sym_next)do i=(255&e.pending_buf[e.sym_buf+s++])+((255&e.pending_buf[e.sym_buf+s++])<<8),r=e.pending_buf[e.sym_buf+s++],0===i?aQ(e,r,t):(aQ(e,(l=aH[r])+256+1,t),0!==(a=aL[l])&&aG(e,r-=aV[l],a),aQ(e,l=aY(--i),n),0!==(a=aN[l])&&aG(e,i-=aW[l],a));while(s<e.sym_next);aQ(e,256,t)},a7=(e,t)=>{let n,i,r;let l=t.dyn_tree,a=t.stat_desc.static_tree,s=t.stat_desc.has_stree,o=t.stat_desc.elems,d=-1;for(n=0,e.heap_len=0,e.heap_max=573;n<o;n++)0!==l[2*n]?(e.heap[++e.heap_len]=d=n,e.depth[n]=0):l[2*n+1]=0;for(;e.heap_len<2;)l[2*(r=e.heap[++e.heap_len]=d<2?++d:0)]=1,e.depth[r]=0,e.opt_len--,s&&(e.static_len-=a[2*r+1]);for(t.max_code=d,n=e.heap_len>>1;n>=1;n--)a4(e,l,n);r=o;do n=e.heap[1],e.heap[1]=e.heap[e.heap_len--],a4(e,l,1),i=e.heap[1],e.heap[--e.heap_max]=n,e.heap[--e.heap_max]=i,l[2*r]=l[2*n]+l[2*i],e.depth[r]=(e.depth[n]>=e.depth[i]?e.depth[n]:e.depth[i])+1,l[2*n+1]=l[2*i+1]=r,e.heap[1]=r++,a4(e,l,1);while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1],a1(e,t),a2(l,d,e.bl_count)},se=(e,t,n)=>{let i,r;let l=-1,a=t[1],s=0,o=7,d=4;for(0===a&&(o=138,d=3),t[(n+1)*2+1]=65535,i=0;i<=n;i++)r=a,a=t[(i+1)*2+1],++s<o&&r===a||(s<d?e.bl_tree[2*r]+=s:0!==r?(r!==l&&e.bl_tree[2*r]++,e.bl_tree[32]++):s<=10?e.bl_tree[34]++:e.bl_tree[36]++,s=0,l=r,0===a?(o=138,d=3):r===a?(o=6,d=3):(o=7,d=4))},st=(e,t,n)=>{let i,r;let l=-1,a=t[1],s=0,o=7,d=4;for(0===a&&(o=138,d=3),i=0;i<=n;i++)if(r=a,a=t[(i+1)*2+1],!(++s<o)||r!==a){if(s<d)do aQ(e,r,e.bl_tree);while(0!=--s);else 0!==r?(r!==l&&(aQ(e,r,e.bl_tree),s--),aQ(e,16,e.bl_tree),aG(e,s-3,2)):s<=10?(aQ(e,17,e.bl_tree),aG(e,s-3,3)):(aQ(e,18,e.bl_tree),aG(e,s-11,7));s=0,l=r,0===a?(o=138,d=3):r===a?(o=6,d=3):(o=7,d=4)}},sn=e=>{let t;for(se(e,e.dyn_ltree,e.l_desc.max_code),se(e,e.dyn_dtree,e.d_desc.max_code),a7(e,e.bl_desc),t=18;t>=3&&0===e.bl_tree[2*aU[t]+1];t--);return e.opt_len+=3*(t+1)+5+5+4,t},si=(e,t,n,i)=>{let r;for(aG(e,t-257,5),aG(e,n-1,5),aG(e,i-4,4),r=0;r<i;r++)aG(e,e.bl_tree[2*aU[r]+1],3);st(e,e.dyn_ltree,t-1),st(e,e.dyn_dtree,n-1)},sr=e=>{let t,n=4093624447;for(t=0;t<=31;t++,n>>>=1)if(1&n&&0!==e.dyn_ltree[2*t])return 0;if(0!==e.dyn_ltree[18]||0!==e.dyn_ltree[20]||0!==e.dyn_ltree[26])return 1;for(t=32;t<256;t++)if(0!==e.dyn_ltree[2*t])return 1;return 0},sl=!1,sa=(e,t,n,i)=>{aG(e,0+(i?1:0),3),a6(e),aX(e,n),aX(e,~n),n&&e.pending_buf.set(e.window.subarray(t,t+n),e.pending),e.pending+=n};var ss={_tr_init:e=>{sl||(a5(),sl=!0),e.l_desc=new a$(e.dyn_ltree,r),e.d_desc=new a$(e.dyn_dtree,l),e.bl_desc=new a$(e.bl_tree,a),e.bi_buf=0,e.bi_valid=0,a3(e)},_tr_stored_block:sa,_tr_flush_block:(e,t,n,i)=>{let r,l;let a=0;e.level>0?(2===e.strm.data_type&&(e.strm.data_type=sr(e)),a7(e,e.l_desc),a7(e,e.d_desc),a=sn(e),r=e.opt_len+3+7>>>3,(l=e.static_len+3+7>>>3)<=r&&(r=l)):r=l=n+5,n+4<=r&&-1!==t?sa(e,t,n,i):4===e.strategy||l===r?(aG(e,2+(i?1:0),3),a9(e,aB,aF)):(aG(e,4+(i?1:0),3),si(e,e.l_desc.max_code+1,e.d_desc.max_code+1,a+1),a9(e,e.dyn_ltree,e.dyn_dtree)),a3(e),i&&a6(e)},_tr_tally:(e,t,n)=>(e.pending_buf[e.sym_buf+e.sym_next++]=t,e.pending_buf[e.sym_buf+e.sym_next++]=t>>8,e.pending_buf[e.sym_buf+e.sym_next++]=n,0===t?e.dyn_ltree[2*n]++:(e.matches++,t--,e.dyn_ltree[(aH[n]+256+1)*2]++,e.dyn_dtree[2*aY(t)]++),e.sym_next===e.sym_end),_tr_align:e=>{aG(e,2,3),aQ(e,256,aB),a0(e)}},so=(e,t,n,i)=>{let r=65535&e|0,l=e>>>16&65535|0,a=0;for(;0!==n;){a=n>2e3?2e3:n,n-=a;do l=l+(r=r+t[i++]|0)|0;while(--a);r%=65521,l%=65521}return r|l<<16|0};let sd=new Uint32Array((()=>{let e,t=[];for(var n=0;n<256;n++){e=n;for(var i=0;i<8;i++)e=1&e?3988292384^e>>>1:e>>>1;t[n]=e}return t})());var sc=(e,t,n,i)=>{let r=i+n;e^=-1;for(let n=i;n<r;n++)e=e>>>8^sd[(e^t[n])&255];return -1^e},su={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},sh={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};let{_tr_init:sp,_tr_stored_block:sm,_tr_flush_block:sf,_tr_tally:sx,_tr_align:sg}=ss,{Z_NO_FLUSH:sv,Z_PARTIAL_FLUSH:sb,Z_FULL_FLUSH:sy,Z_FINISH:sj,Z_BLOCK:sw,Z_OK:s_,Z_STREAM_END:sk,Z_STREAM_ERROR:sC,Z_DATA_ERROR:sz,Z_BUF_ERROR:sE,Z_DEFAULT_COMPRESSION:sI,Z_FILTERED:sS,Z_HUFFMAN_ONLY:sP,Z_RLE:sT,Z_FIXED:sM,Z_DEFAULT_STRATEGY:sR,Z_UNKNOWN:sO,Z_DEFLATED:sA}=sh,sD=(e,t)=>(e.msg=su[t],t),sL=e=>2*e-(e>4?9:0),sN=e=>{let t=e.length;for(;--t>=0;)e[t]=0},sZ=e=>{let t,n,i;let r=e.w_size;i=t=e.hash_size;do n=e.head[--i],e.head[i]=n>=r?n-r:0;while(--t);i=t=r;do n=e.prev[--i],e.prev[i]=n>=r?n-r:0;while(--t)},sU=(e,t,n)=>(t<<e.hash_shift^n)&e.hash_mask,sB=e=>{let t=e.state,n=t.pending;n>e.avail_out&&(n=e.avail_out),0!==n&&(e.output.set(t.pending_buf.subarray(t.pending_out,t.pending_out+n),e.next_out),e.next_out+=n,t.pending_out+=n,e.total_out+=n,e.avail_out-=n,t.pending-=n,0===t.pending&&(t.pending_out=0))},sF=(e,t)=>{sf(e,e.block_start>=0?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,sB(e.strm)},sq=(e,t)=>{e.pending_buf[e.pending++]=t},sH=(e,t)=>{e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=255&t},sV=(e,t,n,i)=>{let r=e.avail_in;return(r>i&&(r=i),0===r)?0:(e.avail_in-=r,t.set(e.input.subarray(e.next_in,e.next_in+r),n),1===e.state.wrap?e.adler=so(e.adler,t,r,n):2===e.state.wrap&&(e.adler=sc(e.adler,t,r,n)),e.next_in+=r,e.total_in+=r,r)},sW=(e,t)=>{let n,i,r=e.max_chain_length,l=e.strstart,a=e.prev_length,s=e.nice_match,o=e.strstart>e.w_size-262?e.strstart-(e.w_size-262):0,d=e.window,c=e.w_mask,u=e.prev,h=e.strstart+258,p=d[l+a-1],m=d[l+a];e.prev_length>=e.good_match&&(r>>=2),s>e.lookahead&&(s=e.lookahead);do{if(d[(n=t)+a]!==m||d[n+a-1]!==p||d[n]!==d[l]||d[++n]!==d[l+1])continue;l+=2,n++;do;while(d[++l]===d[++n]&&d[++l]===d[++n]&&d[++l]===d[++n]&&d[++l]===d[++n]&&d[++l]===d[++n]&&d[++l]===d[++n]&&d[++l]===d[++n]&&d[++l]===d[++n]&&l<h);if(i=258-(h-l),l=h-258,i>a){if(e.match_start=t,a=i,i>=s)break;p=d[l+a-1],m=d[l+a]}}while((t=u[t&c])>o&&0!=--r);return a<=e.lookahead?a:e.lookahead},sK=e=>{let t,n,i;let r=e.w_size;do{if(n=e.window_size-e.lookahead-e.strstart,e.strstart>=r+(r-262)&&(e.window.set(e.window.subarray(r,r+r-n),0),e.match_start-=r,e.strstart-=r,e.block_start-=r,e.insert>e.strstart&&(e.insert=e.strstart),sZ(e),n+=r),0===e.strm.avail_in)break;if(t=sV(e.strm,e.window,e.strstart+e.lookahead,n),e.lookahead+=t,e.lookahead+e.insert>=3)for(i=e.strstart-e.insert,e.ins_h=e.window[i],e.ins_h=sU(e,e.ins_h,e.window[i+1]);e.insert&&(e.ins_h=sU(e,e.ins_h,e.window[i+3-1]),e.prev[i&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=i,i++,e.insert--,!(e.lookahead+e.insert<3)););}while(e.lookahead<262&&0!==e.strm.avail_in)},s$=(e,t)=>{let n=e.pending_buf_size-5>e.w_size?e.w_size:e.pending_buf_size-5,i,r,l,a=0,s=e.strm.avail_in;do{if(i=65535,l=e.bi_valid+42>>3,e.strm.avail_out<l||(l=e.strm.avail_out-l,i>(r=e.strstart-e.block_start)+e.strm.avail_in&&(i=r+e.strm.avail_in),i>l&&(i=l),i<n&&(0===i&&t!==sj||t===sv||i!==r+e.strm.avail_in)))break;a=t===sj&&i===r+e.strm.avail_in?1:0,sm(e,0,0,a),e.pending_buf[e.pending-4]=i,e.pending_buf[e.pending-3]=i>>8,e.pending_buf[e.pending-2]=~i,e.pending_buf[e.pending-1]=~i>>8,sB(e.strm),r&&(r>i&&(r=i),e.strm.output.set(e.window.subarray(e.block_start,e.block_start+r),e.strm.next_out),e.strm.next_out+=r,e.strm.avail_out-=r,e.strm.total_out+=r,e.block_start+=r,i-=r),i&&(sV(e.strm,e.strm.output,e.strm.next_out,i),e.strm.next_out+=i,e.strm.avail_out-=i,e.strm.total_out+=i)}while(0===a);return((s-=e.strm.avail_in)&&(s>=e.w_size?(e.matches=2,e.window.set(e.strm.input.subarray(e.strm.next_in-e.w_size,e.strm.next_in),0),e.strstart=e.w_size,e.insert=e.strstart):(e.window_size-e.strstart<=s&&(e.strstart-=e.w_size,e.window.set(e.window.subarray(e.w_size,e.w_size+e.strstart),0),e.matches<2&&e.matches++,e.insert>e.strstart&&(e.insert=e.strstart)),e.window.set(e.strm.input.subarray(e.strm.next_in-s,e.strm.next_in),e.strstart),e.strstart+=s,e.insert+=s>e.w_size-e.insert?e.w_size-e.insert:s),e.block_start=e.strstart),e.high_water<e.strstart&&(e.high_water=e.strstart),a)?4:t!==sv&&t!==sj&&0===e.strm.avail_in&&e.strstart===e.block_start?2:(l=e.window_size-e.strstart,e.strm.avail_in>l&&e.block_start>=e.w_size&&(e.block_start-=e.w_size,e.strstart-=e.w_size,e.window.set(e.window.subarray(e.w_size,e.w_size+e.strstart),0),e.matches<2&&e.matches++,l+=e.w_size,e.insert>e.strstart&&(e.insert=e.strstart)),l>e.strm.avail_in&&(l=e.strm.avail_in),l&&(sV(e.strm,e.window,e.strstart,l),e.strstart+=l,e.insert+=l>e.w_size-e.insert?e.w_size-e.insert:l),e.high_water<e.strstart&&(e.high_water=e.strstart),l=e.bi_valid+42>>3,n=(l=e.pending_buf_size-l>65535?65535:e.pending_buf_size-l)>e.w_size?e.w_size:l,((r=e.strstart-e.block_start)>=n||(r||t===sj)&&t!==sv&&0===e.strm.avail_in&&r<=l)&&(i=r>l?l:r,a=t===sj&&0===e.strm.avail_in&&i===r?1:0,sm(e,e.block_start,i,a),e.block_start+=i,sB(e.strm)),a?3:1)},sY=(e,t)=>{let n,i;for(;;){if(e.lookahead<262){if(sK(e),e.lookahead<262&&t===sv)return 1;if(0===e.lookahead)break}if(n=0,e.lookahead>=3&&(e.ins_h=sU(e,e.ins_h,e.window[e.strstart+3-1]),n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!==n&&e.strstart-n<=e.w_size-262&&(e.match_length=sW(e,n)),e.match_length>=3){if(i=sx(e,e.strstart-e.match_start,e.match_length-3),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=3){e.match_length--;do e.strstart++,e.ins_h=sU(e,e.ins_h,e.window[e.strstart+3-1]),n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart;while(0!=--e.match_length);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=sU(e,e.ins_h,e.window[e.strstart+1])}else i=sx(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(i&&(sF(e,!1),0===e.strm.avail_out))return 1}return(e.insert=e.strstart<2?e.strstart:2,t===sj)?(sF(e,!0),0===e.strm.avail_out)?3:4:e.sym_next&&(sF(e,!1),0===e.strm.avail_out)?1:2},sX=(e,t)=>{let n,i,r;for(;;){if(e.lookahead<262){if(sK(e),e.lookahead<262&&t===sv)return 1;if(0===e.lookahead)break}if(n=0,e.lookahead>=3&&(e.ins_h=sU(e,e.ins_h,e.window[e.strstart+3-1]),n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=2,0!==n&&e.prev_length<e.max_lazy_match&&e.strstart-n<=e.w_size-262&&(e.match_length=sW(e,n),e.match_length<=5&&(e.strategy===sS||3===e.match_length&&e.strstart-e.match_start>4096)&&(e.match_length=2)),e.prev_length>=3&&e.match_length<=e.prev_length){r=e.strstart+e.lookahead-3,i=sx(e,e.strstart-1-e.prev_match,e.prev_length-3),e.lookahead-=e.prev_length-1,e.prev_length-=2;do++e.strstart<=r&&(e.ins_h=sU(e,e.ins_h,e.window[e.strstart+3-1]),n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart);while(0!=--e.prev_length);if(e.match_available=0,e.match_length=2,e.strstart++,i&&(sF(e,!1),0===e.strm.avail_out))return 1}else if(e.match_available){if((i=sx(e,0,e.window[e.strstart-1]))&&sF(e,!1),e.strstart++,e.lookahead--,0===e.strm.avail_out)return 1}else e.match_available=1,e.strstart++,e.lookahead--}return(e.match_available&&(i=sx(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<2?e.strstart:2,t===sj)?(sF(e,!0),0===e.strm.avail_out)?3:4:e.sym_next&&(sF(e,!1),0===e.strm.avail_out)?1:2},sG=(e,t)=>{let n,i,r,l;let a=e.window;for(;;){if(e.lookahead<=258){if(sK(e),e.lookahead<=258&&t===sv)return 1;if(0===e.lookahead)break}if(e.match_length=0,e.lookahead>=3&&e.strstart>0&&(i=a[r=e.strstart-1])===a[++r]&&i===a[++r]&&i===a[++r]){l=e.strstart+258;do;while(i===a[++r]&&i===a[++r]&&i===a[++r]&&i===a[++r]&&i===a[++r]&&i===a[++r]&&i===a[++r]&&i===a[++r]&&r<l);e.match_length=258-(l-r),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=3?(n=sx(e,1,e.match_length-3),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(n=sx(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),n&&(sF(e,!1),0===e.strm.avail_out))return 1}return(e.insert=0,t===sj)?(sF(e,!0),0===e.strm.avail_out)?3:4:e.sym_next&&(sF(e,!1),0===e.strm.avail_out)?1:2},sQ=(e,t)=>{let n;for(;;){if(0===e.lookahead&&(sK(e),0===e.lookahead)){if(t===sv)return 1;break}if(e.match_length=0,n=sx(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,n&&(sF(e,!1),0===e.strm.avail_out))return 1}return(e.insert=0,t===sj)?(sF(e,!0),0===e.strm.avail_out)?3:4:e.sym_next&&(sF(e,!1),0===e.strm.avail_out)?1:2};function sJ(e,t,n,i,r){this.good_length=e,this.max_lazy=t,this.nice_length=n,this.max_chain=i,this.func=r}let s0=[new sJ(0,0,0,0,s$),new sJ(4,4,8,4,sY),new sJ(4,5,16,8,sY),new sJ(4,6,32,32,sY),new sJ(4,4,16,16,sX),new sJ(8,16,32,32,sX),new sJ(8,16,128,128,sX),new sJ(8,32,128,256,sX),new sJ(32,128,258,1024,sX),new sJ(32,258,258,4096,sX)],s1=e=>{e.window_size=2*e.w_size,sN(e.head),e.max_lazy_match=s0[e.level].max_lazy,e.good_match=s0[e.level].good_length,e.nice_match=s0[e.level].nice_length,e.max_chain_length=s0[e.level].max_chain,e.strstart=0,e.block_start=0,e.lookahead=0,e.insert=0,e.match_length=e.prev_length=2,e.match_available=0,e.ins_h=0};function s2(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=sA,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(1146),this.dyn_dtree=new Uint16Array(122),this.bl_tree=new Uint16Array(78),sN(this.dyn_ltree),sN(this.dyn_dtree),sN(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(16),this.heap=new Uint16Array(573),sN(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(573),sN(this.depth),this.sym_buf=0,this.lit_bufsize=0,this.sym_next=0,this.sym_end=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}let s5=e=>{if(!e)return 1;let t=e.state;return t&&t.strm===e&&(42===t.status||57===t.status||69===t.status||73===t.status||91===t.status||103===t.status||113===t.status||666===t.status)?0:1},s3=e=>{if(s5(e))return sD(e,sC);e.total_in=e.total_out=0,e.data_type=sO;let t=e.state;return t.pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=2===t.wrap?57:t.wrap?42:113,e.adler=2===t.wrap?0:1,t.last_flush=-2,sp(t),s_},s6=e=>{let t=s3(e);return t===s_&&s1(e.state),t},s8=(e,t,n,i,r,l)=>{if(!e)return sC;let a=1;if(t===sI&&(t=6),i<0?(a=0,i=-i):i>15&&(a=2,i-=16),r<1||r>9||n!==sA||i<8||i>15||t<0||t>9||l<0||l>sM||8===i&&1!==a)return sD(e,sC);8===i&&(i=9);let s=new s2;return e.state=s,s.strm=e,s.status=42,s.wrap=a,s.gzhead=null,s.w_bits=i,s.w_size=1<<s.w_bits,s.w_mask=s.w_size-1,s.hash_bits=r+7,s.hash_size=1<<s.hash_bits,s.hash_mask=s.hash_size-1,s.hash_shift=~~((s.hash_bits+3-1)/3),s.window=new Uint8Array(2*s.w_size),s.head=new Uint16Array(s.hash_size),s.prev=new Uint16Array(s.w_size),s.lit_bufsize=1<<r+6,s.pending_buf_size=4*s.lit_bufsize,s.pending_buf=new Uint8Array(s.pending_buf_size),s.sym_buf=s.lit_bufsize,s.sym_end=(s.lit_bufsize-1)*3,s.level=t,s.strategy=l,s.method=n,s6(e)};var s4={deflateInit:(e,t)=>s8(e,t,sA,15,8,sR),deflateInit2:s8,deflateReset:s6,deflateResetKeep:s3,deflateSetHeader:(e,t)=>s5(e)||2!==e.state.wrap?sC:(e.state.gzhead=t,s_),deflate:(e,t)=>{if(s5(e)||t>sw||t<0)return e?sD(e,sC):sC;let n=e.state;if(!e.output||0!==e.avail_in&&!e.input||666===n.status&&t!==sj)return sD(e,0===e.avail_out?sE:sC);let i=n.last_flush;if(n.last_flush=t,0!==n.pending){if(sB(e),0===e.avail_out)return n.last_flush=-1,s_}else if(0===e.avail_in&&sL(t)<=sL(i)&&t!==sj)return sD(e,sE);if(666===n.status&&0!==e.avail_in)return sD(e,sE);if(42===n.status&&0===n.wrap&&(n.status=113),42===n.status){let t=sA+(n.w_bits-8<<4)<<8;if(t|=(n.strategy>=sP||n.level<2?0:n.level<6?1:6===n.level?2:3)<<6,0!==n.strstart&&(t|=32),sH(n,t+=31-t%31),0!==n.strstart&&(sH(n,e.adler>>>16),sH(n,65535&e.adler)),e.adler=1,n.status=113,sB(e),0!==n.pending)return n.last_flush=-1,s_}if(57===n.status){if(e.adler=0,sq(n,31),sq(n,139),sq(n,8),n.gzhead)sq(n,(n.gzhead.text?1:0)+(n.gzhead.hcrc?2:0)+(n.gzhead.extra?4:0)+(n.gzhead.name?8:0)+(n.gzhead.comment?16:0)),sq(n,255&n.gzhead.time),sq(n,n.gzhead.time>>8&255),sq(n,n.gzhead.time>>16&255),sq(n,n.gzhead.time>>24&255),sq(n,9===n.level?2:n.strategy>=sP||n.level<2?4:0),sq(n,255&n.gzhead.os),n.gzhead.extra&&n.gzhead.extra.length&&(sq(n,255&n.gzhead.extra.length),sq(n,n.gzhead.extra.length>>8&255)),n.gzhead.hcrc&&(e.adler=sc(e.adler,n.pending_buf,n.pending,0)),n.gzindex=0,n.status=69;else if(sq(n,0),sq(n,0),sq(n,0),sq(n,0),sq(n,0),sq(n,9===n.level?2:n.strategy>=sP||n.level<2?4:0),sq(n,3),n.status=113,sB(e),0!==n.pending)return n.last_flush=-1,s_}if(69===n.status){if(n.gzhead.extra){let t=n.pending,i=(65535&n.gzhead.extra.length)-n.gzindex;for(;n.pending+i>n.pending_buf_size;){let r=n.pending_buf_size-n.pending;if(n.pending_buf.set(n.gzhead.extra.subarray(n.gzindex,n.gzindex+r),n.pending),n.pending=n.pending_buf_size,n.gzhead.hcrc&&n.pending>t&&(e.adler=sc(e.adler,n.pending_buf,n.pending-t,t)),n.gzindex+=r,sB(e),0!==n.pending)return n.last_flush=-1,s_;t=0,i-=r}let r=new Uint8Array(n.gzhead.extra);n.pending_buf.set(r.subarray(n.gzindex,n.gzindex+i),n.pending),n.pending+=i,n.gzhead.hcrc&&n.pending>t&&(e.adler=sc(e.adler,n.pending_buf,n.pending-t,t)),n.gzindex=0}n.status=73}if(73===n.status){if(n.gzhead.name){let t,i=n.pending;do{if(n.pending===n.pending_buf_size){if(n.gzhead.hcrc&&n.pending>i&&(e.adler=sc(e.adler,n.pending_buf,n.pending-i,i)),sB(e),0!==n.pending)return n.last_flush=-1,s_;i=0}t=n.gzindex<n.gzhead.name.length?255&n.gzhead.name.charCodeAt(n.gzindex++):0,sq(n,t)}while(0!==t);n.gzhead.hcrc&&n.pending>i&&(e.adler=sc(e.adler,n.pending_buf,n.pending-i,i)),n.gzindex=0}n.status=91}if(91===n.status){if(n.gzhead.comment){let t,i=n.pending;do{if(n.pending===n.pending_buf_size){if(n.gzhead.hcrc&&n.pending>i&&(e.adler=sc(e.adler,n.pending_buf,n.pending-i,i)),sB(e),0!==n.pending)return n.last_flush=-1,s_;i=0}t=n.gzindex<n.gzhead.comment.length?255&n.gzhead.comment.charCodeAt(n.gzindex++):0,sq(n,t)}while(0!==t);n.gzhead.hcrc&&n.pending>i&&(e.adler=sc(e.adler,n.pending_buf,n.pending-i,i))}n.status=103}if(103===n.status){if(n.gzhead.hcrc){if(n.pending+2>n.pending_buf_size&&(sB(e),0!==n.pending))return n.last_flush=-1,s_;sq(n,255&e.adler),sq(n,e.adler>>8&255),e.adler=0}if(n.status=113,sB(e),0!==n.pending)return n.last_flush=-1,s_}if(0!==e.avail_in||0!==n.lookahead||t!==sv&&666!==n.status){let i=0===n.level?s$(n,t):n.strategy===sP?sQ(n,t):n.strategy===sT?sG(n,t):s0[n.level].func(n,t);if((3===i||4===i)&&(n.status=666),1===i||3===i)return 0===e.avail_out&&(n.last_flush=-1),s_;if(2===i&&(t===sb?sg(n):t!==sw&&(sm(n,0,0,!1),t===sy&&(sN(n.head),0===n.lookahead&&(n.strstart=0,n.block_start=0,n.insert=0))),sB(e),0===e.avail_out))return n.last_flush=-1,s_}return t!==sj?s_:n.wrap<=0?sk:(2===n.wrap?(sq(n,255&e.adler),sq(n,e.adler>>8&255),sq(n,e.adler>>16&255),sq(n,e.adler>>24&255),sq(n,255&e.total_in),sq(n,e.total_in>>8&255),sq(n,e.total_in>>16&255),sq(n,e.total_in>>24&255)):(sH(n,e.adler>>>16),sH(n,65535&e.adler)),sB(e),n.wrap>0&&(n.wrap=-n.wrap),0!==n.pending?s_:sk)},deflateEnd:e=>{if(s5(e))return sC;let t=e.state.status;return e.state=null,113===t?sD(e,sz):s_},deflateSetDictionary:(e,t)=>{let n=t.length;if(s5(e))return sC;let i=e.state,r=i.wrap;if(2===r||1===r&&42!==i.status||i.lookahead)return sC;if(1===r&&(e.adler=so(e.adler,t,n,0)),i.wrap=0,n>=i.w_size){0===r&&(sN(i.head),i.strstart=0,i.block_start=0,i.insert=0);let e=new Uint8Array(i.w_size);e.set(t.subarray(n-i.w_size,n),0),t=e,n=i.w_size}let l=e.avail_in,a=e.next_in,s=e.input;for(e.avail_in=n,e.next_in=0,e.input=t,sK(i);i.lookahead>=3;){let e=i.strstart,t=i.lookahead-2;do i.ins_h=sU(i,i.ins_h,i.window[e+3-1]),i.prev[e&i.w_mask]=i.head[i.ins_h],i.head[i.ins_h]=e,e++;while(--t);i.strstart=e,i.lookahead=2,sK(i)}return i.strstart+=i.lookahead,i.block_start=i.strstart,i.insert=i.lookahead,i.lookahead=0,i.match_length=i.prev_length=2,i.match_available=0,e.next_in=a,e.input=s,e.avail_in=l,i.wrap=r,s_},deflateInfo:"pako deflate (from Nodeca project)"};let s9=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var s7={assign:function(e){let t=Array.prototype.slice.call(arguments,1);for(;t.length;){let n=t.shift();if(n){if("object"!=typeof n)throw TypeError(n+"must be non-object");for(let t in n)s9(n,t)&&(e[t]=n[t])}}return e},flattenChunks:e=>{let t=0;for(let n=0,i=e.length;n<i;n++)t+=e[n].length;let n=new Uint8Array(t);for(let t=0,i=0,r=e.length;t<r;t++){let r=e[t];n.set(r,i),i+=r.length}return n}};let oe=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(e){oe=!1}let ot=new Uint8Array(256);for(let e=0;e<256;e++)ot[e]=e>=252?6:e>=248?5:e>=240?4:e>=224?3:e>=192?2:1;ot[254]=ot[254]=1;let on=(e,t)=>{if(t<65534&&e.subarray&&oe)return String.fromCharCode.apply(null,e.length===t?e:e.subarray(0,t));let n="";for(let i=0;i<t;i++)n+=String.fromCharCode(e[i]);return n};var oi={string2buf:e=>{if("function"==typeof TextEncoder&&TextEncoder.prototype.encode)return new TextEncoder().encode(e);let t,n,i,r,l,a=e.length,s=0;for(r=0;r<a;r++)(64512&(n=e.charCodeAt(r)))==55296&&r+1<a&&(64512&(i=e.charCodeAt(r+1)))==56320&&(n=65536+(n-55296<<10)+(i-56320),r++),s+=n<128?1:n<2048?2:n<65536?3:4;for(l=0,t=new Uint8Array(s),r=0;l<s;r++)(64512&(n=e.charCodeAt(r)))==55296&&r+1<a&&(64512&(i=e.charCodeAt(r+1)))==56320&&(n=65536+(n-55296<<10)+(i-56320),r++),n<128?t[l++]=n:(n<2048?t[l++]=192|n>>>6:(n<65536?t[l++]=224|n>>>12:(t[l++]=240|n>>>18,t[l++]=128|n>>>12&63),t[l++]=128|n>>>6&63),t[l++]=128|63&n);return t},buf2string:(e,t)=>{let n,i;let r=t||e.length;if("function"==typeof TextDecoder&&TextDecoder.prototype.decode)return new TextDecoder().decode(e.subarray(0,t));let l=Array(2*r);for(i=0,n=0;n<r;){let t=e[n++];if(t<128){l[i++]=t;continue}let a=ot[t];if(a>4){l[i++]=65533,n+=a-1;continue}for(t&=2===a?31:3===a?15:7;a>1&&n<r;)t=t<<6|63&e[n++],a--;if(a>1){l[i++]=65533;continue}t<65536?l[i++]=t:(t-=65536,l[i++]=55296|t>>10&1023,l[i++]=56320|1023&t)}return on(l,i)},utf8border:(e,t)=>{(t=t||e.length)>e.length&&(t=e.length);let n=t-1;for(;n>=0&&(192&e[n])==128;)n--;return n<0||0===n?t:n+ot[e[n]]>t?n:t}},or=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0};let ol=Object.prototype.toString,{Z_NO_FLUSH:oa,Z_SYNC_FLUSH:os,Z_FULL_FLUSH:oo,Z_FINISH:od,Z_OK:oc,Z_STREAM_END:ou,Z_DEFAULT_COMPRESSION:oh,Z_DEFAULT_STRATEGY:op,Z_DEFLATED:om}=sh;function of(e){this.options=s7.assign({level:oh,method:om,chunkSize:16384,windowBits:15,memLevel:8,strategy:op},e||{});let t=this.options;t.raw&&t.windowBits>0?t.windowBits=-t.windowBits:t.gzip&&t.windowBits>0&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new or,this.strm.avail_out=0;let n=s4.deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(n!==oc)throw Error(su[n]);if(t.header&&s4.deflateSetHeader(this.strm,t.header),t.dictionary){let e;if(e="string"==typeof t.dictionary?oi.string2buf(t.dictionary):"[object ArrayBuffer]"===ol.call(t.dictionary)?new Uint8Array(t.dictionary):t.dictionary,(n=s4.deflateSetDictionary(this.strm,e))!==oc)throw Error(su[n]);this._dict_set=!0}}function ox(e,t){let n=new of(t);if(n.push(e,!0),n.err)throw n.msg||su[n.err];return n.result}of.prototype.push=function(e,t){let n,i;let r=this.strm,l=this.options.chunkSize;if(this.ended)return!1;for(i=t===~~t?t:!0===t?od:oa,"string"==typeof e?r.input=oi.string2buf(e):"[object ArrayBuffer]"===ol.call(e)?r.input=new Uint8Array(e):r.input=e,r.next_in=0,r.avail_in=r.input.length;;){if(0===r.avail_out&&(r.output=new Uint8Array(l),r.next_out=0,r.avail_out=l),(i===os||i===oo)&&r.avail_out<=6){this.onData(r.output.subarray(0,r.next_out)),r.avail_out=0;continue}if((n=s4.deflate(r,i))===ou)return r.next_out>0&&this.onData(r.output.subarray(0,r.next_out)),n=s4.deflateEnd(this.strm),this.onEnd(n),this.ended=!0,n===oc;if(0===r.avail_out){this.onData(r.output);continue}if(i>0&&r.next_out>0){this.onData(r.output.subarray(0,r.next_out)),r.avail_out=0;continue}if(0===r.avail_in)break}return!0},of.prototype.onData=function(e){this.chunks.push(e)},of.prototype.onEnd=function(e){e===oc&&(this.result=s7.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};var og=function(e,t){let n,i,r,l,a,s,o,d,c,u,h,p,m,f,x,g,v,b,y,j,w,_,k,C;let z=e.state;n=e.next_in,k=e.input,i=n+(e.avail_in-5),r=e.next_out,C=e.output,l=r-(t-e.avail_out),a=r+(e.avail_out-257),s=z.dmax,o=z.wsize,d=z.whave,c=z.wnext,u=z.window,h=z.hold,p=z.bits,m=z.lencode,f=z.distcode,x=(1<<z.lenbits)-1,g=(1<<z.distbits)-1;e:do for(p<15&&(h+=k[n++]<<p,p+=8,h+=k[n++]<<p,p+=8),v=m[h&x];;){if(h>>>=b=v>>>24,p-=b,0==(b=v>>>16&255))C[r++]=65535&v;else if(16&b)for(y=65535&v,(b&=15)&&(p<b&&(h+=k[n++]<<p,p+=8),y+=h&(1<<b)-1,h>>>=b,p-=b),p<15&&(h+=k[n++]<<p,p+=8,h+=k[n++]<<p,p+=8),v=f[h&g];;){if(h>>>=b=v>>>24,p-=b,16&(b=v>>>16&255)){if(j=65535&v,p<(b&=15)&&(h+=k[n++]<<p,(p+=8)<b&&(h+=k[n++]<<p,p+=8)),(j+=h&(1<<b)-1)>s){e.msg="invalid distance too far back",z.mode=16209;break e}if(h>>>=b,p-=b,j>(b=r-l)){if((b=j-b)>d&&z.sane){e.msg="invalid distance too far back",z.mode=16209;break e}if(w=0,_=u,0===c){if(w+=o-b,b<y){y-=b;do C[r++]=u[w++];while(--b);w=r-j,_=C}}else if(c<b){if(w+=o+c-b,(b-=c)<y){y-=b;do C[r++]=u[w++];while(--b);if(w=0,c<y){y-=b=c;do C[r++]=u[w++];while(--b);w=r-j,_=C}}}else if(w+=c-b,b<y){y-=b;do C[r++]=u[w++];while(--b);w=r-j,_=C}for(;y>2;)C[r++]=_[w++],C[r++]=_[w++],C[r++]=_[w++],y-=3;y&&(C[r++]=_[w++],y>1&&(C[r++]=_[w++]))}else{w=r-j;do C[r++]=C[w++],C[r++]=C[w++],C[r++]=C[w++],y-=3;while(y>2);y&&(C[r++]=C[w++],y>1&&(C[r++]=C[w++]))}}else if((64&b)==0){v=f[(65535&v)+(h&(1<<b)-1)];continue}else{e.msg="invalid distance code",z.mode=16209;break e}break}else if((64&b)==0){v=m[(65535&v)+(h&(1<<b)-1)];continue}else if(32&b){z.mode=16191;break e}else{e.msg="invalid literal/length code",z.mode=16209;break e}break}while(n<i&&r<a);n-=y=p>>3,p-=y<<3,h&=(1<<p)-1,e.next_in=n,e.next_out=r,e.avail_in=n<i?5+(i-n):5-(n-i),e.avail_out=r<a?257+(a-r):257-(r-a),z.hold=h,z.bits=p};let ov=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),ob=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),oy=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),oj=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]);var ow=(e,t,n,i,r,l,a,s)=>{let o,d,c,u,h,p,m,f,x;let g=s.bits,v=0,b=0,y=0,j=0,w=0,_=0,k=0,C=0,z=0,E=0,I=null,S=new Uint16Array(16),P=new Uint16Array(16),T=null;for(v=0;v<=15;v++)S[v]=0;for(b=0;b<i;b++)S[t[n+b]]++;for(j=15,w=g;j>=1&&0===S[j];j--);if(w>j&&(w=j),0===j)return r[l++]=20971520,r[l++]=20971520,s.bits=1,0;for(y=1;y<j&&0===S[y];y++);for(w<y&&(w=y),C=1,v=1;v<=15;v++)if(C<<=1,(C-=S[v])<0)return -1;if(C>0&&(0===e||1!==j))return -1;for(v=1,P[1]=0;v<15;v++)P[v+1]=P[v]+S[v];for(b=0;b<i;b++)0!==t[n+b]&&(a[P[t[n+b]]++]=b);if(0===e?(I=T=a,p=20):1===e?(I=ov,T=ob,p=257):(I=oy,T=oj,p=0),E=0,b=0,v=y,h=l,_=w,k=0,c=-1,u=(z=1<<w)-1,1===e&&z>852||2===e&&z>592)return 1;for(;;){m=v-k,a[b]+1<p?(f=0,x=a[b]):a[b]>=p?(f=T[a[b]-p],x=I[a[b]-p]):(f=96,x=0),o=1<<v-k,y=d=1<<_;do r[h+(E>>k)+(d-=o)]=m<<24|f<<16|x|0;while(0!==d);for(o=1<<v-1;E&o;)o>>=1;if(0!==o?(E&=o-1,E+=o):E=0,b++,0==--S[v]){if(v===j)break;v=t[n+a[b]]}if(v>w&&(E&u)!==c){for(0===k&&(k=w),h+=y,C=1<<(_=v-k);_+k<j&&!((C-=S[_+k])<=0);)_++,C<<=1;if(z+=1<<_,1===e&&z>852||2===e&&z>592)return 1;r[c=E&u]=w<<24|_<<16|h-l|0}}return 0!==E&&(r[h+E]=v-k<<24|4194304),s.bits=w,0};let{Z_FINISH:o_,Z_BLOCK:ok,Z_TREES:oC,Z_OK:oz,Z_STREAM_END:oE,Z_NEED_DICT:oI,Z_STREAM_ERROR:oS,Z_DATA_ERROR:oP,Z_MEM_ERROR:oT,Z_BUF_ERROR:oM,Z_DEFLATED:oR}=sh,oO=e=>(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24);function oA(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}let oD=e=>{if(!e)return 1;let t=e.state;return!t||t.strm!==e||t.mode<16180||t.mode>16211?1:0},oL=e=>{if(oD(e))return oS;let t=e.state;return e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=1&t.wrap),t.mode=16180,t.last=0,t.havedict=0,t.flags=-1,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new Int32Array(852),t.distcode=t.distdyn=new Int32Array(592),t.sane=1,t.back=-1,oz},oN=e=>{if(oD(e))return oS;let t=e.state;return t.wsize=0,t.whave=0,t.wnext=0,oL(e)},oZ=(e,t)=>{let n;if(oD(e))return oS;let i=e.state;return(t<0?(n=0,t=-t):(n=(t>>4)+5,t<48&&(t&=15)),t&&(t<8||t>15))?oS:(null!==i.window&&i.wbits!==t&&(i.window=null),i.wrap=n,i.wbits=t,oN(e))},oU=(e,t)=>{if(!e)return oS;let n=new oA;e.state=n,n.strm=e,n.window=null,n.mode=16180;let i=oZ(e,t);return i!==oz&&(e.state=null),i},oB=!0,oF=e=>{if(oB){s=new Int32Array(512),o=new Int32Array(32);let t=0;for(;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(ow(1,e.lens,0,288,s,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;ow(2,e.lens,0,32,o,0,e.work,{bits:5}),oB=!1}e.lencode=s,e.lenbits=9,e.distcode=o,e.distbits=5},oq=(e,t,n,i)=>{let r;let l=e.state;return null===l.window&&(l.wsize=1<<l.wbits,l.wnext=0,l.whave=0,l.window=new Uint8Array(l.wsize)),i>=l.wsize?(l.window.set(t.subarray(n-l.wsize,n),0),l.wnext=0,l.whave=l.wsize):((r=l.wsize-l.wnext)>i&&(r=i),l.window.set(t.subarray(n-i,n-i+r),l.wnext),(i-=r)?(l.window.set(t.subarray(n-i,n),0),l.wnext=i,l.whave=l.wsize):(l.wnext+=r,l.wnext===l.wsize&&(l.wnext=0),l.whave<l.wsize&&(l.whave+=r))),0};var oH={inflateReset:oN,inflateReset2:oZ,inflateResetKeep:oL,inflateInit:e=>oU(e,15),inflateInit2:oU,inflate:(e,t)=>{let n,i,r,l,a,s,o,d,c,u,h,p,m,f,x,g,v,b,y,j,w,_,k,C;let z=0,E=new Uint8Array(4),I=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(oD(e)||!e.output||!e.input&&0!==e.avail_in)return oS;16191===(n=e.state).mode&&(n.mode=16192),a=e.next_out,r=e.output,o=e.avail_out,l=e.next_in,i=e.input,s=e.avail_in,d=n.hold,c=n.bits,u=s,h=o,_=oz;t:for(;;)switch(n.mode){case 16180:if(0===n.wrap){n.mode=16192;break}for(;c<16;){if(0===s)break t;s--,d+=i[l++]<<c,c+=8}if(2&n.wrap&&35615===d){0===n.wbits&&(n.wbits=15),n.check=0,E[0]=255&d,E[1]=d>>>8&255,n.check=sc(n.check,E,2,0),d=0,c=0,n.mode=16181;break}if(n.head&&(n.head.done=!1),!(1&n.wrap)||(((255&d)<<8)+(d>>8))%31){e.msg="incorrect header check",n.mode=16209;break}if((15&d)!==oR){e.msg="unknown compression method",n.mode=16209;break}if(d>>>=4,c-=4,w=(15&d)+8,0===n.wbits&&(n.wbits=w),w>15||w>n.wbits){e.msg="invalid window size",n.mode=16209;break}n.dmax=1<<n.wbits,n.flags=0,e.adler=n.check=1,n.mode=512&d?16189:16191,d=0,c=0;break;case 16181:for(;c<16;){if(0===s)break t;s--,d+=i[l++]<<c,c+=8}if(n.flags=d,(255&n.flags)!==oR){e.msg="unknown compression method",n.mode=16209;break}if(57344&n.flags){e.msg="unknown header flags set",n.mode=16209;break}n.head&&(n.head.text=d>>8&1),512&n.flags&&4&n.wrap&&(E[0]=255&d,E[1]=d>>>8&255,n.check=sc(n.check,E,2,0)),d=0,c=0,n.mode=16182;case 16182:for(;c<32;){if(0===s)break t;s--,d+=i[l++]<<c,c+=8}n.head&&(n.head.time=d),512&n.flags&&4&n.wrap&&(E[0]=255&d,E[1]=d>>>8&255,E[2]=d>>>16&255,E[3]=d>>>24&255,n.check=sc(n.check,E,4,0)),d=0,c=0,n.mode=16183;case 16183:for(;c<16;){if(0===s)break t;s--,d+=i[l++]<<c,c+=8}n.head&&(n.head.xflags=255&d,n.head.os=d>>8),512&n.flags&&4&n.wrap&&(E[0]=255&d,E[1]=d>>>8&255,n.check=sc(n.check,E,2,0)),d=0,c=0,n.mode=16184;case 16184:if(1024&n.flags){for(;c<16;){if(0===s)break t;s--,d+=i[l++]<<c,c+=8}n.length=d,n.head&&(n.head.extra_len=d),512&n.flags&&4&n.wrap&&(E[0]=255&d,E[1]=d>>>8&255,n.check=sc(n.check,E,2,0)),d=0,c=0}else n.head&&(n.head.extra=null);n.mode=16185;case 16185:if(1024&n.flags&&((p=n.length)>s&&(p=s),p&&(n.head&&(w=n.head.extra_len-n.length,n.head.extra||(n.head.extra=new Uint8Array(n.head.extra_len)),n.head.extra.set(i.subarray(l,l+p),w)),512&n.flags&&4&n.wrap&&(n.check=sc(n.check,i,p,l)),s-=p,l+=p,n.length-=p),n.length))break t;n.length=0,n.mode=16186;case 16186:if(2048&n.flags){if(0===s)break t;p=0;do w=i[l+p++],n.head&&w&&n.length<65536&&(n.head.name+=String.fromCharCode(w));while(w&&p<s);if(512&n.flags&&4&n.wrap&&(n.check=sc(n.check,i,p,l)),s-=p,l+=p,w)break t}else n.head&&(n.head.name=null);n.length=0,n.mode=16187;case 16187:if(4096&n.flags){if(0===s)break t;p=0;do w=i[l+p++],n.head&&w&&n.length<65536&&(n.head.comment+=String.fromCharCode(w));while(w&&p<s);if(512&n.flags&&4&n.wrap&&(n.check=sc(n.check,i,p,l)),s-=p,l+=p,w)break t}else n.head&&(n.head.comment=null);n.mode=16188;case 16188:if(512&n.flags){for(;c<16;){if(0===s)break t;s--,d+=i[l++]<<c,c+=8}if(4&n.wrap&&d!==(65535&n.check)){e.msg="header crc mismatch",n.mode=16209;break}d=0,c=0}n.head&&(n.head.hcrc=n.flags>>9&1,n.head.done=!0),e.adler=n.check=0,n.mode=16191;break;case 16189:for(;c<32;){if(0===s)break t;s--,d+=i[l++]<<c,c+=8}e.adler=n.check=oO(d),d=0,c=0,n.mode=16190;case 16190:if(0===n.havedict)return e.next_out=a,e.avail_out=o,e.next_in=l,e.avail_in=s,n.hold=d,n.bits=c,oI;e.adler=n.check=1,n.mode=16191;case 16191:if(t===ok||t===oC)break t;case 16192:if(n.last){d>>>=7&c,c-=7&c,n.mode=16206;break}for(;c<3;){if(0===s)break t;s--,d+=i[l++]<<c,c+=8}switch(n.last=1&d,c-=1,3&(d>>>=1)){case 0:n.mode=16193;break;case 1:if(oF(n),n.mode=16199,t===oC){d>>>=2,c-=2;break t}break;case 2:n.mode=16196;break;case 3:e.msg="invalid block type",n.mode=16209}d>>>=2,c-=2;break;case 16193:for(d>>>=7&c,c-=7&c;c<32;){if(0===s)break t;s--,d+=i[l++]<<c,c+=8}if((65535&d)!=(d>>>16^65535)){e.msg="invalid stored block lengths",n.mode=16209;break}if(n.length=65535&d,d=0,c=0,n.mode=16194,t===oC)break t;case 16194:n.mode=16195;case 16195:if(p=n.length){if(p>s&&(p=s),p>o&&(p=o),0===p)break t;r.set(i.subarray(l,l+p),a),s-=p,l+=p,o-=p,a+=p,n.length-=p;break}n.mode=16191;break;case 16196:for(;c<14;){if(0===s)break t;s--,d+=i[l++]<<c,c+=8}if(n.nlen=(31&d)+257,d>>>=5,c-=5,n.ndist=(31&d)+1,d>>>=5,c-=5,n.ncode=(15&d)+4,d>>>=4,c-=4,n.nlen>286||n.ndist>30){e.msg="too many length or distance symbols",n.mode=16209;break}n.have=0,n.mode=16197;case 16197:for(;n.have<n.ncode;){for(;c<3;){if(0===s)break t;s--,d+=i[l++]<<c,c+=8}n.lens[I[n.have++]]=7&d,d>>>=3,c-=3}for(;n.have<19;)n.lens[I[n.have++]]=0;if(n.lencode=n.lendyn,n.lenbits=7,k={bits:n.lenbits},_=ow(0,n.lens,0,19,n.lencode,0,n.work,k),n.lenbits=k.bits,_){e.msg="invalid code lengths set",n.mode=16209;break}n.have=0,n.mode=16198;case 16198:for(;n.have<n.nlen+n.ndist;){for(;x=(z=n.lencode[d&(1<<n.lenbits)-1])>>>24,g=z>>>16&255,v=65535&z,!(x<=c);){if(0===s)break t;s--,d+=i[l++]<<c,c+=8}if(v<16)d>>>=x,c-=x,n.lens[n.have++]=v;else{if(16===v){for(C=x+2;c<C;){if(0===s)break t;s--,d+=i[l++]<<c,c+=8}if(d>>>=x,c-=x,0===n.have){e.msg="invalid bit length repeat",n.mode=16209;break}w=n.lens[n.have-1],p=3+(3&d),d>>>=2,c-=2}else if(17===v){for(C=x+3;c<C;){if(0===s)break t;s--,d+=i[l++]<<c,c+=8}d>>>=x,c-=x,w=0,p=3+(7&d),d>>>=3,c-=3}else{for(C=x+7;c<C;){if(0===s)break t;s--,d+=i[l++]<<c,c+=8}d>>>=x,c-=x,w=0,p=11+(127&d),d>>>=7,c-=7}if(n.have+p>n.nlen+n.ndist){e.msg="invalid bit length repeat",n.mode=16209;break}for(;p--;)n.lens[n.have++]=w}}if(16209===n.mode)break;if(0===n.lens[256]){e.msg="invalid code -- missing end-of-block",n.mode=16209;break}if(n.lenbits=9,k={bits:n.lenbits},_=ow(1,n.lens,0,n.nlen,n.lencode,0,n.work,k),n.lenbits=k.bits,_){e.msg="invalid literal/lengths set",n.mode=16209;break}if(n.distbits=6,n.distcode=n.distdyn,k={bits:n.distbits},_=ow(2,n.lens,n.nlen,n.ndist,n.distcode,0,n.work,k),n.distbits=k.bits,_){e.msg="invalid distances set",n.mode=16209;break}if(n.mode=16199,t===oC)break t;case 16199:n.mode=16200;case 16200:if(s>=6&&o>=258){e.next_out=a,e.avail_out=o,e.next_in=l,e.avail_in=s,n.hold=d,n.bits=c,og(e,h),a=e.next_out,r=e.output,o=e.avail_out,l=e.next_in,i=e.input,s=e.avail_in,d=n.hold,c=n.bits,16191===n.mode&&(n.back=-1);break}for(n.back=0;x=(z=n.lencode[d&(1<<n.lenbits)-1])>>>24,g=z>>>16&255,v=65535&z,!(x<=c);){if(0===s)break t;s--,d+=i[l++]<<c,c+=8}if(g&&(240&g)==0){for(b=x,y=g,j=v;x=(z=n.lencode[j+((d&(1<<b+y)-1)>>b)])>>>24,g=z>>>16&255,v=65535&z,!(b+x<=c);){if(0===s)break t;s--,d+=i[l++]<<c,c+=8}d>>>=b,c-=b,n.back+=b}if(d>>>=x,c-=x,n.back+=x,n.length=v,0===g){n.mode=16205;break}if(32&g){n.back=-1,n.mode=16191;break}if(64&g){e.msg="invalid literal/length code",n.mode=16209;break}n.extra=15&g,n.mode=16201;case 16201:if(n.extra){for(C=n.extra;c<C;){if(0===s)break t;s--,d+=i[l++]<<c,c+=8}n.length+=d&(1<<n.extra)-1,d>>>=n.extra,c-=n.extra,n.back+=n.extra}n.was=n.length,n.mode=16202;case 16202:for(;x=(z=n.distcode[d&(1<<n.distbits)-1])>>>24,g=z>>>16&255,v=65535&z,!(x<=c);){if(0===s)break t;s--,d+=i[l++]<<c,c+=8}if((240&g)==0){for(b=x,y=g,j=v;x=(z=n.distcode[j+((d&(1<<b+y)-1)>>b)])>>>24,g=z>>>16&255,v=65535&z,!(b+x<=c);){if(0===s)break t;s--,d+=i[l++]<<c,c+=8}d>>>=b,c-=b,n.back+=b}if(d>>>=x,c-=x,n.back+=x,64&g){e.msg="invalid distance code",n.mode=16209;break}n.offset=v,n.extra=15&g,n.mode=16203;case 16203:if(n.extra){for(C=n.extra;c<C;){if(0===s)break t;s--,d+=i[l++]<<c,c+=8}n.offset+=d&(1<<n.extra)-1,d>>>=n.extra,c-=n.extra,n.back+=n.extra}if(n.offset>n.dmax){e.msg="invalid distance too far back",n.mode=16209;break}n.mode=16204;case 16204:if(0===o)break t;if(p=h-o,n.offset>p){if((p=n.offset-p)>n.whave&&n.sane){e.msg="invalid distance too far back",n.mode=16209;break}p>n.wnext?(p-=n.wnext,m=n.wsize-p):m=n.wnext-p,p>n.length&&(p=n.length),f=n.window}else f=r,m=a-n.offset,p=n.length;p>o&&(p=o),o-=p,n.length-=p;do r[a++]=f[m++];while(--p);0===n.length&&(n.mode=16200);break;case 16205:if(0===o)break t;r[a++]=n.length,o--,n.mode=16200;break;case 16206:if(n.wrap){for(;c<32;){if(0===s)break t;s--,d|=i[l++]<<c,c+=8}if(h-=o,e.total_out+=h,n.total+=h,4&n.wrap&&h&&(e.adler=n.check=n.flags?sc(n.check,r,h,a-h):so(n.check,r,h,a-h)),h=o,4&n.wrap&&(n.flags?d:oO(d))!==n.check){e.msg="incorrect data check",n.mode=16209;break}d=0,c=0}n.mode=16207;case 16207:if(n.wrap&&n.flags){for(;c<32;){if(0===s)break t;s--,d+=i[l++]<<c,c+=8}if(4&n.wrap&&d!==(4294967295&n.total)){e.msg="incorrect length check",n.mode=16209;break}d=0,c=0}n.mode=16208;case 16208:_=oE;break t;case 16209:_=oP;break t;case 16210:return oT;default:return oS}return e.next_out=a,e.avail_out=o,e.next_in=l,e.avail_in=s,n.hold=d,n.bits=c,(n.wsize||h!==e.avail_out&&n.mode<16209&&(n.mode<16206||t!==o_))&&oq(e,e.output,e.next_out,h-e.avail_out),u-=e.avail_in,h-=e.avail_out,e.total_in+=u,e.total_out+=h,n.total+=h,4&n.wrap&&h&&(e.adler=n.check=n.flags?sc(n.check,r,h,e.next_out-h):so(n.check,r,h,e.next_out-h)),e.data_type=n.bits+(n.last?64:0)+(16191===n.mode?128:0)+(16199===n.mode||16194===n.mode?256:0),(0===u&&0===h||t===o_)&&_===oz&&(_=oM),_},inflateEnd:e=>{if(oD(e))return oS;let t=e.state;return t.window&&(t.window=null),e.state=null,oz},inflateGetHeader:(e,t)=>{if(oD(e))return oS;let n=e.state;return(2&n.wrap)==0?oS:(n.head=t,t.done=!1,oz)},inflateSetDictionary:(e,t)=>{let n;let i=t.length;return oD(e)||0!==(n=e.state).wrap&&16190!==n.mode?oS:16190===n.mode&&so(1,t,i,0)!==n.check?oP:oq(e,t,i,i)?(n.mode=16210,oT):(n.havedict=1,oz)},inflateInfo:"pako inflate (from Nodeca project)"},oV=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1};let oW=Object.prototype.toString,{Z_NO_FLUSH:oK,Z_FINISH:o$,Z_OK:oY,Z_STREAM_END:oX,Z_NEED_DICT:oG,Z_STREAM_ERROR:oQ,Z_DATA_ERROR:oJ,Z_MEM_ERROR:o0}=sh;function o1(e){this.options=s7.assign({chunkSize:65536,windowBits:15,to:""},e||{});let t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,0===t.windowBits&&(t.windowBits=-15)),t.windowBits>=0&&t.windowBits<16&&!(e&&e.windowBits)&&(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&(15&t.windowBits)==0&&(t.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new or,this.strm.avail_out=0;let n=oH.inflateInit2(this.strm,t.windowBits);if(n!==oY||(this.header=new oV,oH.inflateGetHeader(this.strm,this.header),t.dictionary&&("string"==typeof t.dictionary?t.dictionary=oi.string2buf(t.dictionary):"[object ArrayBuffer]"===oW.call(t.dictionary)&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&(n=oH.inflateSetDictionary(this.strm,t.dictionary))!==oY)))throw Error(su[n])}function o2(e,t){let n=new o1(t);if(n.push(e),n.err)throw n.msg||su[n.err];return n.result}o1.prototype.push=function(e,t){let n,i,r;let l=this.strm,a=this.options.chunkSize,s=this.options.dictionary;if(this.ended)return!1;for(i=t===~~t?t:!0===t?o$:oK,"[object ArrayBuffer]"===oW.call(e)?l.input=new Uint8Array(e):l.input=e,l.next_in=0,l.avail_in=l.input.length;;){for(0===l.avail_out&&(l.output=new Uint8Array(a),l.next_out=0,l.avail_out=a),(n=oH.inflate(l,i))===oG&&s&&((n=oH.inflateSetDictionary(l,s))===oY?n=oH.inflate(l,i):n===oJ&&(n=oG));l.avail_in>0&&n===oX&&l.state.wrap>0&&0!==e[l.next_in];)oH.inflateReset(l),n=oH.inflate(l,i);switch(n){case oQ:case oJ:case oG:case o0:return this.onEnd(n),this.ended=!0,!1}if(r=l.avail_out,l.next_out&&(0===l.avail_out||n===oX)){if("string"===this.options.to){let e=oi.utf8border(l.output,l.next_out),t=l.next_out-e,n=oi.buf2string(l.output,e);l.next_out=t,l.avail_out=a-t,t&&l.output.set(l.output.subarray(e,e+t),0),this.onData(n)}else this.onData(l.output.length===l.next_out?l.output:l.output.subarray(0,l.next_out))}if(n!==oY||0!==r){if(n===oX)return n=oH.inflateEnd(this.strm),this.onEnd(n),this.ended=!0,!0;if(0===l.avail_in)break}}return!0},o1.prototype.onData=function(e){this.chunks.push(e)},o1.prototype.onEnd=function(e){e===oY&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=s7.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};let{Deflate:o5,deflate:o3,deflateRaw:o6,gzip:o8}={Deflate:of,deflate:ox,deflateRaw:function(e,t){return(t=t||{}).raw=!0,ox(e,t)},gzip:function(e,t){return(t=t||{}).gzip=!0,ox(e,t)},constants:sh},{Inflate:o4,inflate:o9,inflateRaw:o7,ungzip:de}={Inflate:o1,inflate:o2,inflateRaw:function(e,t){return(t=t||{}).raw=!0,o2(e,t)},ungzip:o2,constants:sh};var dt={Deflate:o5,deflate:o3,deflateRaw:o6,gzip:o8,Inflate:o4,inflate:o9,inflateRaw:o7,ungzip:de,constants:sh};function dn(e,t){return di(e)?e[Number(t)]:e[t]}function di(e){return Array.isArray(e)}function dr(e){return e&&"object"==typeof e}function dl(e,t,n){if(di(e)){e[Number(t)]=n;return}if(dr(e)){e[t]=n;return}throw Error("shallowClone: target must be an object or an array")}function da(e){if(di(e))return e.slice(0);if(dr(e))return function(e,t){var n;for(n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}({},e);throw Error("shallowClone: source must be an object or an array")}let ds=[],dd={},dc=[{name:"auto",title:"Full",rect:{width:"auto"}},{name:"768",title:"768px",rect:{width:768}},{name:"375",title:"375px",rect:{width:375,height:667}},{name:"320",title:"320px",rect:{width:320,height:568}}],du=[{value:.5,title:"50%"},{value:.75,title:"75%"},{value:1,title:"100%"},{value:1.5,title:"150%"},{value:2,title:"200%"},{value:3,title:"300%"}];function dh(){let e=new Set;return{publish(t){for(let n of e)n(t)},subscribe:t=>(e.add(t),()=>{e.delete(t)})}}let dp={parse(e){let t=new URLSearchParams("?"+e),n={};return t.forEach((e,t)=>{n[t]=e}),n},stringify:e=>Object.entries(e).map(e=>{let[t,n]=e;return"".concat(t,"=").concat(n)}).join("&")};function dm(e){let{baseUrl:t="/frame/",path:n,payload:i,scheme:r,viewport:l,zoom:a}=e;return[t,"?path=".concat(encodeURIComponent(n)),"&scheme=".concat(r),"&viewport=".concat(l),"&zoom=".concat(a),...Object.entries(i).map(e=>{let[t,n]=e;return"&".concat(t,"=").concat(n)})].join("")}let df=(0,td.createContext)(null);function dx(){let e=(0,td.useContext)(df);if(!e)throw Error("Props: missing context value");return e}let dg=(0,td.memo)(function(e){let{schema:t,value:n}=e,{setPropValue:i}=dx();return(0,tc.jsxs)(tp.kC,{as:"label",padding:3,children:[(0,tc.jsx)(tp.xu,{marginRight:2,style:{lineHeight:0},children:(0,tc.jsx)(tp.XZ,{checked:n||!1,onChange:e=>i(t.name,e.currentTarget.checked)})}),(0,tc.jsx)(tp.xu,{paddingY:1,children:(0,tc.jsx)(tp.xv,{size:1,weight:"semibold",children:t.name})})]})}),dv=(0,td.memo)(function(e){let{schema:t,value:n=""}=e,{setPropValue:i}=dx();return(0,tc.jsxs)(tp.xu,{padding:3,children:[(0,tc.jsx)(tp.xv,{size:1,weight:"semibold",children:t.name}),(0,tc.jsx)(tp.xu,{marginTop:2,children:(0,tc.jsx)(tp.oi,{fontSize:[2,2,1],onChange:e=>i(t.name,Number(e.currentTarget.value)),padding:2,value:n})})]})}),db=(0,td.memo)(function(e){let{schema:t,value:n}=e,{setPropValue:i}=dx(),r=(0,td.useMemo)(()=>{for(let[e,i]of Object.entries(t.options))if(i===n)return e;return""},[t,n]);return(0,tc.jsxs)(tp.xu,{padding:3,children:[(0,tc.jsx)(tp.xv,{size:1,weight:"semibold",children:t.name}),(0,tc.jsx)(tp.xu,{marginTop:2,children:(0,tc.jsx)(tp.Ph,{fontSize:[2,2,1],onChange:e=>{let n=e.currentTarget.value,r=t.options[n];i(t.name,r)},padding:2,radius:2,value:String(r||""),children:Object.entries(t.options).map(e=>{let[t]=e;return(0,tc.jsx)("option",{value:t,children:t},t)})})})]})}),dy=(0,td.memo)(function(e){let{schema:t,value:n}=e,{setPropValue:i}=dx();return(0,tc.jsxs)(tp.xu,{padding:3,children:[(0,tc.jsx)(tp.xv,{size:1,weight:"semibold",children:t.name}),(0,tc.jsx)(tp.xu,{marginTop:2,children:(0,tc.jsx)(tp.oi,{fontSize:[2,2,1],onChange:e=>i(t.name,e.currentTarget.value),padding:2,value:n||""})})]})}),dj=(0,td.memo)(function(e){let{schema:t,value:n}=e,{setPropValue:i}=dx();return(0,tc.jsxs)(tp.xu,{padding:3,children:[(0,tc.jsx)(tp.xv,{size:1,weight:"semibold",children:t.name}),(0,tc.jsx)(tp.xu,{marginTop:2,children:(0,tc.jsx)(tp.Kx,{fontSize:[2,2,1],onChange:e=>i(t.name,e.currentTarget.value),rows:4,value:n||""})})]})});function dw(e){let{schema:t,value:n}=e;return"boolean"===t.type?(0,tc.jsx)(dg,{schema:t,value:n}):"number"===t.type?(0,tc.jsx)(dv,{schema:t,value:n}):"select"===t.type?(0,tc.jsx)(db,{schema:t,value:n}):"string"===t.type?(0,tc.jsx)(dy,{schema:t,value:n}):"text"===t.type?(0,tc.jsx)(dj,{schema:t,value:n}):(0,tc.jsx)(tp.xu,{padding:2,children:(0,tc.jsxs)(tp.xv,{size:1,weight:"semibold",children:["Unknown Prop type:"," ",(0,tc.jsxs)("code",{children:[t.name,": ",t.type]})]})})}let d_=(0,td.memo)(function(){let{schemas:e,value:t}=dx();return(0,tc.jsxs)(tp.xu,{padding:2,children:[0===e.length&&(0,tc.jsx)(tp.xu,{padding:2,children:(0,tc.jsx)(tp.xv,{muted:!0,size:[2,2,1],children:"No properties"})}),e.length>0&&e.map((e,n)=>(0,tc.jsx)(dw,{schema:e,value:void 0===t[e.name]?e.defaultValue:t[e.name]},n))]})}),dk=ne(),dC=(0,td.createContext)(null);function dz(){let e=(0,td.useContext)(dC);if(!e)throw Error("Workshop: missing context value");return e}let dE="undefined"==typeof window?e=>nH.from(e,"binary").toString("base64"):window.btoa,dI="undefined"==typeof window?e=>nH.from(e,"base64").toString("binary"):window.atob;function dS(e){try{return JSON.parse(function(e){if(0===e.length)return"";let t=function(e){let t=dI(e),n=t.length,i=new Uint8Array(n);for(let e=0;e<n;e++)i[e]=t.charCodeAt(e);return i}(e);return dt.inflate(t,{to:"string"})}(e))}catch(e){return{}}}let dP=(0,td.memo)(function(e){let{children:t}=e,{channel:n,broadcast:i,payload:r}=dz(),l=r.value,a=(0,td.useRef)(l),[{schemas:s,value:o},d]=(0,td.useState)({schemas:[],value:dS(String(l))||{}}),c=(0,td.useCallback)(e=>{i({type:"workshop/props/registerProp",schema:e})},[i]),u=(0,td.useCallback)(e=>{i({type:"workshop/props/unregisterProp",name:e})},[i]),h=(0,td.useCallback)((e,t)=>{i({type:"workshop/props/setPropValue",name:e,value:t})},[i]),p=(0,td.useMemo)(()=>({registerProp:c,schemas:s,setPropValue:h,unregisterProp:u,value:o}),[c,s,h,u,o]);return(0,td.useEffect)(()=>n.subscribe(e=>{d(t=>{let n=function(e,t){if("workshop/props/setValue"===t.type)return{...e,value:t.value};if("workshop/props/registerProp"===t.type)return{...e,schemas:e.schemas.concat([t.schema])};if("workshop/props/unregisterProp"===t.type){let n={...e.value};return delete n[t.name],{...e,schemas:e.schemas.filter(e=>e.name!==t.name),value:n}}return"workshop/props/setPropValue"===t.type?{...e,value:{...e.value,[t.name]:t.value}}:e}(t,e);return dk(t,n)?t:n})}),[n]),(0,td.useEffect)(()=>{var e;let t=0===(e=JSON.stringify(o)).length?"":function(e){let t="";for(let n=0,{length:i}=e;n<i;n++)t+=String.fromCharCode(e[n]);return dE(t)}(dt.deflate(e));a.current!==t&&(a.current=t,i({type:"workshop/setPayloadValue",key:"value",value:t}))},[i,o]),(0,td.useEffect)(()=>{a.current!==l&&(a.current=l,d(e=>({...e,value:dS(String(l))||{}})))},[l]),(0,tc.jsx)(df.Provider,{value:p,children:t})}),dT=(0,td.memo)(function(e){let{broadcast:t,children:n,channel:i,config:r,frameReady:l,origin:a,path:s,payload:o,scheme:d,viewport:c="auto",zoom:u=1}=e,{plugins:h=ds,collections:p=ds,frameUrl:m="/frame/",scopes:f,title:x="Workshop"}=r;if(!o)throw Error("missing `payload` property");let g=(0,td.useMemo)(()=>[{name:"props",title:"Properties",inspector:d_,provider:dP},...h],[h]),{scope:v,story:b}=(0,td.useMemo)(()=>(function(e,t){let n=t.split("/").slice(1).filter(Boolean),i=n.join("/");if(0===n.length)return{scope:null,story:null};for(let t of e)for(let e of t.stories)if(i===[t.name,e.name].filter(Boolean).join("/"))return{scope:t,story:e};return{scope:null,story:null}})(f,s),[s,f]),y=(0,td.useMemo)(()=>({plugins:g,broadcast:t,channel:i,collections:p,frameReady:l,frameUrl:m,origin:a,path:s,payload:o,scheme:d,scope:v,scopes:f,story:b,title:x,viewport:c,zoom:u}),[g,t,i,p,l,m,a,s,o,d,v,f,b,x,c,u]),j=n;for(let e of g)e.provider&&(j=(0,td.createElement)(e.provider,{options:e.options||dd},j));return(0,tc.jsx)(dC.Provider,{value:y,children:j})});function dM(e,t){if("workshop/frameReady"===t.type)return{...e,frameReady:!0};if("workshop/setState"===t.type)return dk(e,t.value)?e:t.value;if("workshop/setZoom"===t.type)return e.zoom===t.value?e:{...e,zoom:t.value};if("workshop/setViewport"===t.type)return e.viewport===t.value?e:{...e,viewport:t.value};if("workshop/toggleScheme"===t.type)return{...e,scheme:"light"===e.scheme?"dark":"light"};if("workshop/setScheme"===t.type)return e.scheme===t.value?e:{...e,scheme:t.value};if("workshop/setPath"===t.type)return e.path===t.value?e:{...e,path:t.value};if("workshop/setPayload"===t.type)return dk(e.payload,t.value)?e:{...e,payload:t.value};if("workshop/setPayloadValue"===t.type){let n={...e.payload,[t.key]:t.value};return dk(e.payload,n)?e:{...e,payload:n}}return e}let dR=(()=>{try{return nV.env.ROOT_PATH}catch(e){return}})(),dO=/http:\/\/([^:/\s]+)(:[0-9]+)?/g,dA=/\/@fs\//g,dD=/\?([a-z]{1})=([0-9]+)/g;function dL(e){let t=decodeURIComponent(e);return(t=e.replace(dO,"").replace(dA,"/").replace(dD,""),dR)?function(e,t){let n=RegExp(t.replace(/\//g,"\\/"),"g");return e.replace(n,"")}(t,dR+"/"):t}let dN=(0,td.memo)(function(){let{story:e}=dz(),[t,n]=(0,td.useState)({error:null,errorInfo:null}),i=(0,td.useCallback)(e=>{let{error:t,info:i}=e;n({error:t,errorInfo:i})},[]),r=(0,td.useCallback)(()=>{n({error:null,errorInfo:null})},[]);return e?t.error?(0,tc.jsx)(tp.Zb,{as:"main",height:"fill",overflow:"auto",tone:"critical",children:(0,tc.jsx)(dU,{error:t.error,errorInfo:t.errorInfo,onRetry:r})}):(0,tc.jsxs)(tc.Fragment,{children:[(0,tc.jsx)("h1",{hidden:!0,children:e.title}),(0,tc.jsx)(td.Suspense,{fallback:(0,tc.jsx)(dZ,{story:e}),children:(0,tc.jsx)(tp.Zb,{as:"main",height:"fill",children:(0,tc.jsx)(tp.SV,{onCatch:i,children:(0,td.createElement)(e.component)})})})]}):(0,tc.jsx)(tc.Fragment,{})}),dZ=(0,td.memo)(function(e){let{story:t}=e;return(0,tc.jsxs)(tc.Fragment,{children:[(0,tc.jsxs)("h1",{hidden:!0,children:["Loading ",(0,tc.jsx)("em",{children:t.title}),"…"]}),(0,tc.jsx)(tp.kC,{align:"center",as:"main",height:"fill",justify:"center",children:(0,tc.jsx)(tp.$j,{muted:!0})})]})}),dU=(0,td.memo)(function(e){let{error:t,errorInfo:n,onRetry:i}=e;return(0,tc.jsx)(tp.xu,{padding:4,children:(0,tc.jsxs)(tp.Kq,{space:4,children:[(0,tc.jsx)(tp.X6,{as:"h1",size:[1,1,2],children:t.message}),(0,tc.jsx)(tp.xu,{children:(0,tc.jsx)(tp.zx,{onClick:i,text:"Retry"})}),t.stack&&(0,tc.jsx)(tp.EK,{size:1,children:dL(t.stack)}),n&&(0,tc.jsx)(tp.EK,{size:1,children:"Component stack:"+dL(n.componentStack)})]})})});function dB(e){return Array.isArray(e)}function dF(e){return!!e&&"object"==typeof e&&!Array.isArray(e)}(0,td.memo)(function(e){let{config:t,setScheme:n}=e,i=(0,td.useMemo)(()=>(function(){let e=new Set,t=[],n=null;function i(t){let n=t.data;if(dB(n)){for(let t of n)if(dF(t)&&"string"==typeof t.type&&t.type.startsWith("workshop/"))for(let n of e)n(t)}}return{message:{publish(e){t.push(e),n&&clearInterval(n),n=setTimeout(()=>{window.parent.postMessage(t),t=[],n=null},0)},subscribe:t=>(e.add(t),1===e.size&&window.addEventListener("message",i,!1),()=>{e.delete(t),0===e.size&&window.removeEventListener("message",i,!1)})}}})(),[]),r=(0,td.useMemo)(()=>dh(),[]),[l,a]=(0,td.useState)(null),[s,o]=(0,td.useState)(null),d=(0,td.useCallback)(e=>{r.publish(e),i.message.publish(e)},[r,i]),[{frameReady:c,path:u,payload:h,scheme:p,viewport:m,zoom:f},x]=(0,td.useState)(()=>(function(){let{path:e="/",scheme:t,viewport:n,zoom:i,...r}="undefined"==typeof window?{}:dp.parse(window.location.search.slice(1));return{frameReady:!1,path:e,payload:r,scheme:"string"==typeof t?t:"light",viewport:"string"==typeof n?n:"auto",zoom:"string"==typeof i?Number(i):1}})());return(0,td.useEffect)(()=>r.subscribe(e=>x(t=>dM(t,e))),[r]),(0,td.useEffect)(()=>i.message.subscribe(r.publish),[r,i]),(0,td.useEffect)(()=>n(p),[n,p]),(0,td.useEffect)(()=>d({type:"workshop/frameReady"}),[d]),(0,tc.jsx)(tp.VW,{children:(0,tc.jsx)(tp.NM,{element:l,children:(0,tc.jsx)(tp.Xp,{element:s,children:(0,tc.jsx)(dT,{broadcast:d,config:t,channel:r,frameReady:c,origin:"frame",path:u,payload:h,scheme:p,viewport:m,zoom:f,children:(0,tc.jsxs)(tp.Zb,{height:"fill",ref:a,children:[(0,tc.jsx)(dN,{}),(0,tc.jsx)("div",{"data-portal":"",ref:o})]})})})})})});var dq=Object.freeze,dH=Object.defineProperty;(0,tm.vJ)(ew||(ew=dq(dH(v=["\n  body {\n    background-color: ",";\n  }\n"],"raw",{value:dq(v.slice())}))),e=>{let{theme:t}=e;return t.sanity.color.base.bg});var dV=Object.freeze,dW=Object.defineProperty;let dK=(0,td.memo)(tp.OK),d$=(0,tm.ZP)(tp.Zb)(e_||(e_=dV(dW(b=["\n  line-height: 0;\n\n  @media screen and (max-width: ","px) {\n    text-align: center;\n  }\n"],"raw",{value:dV(b.slice())}))),e=>{let{theme:t}=e;return t.sanity.media[1]-1}),dY=(0,td.memo)(function(e){let{currentTabId:t,onTabChange:n,tabs:i}=e,r=(0,td.useMemo)(()=>({flex:"none",position:"sticky",top:0}),[]),l=(0,td.useMemo)(()=>i.map(e=>(0,tc.jsx)(dX,{onTabChange:n,selected:e.id===t,tab:e},e.id)),[t,n,i]);return(0,tc.jsx)(tp.mh,{style:r,children:(0,tc.jsx)(d$,{padding:2,shadow:1,children:(0,tc.jsx)(tp.td,{space:1,children:l})})})});function dX(e){let{onTabChange:t,selected:n,tab:i}=e,r=(0,td.useCallback)(()=>{t(i.id)},[t,i]);return(0,tc.jsx)(dK,{"aria-controls":"".concat(i.id,"-panel"),fontSize:[2,2,1],id:i.id,label:i.label,onClick:r,selected:n,tone:i.tone})}var dG=Object.freeze,dQ=Object.defineProperty;let dJ=(0,tm.ZP)(tp.Zb)(ek||(ek=dG(dQ(y=["\n  overflow: hidden;\n\n  @media screen and (min-width: ","px) {\n    border-left: 1px solid var(--card-border-color);\n    min-width: 180px;\n    max-width: 300px;\n    overflow: auto;\n  }\n"],"raw",{value:dG(y.slice())}))),e=>{let{theme:t}=e;return t.sanity.media[1]}),d0=(0,td.memo)(function(e){return(0,td.createElement)(e.component,{options:e.options})}),d1=(0,td.memo)(function(e){let{expanded:t}=e,{plugins:n}=dz(),i=(0,td.useMemo)(()=>n.filter(e=>e.inspector).map(e=>({id:e.name,label:e.title,tone:void 0,plugin:e})),[n]),[r,l]=(0,td.useState)(i.length>0?i[0].id:null),a=i.find(e=>e.id===r),s=i.length>1,o=(0,td.useMemo)(()=>t?["block"]:["none","none","block"],[t]);return(0,tc.jsx)(dJ,{display:o,flex:1,children:(0,tc.jsxs)(tp.kC,{direction:"column",height:"fill",children:[s&&(0,tc.jsx)(dY,{currentTabId:r,onTabChange:l,tabs:i}),s&&i.map(e=>(0,tc.jsx)(tp.x4,{"aria-labelledby":"".concat(e.id,"-tab"),flex:1,hidden:e.id!==r,id:"".concat(e.id,"-panel"),overflow:"auto",children:e.plugin.inspector&&(0,tc.jsx)(d0,{component:e.plugin.inspector,options:e.plugin.options||dd})},e.id)),!s&&(null==a?void 0:a.plugin.inspector)&&(0,tc.jsx)(tp.xu,{flex:1,overflow:"auto",children:(0,tc.jsx)(d0,{component:a.plugin.inspector,options:a.plugin.options||dd})})]})})}),d2=na();function d5(){let{broadcast:e,scope:t,story:n,title:i}=dz(),r=(0,td.useCallback)(t=>{t.preventDefault(),e({type:"workshop/setPath",value:"/"})},[e]);return(0,tc.jsx)(d3,{onHomeClick:r,scopeTitle:null==t?void 0:t.title,storyTitle:null==n?void 0:n.title,title:i})}let d3=(0,td.memo)(function(e){let{onHomeClick:t,scopeTitle:n,storyTitle:i,title:r}=e;return(0,tc.jsxs)(tp.Oo,{separator:(0,tc.jsx)(tp.xv,{muted:!0,size:[2,2,1],children:"/"}),space:2,children:[(0,tc.jsx)(tp.xv,{size:[2,2,1],weight:"bold",children:(0,tc.jsx)("a",{href:"/",onClick:t,style:{color:"inherit"},children:r})}),n&&(0,tc.jsx)(tp.xv,{align:"center",size:[2,2,1],children:n}),i&&(0,tc.jsx)(tp.xv,{size:[2,2,1],children:i})]})}),d6=(0,td.memo)(function(){let{frameUrl:e,path:t,payload:n,scheme:i,zoom:r,viewport:l}=dz(),a=(0,td.useMemo)(()=>"/"===t?void 0:dm({baseUrl:e,path:t,payload:n,scheme:i,zoom:r,viewport:l}),[e,t,n,i,r,l]);return(0,tc.jsx)(tp.zx,{as:a?"a":"button",disabled:!a,fontSize:1,href:a,iconRight:to.buG,mode:"ghost",padding:2,rel:"noopener noreferrer",target:"_blank",text:"Open story"})});function d8(){let{broadcast:e,scheme:t}=dz(),n=(0,td.useCallback)(()=>{e({type:"workshop/toggleScheme"})},[e]);return(0,tc.jsx)(d4,{dark:"dark"===t,onToggleScheme:n})}let d4=(0,td.memo)(function(e){let{dark:t,onToggleScheme:n}=e;return(0,tc.jsx)(tp.zx,{fontSize:1,icon:t?to.kLh:to.NWY,mode:"bleed",onClick:n,padding:2})}),d9=(0,td.memo)(function(){let{broadcast:e,story:t,viewport:n}=dz(),i=(0,td.useCallback)(t=>{e({type:"workshop/setViewport",value:t})},[e]);return(0,tc.jsx)(ce,{disabled:!t,setViewport:i,viewport:n})}),d7={constrainSize:!0,matchReferenceWidth:!0,placement:"bottom",portal:!0},ce=(0,td.memo)(function(e){var t;let{disabled:n,setViewport:i,viewport:r}=e;return(0,tc.jsx)(tp.j2,{button:(0,tc.jsx)(tp.zx,{disabled:n,fontSize:1,iconRight:to.GVG,mode:"ghost",padding:2,style:{minWidth:80},text:null==(t=dc.find(e=>e.name===r))?void 0:t.title}),id:"viewport-menu",menu:(0,tc.jsx)(tp.v2,{children:dc.map(e=>(0,tc.jsx)(tp.sN,{fontSize:1,onClick:()=>i(e.name),padding:2,selected:e.name===r,text:e.title},e.name))}),popover:d7})});function ct(){let{broadcast:e,story:t,zoom:n}=dz(),i=(0,td.useCallback)(t=>e({type:"workshop/setZoom",value:t}),[e]);return(0,tc.jsx)(ci,{disabled:!t,setZoom:i,zoom:n})}let cn={constrainSize:!0,matchReferenceWidth:!0,placement:"bottom",portal:!0},ci=(0,td.memo)(function(e){var t;let{disabled:n,setZoom:i,zoom:r}=e;return(0,tc.jsx)(tp.j2,{button:(0,tc.jsx)(tp.zx,{disabled:n,fontSize:1,iconRight:to.GVG,mode:"ghost",padding:2,style:{minWidth:80},text:null==(t=du.find(e=>e.value===r))?void 0:t.title}),id:"zoom-menu",menu:(0,tc.jsx)(tp.v2,{children:du.map(e=>(0,tc.jsx)(tp.sN,{fontSize:1,onClick:()=>i(e.value),padding:2,selected:e.value===r,text:e.title},e.value))}),popover:cn})}),cr=(0,td.memo)(function(e){let{inspectorExpanded:t,navigatorExpanded:n,onInspectorToggle:i,onNavigatorToggle:r}=e,l=(0,tp.d2)(),{story:a,title:s}=dz();return(0,tc.jsx)(tp.Zb,{borderBottom:!0,flex:"none",padding:2,style:{lineHeight:0},children:(0,tc.jsxs)(tp.kC,{gap:1,children:[(0,tc.jsx)(tp.xu,{display:["block","block","none"],flex:"none",children:(0,tc.jsx)(tp.zx,{"aria-label":"Open navigator",fontSize:[2,2,1],icon:to.Oqj,mode:"bleed",onClick:r,padding:2,selected:n})}),(0,tc.jsxs)(tp.kC,{flex:1,justify:["center","center","flex-start"],padding:2,sizing:"border",style:{minWidth:250},children:[l<2&&(0,tc.jsx)(tp.xv,{weight:"bold",children:(null==a?void 0:a.title)||s}),l>=2&&(0,tc.jsx)(d5,{})]}),(0,tc.jsx)(tp.xu,{display:["block","block","none"],flex:"none",children:(0,tc.jsx)(tp.zx,{"aria-label":"Open inspector",fontSize:[2,2,1],icon:to.d$S,mode:"bleed",onClick:i,padding:2,selected:t})}),(0,tc.jsx)(tp.xu,{display:["none","none","block"],flex:"none",children:(0,tc.jsxs)(tp.gF,{space:1,children:[(0,tc.jsx)(d6,{}),(0,tc.jsx)(d9,{}),(0,tc.jsx)(ct,{}),(0,tc.jsx)(d8,{})]})})]})})}),cl=(0,td.memo)(function(e){let{matches:t,onStoryClick:n}=e;return(0,tc.jsx)(tp.Kq,{space:1,children:t.map(e=>{let{scope:t,story:i}=e;return(0,tc.jsx)(tp.Zb,{as:"a","data-path":"/".concat(t.name,"/").concat(i.name),href:"/".concat(t.name,"/").concat(i.name),onClick:n,padding:2,radius:2,children:(0,tc.jsx)(tp.xv,{size:1,textOverflow:"ellipsis",children:[t.title||"",i.title].filter(Boolean).join(" / ")})},"".concat(t.name,"/").concat(i.name))})})}),ca=(0,td.memo)(function(e){let{items:t}=e;return(0,tc.jsx)(tp.mp,{space:1,children:(0,tc.jsx)(cs,{items:t})})}),cs=(0,td.memo)(function(e){let{basePath:t="",items:n}=e,{broadcast:i,path:r,scope:l,story:a}=dz(),s=(0,td.useCallback)(e=>{e.preventDefault();let t=e.currentTarget.getAttribute("data-path");t&&i({type:"workshop/setPath",value:t})},[i]);return(0,td.useMemo)(()=>0===n.length?null:(0,tc.jsx)(tc.Fragment,{children:n.map((e,n)=>{if("list"===e.type){let i="".concat(t,"/").concat(e.name);return(0,tc.jsx)(co,{expanded:r.startsWith(i+"/"),item:e,path:i},e.name||n)}return"story"===e.type?(0,tc.jsx)(tp.kf,{"data-path":"/".concat(e.name||""),fontSize:[2,2,1],href:"/".concat(e.name||""),onClick:s,padding:2,selected:(null==a?void 0:a.component)===e.component,text:e.title},e.name):"scope"===e.type?(0,tc.jsx)(cd,{currentStory:a,expanded:e.scope===l,item:e,onStoryClick:s},e.name):(0,tc.jsx)(tp.kf,{text:"unknown"},n)})}),[t,l,a,s,n,r])}),co=(0,td.memo)(function(e){let{expanded:t,item:n,path:i}=e,r=(0,td.useMemo)(()=>(0,tc.jsx)(cs,{basePath:i,items:n.items}),[n,i]);return(0,tc.jsx)(tp.kf,{expanded:t,fontSize:[2,2,1],padding:2,text:n.title,weight:"semibold",children:r})}),cd=(0,td.memo)(function(e){let{currentStory:t,expanded:n,item:i,onStoryClick:r}=e,l=(0,td.useMemo)(()=>i.scope.stories.map(e=>(0,tc.jsx)(tp.kf,{"data-path":"/".concat(i.scope.name,"/").concat(e.name),fontSize:[2,2,1],href:"/".concat(i.scope.name,"/").concat(e.name),onClick:r,padding:2,selected:t===e,text:e.title},e.name)),[t,i,r]);return(0,tc.jsx)(tp.kf,{expanded:n,fontSize:[2,2,1],padding:2,text:i.title,weight:"semibold",children:l})});var cc=Object.freeze,cu=Object.defineProperty;let ch=(0,tm.ZP)(tp.Zb)(eC||(eC=cc(cu(j=["\n  overflow: hidden;\n\n  @media screen and (min-width: ","px) {\n    border-right: 1px solid var(--card-border-color);\n    min-width: 180px;\n    max-width: 300px;\n    overflow: auto;\n  }\n"],"raw",{value:cc(j.slice())}))),e=>{let{theme:t}=e;return t.sanity.media[1]}),cp={flex:"none"},cm={lineHeight:0},cf=[2,2,1],cx=(0,td.memo)(function(e){let{collections:t=[],expanded:n}=e,{broadcast:i,scopes:r}=dz(),l=(0,td.useMemo)(()=>(function(e,t){let n={};for(let e of t){let t=e.name||"@@root@@",i=n[t]||{name:t,title:e.title,stories:[]},r={...i,name:t,stories:i.stories.concat(e.stories)};n[t]=r}let i={};for(let e of Object.values(n))i=function(e,t,n){if(!t){if(di(n)||dr(n))return n;throw Error("set: cannot replace value with a non-record value")}if((t?function e(t,n){if(t){var i=dn(t,n.shift());return n.length&&(di(i)||dr(i))?e(i,n):i}}(e,t.split("/")):e)===n)return e;for(var i=da(e),r=t.split("/"),l=e,a=i;r.length;){var s=r.shift();if(r.length){var o=dn(l,s);if(void 0===o&&dl(l,s,o={}),!di(o)&&!dr(o))throw Error('set: path is not targeting an object nor an array: "'+t+'"');var d=da(l=o);dl(a,s,d),a=d}else dl(a,s,n)}return i}(i,e.name||"@@root@@",{__scope__:e});let r={type:"list",name:"@@root@@",items:[]};for(let[t,n]of Object.entries(i))r.items.push(...function e(t,n,i){if(n.__scope__){let e=n.__scope__;return"@@root@@"===e.name?e.stories.map(e=>({type:"story",...e})):[{type:"scope",name:e.name||"@@root@@",title:e.title||"(root)",scope:e}]}let r=t.find(e=>e.name===i),l=Object.entries(n).filter(e=>{let[t]=e;return"__scope__"!==t}).flatMap(t=>{let[n,i]=t;return e((null==r?void 0:r.children)||[],i,n)});return[{type:"list",name:i,title:(null==r?void 0:r.title)||i,items:l}]}(e,n,t));return r})(t,r),[t,r]),[a,s]=(0,td.useState)(""),o=(0,td.useMemo)(()=>{var e;if(!a)return ds;let t=a.toLowerCase(),n=[];for(let i of r)for(let r of i.stories)((null==(e=i.title)?void 0:e.toLowerCase().includes(t))||r.title.toLowerCase().includes(t))&&n.push({scope:i,story:r});return n},[a,r]),d=(0,td.useCallback)(e=>s(e.currentTarget.value),[]),c=(0,td.useCallback)(()=>s(""),[]),u=(0,td.useCallback)(e=>{e.preventDefault();let t=e.currentTarget.getAttribute("data-path");t&&(i({type:"workshop/setPath",value:t}),s(""))},[i]);return(0,tc.jsx)(cg,{expanded:n,matches:o,menu:l,onSearchQueryChange:d,onSearchQueryClear:c,onStoryClick:u,query:a})}),cg=(0,td.memo)(function(e){let{expanded:t,matches:n,menu:i,onSearchQueryChange:r,onSearchQueryClear:l,onStoryClick:a,query:s}=e,o=(0,td.useMemo)(()=>t?["block"]:["none","none","block"],[t]);return(0,tc.jsx)(ch,{display:o,flex:1,children:(0,tc.jsxs)(tp.kC,{direction:"column",height:"fill",children:[(0,tc.jsx)(tp.mh,{style:cp,children:(0,tc.jsx)(tp.Zb,{padding:2,shadow:1,style:cm,children:(0,tc.jsx)(tp.oi,{border:!1,clearButton:!!s,fontSize:cf,icon:to.W1M,onChange:r,onClear:l,padding:2,placeholder:"Stories",radius:2,space:2,value:s})})}),(0,tc.jsxs)(tp.Zb,{flex:1,overflow:"auto",children:[s&&n.length>0&&(0,tc.jsx)(tp.xu,{padding:2,children:(0,tc.jsx)(cl,{matches:n,onStoryClick:a})}),!s&&"list"===i.type&&(0,tc.jsx)(tp.xu,{padding:2,children:(0,tc.jsx)(ca,{items:i.items})})]})]})})});var cv=Object.freeze,cb=Object.defineProperty;let cy=tm.ZP.iframe(ez||(ez=cv(cb(w=["\n  display: block;\n  border: 0;\n  height: 100%;\n  width: 100%;\n"],"raw",{value:cv(w.slice())})))),cj=(0,td.memo)(function(e){let{frameRef:t,hidden:n}=e,{frameReady:i,frameUrl:r,path:l,payload:a,scheme:s,title:o,viewport:d,zoom:c}=dz(),u=dc.find(e=>e.name===d)||dc[0],h=null==u?void 0:u.rect.width,p=null==u?void 0:u.rect.height,[m]=(0,td.useState)(()=>dm({baseUrl:r,path:l,payload:a,scheme:s,viewport:d,zoom:c})),f=(0,td.useMemo)(()=>({maxWidth:"auto"===h?void 0:"".concat((h||1)*c,"px"),maxHeight:p?"".concat((p||1)*c,"px"):void 0}),[h,p,c]),x=(0,td.useMemo)(()=>n?"none":"block",[n]),g=(0,td.useMemo)(()=>({transform:"scale(".concat(c,")"),transformOrigin:"0 0",width:"".concat(100/c,"%"),height:"".concat(100/c,"%")}),[c]);return(0,tc.jsx)(tp.Zb,{display:x,flex:1,overflow:"hidden",tone:"transparent",children:(0,tc.jsxs)(tp.kC,{align:"center",height:"fill",justify:"center",sizing:"border",children:["/"===l&&(0,tc.jsx)(tp.W2,{width:0,children:(0,tc.jsxs)(tp.Kq,{padding:4,space:4,children:[(0,tc.jsx)(tp.X6,{align:"center",children:o}),(0,tc.jsx)(tp.xv,{align:"center",muted:!0,children:"Browse workshop stories in the navigator to the left."})]})}),!i&&"/"!==l&&(0,tc.jsx)(tp.$j,{muted:!0}),(0,tc.jsx)(tp.W2,{height:"fill",hidden:!i||"/"===l,style:f,width:"auto",children:(0,tc.jsx)(tp.Zb,{height:"fill",shadow:1,children:(0,tc.jsx)(cy,{ref:t,src:m,style:g})})})]})})});function cw(e,t,n){let i=e.path,{scheme:r,viewport:l,zoom:a,...s}=e.query||{};return{frameReady:n||!1,path:i,payload:s,scheme:t||("string"==typeof r?r:"light"),viewport:"string"==typeof l?l:"auto",zoom:"number"==typeof a?a:1}}function c_(e){let t=!(arguments.length>1)||void 0===arguments[1]||arguments[1],{payload:n,scheme:i,viewport:r,zoom:l}=e,a={scheme:i};if(r&&"auto"!==r&&(a.viewport=r),l&&1!==l&&(a.zoom=l),t)for(let[e,t]of Object.entries(n))["schema","viewport","zoom"].includes(e)?console.warn('Workshop: the payload cannot contain a property named "'.concat(e,'" (protected name)')):a[e]=t;return a}function ck(e){let{currentUser:t,fieldName:n,mentionOptions:i,onBlur:r,onFocus:l,onKeyDown:a,onNewThreadCreate:s,readOnly:o}=e,[d,c]=(0,td.useState)(ds),u=(0,td.useRef)(null),h=(0,td.useCallback)(()=>{null==s||s(d),c(ds)},[s,d]),p=(0,td.useMemo)(()=>l_(d),[d]),m=(0,td.useCallback)(()=>{var e;p&&(null==(e=u.current)||e.discardDialogController.open())},[p]),f=(0,td.useCallback)(e=>{!e.isDefaultPrevented()&&("Escape"===e.key&&(e.preventDefault(),e.stopPropagation(),m()),a&&a(e))},[a,m]),x=(0,td.useCallback)(()=>{var e,t;c(ds),null==(e=u.current)||e.discardDialogController.close(),null==(t=u.current)||t.focus()},[]),g=(0,td.useCallback)(()=>{var e;null==(e=u.current)||e.discardDialogController.close()},[]),v=(0,tc.jsxs)(tc.Fragment,{children:["Add comment to ",(0,tc.jsx)("b",{children:n})]});return(0,tc.jsx)(l6,{currentUser:t,expandOnFocus:!0,mentionOptions:i,onBlur:r,onChange:c,onDiscardCancel:g,onDiscardConfirm:x,onKeyDown:f,onFocus:l,onSubmit:h,placeholder:v,readOnly:o,ref:u,value:d})}(0,td.memo)(function(e){var t,n;let{config:i,locationStore:r,onSchemeChange:l,scheme:a}=e,s=null==(n=null==(t=i.features)?void 0:t.navbar)||n,o=(0,td.useMemo)(()=>dh(),[]),d=(0,td.useMemo)(()=>(function(){let e=new Set,t=null,n=[],i=null;function r(t){let n=t.data;if(dB(n)){for(let t of n)if(dF(t)&&"string"==typeof t.type&&t.type.startsWith("workshop/"))for(let n of e)n(t)}}return{message:{publish(e){n.push(e),i&&clearInterval(i),i=setTimeout(()=>{var e;null==(e=null==t?void 0:t.contentWindow)||e.postMessage(n,window.location.origin),n=[],i=null},0)},subscribe:t=>(e.add(t),()=>{e.delete(t)})},setElement(e){let n=t;(t=e,e)?(null==t?void 0:t.contentWindow)&&window.addEventListener("message",r):n&&(null==n?void 0:n.contentWindow)&&window.removeEventListener("message",r)}}})(),[]),[c,u]=(0,td.useState)(null),[h,p]=(0,td.useState)(null),[{frameReady:m,path:f,payload:x,scheme:g,viewport:v,zoom:b},y]=(0,td.useState)(()=>cw(r.get(),a)),j=(0,tp.d2)(),[w,_]=(0,td.useState)(!1),[k,C]=(0,td.useState)(!1),z=(0,td.useRef)(m),E=(0,td.useRef)(g),I=(0,td.useRef)(f),S=(0,td.useRef)({scheme:g,viewport:v,zoom:b,...x}),P=(0,td.useCallback)(e=>{o.publish(e),d.message.publish(e)},[o,d]),T=(0,td.useMemo)(()=>d2(e=>r.push(e),150),[r]),M=(0,td.useMemo)(()=>d2(e=>r.replace(e),150),[r]),R=(0,td.useCallback)(()=>{_(e=>!e),C(!1)},[]),O=(0,td.useCallback)(()=>{_(!1),C(e=>!e)},[]),A=(0,td.useRef)(j);return((0,td.useEffect)(()=>{A.current<2&&j>=2&&(_(!1),C(!1)),A.current=j},[j]),(0,td.useEffect)(()=>{_(!1)},[f]),(0,td.useEffect)(()=>()=>T.cancel(),[T]),(0,td.useEffect)(()=>()=>M.cancel(),[M]),(0,td.useEffect)(()=>o.subscribe(e=>{y(t=>{let n=dM(t,e),i=!dk(t,n);if(i){if("workshop/setPath"===e.type){if(I.current!==n.path){I.current=n.path;let e=c_(n,!1);T({path:n.path,query:e})}}else if("workshop/setState"!==e.type){let e=c_(n);dk(S.current,e)||(S.current=e,M({path:n.path,query:e}))}}return i?n:t})}),[T,M,o,r]),(0,td.useEffect)(()=>d.message.subscribe(o.publish),[o,d]),(0,td.useEffect)(()=>{z.current=m},[m]),(0,td.useEffect)(()=>r.subscribe(e=>{P({type:"workshop/setState",value:cw(e,void 0,m)})}),[P,m,r]),(0,td.useEffect)(()=>{E.current=g,l(g)},[l,g]),(0,td.useEffect)(()=>{a&&E.current!==a&&(E.current=a,P({type:"workshop/setScheme",value:a}))},[P,a]),i.scopes)?(0,tc.jsx)(dT,{config:i,broadcast:P,channel:o,frameReady:m,origin:"main",path:f,payload:x,scheme:g,viewport:v,zoom:b,children:(0,tc.jsx)(tp.VW,{children:(0,tc.jsx)(tp.NM,{element:c,children:(0,tc.jsx)(tp.Xp,{element:h,children:(0,tc.jsxs)(tp.kC,{"data-boundary":"",direction:"column",height:"fill",ref:u,style:{minWidth:320},children:[s&&(0,tc.jsx)(cr,{inspectorExpanded:k,navigatorExpanded:w,onInspectorToggle:O,onNavigatorToggle:R}),(0,tc.jsxs)(tp.kC,{flex:1,children:[(0,tc.jsx)(cx,{collections:i.collections,expanded:w}),(0,tc.jsx)(cj,{frameRef:d.setElement,hidden:w||k}),(0,tc.jsx)(d1,{expanded:k})]}),(0,tc.jsx)("div",{"data-portal":"",ref:p})]})})})})}):(0,tc.jsx)(tc.Fragment,{children:"No scopes"})});var cC=Object.freeze,cz=Object.defineProperty,cE=(e,t)=>cC(cz(e,"raw",{value:cC(t||e.slice())}));let cI=(0,tm.ZP)(tp.kC)(eE||(eE=cE(["\n  min-height: 25px;\n"]))),cS=(0,tm.ZP)(tp.zx)(e=>{let{theme:t}=e,n=t.sanity.color.base.fg;return(0,tm.iv)(eI||(eI=cE(["\n    --card-fg-color: ",";\n\n    // The width is needed to make the text ellipsis work\n    // in the breadcrumbs component\n    max-width: 100%;\n  "])),n)});function cP(e){let{breadcrumbs:t,canCreateNewThread:n,children:i,currentUser:r,fieldPath:l,isSelected:a,mentionOptions:s,onNewThreadCreate:o,onPathSelect:d,readOnly:c}=e,u=(0,td.useCallback)(e=>{let t={fieldPath:l,message:e,parentCommentId:void 0,status:"open",threadId:(0,t6.Z)()};null==o||o(t)},[o,l]),h=(0,td.useCallback)(e=>{e.stopPropagation(),null==d||d({fieldPath:l,origin:"inspector",threadId:null})},[l,d]),p=(0,td.useCallback)(e=>{e.stopPropagation(),0!==e.detail&&(null==d||d({fieldPath:l,origin:"inspector",threadId:null}))},[l,d]),m=(0,td.useMemo)(()=>(null==t?void 0:t.map(e=>e.title))||[],[t]),f=m[m.length-1];return(0,tc.jsxs)(tp.Kq,{space:2,children:[(0,tc.jsx)(cI,{align:"center",gap:2,paddingRight:1,sizing:"border",children:(0,tc.jsx)(tp.Kq,{flex:1,children:(0,tc.jsx)(tp.kC,{align:"center",children:(0,tc.jsx)(cS,{"aria-label":"Go to ".concat(f," field"),mode:"bleed",onClick:h,padding:2,children:(0,tc.jsx)(aA,{maxLength:3,titlePath:m})})})})}),n&&(0,tc.jsx)(a_,{onClick:p,tone:a?"primary":void 0,children:(0,tc.jsx)(ck,{currentUser:r,fieldName:f,mentionOptions:s,onNewThreadCreate:u,readOnly:c})}),(0,tc.jsx)(tp.Kq,{space:2,children:i})]})}let cT={open:{title:"No open comments yet",message:(0,tc.jsxs)("span",{children:["Open comments on this document ",(0,tc.jsx)("br",{}),"will be shown here."]})},resolved:{title:"No resolved comments yet",message:(0,tc.jsxs)(tc.Fragment,{children:["Resolved comments on this document ",(0,tc.jsx)("br",{}),"will be shown here."]})}};function cM(e){let{status:t,error:n,loading:i,hasNoComments:r}=e;return n?(0,tc.jsx)(tp.kC,{align:"center",justify:"center",flex:1,padding:4,children:(0,tc.jsx)(tp.kC,{align:"center",children:(0,tc.jsx)(tp.xv,{size:1,muted:!0,children:"Something went wrong"})})}):i?(0,tc.jsx)(tp.kC,{align:"center",justify:"center",flex:1,padding:4,children:(0,tc.jsxs)(tp.kC,{align:"center",gap:2,children:[(0,tc.jsx)(tp.$j,{muted:!0,size:1}),(0,tc.jsx)(tp.xv,{size:1,muted:!0,children:"Loading comments..."})]})}):r?(0,tc.jsx)(tp.kC,{align:"center",justify:"center",flex:1,sizing:"border",children:(0,tc.jsx)(tp.W2,{width:0,padding:4,children:(0,tc.jsxs)(tp.Kq,{space:3,children:[(0,tc.jsx)(tp.xv,{align:"center",size:1,muted:!0,weight:"semibold",children:cT[t].title}),(0,tc.jsx)(tp.xv,{align:"center",size:1,muted:!0,children:cT[t].message})]})})}):null}let cR={behavior:"smooth",block:"start",inline:"nearest"},cO=(0,td.forwardRef)(function(e,t){let{comments:n,currentUser:i,error:r,loading:l,mentionOptions:a,onCopyLink:s,onCreateRetry:o,onDelete:d,onEdit:c,onNewThreadCreate:u,onPathSelect:h,onReply:p,onStatusChange:m,readOnly:f,selectedPath:x,status:g}=e,[v,b]=(0,td.useState)(null),y=(0,td.useCallback)(e=>{let t=null==document?void 0:document.querySelector('[data-comment-id="'.concat(e,'"]'));t&&t.scrollIntoView(cR)},[]);(0,td.useImperativeHandle)(t,()=>({scrollToComment:y}),[y]);let j=(0,td.useMemo)(()=>Object.entries(n.reduce((e,t)=>{let n=t.fieldPath;return e[n]||(e[n]=[]),e[n].push(t),e},{})),[n]),w=!l&&!r&&j.length>0;return(0,tc.jsxs)(tp.kC,{direction:"column",flex:1,height:"fill",overflow:"hidden",ref:b,sizing:"border",children:[(0,tc.jsx)(cM,{error:r,hasNoComments:0===j.length,loading:l,status:g}),w&&(0,tc.jsx)(tp.Kq,{as:"ul",flex:1,overflow:"auto",padding:3,paddingTop:1,paddingBottom:6,sizing:"border",space:1,children:(0,tc.jsx)(tp.NM,{element:v,children:null==j?void 0:j.map(e=>{let[t,n]=e,r=n[0].breadcrumbs,l=n[0].threadId,v=(null==x?void 0:x.fieldPath)===t&&!x.threadId;return(0,tc.jsx)(tp.Kq,{as:"li","data-group-id":l,paddingTop:3,children:(0,tc.jsx)(cP,{breadcrumbs:r,canCreateNewThread:"open"===g,currentUser:i,fieldPath:t,isSelected:v,mentionOptions:a,onNewThreadCreate:u,onPathSelect:h,readOnly:f,children:n.map(e=>{var t,n;let r=e.replies.slice().reverse(),l="open"===g&&(null==(t=e.parentComment._state)?void 0:t.type)!=="createError"&&(null==(n=e.parentComment._state)?void 0:n.type)!=="createRetrying",u=(null==x?void 0:x.threadId)===e.parentComment.threadId&&(null==x?void 0:x.fieldPath)===e.parentComment.target.path.field;return(0,tc.jsx)(aT,{canReply:l,currentUser:i,isSelected:u,mentionOptions:a,onCopyLink:s,onCreateRetry:o,onDelete:d,onEdit:c,onPathSelect:h,onReply:p,onStatusChange:m,parentComment:e.parentComment,readOnly:f,replies:r},e.parentComment._id)})},t)},t)})})})]})}),cA=td.memo(cO),cD={thread:{title:"Delete this comment thread?",body:"This comment and its replies will be deleted, and once deleted cannot be recovered.",confirmButtonText:"Delete thread"},comment:{title:"Delete this comment?",body:"Once deleted, a comment cannot be recovered.",confirmButtonText:"Delete comment"}};function cL(e){let{isParent:t,onClose:n,commentId:i,onConfirm:r,loading:l,error:a}=e,{title:s,body:o,confirmButtonText:d}=cD[t?"thread":"comment"],c=(0,td.useCallback)(()=>{r(i)},[i,r]);return(0,tc.jsx)(tp.Vq,{header:s,id:"delete-comment-dialog",onClose:n,width:0,footer:(0,tc.jsxs)(tp.rj,{columns:2,padding:2,gap:2,children:[(0,tc.jsx)(tp.zx,{text:"Cancel",mode:"ghost",onClick:n}),(0,tc.jsx)(tp.zx,{loading:l,onClick:c,text:d,tone:"critical"})]}),children:(0,tc.jsxs)(tp.Kq,{padding:4,space:4,children:[(0,tc.jsx)(tp.xv,{children:o}),a&&(0,tc.jsx)(tu.LPT,{tone:"critical",children:"An error occurred while deleting the comment. Please try again."})]})})}var cN=Object.freeze,cZ=Object.defineProperty,cU=(e,t)=>cN(cZ(e,"raw",{value:cN(t||e.slice())}));let cB=(0,tm.ZP)(tp.xu)(eS||(eS=cU(["\n  max-width: 280px;\n"]))),cF=(0,tm.F4)(eP||(eP=cU(["\n  from {\n    opacity: 0;\n  }\n  to {\n    opacity: 1;\n  }\n"]))),cq=(0,tm.ZP)(tp.J2)(eT||(eT=cU(["\n  opacity: 0;\n  // Fade in the popover after 500ms\n  animation: "," 200ms 500ms forwards;\n"])),cF);function cH(e){let{onDismiss:t}=e;return(0,tc.jsx)(cq,{content:(0,tc.jsx)(cB,{padding:4,children:(0,tc.jsxs)(tp.Kq,{space:3,children:[(0,tc.jsx)(tp.xv,{weight:"semibold",size:1,children:"Document fields now have comments"}),(0,tc.jsx)(tp.xv,{size:1,children:"You can add comments to any field in a document. They'll show up here, grouped by field."}),(0,tc.jsx)(tp.kC,{justify:"flex-end",marginTop:2,children:(0,tc.jsx)(tp.zx,{fontSize:1,padding:2,text:"Got it",tone:"primary",onClick:t})})]})}),open:!0,portal:!0,...e})}let cV=(0,td.createContext)(null),cW=new Map;async function cK(e,t,n){cW.has(t)||cW.set(t,(0,nu.Qc)("*[".concat(t,"]")));let i=cW.get(t),r=function(e){let t={};return null!==e&&(t.identity=e.id),t}(e),{identity:l}=r,a={...r},s=await (await (0,nu.ku)(i,{dataset:[n],identity:l,params:a})).get();return(null==s?void 0:s.length)===1}async function c$(e,t,n,i){if(!i)return{granted:!0,reason:"Null document, nothing to check"};if(!t.length)return{granted:!1,reason:"No document grants"};let r=[];for(let n of t)await cK(e,n.filter,i)&&r.push(n);let l=r.some(e=>e.permissions.some(e=>e===n));return{granted:l,reason:l?"Matching grant":"No matching grants found"}}let cY={data:[],error:null,loading:!0},cX=null;function cG(){let e=(0,td.useContext)(cV);if(!e)throw Error("useComments must be used within a CommentsProvider");return e}function cQ(e){let{documentId:t,documentType:n}=e,{enabled:i,isLoading:r}=(0,tu.nhK)("studioComments"),{enabled:l}=(0,tu.Lky)().document.unstable_comments,a=l({documentType:n,documentId:(0,tu.vsM)(t)});return(0,td.useMemo)(()=>r?{isEnabled:!1,reason:"loading"}:i?a?{isEnabled:!0,reason:null}:{isEnabled:!1,reason:"disabled-by-config"}:{isEnabled:!1,reason:"plan-upgrade-required"},[a,i,r])}let cJ=(0,td.createContext)(null),c0="sanityStudio:comments:inspector:onboarding:dismissed:v".concat(1),c1=e=>{try{window.localStorage.setItem(c0,JSON.stringify(e))}catch(e){}},c2=()=>{try{let e=window.localStorage.getItem(c0);return!!e&&JSON.parse(e)}catch(e){return!1}};function c5(e){let{children:t}=e,[n,i]=(0,td.useState)(c2()),r=(0,td.useCallback)(()=>{i(!0),c1(!0)},[i]),l=(0,td.useMemo)(()=>({setDismissed:r,isDismissed:n}),[r,n]);return(0,tc.jsx)(cJ.Provider,{value:l,children:t})}function c3(){let e=(0,td.useContext)(uc);if(!e)throw Error("useCommentsSelectedPath: missing context value");return e}function c6(e,t){switch(t.type){case"COMMENTS_SET":{let n=t.comments.reduce((e,t)=>({...e,[t._id]:t}),{});return{...e,comments:n}}case"COMMENT_ADDED":{let n=t.payload,i={[n._id]:{...e.comments[n._id],...n,_state:n._state||void 0,_createdAt:n._createdAt||new Date().toISOString()}};if(e.comments&&e.comments[n._id])return{...e,comments:{...e.comments,...i}};let r={...e.comments||{},...i};return{...e,comments:r}}case"COMMENT_RECEIVED":{let n=t.payload;return{...e,comments:{...e.comments,[n._id]:n}}}case"COMMENT_DELETED":{let{[t.id]:n,...i}=e.comments;return Object.keys(i).forEach(e=>{i[e].parentCommentId===t.id&&delete i[e]}),{...e,comments:i}}case"COMMENT_UPDATED":{let n=t.payload,i=n._id;return{...e,comments:{...e.comments,[i]:{...e.comments[i],...n}}}}default:return e}}let c8={comments:{}},c4={events:["welcome","mutation","reconnect"],includeResult:!0,visibility:"query"},c9="order(".concat("_createdAt"," ").concat("desc",")"),c7="*[".concat('_type == "comment" && target.document._ref == $documentId',"] ").concat("{\n  _createdAt,\n  _id,\n  authorId,\n  lastEditedAt,\n  message,\n  parentCommentId,\n  status,\n  target,\n  threadId,\n}"," | ").concat(c9),ue=[],ut={open:ue,resolved:ue},un=async()=>{await Promise.resolve()},ui={execute:un},ur={comments:{data:ut,error:null,loading:!1},create:ui,edit:ui,getComment:()=>void 0,isRunningSetup:!1,mentionOptions:{data:[],error:null,loading:!1},remove:ui,setStatus:un,status:"open",update:ui},ul=(0,td.memo)(function(e){let{children:t,documentId:n,documentType:i}=e,{isEnabled:r}=cQ({documentId:n,documentType:i});return r?(0,tc.jsx)(ua,{...e}):(0,tc.jsx)(cV.Provider,{value:ur,children:t})}),ua=(0,td.memo)(function(e){let{children:t,documentId:n,documentType:i}=e,[r,l]=(0,td.useState)("open"),{client:a,runSetup:s,isRunningSetup:o}=function(){let e=(0,td.useContext)(us);if(!e)throw Error("useCommentsSetup: missing context value");return e}(),d=(0,tu.vsM)(n),c=(0,tu.iav)(d,i,"low"),u=(0,td.useMemo)(()=>c.draft||c.published,[c.draft,c.published]),{dispatch:h,data:p=ue,error:m,loading:f}=function(e){let{client:t,documentId:n}=e,[i,r]=(0,td.useReducer)(c6,c8),[l,a]=(0,td.useState)(null!==t),[s,o]=(0,td.useState)(null),d=(0,td.useMemo)(()=>({documentId:(0,tu.vsM)(n)}),[n]),c=(0,td.useCallback)(async()=>{if(!t){a(!1);return}try{let e=await t.fetch(c7,d);r({type:"COMMENTS_SET",comments:e}),a(!1)}catch(e){o(e)}},[t,d]),u=(0,td.useCallback)(async e=>{if("welcome"===e.type&&(a(!0),await c(),a(!1)),"reconnect"===e.type&&a(!0),"mutation"===e.type){if("appear"===e.transition){let t=e.result;t&&r({type:"COMMENT_RECEIVED",payload:t})}if("disappear"===e.transition&&r({type:"COMMENT_DELETED",id:e.documentId}),"update"===e.transition){let t=e.result;t&&r({type:"COMMENT_UPDATED",payload:t})}}},[c]),h=(0,td.useMemo)(()=>t?t.observable.listen(c7,d,c4).pipe((0,tk.K)(e=>(o(e),(0,tv.of)(e)))):(0,tv.of)(),[t,d]);return(0,td.useEffect)(()=>{let e=h.subscribe(u);return()=>{null==e||e.unsubscribe()}},[u,h]),{data:(0,td.useMemo)(()=>Object.values(i.comments),[i.comments]),dispatch:r,error:s,loading:l}}({documentId:d,client:a}),x=function(e){let{documentValue:t}=e,n=(0,tu.iZE)(),i=(0,tu.LMB)(),r=(0,tu.m85)(tu.Dr7),[l,a]=(0,td.useState)(cY),s=(0,td.useMemo)(()=>{let e=n.get().pipe((0,tb.U)(e=>{var t;return null==(t=e.members)?void 0:t.filter(e=>!e.isRobot)})).pipe((0,ty.w)(async e=>{let t=e.map(e=>{let{id:t}=e;return t});return await i.getUsers(t)}),(0,tb.U)(e=>e.map(e=>({displayName:e.displayName,id:e.id,canBeMentioned:!1})))),l=cX,a=l?(0,tv.of)(l):r.observable.fetch('*[_type == "system.group"]');return(0,tj.D)([e,a]).pipe((0,tw.z)(async e=>{let[n,i]=e;l||(cX=i);let r=null==n?void 0:n.map(async e=>{let n=[...i.map(t=>t.members.includes(e.id)?t.grants:[])].flat(),{granted:r}=await c$(e,n,"read",t);return{...e,canBeMentioned:r}});return await Promise.all(r||[])})).pipe((0,tb.U)(e=>({error:null,loading:!1,data:nc()(e,"displayName")})))},[r.observable,t,n,i]);return(0,td.useEffect)(()=>{let e=(0,tv.of)(cY),t=(0,t_.z)(e,s).subscribe(a);return()=>{t.unsubscribe()}},[s]),l}((0,td.useMemo)(()=>({documentValue:u}),[u])),g=(0,tu.I_y)().get(i),v=(0,tu.xJ)(),{name:b,dataset:y,projectId:j}=(0,tu.cFj)(),w=(0,td.useMemo)(()=>{if(!g||!v)return ut;let e=function(e){let{comments:t,currentUser:n,documentValue:i,schemaType:r}=e;return(null==t?void 0:t.filter(e=>!e.parentCommentId)).map(e=>{let l=function(e){let{currentUser:t,schemaType:n,fieldPath:i,documentValue:r}=e,l=t0.mL(i),a=[],s=null;return l.forEach((e,i)=>{var o,d,c,u,h;let p=l.slice(0,i+1),m=l.slice(0,i),f=function e(t,n){var i;let r=t0.mL(n),l=r[0];if(l&&(0,th.m$)(t)){let n=null==(i=null==t?void 0:t.fields)?void 0:i.find(e=>e.name===l);if(n){let t=t0.BB(r.slice(1));return t?e(n.type,t):n}}}(n,t0.BB(p)),x=e.hasOwnProperty("_key"),g=(0,tu.PtK)(r,m),v=(0,tu.PtK)(r,p),b={document:r,currentUser:t,parent:g,value:v};if(x&&Array.isArray(g)){let t=function(e,t){if("number"==typeof t)return t;let n=np()(e,t);return -1!==n&&n}(g,e);a.push({invalid:!1===t,isArrayItem:!0,title:"number"==typeof t?"#".concat(Number(t)+1):"Unknown array item"});return}if(null==f?void 0:f.type){let e=(0,tu.ZCh)(f.type.hidden,b);a.push({invalid:e,isArrayItem:!1,title:(0,tu.EZo)(f.type)}),s=f.type;return}if((0,th.jB)(s)){let t=(0,tu.PtK)(r,m),n=null==t?void 0:t._type,i=null==(o=null==s?void 0:s.of)?void 0:o.find(e=>e.name===n),l=null==(d=null==i?void 0:i.fields)?void 0:d.find(t=>t.name===e);if(!n&&v){let t=null==(c=null==s?void 0:s.of)?void 0:c.map(e=>null==e?void 0:e.fields).filter(Boolean).flat(),n=null==t?void 0:t.find(t=>(null==t?void 0:t.name)===e),i=(0,tu.ZCh)(null==(u=null==n?void 0:n.type)?void 0:u.hidden,b);n&&(a.push({invalid:i,isArrayItem:!1,title:(0,tu.EZo)(null==n?void 0:n.type)}),s=null==n?void 0:n.type);return}if(!l){a.push({invalid:!0,isArrayItem:!1,title:"Unknown field"});return}let p=(0,tu.EZo)(null==l?void 0:l.type),f=(0,tu.ZCh)(null==(h=null==i?void 0:i.type)?void 0:h.hidden,b),x=(0,tu.ZCh)(null==l?void 0:l.type.hidden,b);a.push({invalid:f||x,isArrayItem:!1,title:p}),s=null==l?void 0:l.type;return}a.push({invalid:!0,isArrayItem:!1,title:"Unknown field"})}),a}({currentUser:n,documentValue:i,fieldPath:e.target.path.field,schemaType:r});if(l.some(e=>e.invalid))return;let a=null==t?void 0:t.filter(t=>t.parentCommentId===e._id);return{breadcrumbs:l,commentsCount:[e,...a].length,fieldPath:e.target.path.field,parentComment:e,replies:a,threadId:e.threadId}}).filter(Boolean)}({comments:no()(p,["_createdAt"],["desc"]),schemaType:g,currentUser:v,documentValue:u});return{open:e.filter(e=>"open"===e.parentComment.status),resolved:e.filter(e=>"resolved"===e.parentComment.status)}},[v,p,u,g]),_=(0,td.useCallback)(e=>w.open.filter(t=>t.threadId===e).length,[w.open]),k=(0,td.useCallback)(e=>null==p?void 0:p.find(t=>t._id===e),[p]),C=(0,td.useCallback)(async e=>{var t,n;let i=(null==(n=null==(t=null==p?void 0:p.find(t=>t._id===e._id))?void 0:t._state)?void 0:n.type)==="createError";h({type:"COMMENT_ADDED",payload:{...e,_state:i?{type:"createRetrying"}:void 0}})},[p,h]),z=(0,td.useCallback)((e,t)=>{h({type:"COMMENT_UPDATED",payload:{_id:e,...t}})},[h]),E=(0,td.useCallback)((e,t)=>{h({type:"COMMENT_UPDATED",payload:{_id:e,...t}})},[h]),I=(0,td.useCallback)((e,t)=>{h({type:"COMMENT_UPDATED",payload:{_id:e,_state:{error:t,type:"createError"}}})},[h]),{operation:S}=function(e){let{client:t,currentUser:n,dataset:i,documentId:r,documentType:l,getThreadLength:a,onCreate:s,onCreateError:o,onEdit:d,onRemove:c,onUpdate:u,projectId:h,runSetup:p,workspace:m}=e,f=null==n?void 0:n.id,x=(0,tG.z)((0,td.useCallback)(e=>"string"==typeof e.tool?e.tool:void 0,[])),{tools:g}=(0,tu.cFj)(),v=(0,td.useMemo)(()=>g.find(e=>e.name===x),[x,g]),{getNotificationValue:b}=function(e){let{documentId:t,documentType:n}=e||{},i=(0,tu.I_y)().get(n),{title:r}=(0,tu.cFj)(),{createPathWithParams:l,params:a}=ie(),s=(0,tu.rq_)(),{published:o,draft:d}=(0,tX.m2)(()=>t&&i?(0,tu.eLL)(s,i,t,""):(0,tv.of)(null),[t,s,i])||{},c=(null==d?void 0:d.title)||(null==o?void 0:o.title)||"Sanity document";return{getNotificationValue:(0,td.useCallback)(e=>{let{commentId:t}=e,n=l({...a,comment:t,inspect:rQ});return{documentTitle:c,url:"".concat(window.location.origin).concat(n),workspaceTitle:r}},[l,c,a,r])}}({documentId:r,documentType:l}),y=(0,td.useCallback)(async e=>{let n=(null==e?void 0:e.id)||(0,t6.Z)(),d=((null==a?void 0:a(e.threadId))||0)+1,{documentTitle:c="",url:u="",workspaceTitle:x=""}=b({commentId:n})||{},g={_id:n,_type:"comment",authorId:f||"",lastEditedAt:void 0,message:e.message,parentCommentId:e.parentCommentId,status:e.status,threadId:e.threadId,context:{payload:{workspace:m},notification:{currentThreadLength:d,documentTitle:c,url:u,workspaceTitle:x},tool:(null==v?void 0:v.name)||""},target:{path:{field:e.fieldPath},document:{_dataset:i,_projectId:h,_ref:r,_type:"crossDatasetReference",_weak:!0},documentType:l}};if(null==s||s(g),!t){try{await p(g)}catch(e){throw null==o||o(g._id,e),e}return}try{await t.create(g)}catch(e){throw null==o||o(g._id,e),e}},[null==v?void 0:v.name,f,t,i,r,l,b,a,s,o,h,p,m]),j=(0,td.useCallback)(async e=>{t&&(null==c||c(e),await Promise.all([t.delete({query:'*[_type == "comment" && parentCommentId == "'.concat(e,'"]')}),t.delete(e)]))},[t,c]),w=(0,td.useCallback)(async(e,n)=>{if(!t)return;let i={message:n.message,lastEditedAt:new Date().toISOString()};null==d||d(e,i),await t.patch(e).set(i).commit()},[t,d]),_=(0,td.useCallback)(async(e,n)=>{if(t){if(null==u||u(e,n),n.status){await Promise.all([t.patch({query:'*[_type == "comment" && parentCommentId == "'.concat(e,'"]')}).set({status:n.status}).commit(),t.patch(e).set(n).commit()]);return}await (null==t?void 0:t.patch(e).set(n).commit())}},[t,u]);return{operation:(0,td.useMemo)(()=>({create:y,edit:w,remove:j,update:_}),[y,j,w,_])}}((0,td.useMemo)(()=>({client:a,currentUser:v,dataset:y,documentId:d,documentType:i,projectId:j,schemaType:g,workspace:b,getThreadLength:_,runSetup:s,onCreate:C,onCreateError:I,onEdit:E,onUpdate:z}),[a,v,y,d,i,j,g,b,_,s,C,I,E,z])),P=(0,td.useMemo)(()=>({isRunningSetup:o,status:r,setStatus:l,getComment:k,comments:{data:w,error:m,loading:f||o},create:{execute:S.create},remove:{execute:S.remove},edit:{execute:S.edit},update:{execute:S.update},mentionOptions:x}),[o,r,k,w,m,f,S.create,S.remove,S.edit,S.update,x]);return(0,tc.jsx)(cV.Provider,{value:P,children:t})}),us=(0,td.createContext)(null),uo="v2023-11-13";function ud(e){let{children:t}=e,{dataset:n,projectId:i}=(0,tu.cFj)(),r=(0,tu.m85)(tu.Dr7),[l,a]=(0,td.useState)(null),[s,o]=(0,td.useState)(!1),d=(0,td.useCallback)(async()=>{var e;let t=await r.withConfig({apiVersion:"vX"}).request({uri:"/projects/".concat(i,"/datasets?datasetProfile=comments&addonFor=").concat(n),tag:"sanity.studio"});return null==(e=null==t?void 0:t[0])?void 0:e.name},[n,r,i]),c=(0,td.useCallback)(e=>r.withConfig({apiVersion:uo,dataset:e,projectId:i,requestTagPrefix:"sanity.studio",useCdn:!1,withCredentials:!0}),[r,i]),u=(0,td.useCallback)(async e=>{o(!0);try{let t=await d();if(t){let n=c(t);a(n),await n.create(e),o(!1);return}}catch(e){}try{let t=await r.withConfig({apiVersion:uo}).request({uri:"/comments/".concat(n,"/setup"),method:"POST"}),i=null==t?void 0:t.datasetName;if(!i){o(!1);return}let l=c(i);a(l),await l.create(e)}catch(e){throw e}finally{o(!1)}},[n,d,c,r]);(0,td.useEffect)(()=>{d().then(e=>{e&&a(c(e))})},[d,c]);let h=(0,td.useMemo)(()=>({client:l,runSetup:u,isRunningSetup:s}),[l,u,s]);return(0,tc.jsx)(us.Provider,{value:h,children:t})}let uc=(0,td.createContext)(null),uu=td.memo(function(e){let{children:t}=e,[n,i]=(0,td.useState)(null),r=(0,td.useCallback)(e=>{i(e)},[]),l=(0,td.useMemo)(()=>({selectedPath:n,setSelectedPath:r}),[n,r]);return(0,tc.jsx)(uc.Provider,{value:l,children:t})}),uh=(0,tm.ZP)(tp.Zb)({position:"relative",zIndex:1,lineHeight:0,"&:after":{content:'""',display:"block",position:"absolute",left:0,bottom:-1,right:0,borderBottom:"1px solid var(--card-border-color)",opacity:.5}}),up=(0,td.forwardRef)(function(e,t){let{onClose:n,onViewChange:i,view:r}=e,l=(0,td.useCallback)(()=>i("open"),[i]),a=(0,td.useCallback)(()=>i("resolved"),[i]);return(0,tc.jsx)(uh,{ref:t,children:(0,tc.jsxs)(tp.kC,{padding:2,children:[(0,tc.jsxs)(tp.kC,{align:"center",flex:1,gap:2,paddingY:2,padding:3,children:[(0,tc.jsx)(tp.xv,{as:"h1",size:1,weight:"semibold",children:"Comments"}),(0,tc.jsx)(tu.vwM,{})]}),(0,tc.jsxs)(tp.kC,{flex:"none",padding:1,gap:2,children:[(0,tc.jsx)(tp.j2,{id:"comment-status-menu-button",button:(0,tc.jsx)(tp.zx,{text:nf()(r),fontSize:1,padding:2,mode:"bleed",iconRight:to.v4q,space:2}),menu:(0,tc.jsxs)(tp.v2,{style:{width:"180px"},children:[(0,tc.jsx)(tp.sN,{fontSize:1,iconRight:"open"===r?to.KML:void 0,onClick:l,text:"Open comments"}),(0,tc.jsx)(tp.sN,{fontSize:1,iconRight:"resolved"===r?to.KML:void 0,onClick:a,text:"Resolved comments"})]}),popover:{placement:"bottom-end"}}),(0,tc.jsx)(tp.zx,{"aria-label":"Close comments",fontSize:1,icon:to.hZl,mode:"bleed",onClick:n,padding:2})]})]})})});var um=Object.freeze,uf=Object.defineProperty,ux=(e,t)=>um(uf(e,"raw",{value:um(t||e.slice())}));let ug=tm.ZP.span(eM||(eM=ux(["\n  margin-right: 0.2em;\n"]))),uv=tm.ZP.a(eR||(eR=ux(["\n  white-space: nowrap;\n"]))),ub=(0,tm.ZP)(tp.Zb)({position:"relative",zIndex:1,"&:after":{content:'""',display:"block",position:"absolute",left:0,top:-1,right:0,borderBottom:"1px solid var(--card-border-color)",opacity:.5}});function uy(){return(0,tc.jsx)(ub,{padding:3,children:(0,tc.jsxs)(tp.xv,{muted:!0,size:1,children:["Help improve comments."," ",(0,tc.jsxs)(uv,{href:"https://snty.link/comments-beta-feedback",target:"_blank",rel:"noreferrer",children:[(0,tc.jsx)(ug,{children:"Share your feedback "})," ",(0,tc.jsx)(to.buG,{})]})]})})}var uj=Object.freeze,uw=Object.defineProperty;let u_=(0,tm.ZP)(tp.mh)(eO||(eO=uj(uw(_=["\n  display: flex;\n  flex-direction: column;\n  height: 100%;\n  overflow: hidden;\n"],"raw",{value:uj(_.slice())}))));function uk(e){let{onClose:t}=e,[n,i]=(0,td.useState)(!1),[r,l]=(0,td.useState)(null),[a,s]=(0,td.useState)(!1),[o,d]=(0,td.useState)(null),c=(0,td.useRef)(null),u=(0,td.useRef)(null),h=(0,tu.xJ)(),{params:p,createPathWithParams:m,setParams:f}=ie(),x=(0,tu.BoV)(p)||rO,g=(0,td.useRef)(null==x?void 0:x.comment),v=(0,td.useRef)(!1),b=(0,tp.pm)().push,{onPathOpen:y,ready:j}=rj(),{isDismissed:w,setDismissed:_}=function(){let e=(0,td.useContext)(cJ);if(!e)throw Error("useCommentsOnboarding: missing context value");return e}(),{comments:k,create:C,edit:z,getComment:E,isRunningSetup:I,mentionOptions:S,remove:P,setStatus:T,status:M,update:R}=cG(),{isTopLayer:O}=(0,tp.sJ)(),A=(0,td.useMemo)(()=>k.data[M],[k,M]),D=(0,td.useMemo)(()=>k.loading||!j,[k.loading,j]),{selectedPath:L,setSelectedPath:N}=c3(),Z=(0,td.useCallback)(e=>{T(e),N(null)},[N,T]),U=(0,td.useCallback)(()=>{t(),N(null)},[t,N]),B=(0,td.useCallback)(e=>{let t=m({...p,comment:e}),n="".concat(window.location.origin).concat(t);navigator.clipboard.writeText(n).then(()=>{b({closable:!0,status:"info",title:"Copied link to clipboard"})}).catch(()=>{b({closable:!0,status:"error",title:"Unable to copy link to clipboard"})})},[m,p,b]),F=(0,td.useCallback)(e=>{let t=E(e);t&&C.execute({fieldPath:t.target.path.field,id:t._id,message:t.message,parentCommentId:t.parentCommentId,status:t.status,threadId:t.threadId})},[C,E]),q=(0,td.useCallback)(()=>{a||(i(!1),l(null))},[a]),H=(0,td.useCallback)(e=>{N(e),(null==e?void 0:e.fieldPath)&&y(t0.mL(e.fieldPath))},[y,N]),V=(0,td.useCallback)(e=>{C.execute(e),N({fieldPath:e.fieldPath,origin:"inspector",threadId:e.threadId})},[C,N]),W=(0,td.useCallback)(e=>{C.execute(e)},[C]),K=(0,td.useCallback)((e,t)=>{z.execute(e,t)},[z]),$=(0,td.useCallback)(e=>{var t;let n=A.find(t=>{var n;return(null==(n=t.parentComment)?void 0:n._id)===e}),r=!!(n&&(null==(t=null==n?void 0:n.replies)?void 0:t.length)>0);i(!0),l({commentId:e,isParent:r})},[A]),Y=(0,td.useCallback)(async e=>{try{s(!0),await P.execute(e),q()}catch(e){d(e)}finally{s(!1)}},[q,P]),X=(0,td.useCallback)((e,t)=>{let n=E(e);n&&(N({fieldPath:n.target.path.field||null,origin:t||"inspector",threadId:n.threadId||null}),setTimeout(()=>{var t;null==(t=c.current)||t.scrollToComment(e)}))},[E,N]),G=(0,td.useCallback)((e,t)=>{R.execute(e,{status:t}),"open"===t&&(T("open"),X(e))},[X,T,R]),Q=(0,td.useCallback)(()=>{L&&O&&N(null)},[O,L,N]);return(0,tp.O8)(Q,[u.current]),(0,td.useEffect)(()=>{let e=E(g.current||"");!D&&e&&!1===v.current&&(T(e.status||"open"),X(e._id,"url"),v.current=!0,g.current=void 0,f({...p,comment:void 0}))},[E,X,D,p,f,T]),(0,tc.jsxs)(td.Fragment,{children:[r&&n&&(0,tc.jsx)(cL,{...r,error:o,loading:a,onClose:q,onConfirm:Y}),(0,tc.jsxs)(tp.kC,{direction:"column",flex:1,height:"fill",onClick:Q,overflow:"hidden",ref:u,children:[(0,tc.jsx)(cH,{onDismiss:_,open:!w,placement:"left-start",children:(0,tc.jsx)(up,{onClose:U,onViewChange:Z,view:M})}),h&&(0,tc.jsx)(cA,{comments:A,currentUser:h,error:k.error,loading:D,mentionOptions:S,onCopyLink:B,onCreateRetry:F,onDelete:$,onEdit:K,onNewThreadCreate:V,onPathSelect:H,onReply:W,onStatusChange:G,readOnly:I,ref:c,selectedPath:L,status:M}),(0,tc.jsx)(uy,{})]})]})}let uC=(0,tu.mbX)({name:rQ,component:function(e){return(0,tc.jsx)(u_,{children:(0,tc.jsx)(uk,{...e})})},useMenuItem:function(e){let{documentId:t,documentType:n}=e,{isEnabled:i}=cQ({documentId:t,documentType:n});return{hidden:!i,icon:to.qtd,showAsAction:!0,title:"Comments"}}});var uz=Object.freeze,uE=Object.defineProperty,uI=(e,t)=>uz(uE(e,"raw",{value:uz(t||e.slice())}));let uS={open:500},uP=(0,tm.ZP)(tp.xv)(eA||(eA=uI(["\n  width: max-content;\n"]))),uT=(0,tm.ZP)(tp.Kq)(eD||(eD=uI(["\n  width: 320px;\n"])));function uM(e){let{count:t,currentUser:n,fieldTitle:i,isRunningSetup:r,mentionOptions:l,onChange:a,onClick:s,onCommentAdd:o,onDiscard:d,onInputKeyDown:c,open:u,setOpen:h,value:p}=e,[m,f]=(0,td.useState)(null),[x,g]=(0,td.useState)(null),v=(0,td.useRef)(null),b=t>0,y=(0,td.useCallback)(()=>{u&&(h(!1),null==x||x.focus())},[x,u,h]),j=(0,td.useCallback)(()=>{o(),y()},[y,o]),w=(0,td.useMemo)(()=>l_(p),[p]),_=(0,td.useCallback)(()=>{var e;if(!w){y();return}null==(e=v.current)||e.discardDialogController.open()},[y,w]),k=(0,td.useCallback)(e=>{!e.isDefaultPrevented()&&c&&c(e)},[c]),C=(0,td.useCallback)(()=>{var e;null==(e=v.current)||e.discardDialogController.close()},[]),z=(0,td.useCallback)(()=>{var e;null==(e=v.current)||e.discardDialogController.close(),y(),d()},[y,d]),E=(0,td.useCallback)(e=>{"Escape"===e.key&&(e.preventDefault(),e.stopPropagation(),_())},[_]),I=(0,td.useCallback)(()=>{u&&_()},[u,_]);if((0,tp.O8)(I,[m]),!b){let e=(0,tc.jsxs)(tc.Fragment,{children:["Add comment to ",(0,tc.jsx)("b",{children:i})]}),t=(0,tc.jsx)(uT,{padding:2,space:4,children:(0,tc.jsx)(l6,{currentUser:n,focusLock:!0,focusOnMount:!0,mentionOptions:l,onChange:a,onDiscardCancel:C,onDiscardConfirm:z,onKeyDown:k,onSubmit:j,placeholder:e,readOnly:r,ref:v,value:p})});return(0,tc.jsx)(tp.J2,{constrainSize:!0,content:t,fallbackPlacements:["bottom-end"],open:u,placement:"right-start",portal:!0,ref:f,onKeyDown:E,children:(0,tc.jsx)("div",{children:(0,tc.jsx)(tp.u,{delay:uS,disabled:u,portal:!0,placement:"top",content:(0,tc.jsx)(tp.xu,{padding:2,children:(0,tc.jsx)(tp.xv,{size:1,children:"Add comment"})}),children:(0,tc.jsx)(tp.zx,{"aria-label":"Add comment",disabled:r,fontSize:1,icon:ly,mode:"bleed",onClick:s,padding:2,ref:g,selected:u})})})})}return(0,tc.jsx)(tp.u,{portal:!0,placement:"top",content:(0,tc.jsx)(tp.xu,{padding:2,sizing:"border",children:(0,tc.jsxs)(uP,{size:1,children:["View comment",t>1?"s":""]})}),delay:uS,fallbackPlacements:["bottom"],children:(0,tc.jsx)(tp.zx,{"aria-label":"Open comments",mode:"bleed",onClick:s,padding:2,children:(0,tc.jsxs)(tp.kC,{align:"center",gap:2,children:[(0,tc.jsx)(tp.xv,{size:1,children:(0,tc.jsx)(lj,{})}),(0,tc.jsx)(tp.xv,{size:0,children:t>9?"9+":t})]})})})}var uR=Object.freeze,uO=Object.defineProperty,uA=(e,t)=>uR(uO(e,"raw",{value:uR(t||e.slice())}));let uD={initial:{opacity:0},animate:{opacity:1},exit:{opacity:0}},uL={behavior:"smooth",block:"start"},uN=(0,tm.ZP)(ng.E.div)(e=>{let{theme:t}=e,{radius:n,space:i,color:r}=t.sanity,l=ni.VG.blue[r.dark?900:50].hex;return(0,tm.iv)(eL||(eL=uA(["\n    mix-blend-mode: ",";\n    border-radius: ","px;\n    top: -","px;\n    left: -","px;\n    bottom: -","px;\n    right: -","px;\n    pointer-events: none;\n    position: absolute;\n    z-index: 1;\n    width: calc(100% + ","px);\n    height: calc(100% + ","px);\n    background-color: ",";\n  "])),r.dark?"screen":"multiply",n[3],i[2],i[2],i[2],i[2],2*i[2],2*i[2],l)}),uZ=(0,tm.ZP)(tp.Kq)(eN||(eN=uA(["\n  position: relative;\n"])));function uU(e){let[t,n]=(0,td.useState)(!1),[i,r]=(0,td.useState)(null),l=(0,td.useRef)(null),{element:a}=(0,tp.sz)(),{openInspector:s,inspector:o}=rj(),d=(0,tu.xJ)(),{comments:c,create:u,isRunningSetup:h,mentionOptions:p,setStatus:m,status:f}=cG(),{selectedPath:x,setSelectedPath:g}=c3(),v=(0,td.useMemo)(()=>(0,tu.EZo)(e.schemaType),[e.schemaType]),[b,y]=(0,td.useState)(null),j=(0,td.useMemo)(()=>(null==o?void 0:o.name)===rQ,[null==o?void 0:o.name]),w=(0,td.useMemo)(()=>!!j&&(null==x?void 0:x.origin)!=="form"&&(null==x?void 0:x.origin)!=="url"&&(null==x?void 0:x.fieldPath)===t0.BB(e.path),[j,e.path,x]),_=(0,td.useMemo)(()=>{let t=t0.BB(e.path);return c.data.open.map(e=>e.fieldPath===t?e.commentsCount:0).reduce((e,t)=>e+t,0)||0},[c.data.open,e.path]),k=_>0,C=(0,td.useCallback)(()=>s(rQ),[s]),z=(0,td.useCallback)(t=>{g({threadId:t,origin:"form",fieldPath:t0.BB(e.path)}),y(t)},[e.path,g]),E=(0,td.useCallback)(()=>{var t;if(k){"resolved"===f&&m("open"),n(!1),s(rQ);let i=null==(t=c.data.open.find(t=>t.fieldPath===t0.BB(e.path)))?void 0:t.threadId;i&&z(i);return}n(e=>!e)},[f,k,z,c.data,m,s,e.path]),I=(0,td.useCallback)(()=>{if(i){let t=(0,t6.Z)(),n={fieldPath:t0.BB(e.path),message:i,parentCommentId:void 0,status:"open",threadId:t};u.execute(n),C(),"resolved"===f&&m("open"),r(null),z(t)}},[u,C,z,e.path,m,f,i]),S=(0,td.useCallback)(()=>r(null),[]),P=(0,td.useMemo)(()=>({...uL,boundary:a,scrollMode:"if-needed",block:"start"}),[a]);(0,td.useEffect)(()=>{w&&l.current&&j&&(0,nx.Z)(l.current,P)},[a,j,w,e.path,P]),(0,td.useEffect)(()=>{if(j&&b){let e=document.querySelector('[data-group-id="'.concat(b,'"]'));e&&(e.scrollIntoView(uL),y(null))}},[j,b]);let T=(0,td.useMemo)(()=>({button:d&&(0,tc.jsx)(uM,{count:Number(_),currentUser:d,fieldTitle:v,isRunningSetup:h,mentionOptions:p,onChange:r,onClick:E,onCommentAdd:I,onDiscard:S,open:t,setOpen:n,value:i}),hasComments:k,isAddingComment:t}),[d,_,v,p,E,I,S,t,i,h,k]);return(0,tc.jsxs)(uZ,{ref:l,children:[e.renderDefault({...e,__internal_comments:T}),(0,tc.jsx)(nv.M,{children:w&&(0,tc.jsx)(uN,{animate:"animate",exit:"exit",initial:"initial",variants:uD})})]})}let uB=(0,tu.Cw0)({name:"sanity/desk/comments",document:{inspectors:[uC]},form:{components:{field:function(e){let{documentId:t,documentType:n}=rj(),{isEnabled:i}=cQ({documentId:t,documentType:n});return i?(0,tc.jsx)(uU,{...e}):e.renderDefault(e)}}},studio:{components:{layout:function(e){return(0,tc.jsx)(ud,{children:(0,tc.jsx)(c5,{children:e.renderDefault(e)})})}}}}),uF="sanityStudio:desk:renameDismissed",uq=(()=>{if("undefined"==typeof localStorage)return!1;let e="lsCheck";try{return localStorage.setItem(e,e),localStorage.removeItem(e),!0}catch(e){return!1}})(),uH=(0,nb.h)("desk-is-now-structure");function uV(e){let t=(0,td.useCallback)(e=>{e.stopPropagation()},[]);return(0,tc.jsxs)(tp.Kq,{as:"section",padding:3,space:3,onClick:t,children:[(0,tc.jsxs)(tp.Kq,{padding:2,space:4,children:[(0,tc.jsx)(tp.kC,{gap:2,align:"center",children:(0,tc.jsxs)(tp.xv,{as:"h1",size:1,weight:"semibold",children:[(0,tc.jsx)("strong",{children:"Desk"})," is now ",(0,tc.jsx)("strong",{children:"Structure"})]})}),(0,tc.jsx)(tp.Kq,{space:3,children:(0,tc.jsx)(tp.xv,{as:"p",muted:!0,size:1,children:"We've renamed this tool to better reflect its purpose alongside the new Presentation tool."})})]}),(0,tc.jsxs)(tp.rj,{columns:2,gap:3,children:[(0,tc.jsx)(tp.zx,{as:"a","data-as":"a",href:uH,icon:to.buG,target:"_blank",rel:"noreferrer",fontSize:1,padding:3,text:"Learn more",mode:"ghost"}),(0,tc.jsx)(tp.zx,{fontSize:1,icon:to.KML,onClick:e.onDismiss,padding:3,text:"Got it",tone:"primary"})]})]})}let uW=(0,td.createContext)(null);function uK(){let e=(0,td.useContext)(uW);if(!e)throw Error("DeskTool: missing context value");return e}let u$={create:"created",delete:"deleted",discardDraft:"discarded draft",initial:"created",editDraft:"edited",editLive:"live edited",publish:"published",unpublish:"unpublished"},uY={create:to.agZ,delete:to.XHJ,discardDraft:to.Two,initial:to.agZ,editDraft:to.dY8,editLive:to.dY8,publish:to.EI4,unpublish:to.xEY};function uX(e){let{maxLength:t,userIds:n}=e;return(0,tc.jsx)(tp.Jh,{maxLength:t,children:n.map(e=>(0,tc.jsx)(tu.YtX,{user:e,withTooltip:!0},e))})}var uG=Object.freeze,uQ=Object.defineProperty,uJ=(e,t)=>uG(uQ(e,"raw",{value:uG(t||e.slice())}));let u0=(0,tm.ZP)(tp.kC)(e=>{var t;let{theme:n}=e,i=null==(t=n.sanity.color.base.skeleton)?void 0:t.from;return(0,tm.iv)(eZ||(eZ=uJ(["\n    --timeline-hairline-width: 1px;\n    position: relative;\n    z-index: 2;\n    margin: 0;\n    padding: 0;\n\n    &::before {\n      position: absolute;\n      content: '';\n      height: 100%;\n      width: var(--timeline-hairline-width);\n      background: ",";\n      top: 0;\n      left: calc((100% - var(--timeline-hairline-width)) / 2);\n      z-index: 1;\n    }\n  "])),i)}),u1=(0,tm.ZP)(tp.zx)(e=>{let{$selected:t,$disabled:n}=e;return(0,tm.iv)(eF||(eF=uJ(["\n    position: relative;\n    width: 100%;\n\n    /* Line styling */\n    &[data-first] ","::before {\n      height: 50%;\n      top: unset;\n      bottom: 0;\n    }\n\n    &[data-last] ","::before {\n      height: 50%;\n    }\n\n    ","\n\n    ","\n  "])),u0,u0,t&&(0,tm.iv)(eU||(eU=uJ(["\n      ","::before {\n        background: transparent;\n      }\n    "])),u0),n&&(0,tm.iv)(eB||(eB=uJ(["\n      cursor: not-allowed;\n    "]))))}),u2=(0,tm.ZP)(tp.xu)(eq||(eq=uJ(["\n  background: var(--card-bg-color);\n  border-radius: 50px;\n  position: relative;\n  z-index: 2;\n"]))),u5=(0,tm.ZP)(tp.xv)(eH||(eH=uJ(["\n  text-transform: capitalize;\n"]))),u3=(0,tm.ZP)(tp.xu)(eV||(eV=uJ(["\n  min-width: 1rem;\n  margin-left: ",";\n"])),e=>{let{theme:t}=e;return"-".concat((0,tp.hO)(t.sanity.space[1]))}),u6={initial:"primary",create:"primary",publish:"positive",editLive:"caution",editDraft:"caution",unpublish:"critical",discardDraft:"critical",delete:"critical",withinSelection:"primary"};function u8(e){let{chunk:t,isFirst:n,isLast:i,isLatest:r,isSelected:l,onSelect:a,timestamp:s,type:o}=e,d=uY[o],c=Array.from(t.authors),u="delete"!==o,h=(0,td.useMemo)(()=>{let e=new Date(s);return(0,nr.Z)(e,"MMM d, yyyy, hh:mm a")},[s]),p=(0,td.useCallback)(e=>{e.preventDefault(),e.stopPropagation(),u&&a(t)},[a,t,u]);return(0,tc.jsx)(u1,{$selected:l,$disabled:!u,"data-chunk-id":t.id,"data-first":!!n||void 0,"data-last":!!i||void 0,"data-ui":"timelineItem",mode:l?"default":"bleed",onClick:p,padding:0,radius:2,tone:l?"primary":u6[t.type],children:(0,tc.jsx)(tp.xu,{paddingX:2,children:(0,tc.jsxs)(tp.kC,{align:"stretch",children:[(0,tc.jsx)(u0,{align:"center",children:(0,tc.jsx)(u2,{padding:2,children:(0,tc.jsx)(tp.xv,{size:2,children:d&&(0,td.createElement)(d)})})}),(0,tc.jsxs)(tp.Kq,{space:2,margin:2,children:[r&&(0,tc.jsx)(tp.kC,{children:(0,tc.jsx)(tp.Zb,{padding:1,radius:2,shadow:1,tone:l?"primary":u6[t.type],children:(0,tc.jsx)(tp.__,{muted:!0,size:0,children:"Latest"})})}),(0,tc.jsx)(tp.xu,{children:(0,tc.jsx)(u5,{size:1,weight:"medium",children:u$[o]||(0,tc.jsx)("code",{children:o})})}),(0,tc.jsx)(u3,{paddingX:1,children:(0,tc.jsx)(tp.xv,{size:0,muted:!0,children:h})})]}),(0,tc.jsx)(tp.kC,{flex:1,justify:"flex-end",align:"center",children:(0,tc.jsx)(uX,{maxLength:3,userIds:c})})]})})})}var u4=Object.freeze,u9=Object.defineProperty,u7=(e,t)=>u4(u9(e,"raw",{value:u4(t||e.slice())}));let he=(0,tm.ZP)(tp.Kq)(eW||(eW=u7(["\n  max-width: 200px;\n"]))),ht=(0,tm.ZP)(tp.kC)(eK||(eK=u7(["\n  max-height: calc(100vh - 198px);\n  min-width: 244px;\n"]))),hn=(0,tm.ZP)(tp.xu)(e=>{let{$visible:t}=e;return(0,tm.iv)(eY||(eY=u7(["\n    opacity: 0;\n    pointer-events: none;\n\n    ","\n  "])),t&&(0,tm.iv)(e$||(e$=u7(["\n      opacity: 1;\n      pointer-events: auto;\n    "]))))}),hi=e=>{let{chunks:t,disabledBeforeFirstChunk:n,hasMoreChunks:i,lastChunk:r,onLoadMore:l,onSelect:a,firstChunk:s}=e,[o,d]=(0,td.useState)(!1),c=(0,td.useMemo)(()=>t.filter(e=>!n||!s||e.index<s.index),[t,n,s]),u=(0,td.useMemo)(()=>(null==r?void 0:r.id)?c.findIndex(e=>e.id===r.id):-1,[null==r?void 0:r.id,c]),h=(0,td.useCallback)((e,t)=>{let{activeIndex:r}=t,l=0===r,s=c&&r===c.length-1||!1;return(0,tc.jsxs)(tp.xu,{paddingBottom:s?1:0,paddingTop:l?1:0,paddingX:1,children:[(0,tc.jsx)(u8,{chunk:e,isFirst:l,isLast:s,isLatest:0===r&&!n,isSelected:r===u,onSelect:a,timestamp:e.endTimestamp,type:e.type}),r===c.length-1&&i&&(0,tc.jsx)(tp.kC,{align:"center",justify:"center",padding:4,children:(0,tc.jsx)(tp.$j,{muted:!0})})]})},[n,c,i,a,u]);return(0,td.useEffect)(()=>d(!0),[]),(0,tc.jsxs)(hn,{$visible:!u||o,"data-ui":"timeline",children:[0===c.length&&(0,tc.jsxs)(he,{padding:3,space:3,children:[(0,tc.jsx)(tp.xv,{size:1,weight:"semibold",children:"No document history"}),(0,tc.jsx)(tp.xv,{muted:!0,size:1,children:"When changing the content of the document, the document versions will appear in this menu."})]}),c.length>0&&(0,tc.jsx)(ht,{direction:"column",children:(0,tc.jsx)(tu.e8h,{activeItemDataAttr:"data-hovered",ariaLabel:"Document revisions",autoFocus:"list",initialIndex:u,initialScrollAlign:"center",itemHeight:40,items:c,onEndReached:l,onEndReachedIndexOffset:20,overscan:5,renderItem:h,wrapAround:!1})})]})};function hr(){return(0,tc.jsxs)(tp.kC,{align:"flex-start",gap:3,padding:4,children:[(0,tc.jsx)(tu.LPT,{tone:"critical",children:(0,tc.jsx)(to.uIy,{})}),(0,tc.jsxs)(tp.Kq,{space:4,children:[(0,tc.jsx)(tu.LPT,{size:1,tone:"critical",weight:"semibold",children:"An error occurred whilst retrieving document changes."}),(0,tc.jsx)(tu.LPT,{size:1,tone:"critical",children:"Document history transactions have not been affected."})]})]})}hi.displayName="Timeline";var hl=Object.freeze,ha=Object.defineProperty;let hs=(0,tm.ZP)(tp.J2)(eX||(eX=hl(ha(k=["\n  overflow: hidden;\n  overflow: clip;\n"],"raw",{value:hl(k.slice())}))));function ho(e){var t;let{chunk:n,mode:i,placement:r}=e,{setTimelineRange:l,setTimelineMode:a,timelineError:s,ready:o,timelineStore:d,isDeleted:c}=rj(),[u,h]=(0,td.useState)(!1),[p,m]=(0,td.useState)(null),[f,x]=(0,td.useState)(null),g=(0,tp.pm)(),v=(0,tu.P08)(d,e=>e.chunks),b=(0,tu.P08)(d,e=>e.isLoading),y=(0,tu.P08)(d,e=>e.hasMoreChunks),j=(0,tu.P08)(d,e=>e.realRevChunk),w=(0,tu.P08)(d,e=>e.sinceTime),_=(0,td.useCallback)(()=>{a(i),h(!0)},[i,a]),k=(0,td.useCallback)(()=>{a("closed"),h(!1)},[a]),C=(0,td.useCallback)(()=>{u&&k()},[k,u]),z=(0,td.useCallback)(e=>{u&&("Escape"===e.key||"Tab"===e.key)&&(k(),null==p||p.focus())},[p,k,u]);(0,tp.O8)(C,[p,f]),(0,tp.qh)(z);let E=(0,td.useCallback)(e=>{try{let[t,n]=d.findRangeForRev(e);a("closed"),l(t,n)}catch(e){g.push({closable:!0,description:e.message,status:"error",title:"Unable to load revision"})}},[a,l,d,g]),I=(0,td.useCallback)(e=>{try{let[t,n]=d.findRangeForSince(e);a("closed"),l(t,n)}catch(e){g.push({closable:!0,description:e.message,status:"error",title:"Unable to load revision"})}},[a,l,d,g]),S=(0,td.useCallback)(()=>{b||d.loadMore()},[b,d]),P=s?(0,tc.jsx)(hr,{}):(0,tc.jsxs)(tc.Fragment,{children:["rev"===i&&(0,tc.jsx)(hi,{chunks:v,firstChunk:j,hasMoreChunks:y,lastChunk:j,onLoadMore:S,onSelect:E}),"since"===i&&(0,tc.jsx)(hi,{chunks:v,disabledBeforeFirstChunk:!0,firstChunk:j,hasMoreChunks:y,lastChunk:w,onLoadMore:S,onSelect:I})]}),T=(t=(null==n?void 0:n.endTimestamp)||"",(0,td.useMemo)(()=>{let e=t?new Date(t):new Date;return(0,nr.Z)(e,"MMM d, yyyy, hh:mm a")},[t])),M=n?"".concat(nj()(u$[n.type]),": ").concat(T):"Latest version",R="rev"===i?M:n?"Since: ".concat(T):"Since: unknown version";return(0,tc.jsx)(hs,{constrainSize:!0,content:u&&P,"data-ui":"versionMenu",open:u,placement:r,portal:!0,ref:x,children:(0,tc.jsx)(tp.zx,{disabled:!o,mode:"bleed",fontSize:1,padding:2,iconRight:to.GVG,onClick:u?k:_,ref:m,selected:u,style:{maxWidth:"100%"},text:o?R:"Loading history"})})}let hd=(0,tm.ZP)(tp.Zb)({position:"relative",zIndex:1,lineHeight:0,"&:after":{content:'""',display:"block",position:"absolute",left:0,bottom:-1,right:0,borderBottom:"1px solid var(--card-border-color)",opacity:.5}});function hc(e){let{as:t,children:n,closeButtonLabel:i,onClose:r,title:l,...a}=e;return(0,tc.jsxs)(hd,{...a,as:t,children:[(0,tc.jsxs)(tp.kC,{padding:2,children:[(0,tc.jsx)(tp.xu,{flex:1,padding:3,children:(0,tc.jsx)(tp.xv,{as:"h1",size:1,weight:"semibold",children:l})}),(0,tc.jsx)(tp.xu,{flex:"none",padding:1,children:(0,tc.jsx)(tp.zx,{"aria-label":i,fontSize:1,icon:to.Two,mode:"bleed",onClick:r,padding:2})})]}),n]})}var hu=Object.freeze,hh=Object.defineProperty;let hp=tm.ZP.div(eG||(eG=hu(hh(C=["\n  position: absolute;\n  top: 0;\n  left: -4px;\n  bottom: 0;\n  width: 9px;\n  z-index: 201;\n  cursor: ew-resize;\n\n  /* Border */\n  & > span:nth-child(1) {\n    display: block;\n    border-left: 1px solid var(--card-border-color);\n    position: absolute;\n    top: 0;\n    left: 4px;\n    bottom: 0;\n    transition: opacity 200ms;\n    opacity: 0.5;\n  }\n\n  /* Hover effect */\n  & > span:nth-child(2) {\n    display: block;\n    position: absolute;\n    top: 0;\n    left: 0;\n    width: 9px;\n    bottom: 0;\n    background-color: var(--card-border-color);\n    opacity: 0;\n    transition: opacity 150ms;\n  }\n\n  @media (hover: hover) {\n    &:hover > span:nth-child(2) {\n      opacity: 0.2;\n    }\n  }\n"],"raw",{value:hu(C.slice())}))));function hm(e){let{onResize:t,onResizeStart:n}=e,i=(0,td.useRef)(0),r=(0,td.useCallback)(e=>{e.preventDefault(),i.current=e.pageX,n();let r=e=>{e.preventDefault(),t(e.pageX-i.current)},l=()=>{window.removeEventListener("mousemove",r),window.removeEventListener("mouseup",l)};window.addEventListener("mousemove",r),window.addEventListener("mouseup",l)},[t,n]);return(0,tc.jsxs)(hp,{onMouseDown:r,children:[(0,tc.jsx)("span",{}),(0,tc.jsx)("span",{})]})}var hf=Object.freeze,hx=Object.defineProperty;let hg=(0,tm.ZP)(tp.xu)(eQ||(eQ=hf(hx(z=["\n  position: relative;\n  flex: 1;\n  padding-left: 1px;\n"],"raw",{value:hf(z.slice())}))));function hv(e){let{as:t,children:n,minWidth:i,maxWidth:r,...l}=e,[a,s]=(0,td.useState)(null),o=(0,td.useRef)(),[d,c]=(0,td.useState)(),u=(0,td.useCallback)(()=>{o.current=null==a?void 0:a.offsetWidth},[a]),h=(0,td.useCallback)(e=>{let t=o.current;t&&c(Math.min(Math.max(t-e,i),r))},[i,r]),p=(0,td.useMemo)(()=>d?{flex:"none",width:d}:{minWidth:i,maxWidth:r},[i,r,d]);return(0,tc.jsxs)(hg,{as:t,...l,ref:s,style:p,children:[n,(0,tc.jsx)(hm,{onResize:h,onResizeStart:u})]})}function hb(e){let{documentId:t,documentType:n,flex:i}=e,{collapsed:r}=iZ(),{closeInspector:l,inspector:a}=rj(),{features:s}=uK(),o=(0,td.useCallback)(()=>{a&&l(a.name)},[l,a]);if(r||!a)return null;let d=(0,td.createElement)(a.component,{onClose:o,documentId:t,documentType:n});return s.resizablePanes?(0,tc.jsx)(hv,{as:"aside","data-ui":"DocumentInspectorPanel",flex:i,maxWidth:540,minWidth:320,children:d}):(0,tc.jsx)(tp.xu,{as:"aside","data-ui":"DocumentInspectorPanel",flex:i,children:d})}function hy(){return(0,tc.jsx)(nW,{ms:300,children:(0,tc.jsxs)(tp.kC,{align:"center",direction:"column",height:"fill",justify:"center",paddingTop:3,children:[(0,tc.jsx)(tp.$j,{muted:!0}),(0,tc.jsx)(tp.xu,{marginTop:3,children:(0,tc.jsx)(tp.xv,{align:"center",muted:!0,size:1,children:"Loading changes"})})]})})}var hj=Object.freeze,hw=Object.defineProperty;let h_=(0,tm.ZP)(tu.l$t)(eJ||(eJ=hj(hw(E=["\n  height: 100%;\n  overflow: auto;\n  position: relative;\n  scroll-behavior: smooth;\n"],"raw",{value:hj(E.slice())}))));function hk(e){let{error:t,diff:n,documentContext:i,loading:r,schemaType:l}=e;return t?(0,tc.jsx)(tu.kwM,{}):r?(0,tc.jsx)(hy,{}):n?(0,tc.jsx)(tu.H7Z.Provider,{value:i,children:(0,tc.jsx)(tu.EyJ,{diff:n,schemaType:l})}):(0,tc.jsx)(tu.kwM,{})}let hC={error:to.uIy,warning:to.foC,info:to.hQ6},hz={error:"critical",warning:"caution",info:"primary"};function hE(e){let{marker:t,onOpen:n,schemaType:i,value:r}=e,l=(0,td.useCallback)(()=>n(t.path),[t,n]),[a,s]=(0,td.useState)(null);return(0,tc.jsxs)(tp.SV,{onCatch:s,children:[a&&(0,tc.jsx)(tp.Zb,{padding:3,radius:2,tone:"critical",children:(0,tc.jsxs)(tp.xv,{size:1,children:["ERROR: ",a.error.message]})}),!a&&(0,tc.jsx)(tp.Zb,{__unstable_focusRing:!0,as:"button",onClick:l,padding:3,radius:2,tone:hz[t.level],children:(0,tc.jsxs)(tp.kC,{align:"flex-start",gap:3,children:[(0,tc.jsx)(tp.xu,{flex:"none",children:(0,tc.jsx)(tp.xv,{size:1,children:(0,td.createElement)(hC[t.level])})}),(0,tc.jsxs)(tp.Kq,{flex:1,space:2,children:[(0,tc.jsx)(hI,{path:t.path,schemaType:i,value:r}),(0,tc.jsx)(tp.xv,{muted:!0,size:1,children:t.item.message})]})]})})]})}function hI(e){let{path:t,schemaType:n,value:i}=e,r=(0,td.useMemo)(()=>(function(e){let{path:t,schemaType:n,value:i}=e,r=[],l=n,a=i;for(let e of t){if("string"==typeof e){if(!(0,tu.Uy$)(a)&&void 0!==a)throw Error("Parent value is not an object, cannot get path segment: .".concat(e));if("object"!==l.jsonType)throw Error("Parent type is not an object schema type, cannot get path segment: .".concat(e));a=null==a?void 0:a[e];let t=l.fields.find(t=>t.name===e);if(!t)throw Error("Field type not found: .".concat(e));l=t.type,r.push(l);continue}if("number"==typeof e){if(!(0,tu.kJL)(a)&&void 0!==a)throw Error("Parent value is not an array, cannot get path segment: [".concat(e,"]"));if("array"!==l.jsonType)throw Error("Parent type is not an array schema type, cannot get path segment: [".concat(e,"]"));a=null==a?void 0:a[e];let t=l.of.find(e=>"string"==typeof a?"string"===e.jsonType:"number"==typeof a?"number"===e.jsonType:"boolean"==typeof a?"boolean"===e.jsonType:!!(0,tu.Uy$)(a)&&e.name===(null==a?void 0:a._type));if(!t)throw Error("Item type not found: [".concat(e,"]"));l=t,r.push(l);continue}if((0,tu.Uy$)(e)&&e._key){if(!(0,tu.kJL)(a))throw Error("Parent value is not an array, cannot get path segment: [_key == ".concat(e,"]"));if("array"!==l.jsonType)throw Error("Parent type is not an array schema type, cannot get path segment: .".concat(e));if(a=(null!=a?a:[]).find(t=>(0,tu.Uy$)(t)&&t._key===e._key),!(0,tu.Uy$)(a))throw Error("Array item not found: [_key == ".concat(e._key,"]"));let t=l.of.find(e=>(0,tu.Uy$)(a)&&e.name===(null==a?void 0:a._type));if(!t)throw Error("Array item type not found: .".concat(null==a?void 0:a._type));l=t,r.push(l);continue}throw Error("Invalid path segment: ".concat(JSON.stringify(e)))}return r})({path:t,schemaType:n,value:i}),[t,n,i]);return(0,tc.jsx)(tp.xv,{size:1,children:r.map((e,t)=>(0,tc.jsxs)(td.Fragment,{children:[t>0&&(0,tc.jsx)("span",{style:{color:"var(--card-muted-fg-color)",opacity:.5},children:" / "}),(0,tc.jsx)("span",{style:{fontWeight:500},children:e.title||e.name})]},t))})}let hS=[rP,rM,rC,rE,r_,rI],hP=[e=>{let{liveEdit:t}=e;return t?{label:"Live",color:"danger"}:null}],hT=[{name:"sanity/desk/validation",component:function(e){let{onClose:t}=e,{onFocus:n,onPathOpen:i,schemaType:r,validation:l,value:a}=rj(),s=(0,td.useCallback)(e=>{i(e),n(e)},[n,i]);return(0,tc.jsxs)(tp.kC,{direction:"column",height:"fill",overflow:"hidden",children:[(0,tc.jsx)(hc,{as:"header",closeButtonLabel:"Close validation",flex:"none",onClose:t,title:"Validation"}),(0,tc.jsxs)(tp.Zb,{flex:1,overflow:"auto",padding:3,children:[0===l.length&&(0,tc.jsx)(tp.xu,{padding:2,children:(0,tc.jsx)(tp.xv,{muted:!0,size:1,children:"No validation errors"})}),l.length>0&&(0,tc.jsx)(tp.Kq,{space:2,children:l.map((e,t)=>(0,tc.jsx)(hE,{marker:e,onOpen:s,schemaType:r,value:a},t))})]})]})},useMenuItem:function(e){let{documentId:t,documentType:n}=e,{validation:i}=(0,tu.a3k)(t,n),r=(0,td.useMemo)(()=>i.map(e=>({level:e.level,message:e.item.message,path:e.path})),[i]),l=r.some(th.z1),a=r.some(th.AY),s=(0,td.useMemo)(()=>l?to.uIy:a?to.foC:to.nSX,[l,a]),o=(0,td.useMemo)(()=>l?"critical":a?"caution":"positive",[l,a]);return{hidden:0===r.length,icon:s,title:"Validation",tone:o,showAsAction:!0}}},{name:rG,useMenuItem:()=>{let{features:e}=uK();return{hidden:!e.reviewChanges,icon:to.vaD,title:"Review changes"}},component:function(e){let{onClose:t}=e,{documentId:n,schemaType:i,timelineError:r,timelineStore:l,value:a}=rj(),s=(0,td.useRef)(null),o=(0,tu.P08)(l,e=>e.diff),d=(0,tu.P08)(l,e=>e.onOlderRevision),c=(0,tu.P08)(l,e=>e.selectionState),u=(0,tu.P08)(l,e=>e.sinceTime),h=!d,p=td.useMemo(()=>({documentId:n,schemaType:i,FieldWrapper:tu.MUX,rootDiff:o,isComparingCurrent:h,value:a}),[n,o,h,i,a]),m=td.useMemo(()=>o?function(e){let t=new Map;return(0,tu.Z7x)(e,e=>{if("unchanged"===e.action||!("annotation"in e)||!e.annotation)return!0;let{author:n,timestamp:i}=e.annotation,r=t.get(n);return(!r||r.timestamp<i)&&t.set(n,e.annotation),!0}),Array.from(t.values()).sort((e,t)=>e.timestamp<t.timestamp?1:-1)}(o):[],[o]);return(0,tc.jsxs)(tp.kC,{"data-testid":"review-changes-pane",direction:"column",height:"fill",overflow:"hidden",children:[(0,tc.jsx)(hc,{as:"header",closeButtonLabel:"Close review changes",flex:"none",onClose:t,title:"Review changes",children:(0,tc.jsxs)(tp.kC,{gap:1,padding:3,paddingTop:0,paddingBottom:2,children:[(0,tc.jsx)(tp.xu,{flex:1,children:(0,tc.jsx)(ho,{mode:"since",chunk:u,placement:"bottom-start"})}),(0,tc.jsx)(tp.xu,{flex:"none",children:(0,tc.jsx)(tu.IIC,{annotations:m,description:"Changes by",portal:!0,children:(0,tc.jsx)(tp.Jh,{maxLength:4,"aria-label":"Changes by",children:m.map(e=>{let{author:t}=e;return(0,tc.jsx)(tu.YtX,{user:t},t)})})})})]})}),(0,tc.jsx)(tp.Zb,{flex:1,children:(0,tc.jsx)(tp.NM,{element:s.current,children:(0,tc.jsx)(h_,{"data-ui":"Scroller",ref:s,children:(0,tc.jsx)(tp.xu,{flex:1,padding:4,children:(0,tc.jsx)(hk,{diff:o,documentContext:p,error:r,loading:"loading"===c,schemaType:i})})})})})]})},onClose:e=>{let{params:t}=e;return{params:{...t,since:void 0}}},onOpen:e=>{let{params:t}=e;return{params:{...t,since:"@lastPublished"}}}}],hM=(0,tu.Cw0)(e=>{let t=!!e&&"string"==typeof e.name,i=(null==e?void 0:e.icon)||to.kLv,r=t?i:function(){let[e,t]=(0,td.useState)(void 0),{showOnboarding:n,dismissOnboarding:r}=function(){let[e,t]=(0,td.useState)(()=>!(!uq||"1"===localStorage.getItem(uF)));return(0,td.useEffect)(()=>{if("undefined"==typeof window||!uq)return()=>{};function e(e){e.newValue!==e.oldValue&&e.key===uF&&t("1"!==e.newValue)}return window.addEventListener("storage",e),()=>{window.removeEventListener("storage",e)}},[]),{showOnboarding:e,dismissOnboarding:(0,td.useCallback)(()=>{t(!1),uq&&localStorage.setItem(uF,"1")},[])}}(),l=(0,td.useCallback)(e=>{let n=null==e?void 0:e.closest("[data-hidden]");t((null==n?void 0:n.getAttribute("data-hidden"))!=="true")},[]);return(0,tc.jsx)("div",{ref:l,children:(0,tc.jsx)(tp.J2,{content:(0,tc.jsx)(uV,{onDismiss:r}),open:n&&e,portal:!0,placement:"bottom",fallbackPlacements:["top","bottom"],__unstable_margins:[9,0,0,0],tone:"default",width:0,children:(0,tc.jsx)(i,{})})})};return{name:"@sanity/desk-tool",document:{actions:e=>Array.from(new Set([...e,...hS])),badges:e=>Array.from(new Set([...e,...hP])),inspectors:e=>Array.from(new Set([...e,...hT]))},plugins:[uB()],tools:[{name:(null==e?void 0:e.name)||"structure",title:(null==e?void 0:e.title)||"Structure",icon:r,component:(0,td.lazy)(()=>n.e(573).then(n.bind(n,38573))),canHandleIntent:(e,t)=>{var n;return"create"===e?"type"in t&&(!("template"in t)||{template:!0}):"edit"===e&&"id"in(n=t)&&(!("mode"in n)||{mode:"structure"===n.mode})},getIntentState:rZ,controlsDocumentTitle:!0,options:e,router:rB}]}});class hR extends Error{constructor(e,t,n,i){super(e);let r=void 0===n?"<unknown>":"".concat(n);this.path=(t||[]).concat(i?"".concat(r," (").concat(i,")"):r)}withHelpUrl(e){return this.helpId=e,this}}var hO=((I=hO||{}).ID_REQUIRED="structure-node-id-required",I.TITLE_REQUIRED="structure-title-required",I.FILTER_REQUIRED="structure-filter-required",I.INVALID_LIST_ITEM="structure-invalid-list-item",I.COMPONENT_REQUIRED="structure-view-component-required",I.DOCUMENT_ID_REQUIRED="structure-document-id-required",I.DOCUMENT_TYPE_REQUIRED="structure-document-type-required",I.SCHEMA_TYPE_REQUIRED="structure-schema-type-required",I.SCHEMA_TYPE_NOT_FOUND="structure-schema-type-not-found",I.LIST_ITEMS_MUST_BE_ARRAY="structure-list-items-must-be-array",I.QUERY_PROVIDED_FOR_FILTER="structure-query-provided-for-filter",I.ACTION_OR_INTENT_REQUIRED="structure-action-or-intent-required",I.LIST_ITEM_IDS_MUST_BE_UNIQUE="structure-list-item-ids-must-be-unique",I.ACTION_AND_INTENT_MUTUALLY_EXCLUSIVE="structure-action-and-intent-mutually-exclusive",I.API_VERSION_REQUIRED_FOR_CUSTOM_FILTER="structure-api-version-required-for-custom-filter",I);let hA=["_id","_type","_createdAt","_updatedAt","_rev"],hD={title:"Last edited",name:"lastEditedDesc",by:[{field:"_updatedAt",direction:"desc"}]},hL=[hD,{title:"Created",name:"lastCreatedDesc",by:[{field:"_createdAt",direction:"desc"}]}];function hN(e,t,n){return e instanceof hZ?e.serialize({path:n,index:t}):e}class hZ{constructor(e,t){this._context=e,this.spec=t||{}}action(e){return this.clone({action:e})}getAction(){return this.spec.action}intent(e){return this.clone({intent:e})}getIntent(){return this.spec.intent}title(e){return this.clone({title:e})}getTitle(){return this.spec.title}group(e){return this.clone({group:e})}getGroup(){return this.spec.group}icon(e){return this.clone({icon:e})}getIcon(){return this.spec.icon}params(e){return this.clone({params:e})}getParams(){return this.spec.params}showAsAction(){let e=!(arguments.length>0)||void 0===arguments[0]||arguments[0];return this.clone({showAsAction:!!e})}getShowAsAction(){return this.spec.showAsAction}serialize(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{path:[]},{title:t,action:n,intent:i}=this.spec;if(!t)throw new hR("`title` is required for menu item",e.path,e.index,"string"==typeof n?'action: "'.concat(n,'"'):void 0).withHelpUrl(hO.TITLE_REQUIRED);if(!n&&!i)throw new hR("`action` or `intent` required for menu item with title ".concat(this.spec.title),e.path,e.index,'"'.concat(t,'"')).withHelpUrl(hO.ACTION_OR_INTENT_REQUIRED);if(i&&n)throw new hR("cannot set both `action` AND `intent`",e.path,e.index,'"'.concat(t,'"')).withHelpUrl(hO.ACTION_AND_INTENT_MUTUALLY_EXCLUSIVE);return{...this.spec,title:t}}clone(e){let t=new hZ(this._context);return t.spec={...this.spec,...e||{}},t}}function hU(e,t,n){return new hZ(e).group("sorting").title("Sort by ".concat(t.title)).icon(to.fzI).action("setSortOrder").params({by:t.by,extendedProjection:n})}function hB(e,t){let{schema:n}=e,i="string"==typeof t?n.get(t):t;return i&&"orderings"in i?(i.orderings?i.orderings.concat(hL):hL).map(t=>hU(e,t,t.by.map(e=>(function e(t,n){let[i,...r]=n;if(!("fields"in t))return"";let l=t.fields.find(e=>e.name===i);if(!l)return hA.includes(i)||console.warn('The current ordering config targeted the nonexistent field "%s" on schema type "%s". It should be one of %o',i,t.name,t.fields.map(e=>e.name)),"";if("to"in l.type&&"reference"===l.type.name){let t=l.type.to;return"".concat(i,"->{").concat(t.map(t=>e(t,r)).join(","),"}")}let a=r.length>0&&e(l.type,r);return r.length>0?"".concat(i).concat(a?"{".concat(a,"}"):""):i})(i,e.field.split("."))).join(", "))):[]}function hF(e,t,n){return e instanceof hq?e.serialize({path:n,index:t}):e}class hq{constructor(e,t){this._context=e,this._id=t?t.id:"",this._title=t?t.title:""}id(e){return new hq(this._context,{id:e,title:this._title})}getId(){return this._id}title(e){return new hq(this._context,{id:this._id,title:e})}getTitle(){return this._title}serialize(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{path:[]},{_id:t,_title:n}=this;if(!t)throw new hR("`id` is required for a menu item group",e.path,e.index,n).withHelpUrl(hO.ID_REQUIRED);if(!n)throw new hR("`title` is required for a menu item group",e.path,t).withHelpUrl(hO.TITLE_REQUIRED);return{id:t,title:n}}}let hH=/([^A-Za-z0-9-_.])/;function hV(e,t,n){if("string"!=typeof e)throw new hR("Structure node id must be of type string, got ".concat(typeof e),t,n);let[i]=e.match(hH)||[];if(i)throw new hR('Structure node id cannot contain character "'.concat(i,'"'),t,n);if(e.startsWith("__edit__"))throw new hR("Structure node id cannot start with __edit__",t,n);return e}function hW(e,t){if(t)return t;let n=n_()(e);return hH.test(n)?n_()(nC()(e)):n}class hK{constructor(e){this.spec={options:{},...e||{}}}id(e){return this.clone({id:e})}getId(){return this.spec.id}title(e){return this.clone({title:e,id:hW(e,this.spec.id)})}getTitle(){return this.spec.title}child(e){return this.clone({child:e})}getChild(){return this.spec.child}component(e){return this.clone({component:e})}getComponent(){return this.spec.component}options(e){return this.clone({options:e})}getOptions(){return this.spec.options||{}}menuItems(e){return this.clone({menuItems:e})}getMenuItems(){return this.spec.menuItems}menuItemGroups(e){return this.clone({menuItemGroups:e})}getMenuItemGroups(){return this.spec.menuItemGroups}serialize(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{path:[]},{id:t,title:n,child:i,options:r,component:l}=this.spec;if(!t)throw new hR("`id` is required for `component` structure item",e.path,e.index).withHelpUrl(hO.ID_REQUIRED);if(!l)throw new hR("`component` is required for `component` structure item",e.path,e.index).withHelpUrl(hO.ID_REQUIRED);return{id:hV(t,e.path,e.index),title:n,type:"component",child:i,component:l,options:r||{},menuItems:(this.spec.menuItems||[]).map((t,n)=>hN(t,n,e.path)),menuItemGroups:(this.spec.menuItemGroups||[]).map((t,n)=>hF(t,n,e.path))}}clone(e){let t=new hK;return t.spec={...this.spec,...e||{}},t}}async function h$(e,t){let n=(0,tu.vsM)(t),i=(0,tu.qyu)(t);return(await e(tu.Dr7).fetch("*[_id in [$documentId, $draftId]]._type",{documentId:n,draftId:i},{tag:"structure.resolve-type"}))[0]}class hY{constructor(){this.spec={}}id(e){return this.clone({id:e})}getId(){return this.spec.id}title(e){return this.clone({title:e,id:this.spec.id||nS()(e)})}getTitle(){return this.spec.title}icon(e){return this.clone({icon:e})}getIcon(){return this.spec.icon}serialize(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{path:[]},{id:t,title:n,icon:i}=this.spec;if(!t)throw new hR("`id` is required for view item",e.path,e.index).withHelpUrl(hO.ID_REQUIRED);if(!n)throw new hR("`title` is required for view item",e.path,e.index).withHelpUrl(hO.TITLE_REQUIRED);return{id:hV(t,e.path,e.index),title:n,icon:i}}}function hX(e,t,n){return"function"==typeof e.serialize?e.serialize({path:n,index:t}):e}let hG=e=>(0,tu.Uy$)(e)&&"component"===e.type;class hQ extends hY{constructor(e){let t=hG(e)?{...e}:{options:{}};super(),this.spec=t;let n="function"==typeof e?e:this.spec.component;n&&(this.spec=this.component(n).spec)}component(e){return this.clone({component:e})}getComponent(){return this.spec.component}options(e){return this.clone({options:e})}getOptions(){return this.spec.options||{}}serialize(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{path:[]},t=super.serialize(e),n=this.spec.component;if("function"!=typeof n)throw new hR("`component` is required and must be a function for `component()` view item",e.path,e.index).withHelpUrl(hO.COMPONENT_REQUIRED);return{...t,component:n,options:this.spec.options||{},type:"component"}}clone(e){let t=new hQ;return t.spec={...this.spec,...e||{}},t}}class hJ extends hY{constructor(e){super(),this.spec={id:"editor",title:"Editor",...e||{}}}serialize(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{path:[]};return{...super.serialize(e),type:"form"}}clone(e){let t=new hJ;return t.spec={...this.spec,...e||{}},t}}let h0=e=>new hJ(e);var h1=Object.freeze({__proto__:null,ComponentViewBuilder:hQ,FormViewBuilder:hJ,GenericViewBuilder:hY,component:e=>new hQ(e),form:h0,maybeSerializeView:hX});let h2=e=>{let{resolveDocumentNode:t,getClient:n}=e;return async(e,i)=>{let{params:r,path:l}=i,a=r.type,s=l.slice(0,l.length-1),o=l[l.length-1];if(a||(a=await h$(n,e)),!a)throw new hR("Failed to resolve document, and no type provided in parameters.",s,o);return t({documentId:e,schemaType:a})}};class h5{constructor(e,t){this._context=e,this.spec=t||{}}id(e){return this.clone({id:e})}getId(){return this.spec.id}title(e){return this.clone({title:e,id:hW(e,this.spec.id)})}getTitle(){return this.spec.title}child(e){return this.clone({child:e})}getChild(){return this.spec.child}documentId(e){let t=this.spec.id||e;return this.clone({id:t,options:{...this.spec.options||{},id:e}})}getDocumentId(){var e;return null==(e=this.spec.options)?void 0:e.id}schemaType(e){return this.clone({options:{...this.spec.options||{},type:"string"==typeof e?e:e.name}})}getSchemaType(){var e;return null==(e=this.spec.options)?void 0:e.type}initialValueTemplate(e,t){return this.clone({options:{...this.spec.options||{},template:e,templateParameters:t}})}getInitialValueTemplate(){var e;return null==(e=this.spec.options)?void 0:e.template}getInitialValueTemplateParameters(){var e;return null==(e=this.spec.options)?void 0:e.templateParameters}views(e){return this.clone({views:e})}getViews(){return this.spec.views||[]}serialize(){let{path:e=[],index:t,hint:n}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{path:[]},i=e[t||e.length-1],r=this.spec.id||i&&"".concat(i)||"",l={id:r,type:void 0,template:void 0,templateParameters:void 0,...this.spec.options};if("string"!=typeof r||!r)throw new hR("`id` is required for document nodes",e,t,n).withHelpUrl(hO.ID_REQUIRED);if(!l||!l.id)throw new hR("document id (`id`) is required for document nodes",e,r,n).withHelpUrl(hO.DOCUMENT_ID_REQUIRED);if(!l||!l.type)throw new hR("document type (`schemaType`) is required for document nodes",e,r,n);let a=(this.spec.views&&this.spec.views.length>0?this.spec.views:[h0()]).map((t,n)=>hX(t,n,e)),s=a.map(e=>e.id),o=nE()(s.filter((e,t)=>s.includes(e,t+1)));if(o.length>0)throw new hR("document node has views with duplicate IDs: ".concat(o.join(",  ")),e,r,n);return{...this.spec,child:this.spec.child||h2(this._context),id:hV(r,e,t),type:"document",options:function(e){let t={id:e.id||"",type:e.type||"*"};return e.template&&(t.template=e.template),e.templateParameters&&(t.templateParameters=e.templateParameters),t}(l),views:a}}clone(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=new h5(this._context),n={...this.spec.options||{},...e.options||{}};return t.spec={...this.spec,...e,options:n},t}}let h3=["default","card","media","detail","block"],h6=Symbol("Document type list canHandleIntent"),h8=(e,t,n)=>{var i,r;let{pane:l}=n,a="create"===e,s=(null==(i=l.options)?void 0:i.filter)||"",o=(null==(r=l.options)?void 0:r.params)||{},d=l.schemaTypeName?[l.schemaTypeName]:pr(s,o),c=l.initialValueTemplates||[];return a&&t.template?c.some(e=>e.templateId===t.template):"edit"===e&&t.id&&d.includes(t.type)||a&&d.includes(t.type)};h8.identity=h6;class h4{constructor(e,t){this._context=e,this.spec=t||{}}id(e){return this.clone({id:e})}getId(){return this.spec.id}title(e){return this.clone({title:e})}getTitle(){return this.spec.title}description(e){return this.clone({description:e})}getDescription(){return this.spec.description}templateId(e){let t=this.spec.id||e;return this.clone({id:t,templateId:e})}getTemplateId(){return this.spec.templateId}parameters(e){return this.clone({parameters:e})}getParameters(){return this.spec.parameters}serialize(){let{path:e=[],index:t,hint:n}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{path:[]},{spec:i,_context:r}=this,{templates:l}=r;if("string"!=typeof i.id||!i.id)throw new hR("`id` is required for initial value template item nodes",e,t,n).withHelpUrl(hO.ID_REQUIRED);if(!i.templateId)throw new hR("template id (`templateId`) is required for initial value template item nodes",e,i.id,n).withHelpUrl(hO.ID_REQUIRED);let a=l.find(e=>e.id===i.templateId);if(!a)throw new hR("template id (`templateId`) is required for initial value template item nodes",e,i.id,n).withHelpUrl(hO.ID_REQUIRED);return{id:i.id,templateId:i.id,schemaType:a.schemaType,type:"initialValueTemplateItem",description:i.description||a.description,title:i.title||a.title,subtitle:i.subtitle,icon:i.icon||a.icon,initialDocumentId:i.initialDocumentId,parameters:i.parameters}}clone(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=new h4(this._context);return t.spec={...this.spec,...e},t}}function h9(){}let h7=(e,t,n)=>{let{pane:i,index:r}=n;return r<=1&&h8(e,t,{pane:i,index:r})};class pe{constructor(){this.initialValueTemplatesSpecified=!1,this.spec={}}id(e){return this.clone({id:e})}getId(){return this.spec.id}title(e){return this.clone({title:e,id:hW(e,this.spec.id)})}getTitle(){return this.spec.title}defaultLayout(e){return this.clone({defaultLayout:e})}getDefaultLayout(){return this.spec.defaultLayout}menuItems(e){return this.clone({menuItems:e})}getMenuItems(){return this.spec.menuItems}menuItemGroups(e){return this.clone({menuItemGroups:e})}getMenuItemGroups(){return this.spec.menuItemGroups}child(e){return this.clone({child:e})}getChild(){return this.spec.child}canHandleIntent(e){return this.clone({canHandleIntent:e})}getCanHandleIntent(){return this.spec.canHandleIntent}showIcons(){let e=!(arguments.length>0)||void 0===arguments[0]||arguments[0];return this.clone({displayOptions:{...this.spec.displayOptions||{},showIcons:e}})}getShowIcons(){return this.spec.displayOptions?this.spec.displayOptions.showIcons:void 0}initialValueTemplates(e){return this.initialValueTemplatesSpecified=!0,this.clone({initialValueTemplates:Array.isArray(e)?e:[e]})}getInitialValueTemplates(){return this.spec.initialValueTemplates}serialize(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{path:[]},t=this.spec.id||"",n=e.path,i=this.spec.defaultLayout;if(i&&!h3.includes(i))throw new hR("`layout` must be one of ".concat(h3.map(e=>'"'.concat(e,'"')).join(", ")),n,t||e.index,this.spec.title);let r=(this.spec.initialValueTemplates||[]).map((e,t)=>e instanceof h4?e.serialize({path:n,index:t}):e);return{id:hV(t,e.path,t||e.index),title:this.spec.title,type:"genericList",defaultLayout:i,child:this.spec.child||h9,canHandleIntent:this.spec.canHandleIntent||h7,displayOptions:this.spec.displayOptions,initialValueTemplates:r,menuItems:(this.spec.menuItems||[]).map((e,t)=>hN(e,t,n)),menuItemGroups:(this.spec.menuItemGroups||[]).map((e,t)=>hF(e,t,n))}}}let pt=(e,t)=>{var n;let i=(null==(n=e.options)?void 0:n.filter.trim())||"";if(["*","{"].includes(i[0]))throw new hR("`filter` cannot start with `".concat(i[0],"` - looks like you are providing a query, not a filter"),t.path,e.id,e.title).withHelpUrl(hO.QUERY_PROVIDED_FOR_FILTER);return i},pn=e=>(t,n)=>{var i;let r=n.parent,l=(null==(i=n.params)?void 0:i.template)?e.templates.find(e=>e.id===n.params.template):void 0;return Promise.resolve(l?l.schemaType:r.schemaTypeName||h$(e.getClient,t)).then(n=>n?e.resolveDocumentNode({schemaType:n,documentId:t}):new h5(e).id("editor").documentId(t).schemaType(""))};class pi extends pe{constructor(e,t){super(),this._context=e,this.spec=t||{},this.initialValueTemplatesSpecified=!!(null==t?void 0:t.initialValueTemplates)}apiVersion(e){return this.clone({options:{...this.spec.options||{filter:""},apiVersion:e}})}getApiVersion(){var e;return null==(e=this.spec.options)?void 0:e.apiVersion}filter(e){return this.clone({options:{...this.spec.options||{},filter:e}})}getFilter(){var e;return null==(e=this.spec.options)?void 0:e.filter}schemaType(e){let t="string"==typeof e?e:e.name;return this.clone({schemaTypeName:t})}getSchemaType(){return this.spec.schemaTypeName}params(e){return this.clone({options:{...this.spec.options||{filter:""},params:e}})}getParams(){var e;return null==(e=this.spec.options)?void 0:e.params}defaultOrdering(e){if(!Array.isArray(e))throw Error("`defaultOrdering` must be an array of order clauses");return this.clone({options:{...this.spec.options||{filter:""},defaultOrdering:e}})}getDefaultOrdering(){var e;return null==(e=this.spec.options)?void 0:e.defaultOrdering}serialize(){var e;let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{path:[]};if("string"!=typeof this.spec.id||!this.spec.id)throw new hR("`id` is required for document lists",t.path,t.index,this.spec.title).withHelpUrl(hO.ID_REQUIRED);if(!this.spec.options||!this.spec.options.filter)throw new hR("`filter` is required for document lists",t.path,this.spec.id,this.spec.title).withHelpUrl(hO.FILTER_REQUIRED);return(null==(e=this.spec.options)?void 0:e.filter)!=="_type == $type"&&this.spec.options.filter&&!this.spec.options.apiVersion&&console.warn("No apiVersion specified for document type list with custom filter: `".concat(this.spec.options.filter,"`. This will be required in the future. See %s for more info."),(0,nb.h)(hO.API_VERSION_REQUIRED_FOR_CUSTOM_FILTER)),{...super.serialize(t),type:"documentList",schemaTypeName:this.spec.schemaTypeName,child:this.spec.child||pn(this._context),options:{...this.spec.options,apiVersion:this.spec.options.apiVersion||tu.Dr7.apiVersion,filter:pt(this.spec,t)}}}clone(e){let t=new pi(this._context);return t.spec={...this.spec,...e||{}},this.initialValueTemplatesSpecified||(t.spec.initialValueTemplates=function(e,t){let{document:n}=e,{schemaTypeName:i,options:r}=t,{filter:l,params:a}=r||{filter:"",params:{}},s=i?[i]:Array.from(new Set(pr(l,a)));if(0!==s.length)return s.flatMap(e=>n.resolveNewDocumentOptions({type:"structure",schemaType:e})).map(e=>({...e,icon:to.dtP}))}(this._context,t.spec)),t.spec.schemaTypeName||(t.spec.schemaTypeName=function(e){let{options:t}=e,{filter:n,params:i}=t||{filter:"",params:{}},r=pr(n,i);return 1===r.length?r[0]:void 0}(t.spec)),t}getSpec(){return this.spec}}function pr(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=function(e){let t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=/\b_type\s*==\s*(['"].*?['"]|\$.*?(?:\s|$))|\B(['"].*?['"]|\$.*?(?:\s|$))\s*==\s*_type/g,r=[];for(;null!==(t=i.exec(e));)r.push(t[1]||t[2]);return r.map(e=>(("$"===e[0]?n[e.slice(1)]:e)||"").trim().replace(/^["']|["']$/g,"")).filter(Boolean)}(e,t);return 0===n.length&&(n=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.match(/\b_type\s+in\s+\[(.*?)\]/);return n?n[1].split(/,\s*/).map(e=>e.trim().replace(/^["']+|["']+$/g,"")).map(e=>"$"===e[0]?t[e.slice(1)]:e).filter(Boolean):[]}(e,t)),n}let pl=e=>e instanceof pd?"ListBuilder":(0,tu.Uy$)(e)&&"function"==typeof e.then?"Promise":Array.isArray(e)?"array":typeof e,pa=e=>"listItem"===e.type,ps=(e,t,n)=>(n.pane.items||[]).filter(pp).some(e=>e.schemaType.name===t.type&&e._id===t.id)||h7(e,t,n),po=(e,t)=>{let n=(t.parent.items.filter(pa).find(t=>t.id===e)||{child:void 0}).child;return n&&"function"==typeof n&&"function"==typeof n?n(e,t):n};class pd extends pe{constructor(e,t){super(),this._context=e,this.spec=t||{},this.initialValueTemplatesSpecified=!!(t&&t.initialValueTemplates)}items(e){return this.clone({items:e})}getItems(){return this.spec.items}serialize(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{path:[]},t=this.spec.id;if("string"!=typeof t||!t)throw new hR("`id` is required for lists",e.path,e.index).withHelpUrl(hO.ID_REQUIRED);let n=void 0===this.spec.items?[]:this.spec.items;if(!Array.isArray(n))throw new hR("`items` must be an array of items",e.path,e.index).withHelpUrl(hO.LIST_ITEMS_MUST_BE_ARRAY);let i=(e.path||[]).concat(t),r=n.map((e,t)=>(function(e,t,n){if(e instanceof pc)return e.serialize({path:n,index:t});if(e&&"divider"===e.type)return e;if(!e||"listItem"!==e.type){let i=e&&e.type||pl(e);throw new hR('List items must be of type "listItem", got "'.concat(i,'"').concat("array"===i?" - did you forget to spread (...moreItems)?":""),n,t).withHelpUrl(hO.INVALID_LIST_ITEM)}return e})(e,t,i)),l=r.filter((e,t)=>nT()(r,{id:e.id},t+1));if(l.length>0){let t=l.map(e=>e.id).slice(0,5),n=l.length>5?"".concat(t.join(", "),"..."):t.join(", ");throw new hR("List items with same ID found (".concat(n,")"),e.path,e.index).withHelpUrl(hO.LIST_ITEM_IDS_MUST_BE_UNIQUE)}return{...super.serialize(e),type:"list",canHandleIntent:this.spec.canHandleIntent||ps,child:this.spec.child||po,items:r}}clone(e){let t=new pd(this._context);return t.spec={...this.spec,...e||{}},t}}class pc{constructor(e,t){this._context=e,this.spec=t||{}}id(e){return this.clone({id:e})}getId(){return this.spec.id}title(e){return this.clone({title:e,id:hW(e,this.spec.id)})}getTitle(){return this.spec.title}icon(e){return this.clone({icon:e})}showIcon(){let e=!(arguments.length>0)||void 0===arguments[0]||arguments[0];return this.clone({displayOptions:{...this.spec.displayOptions||{},showIcon:e}})}getShowIcon(){return this.spec.displayOptions?this.spec.displayOptions.showIcon:void 0}getIcon(){return this.spec.icon}child(e){return this.clone({child:e})}getChild(){return this.spec.child}schemaType(e){return this.clone({schemaType:e})}getSchemaType(){let e=this.spec.schemaType;return"string"==typeof e?this._context.schema.get(e):this.spec.schemaType}serialize(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{path:[]},{id:t,title:n,child:i}=this.spec;if("string"!=typeof t||!t)throw new hR("`id` is required for list items",e.path,e.index).withHelpUrl(hO.ID_REQUIRED);if(!e.titleIsOptional&&("string"!=typeof n||!n))throw new hR("`title` is required for list items",e.path,t).withHelpUrl(hO.TITLE_REQUIRED);let r=this.spec.schemaType;if("string"==typeof r){let n=this._context.schema.get(r);if(!n)throw new hR('Could not find type "'.concat(r,'" in schema'),e.path,t).withHelpUrl(hO.SCHEMA_TYPE_NOT_FOUND);r=n}let l={path:e.path.concat(t),hint:"child"},a=i instanceof hK||i instanceof pi||i instanceof h5||i instanceof pd?i.serialize(l):i;if("function"==typeof a){let e=a;a=(t,n)=>e(t,{...n,serializeOptions:l})}return{...this.spec,id:hV(t,e.path,e.index),schemaType:r,child:a,title:n,type:"listItem"}}clone(e){let t=new pc(this._context);return t.spec={...this.spec,...e||{}},t}}let pu=(e,t)=>n=>{let i=t.schemaType&&("string"==typeof t.schemaType?t.schemaType:t.schemaType.name);return i?e.resolveDocumentNode({schemaType:i,documentId:n}):new h5(e).id("documentEditor").documentId(n)};class ph extends pc{constructor(e,t){super(e,t),this._context=e,this.spec=t||{}}serialize(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{path:[]},t=super.serialize({...e,titleIsOptional:!0});if(!t.schemaType)throw new hR("`schemaType` is required for document list items",e.path,e.index).withHelpUrl(hO.SCHEMA_TYPE_REQUIRED);let n=t.child||pu(this._context,t);return{...t,child:n,schemaType:t.schemaType,_id:t.id}}clone(e){let t=new ph(this._context);return t.spec={...this.spec,...e||{}},t}}function pp(e){return(0,tu.Uy$)(e)&&void 0!==e.schemaType&&"string"==typeof e._id}class pm extends pi{constructor(e,t){super(e),this._context=e,this.spec=t||{}}child(e){return this.cloneWithoutDefaultIntentHandler({child:e})}clone(e){let t=super.clone(e),n=new pm(this._context);return n.spec={...this.spec,...t.getSpec(),...e||{}},n}cloneWithoutDefaultIntentHandler(e){let t=super.clone(e),n=new pm(this._context),i=this.spec.canHandleIntent,r=i&&i.identity===h6;return n.spec={...t.getSpec(),...this.spec,...e||{},...r?{canHandleIntent:void 0}:{}},n}}let pf=["sanity.imageAsset","sanity.fileAsset"];function px(e){return(function(e){let{schema:t}=e;return t.getTypeNames().filter(e=>{var n;let i=t.get(e);return i&&(null==(n=i.type)?void 0:n.name)==="document"}).filter(e=>!pf.includes(e))})(e).map(t=>pg(e,t))}function pg(e,t){let{schema:n}=e,i=n.get(t);if(!i)throw Error('Schema type with name "'.concat(t,'" not found'));let r=i.title||nf()(t);return new pc(e).id(t).title(r).schemaType(i).child((n,i)=>{let r=i.parent,l="list"===r.type?r.items.find(e=>e.id===n):null,a=pv(e,t);return l&&l.title&&(a=a.title(l.title)),a})}function pv(e,t){let{schema:n,resolveDocumentNode:i}=e,r="string"==typeof t?t:t.schemaType,l="string"==typeof r?r:r.name,a="string"==typeof t?{schemaType:r}:t,s=n.get(l);if(!s)throw Error('Schema type with name "'.concat(l,'" not found'));let o=s.title||nf()(l),d=function(e){let t=e.preview;return!!(t&&(t.prepare||t.select&&t.select.media))}(s);return new pm(e).id(a.id||l).title(a.title||o).filter("_type == $type").params({type:l}).schemaType(s).showIcons(d).defaultOrdering(hD.by).menuItemGroups(a.menuItemGroups||[{id:"sorting",title:"Sort"},{id:"layout",title:"Layout"},{id:"actions",title:"Actions"}]).child(a.child||(e=>i({schemaType:l,documentId:e}))).canHandleIntent(a.canHandleIntent||h8).menuItems(a.menuItems||[...hB(e,s),new hZ(e).group("layout").title("Compact view").icon(to.reJ).action("setLayout").params({layout:"default"}),new hZ(e).group("layout").title("Detailed view").icon(to.cMY).action("setLayout").params({layout:"detail"})])}function pb(e){let{defaultDocumentNode:t,structure:n,children:i}=e,[r,l]=(0,td.useState)(!1),a=(0,tu.Lky)(),s=(0,tu.Q3k)(a),o=(0,tu.H__)(),d=(0,td.useMemo)(()=>(function(e){let{defaultDocumentNode:t,source:n}=e,i=(0,tu.nqf)(n),r={...n,getStructureBuilder:()=>l,resolveDocumentNode:e=>{let n=(null==t?void 0:t(l,{...e,...i}))||new h5(r);return n.getId()||(n=n.id("documentEditor")),e.documentId&&(n=n.documentId((0,tu.vsM)(e.documentId))),n.schemaType(e.schemaType)}},l={defaults:()=>(function(e){let t=px(e);return new pd(e).id("__root__").title("Content").items(t).showIcons(t.some(e=>{var t;return!!(t=e.getSchemaType())&&"string"!=typeof t&&!!t.icon}))})(r),documentTypeList:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return pv(r,...t)},documentTypeListItem:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return pg(r,...t)},documentTypeListItems:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return px(r,...t)},document:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return new h5(r,...t)},documentWithInitialValueTemplate:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e,t,n){let{resolveDocumentNode:i,templates:r}=e,l=r.find(e=>e.id===t);if(!l)throw Error('Template with ID "'.concat(t,'" not defined'));return i({schemaType:l.schemaType}).initialValueTemplate(t,n)}(r,...t)},defaultDocument:r.resolveDocumentNode,list:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return new pd(r,...t)},listItem:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return new pc(r,...t)},menuItem:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return new hZ(r,...t)},menuItemGroup:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return new hq(r,...t)},menuItemsFromInitialValueTemplateItems:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e,t){let{schema:n,templates:i}=e;return t.map(t=>{let r=i.find(e=>e.id===t.templateId),l=t.title||(null==r?void 0:r.title)||"Create new",a={};r&&r.schemaType&&(a.type=r.schemaType),t.templateId&&(a.template=t.templateId);let s=t.parameters?[a,t.parameters]:a,o=r&&n.get(r.schemaType);return new hZ(e).title(l).icon(r&&r.icon||(null==o?void 0:o.icon)||to.dtP).intent({type:"create",params:s}).serialize()})}(r,...t)},documentList:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return new pi(r,...t)},documentListItem:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return new ph(r,...t)},orderingMenuItem:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return hU(r,...t)},orderingMenuItemsForType:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return hB(r,...t)},editor:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e,t){let n=(null==t?void 0:t.type)?e.resolveDocumentNode({schemaType:t.type}):new h5(e);if(!t)return n;let{id:i,type:r,template:l,templateParameters:a}=t.options;return n=n.id(t.id).documentId(i),r&&(n=n.schemaType(r)),l&&(n=n.initialValueTemplate(l,a)),t.child&&(n=n.child(t.child)),n}(r,...t)},defaultInitialValueTemplateItems:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e){let{schema:t,getStructureBuilder:n,templates:i}=e,r=t.getTypeNames();return i.filter(e=>{var t;return!(null==(t=e.parameters)?void 0:t.length)}).sort((e,t)=>r.indexOf(e.schemaType)-r.indexOf(t.schemaType)).map(e=>n().initialValueTemplateItem(e.id))}(r,...t)},initialValueTemplateItem:(e,t)=>new h4(r,{id:e,parameters:t,templateId:e}),component:e=>(0,nO.isValidElementType)(e)?new hK().component(e):new hK(e),divider:()=>({id:nR()("__divider__"),type:"divider"}),view:h1,context:r};return l})({defaultDocumentNode:t,source:a}),[t,a]),c=(0,td.useMemo)(()=>n?n(d,{...s,documentStore:o}):d.defaults(),[d,n,s,o]),u=(0,td.useMemo)(()=>({backButton:r,resizablePanes:!r,reviewChanges:!r,splitPanes:!r,splitViews:!r}),[r]),h=(0,td.useMemo)(()=>({features:u,layoutCollapsed:r,setLayoutCollapsed:l,rootPaneNode:c,structureContext:d.context}),[u,r,c,d.context]);return(0,tc.jsx)(uW.Provider,{value:h,children:i})}function py(e){let{children:t,currentMinWidth:n,flex:i,minWidth:r,paneKey:l,title:a="Error",tone:s="critical"}=e;return(0,tc.jsxs)(iN,{currentMinWidth:n,flex:i,id:l,minWidth:r,tone:s,children:[(0,tc.jsx)(i6,{title:a}),(0,tc.jsx)(iq,{overflow:"auto",children:(0,tc.jsx)(tp.xu,{paddingX:4,paddingY:5,children:t})})]})}function pj(e){let t=[{ms:300,message:"Loading…"},{ms:5e3,message:"Still loading…"}];if(tu.r8Q){let n=["Check console for errors?","Is your observable/promise resolving?",e.length>0?"Structure path: ".concat(e.join(" ➝ ")):""];t.push({ms:1e4,message:n.join("\n")})}let n=(0,tv.of)(null);return(0,tC.T)(...t.map(e=>{let{ms:t,message:i}=e;return n.pipe((0,tU.h)(i),(0,tB.g)(t))}))}var pw=Object.freeze,p_=Object.defineProperty;let pk=(0,tm.ZP)(tp.kC)(e0||(e0=pw(p_(S=["\n  opacity: 0;\n  transition: opacity 200ms;\n\n  &[data-mounted] {\n    opacity: 1;\n  }\n"],"raw",{value:pw(S.slice())})))),pC=(0,td.memo)(e=>{let{delay:t=300,flex:n,message:i=pj,minWidth:r,paneKey:l,path:a,selected:s,title:o,tone:d}=e,c=(0,td.useMemo)(()=>"function"==typeof i?i(a?a.split(";"):[]):i,[i,a]),[u,h]=(0,td.useState)(()=>"string"==typeof c?c:"Loading…");(0,td.useEffect)(()=>{if("object"!=typeof c||"function"==typeof c.subscribe)return;let e=c.subscribe(h);return()=>e.unsubscribe()},[c]);let[p,m]=(0,td.useState)(null),[f,x]=(0,td.useState)(!1);(0,td.useEffect)(()=>{if(p)return(0,tp.RE)(()=>x(!0))},[p]);let g=(0,tc.jsxs)(pk,{align:"center","data-mounted":f?"":void 0,direction:"column",height:"fill",justify:"center",ref:m,children:[(0,tc.jsx)(tp.$j,{muted:!0}),(o||u)&&(0,tc.jsx)(tp.xu,{marginTop:3,children:(0,tc.jsx)(tp.xv,{align:"center",muted:!0,size:1,children:o||u})})]});return(0,tc.jsx)(iN,{flex:n,id:l,minWidth:r,selected:s,tone:d,children:(0,tc.jsx)(iq,{children:g})})});pC.displayName="LoadingPane";let pz=["patch","commit"],pE=(0,td.memo)(function(){let{push:e}=(0,tp.pm)(),{documentId:t,documentType:n}=rj(),i=(0,tu.E6V)(t,n),r=(0,td.useRef)(i),l=ie();return(0,td.useEffect)(()=>{let t;if(i&&i!==r.current){var n,a;return"error"===i.type&&e({closable:!0,duration:3e4,status:"error",title:"delete"===(n=i.op)?"An error occurred while attempting to delete this document.\n      This usually means that there are other documents that refers to it.":"unpublish"===n?"An error occurred while attempting to unpublish this document.\n      This usually means that there are other documents that refers to it.":"An error occurred during ".concat(n),description:(0,tc.jsxs)("details",{children:[(0,tc.jsx)("summary",{children:"Details"}),i.error.message]})}),"success"!==i.type||pz.includes(i.op)||e({closable:!0,status:"success",title:"publish"===(a=i.op)?"The document was published":"unpublish"===a?"The document was unpublished. A draft has been created from the latest published version.":"discardChanges"===a?"All changes since last publish has now been discarded. The discarded draft can still be recovered from history":"delete"===a?"The document was successfully deleted":"Successfully performed ".concat(a," on document")}),"success"===i.type&&"delete"===i.op&&(t=setTimeout(()=>l.closeCurrentAndAfter(),0)),r.current=i,()=>clearTimeout(t)}},[i,l,e]),null}),pI=e=>(0,tu.Uy$)(e)&&"string"==typeof e._id&&"string"==typeof e._type,pS=(0,td.memo)(function(e){let{documentId:t,documentType:n,index:i,setMenuItem:r,useMenuItem:l}=e,a=(0,tu.BoV)(l({documentId:t,documentType:n}));return(0,td.useEffect)(()=>{r(i,a)},[i,a,r]),(0,tc.jsx)(tc.Fragment,{})});function pP(e){let{documentId:t,documentType:n,inspectors:i,onMenuItems:r}=e,l=i.length,a=(0,td.useRef)(l),[s,o]=(0,td.useState)(()=>Array.from(Array(l))),d=(0,td.useRef)(s);(0,td.useEffect)(()=>{if(a.current!==l){let e=Array.from(Array(l));for(let t=0;t<l;t++)e[t]=d.current[t];a.current=l,o(()=>(d.current=e,e))}},[l]);let c=(0,td.useCallback)((e,t)=>{o(n=>{let i=[...n];return i[e]=t,d.current=i,i})},[]);return(0,td.useEffect)(()=>{r(s.filter(Boolean))},[s,r]),(0,tc.jsx)(tc.Fragment,{children:i.map((e,i)=>e.useMenuItem&&(0,tc.jsx)(pS,{documentId:t,documentType:n,index:i,setMenuItem:c,useMenuItem:e.useMenuItem},e.name))})}let pT=(0,td.memo)(e=>{let{children:t,index:n,pane:i,paneKey:r,onFocusPath:l}=e,a=(0,tu.I_y)(),s=(0,tu.zEW)(),{actions:o,badges:d,unstable_fieldActions:c,unstable_languageFilter:u,inspectors:h}=(0,tu.Lky)().document,p=(0,tu.ap5)(),m=ie(),f=m.setParams,{features:x}=uK(),{push:g}=(0,tp.pm)(),{options:v,menuItemGroups:b=rX,title:y=null,views:j=[]}=i,w=(0,tu.BoV)(v),_=w.id,k=(0,tu.vsM)(_),C=v.type,z=(0,tu.BoV)(m.params)||r$,E=(0,tu.BoV)(m.payload),{templateName:I,templateParams:S}=(0,td.useMemo)(()=>(function(e,t){let n=t.panePayload||{},i=t.templateName;t.urlTemplate&&i&&i!==t.urlTemplate&&console.warn('Conflicting templates: URL says "'.concat(t.urlTemplate,'", structure node says "').concat(i,'". Using "').concat(i,'".'));let r=i||t.urlTemplate,l=e.filter(e=>e.schemaType===t.documentType),a={...t.templateParams,..."object"==typeof n&&n||{}},s=r;return r||1!==l.length||(s=l[0].id),{templateName:s,templateParams:a}})(s,{documentType:C,templateName:w.template,templateParams:w.templateParameters,panePayload:E,urlTemplate:z.template}),[C,w,z,E,s]),P=(0,tu.t2O)({documentId:k,documentType:C,templateName:I,templateParams:S}),T=(0,tu.BoV)(P),{patch:M}=(0,tu.d9t)(k,C),R=(0,tu.iav)(k,C),{validation:O}=(0,tu.a3k)(k,C),A=(0,tu.z1O)(k,C),D=a.get(C),L=(null==R?void 0:R.draft)||(null==R?void 0:R.published)||T.value,[N,Z]=(0,td.useState)(!1),[U,B]=(0,td.useState)([]),F=(0,td.useMemo)(()=>o({schemaType:C,documentId:k}),[o,k,C]),q=(0,td.useMemo)(()=>d({schemaType:C,documentId:k}),[d,k,C]),H=(0,td.useMemo)(()=>u({schemaType:C,documentId:k}),[k,C,u]),V=(0,tu.BoV)(O),W=(0,tu.BoV)(j),[K,$]=(0,td.useState)(()=>z.path?(0,t0.mL)(z.path):tu.LZ8),Y=(0,td.useRef)(K),X=z.view||W[0]&&W[0].id||null,[G,Q]=(0,td.useState)("closed"),[J,ee]=(0,td.useState)(null),et=(0,tu.Dab)({documentId:k,documentType:C,onError:ee,rev:z.rev,since:z.since}),en=(0,tu.P08)(et,e=>e.onOlderRevision),ei=(0,tu.P08)(et,e=>e.revTime),er=(0,tu.P08)(et,e=>e.sinceAttributes),el=(0,tu.P08)(et,e=>e.timelineDisplayed),ea=(0,tu.P08)(et,e=>e.timelineReady),es=(0,tu.P08)(et,e=>e.isPristine),eo=(0,td.useMemo)(()=>!!ea&&!!(!(null==R?void 0:R.draft)&&!(null==R?void 0:R.published))&&!es,[null==R?void 0:R.draft,null==R?void 0:R.published,es,ea]),ed=function(e){let[t,n]=(0,td.useState)(void 0),[i,r]=(0,td.useState)(null),{resolveProductionUrl:l}=(0,tu.Lky)().document,a=(0,tX.l)(e);if(i)throw i;return(0,td.useEffect)(()=>{a.pipe((0,tF.b)(500),(0,ty.w)(e=>pI(e)?(0,tz.D)(l({document:e})):(0,tv.of)(void 0)),(0,tk.K)(e=>{let t=(0,tu.Uy$)(e)&&"string"==typeof e.message?e.message:"Unknown error";throw Error("An error was thrown while trying to get your preview url: ".concat(t))})).subscribe({next:n,error:r})},[l,a]),t}(L),[ec,eu]=(0,td.useState)([]);(0,td.useEffect)(()=>{let e=p.documentPresence(k).subscribe(e=>{eu(e)});return()=>{e.unsubscribe()}},[k,p]);let eh=(0,td.useMemo)(()=>h({documentId:k,documentType:C}),[k,C,h]),[ep,em]=(0,td.useState)(()=>z.inspect||null),ef=(0,td.useRef)(z.inspect);(0,td.useEffect)(()=>{ef.current!==z.inspect&&(ef.current=z.inspect,em(z.inspect||null))},[z.inspect]);let ex=null==eh?void 0:eh.find(e=>e.name===ep),eg=eh.find(e=>e.name===rG),ev=(null==ex?void 0:ex.name)===rG,eb=!!L,ey=(0,td.useMemo)(()=>(function(e){let t=function(e){let{currentInspector:t,hasValue:n,inspectors:i,inspectorMenuItems:r}=e;return i.map((e,i)=>{var l;let a=r[i];return!a||a.hidden?null:{action:"".concat(rY).concat(e.name),group:a.showAsAction?void 0:"inspectors",icon:a.icon,isDisabled:!n,selected:(null==t?void 0:t.name)===e.name,shortcut:null==(l=a.hotkeys)?void 0:l.join("+"),showAsAction:a.showAsAction,title:a.title,tone:a.tone}}).filter(Boolean)}(e),n=[function(e){let{previewUrl:t}=e;return t?{action:"production-preview",group:"links",title:"Open preview",icon:to.YE8,shortcut:"Ctrl+Alt+O"}:null}(e)].filter(Boolean);return[...t,function(e){let{hasValue:t}=e;return{action:"inspect",group:"inspectors",title:"Inspect",icon:to.bg6,isDisabled:!t,shortcut:"Ctrl+Alt+I"}}(e),...n]})({currentInspector:ex,features:x,hasValue:eb,inspectorMenuItems:U,inspectors:eh,previewUrl:ed}),[ex,x,eb,U,eh,ed]),ej="on"===z.inspect,ew=ev?er:(null==R?void 0:R.published)||null,e_=(0,td.useMemo)(()=>D?c({documentId:k,documentType:C,schemaType:D}):[],[k,C,c,D]),ek="connected"===A&&R.ready&&(ea||!!J),eC=(0,td.useMemo)(()=>en?el||{_id:L._id,_type:L._type}:L,[en,el,L]),ez=(0,td.useCallback)((e,t)=>{f({...z,since:e,rev:t||void 0})},[z,f]),eE=(0,td.useCallback)(e=>{$(e),Y.current!==e&&(Y.current=e,null==l||l(e)),p.setLocation([{type:"document",documentId:k,path:e,lastActiveAt:new Date().toISOString()}])},[k,l,p,$]),eI=(0,td.useCallback)(e=>{e7.current||($(tu.LZ8),Y.current!==tu.LZ8&&(Y.current=tu.LZ8,null==l||l(tu.LZ8)))},[l,$]),eS=(0,td.useRef)(()=>{throw Error("Nope")});eS.current=e=>{M.execute((0,tu.GWp)(e.patches),T.value)};let eP=(0,td.useCallback)(e=>eS.current(e),[]),eT=(0,td.useCallback)(e=>{var t,n,i,r;let l=e&&eh.find(t=>t.name===e);if(e&&!l){console.warn('No inspector named "'.concat(e,'"'));return}if(ex){if(l){let e=null!=(n=null==(t=l.onClose)?void 0:t.call(l,{params:z}))?n:{params:z};em(null),ef.current=void 0,f({...e.params,inspect:void 0});return}if(ex){let e=null!=(r=null==(i=ex.onClose)?void 0:i.call(ex,{params:z}))?r:{params:z};em(null),ef.current=void 0,f({...e.params,inspect:void 0})}}},[ex,eh,z,f]),eM=(0,td.useCallback)((e,t)=>{var n,i,r,l;let a=eh.find(t=>t.name===e);if(!a){console.warn('No inspector named "'.concat(e,'"'));return}if((null==ex?void 0:ex.name)===a.name){f({...z,...t,inspect:a.name});return}let s=z;ex&&(s=(null!=(i=null==(n=a.onClose)?void 0:n.call(a,{params:s}))?i:{params:s}).params);let o=null!=(l=null==(r=a.onOpen)?void 0:r.call(a,{params:s}))?l:{params:s};em(a.name),ef.current=a.name,f({...o.params,...t,inspect:a.name})},[ex,eh,z,f]),eR=(0,td.useCallback)(()=>{eg&&eT(eg.name)},[eT,eg]),eO=(0,td.useCallback)(()=>{x.reviewChanges&&eg&&eM(eg.name)},[x.reviewChanges,eM,eg]),eA=(0,td.useCallback)(()=>m.closeCurrent(),[m]),eD=(0,td.useCallback)(()=>m.duplicateCurrent(),[m]),eL=(0,td.useCallback)(function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:!ej;e?f({...z,inspect:"on"}):f(tJ()(z,"inspect"))},[ej,z,f]),eN=(0,td.useCallback)(e=>{if("production-preview"===e.action&&ed)return window.open(ed),!0;if("inspect"===e.action)return eL(!0),!0;if("reviewChanges"===e.action)return eO(),!0;if("string"==typeof e.action&&e.action.startsWith(rY)){let t=e.action.slice(rY.length),n=eh.find(e=>e.name===t);if(n)return n.name===ep?eT(n.name):eM(n.name),!0}return!1},[eT,eO,ep,eh,eM,ed,eL]),eZ=(0,td.useCallback)(e=>{for(let t of ey)if(t.shortcut&&(0,nA.ZP)(t.shortcut,e)){e.preventDefault(),e.stopPropagation(),eN(t);return}},[eN,ey]),eU=(0,td.useCallback)(()=>eL(!1),[eL]),[eB,eF]=(0,td.useState)([]),[eq,eH]=(0,td.useState)(),[eV,eW]=(0,td.useState)(),[eK,e$]=(0,td.useState)(),eY=(0,td.useCallback)((e,t)=>{eW(n=>(0,tu.pt$)(n,e,t))},[]),eX=(0,td.useCallback)((e,t)=>{e$(n=>(0,tu.pt$)(n,e,t))},[]),eG=(0,td.useCallback)((e,t)=>eH(n=>(0,tu.pt$)(n,e,t)),[]),eQ=L._createdAt?"update":"create",eJ=!!(null==D?void 0:D.liveEdit),e0=L._id?L._id:"dummy-id",e1=(0,td.useMemo)(()=>({...L,_id:eJ?(0,tu.vsM)(e0):(0,tu.qyu)(e0)}),[eJ,L,e0]),[e2,e5]=(0,tu.vSY)({document:e1,permission:eQ}),e3=!(null==L?void 0:L._id),e6=(0,td.useMemo)(()=>{var e;let t=!e5&&!(null==e2?void 0:e2.granted),n=!(0,nD.jA)(D,"update"),i=e3&&!(0,nD.jA)(D,"create"),r="reconnecting"===A,l=null==(e=R.transactionSyncLock)?void 0:e.enabled;return!ek||null!==ei||t||n||i||r||l||N||eo},[A,R.transactionSyncLock,e3,eo,N,e5,null==e2?void 0:e2.granted,ek,ei,D]),e8=(0,tu.clL)(D,{value:eC,readOnly:e6,comparisonValue:ew,focusPath:K,openPath:eB,collapsedPaths:eV,presence:ec,validation:V,collapsedFieldSets:eK,fieldGroupState:eq,changesOpen:ev}),e4=(0,td.useRef)(e8);e4.current=e8;let e9=(0,td.useCallback)(e=>{(0,tu.C8M)(e4.current,e).forEach(e=>{"expandPath"===e.type&&eW(t=>(0,tu.pt$)(t,e.path,!1)),"expandFieldSet"===e.type&&e$(t=>(0,tu.pt$)(t,e.path,!1)),"setSelectedGroup"===e.type&&eH(t=>(0,tu.pt$)(t,e.path,e.groupName))}),eF(e)},[e4]);(0,td.useEffect)(()=>{"reconnecting"===A&&g({id:"sanity/desk/reconnecting",status:"warning",title:(0,tc.jsx)(tc.Fragment,{children:"Connection lost. Reconnecting…"})})},[A,g]);let e7=(0,td.useRef)(!1);(0,td.useEffect)(()=>{var e;if(ek&&z.path){let{path:t,...n}=z,i=(0,t0.vW)(null==(e=e4.current)?void 0:e.value,(0,t0.mL)(t));e7.current=!0,$(i),e9(i),Y.current!==i&&(Y.current=i,null==l||l(i));let r=setTimeout(()=>{e7.current=!1},0);return m.setParams(n),()=>clearTimeout(r)}},[z,k,l,e9,ek,m]);let[te,tt]=(0,td.useState)([]);return(0,tc.jsxs)(ry.Provider,{value:{actions:F,activeViewId:X,badges:q,changesOpen:ev,closeInspector:eT,collapsedFieldSets:eK,collapsedPaths:eV,compareValue:ew,connectionState:A,displayed:eC,documentId:k,documentIdRaw:_,documentType:C,editState:R,fieldActions:e_,focusPath:K,inspector:ex||null,inspectors:eh,menuItems:ey,onBlur:eI,onChange:eP,onFocus:eE,onPathOpen:e9,onHistoryClose:eR,onHistoryOpen:eO,onInspectClose:eU,onKeyUp:eZ,onMenuAction:eN,onPaneClose:eA,onPaneSplit:eD,onSetActiveFieldGroup:eG,onSetCollapsedPath:eY,onSetCollapsedFieldSet:eX,openInspector:eM,index:n,inspectOpen:ej,validation:V,menuItemGroups:b||[],paneKey:r,previewUrl:ed,ready:ek,schemaType:D,isPermissionsLoading:e5,permissions:e2,setTimelineMode:Q,setTimelineRange:ez,setIsDeleting:Z,isDeleting:N,isDeleted:eo,timelineError:J,timelineMode:G,timelineStore:et,title:y,value:L,views:W,formState:e8,unstable_languageFilter:H},children:[eh.length>0&&(0,tc.jsx)(pP,{documentId:k,documentType:C,inspectors:eh,onMenuItems:B}),e_.length>0&&D&&(0,tc.jsx)(tu.QMc,{actions:e_,documentId:k,documentType:C,onActions:tt,path:tu.LZ8,schemaType:D}),(0,tc.jsx)(tu.kNp,{actions:te,path:tu.LZ8,children:(0,tc.jsx)(ul,{documentId:k,documentType:C,children:(0,tc.jsx)(uu,{children:t})})})]})});function pM(e,t,n){let i=(0,tu.F2f)(),[r,l]=(0,td.useState)(n),a=(0,td.useMemo)(()=>i.forNamespace("desk-tool"),[i]),s=(0,td.useMemo)(()=>e?a.forNamespace(e).forKey(t):a.forKey(t),[a,e,t]);(0,td.useEffect)(()=>{let e=s.listen(n).subscribe({next:l});return()=>null==e?void 0:e.unsubscribe()},[n,t,e,s]);let o=(0,td.useCallback)(e=>{l(e),s.set(e)},[s]);return(0,td.useMemo)(()=>[r,o],[o,r])}pT.displayName="DocumentPaneProvider";let pR={id:"parsed",title:"Parsed"},pO={id:"raw",title:"Raw JSON"},pA=[pR,pO],pD=nU()(1e3);function pL(e){let{path:t}=e,n=pD.get(t);void 0!==n&&pD.set(t,!n)}function pN(e){let t=window.getSelection();if(t){let n=document.createRange();t.removeAllRanges(),n.selectNodeContents(e),t.addRange(n)}}function pZ(e){pN(e.currentTarget)}function pU(e){65===e.keyCode&&(e.metaKey||e.ctrlKey)&&(e.preventDefault(),pN(e.currentTarget))}var pB=Object.freeze,pF=Object.defineProperty,pq=(e,t)=>pB(pF(e,"raw",{value:pB(t||e.slice())}));let pH=tm.ZP.div(e=>{let{theme:t}=e,{color:n,fonts:i,space:r}=t.sanity;return(0,tm.iv)(e1||(e1=pq(["\n    & .json-inspector,\n    & .json-inspector .json-inspector__selection {\n      font-family: ",";\n      font-size: ","px;\n      line-height: ","px;\n      color: var(--card-code-fg-color);\n    }\n\n    & .json-inspector .json-inspector__leaf {\n      padding-left: ",";\n    }\n\n    & .json-inspector .json-inspector__leaf.json-inspector__leaf_root {\n      padding-top: ",";\n      padding-left: 0;\n    }\n\n    & .json-inspector > .json-inspector__leaf_root > .json-inspector__line > .json-inspector__key {\n      display: none;\n    }\n\n    & .json-inspector .json-inspector__line {\n      display: block;\n      position: relative;\n      cursor: default;\n    }\n\n    & .json-inspector .json-inspector__line::after {\n      content: '';\n      position: absolute;\n      top: 0;\n      left: -200px;\n      right: -50px;\n      bottom: 0;\n      z-index: -1;\n      pointer-events: none;\n    }\n\n    & .json-inspector .json-inspector__line:hover::after {\n      background: var(--card-code-bg-color);\n    }\n\n    & .json-inspector .json-inspector__leaf_composite > .json-inspector__line {\n      cursor: pointer;\n    }\n\n    & .json-inspector .json-inspector__leaf_composite > .json-inspector__line::before {\n      content: '▸ ';\n      margin-left: calc(0 - "," + 3px);\n      font-size: ","px;\n      line-height: ","px;\n    }\n\n    &\n      .json-inspector\n      .json-inspector__leaf_expanded.json-inspector__leaf_composite\n      > .json-inspector__line::before {\n      content: '▾ ';\n      font-size: ","px;\n      line-height: ","px;\n    }\n\n    & .json-inspector .json-inspector__radio,\n    & .json-inspector .json-inspector__flatpath {\n      display: none;\n    }\n\n    & .json-inspector .json-inspector__value {\n      margin-left: ",";\n    }\n\n    &\n      .json-inspector\n      > .json-inspector__leaf_root\n      > .json-inspector__line\n      > .json-inspector__key\n      + .json-inspector__value {\n      margin: 0;\n    }\n\n    & .json-inspector .json-inspector__key {\n      color: ",";\n    }\n\n    & .json-inspector .json-inspector__value_helper,\n    & .json-inspector .json-inspector__value_null {\n      color: ",";\n    }\n\n    & .json-inspector .json-inspector__not-found {\n      padding-top: ",";\n    }\n\n    & .json-inspector .json-inspector__value_string {\n      color: ",";\n    }\n\n    & .json-inspector .json-inspector__value_boolean {\n      color: ",";\n    }\n\n    & .json-inspector .json-inspector__value_number {\n      color: ",";\n    }\n\n    & .json-inspector .json-inspector__show-original {\n      display: inline-block;\n      padding: 0 6px;\n      cursor: pointer;\n    }\n\n    & .json-inspector .json-inspector__show-original:hover {\n      color: inherit;\n    }\n\n    & .json-inspector .json-inspector__show-original::before {\n      content: '↔';\n    }\n\n    & .json-inspector .json-inspector__show-original:hover::after {\n      content: ' expand';\n    }\n  "])),i.code.family,i.code.sizes[2].fontSize,i.code.sizes[2].lineHeight,(0,tp.hO)(r[4]),(0,tp.hO)(r[3]),(0,tp.hO)(r[4]),i.code.sizes[2].fontSize,i.code.sizes[2].lineHeight,i.code.sizes[2].fontSize,i.code.sizes[2].lineHeight,(0,tp.hO)(r[4]/2),n.syntax.property,n.syntax.constant,(0,tp.hO)(r[3]),n.syntax.string,n.syntax.boolean,n.syntax.number)});function pV(e){let{onChange:t,query:n}=e,i=(0,td.useCallback)(e=>t(e.target.value),[t]);return(0,tc.jsx)(tp.oi,{icon:to.W1M,onChange:i,placeholder:"Search",radius:2,value:n||""})}function pW(e){let{value:t}=e,{onInspectClose:n,paneKey:i}=rj(),r="".concat(i,"_inspect_"),[l,a]=pM("desk-tool","inspect-view-preferred-view-mode-".concat(i),"parsed"),s=pA.find(e=>e.id===l),o=(0,td.useCallback)(()=>{a(pR.id)},[a]),d=(0,td.useCallback)(()=>{a(pO.id)},[a]);return(0,tc.jsx)(tp.Vq,{id:"".concat(r,"dialog"),header:(0,tu.Uy$)(t)&&(0,tu.HD0)(t._id)&&(0,tu.HD0)(t._type)?(0,tc.jsxs)(tc.Fragment,{children:["Inspecting"," ",(0,tc.jsx)("em",{children:(0,tc.jsx)(nK,{document:t})})]}):(0,tc.jsx)("em",{children:"No value"}),onClose:n,onClickOutside:n,width:3,children:(0,tc.jsxs)(tp.kC,{direction:"column",height:"fill",children:[(0,tc.jsx)(tp.Zb,{padding:3,shadow:1,style:{position:"sticky",bottom:0,zIndex:3},children:(0,tc.jsxs)(tp.td,{space:1,children:[(0,tc.jsx)(tp.OK,{"aria-controls":"".concat(r,"tabpanel"),fontSize:1,id:"".concat(r,"tab-").concat(pR.id),label:pR.title,onClick:o,selected:s===pR}),(0,tc.jsx)(tp.OK,{"aria-controls":"".concat(r,"tabpanel"),fontSize:1,id:"".concat(r,"tab-").concat(pO.id),label:pO.title,onClick:d,selected:s===pO})]})}),(0,tc.jsxs)(tp.x4,{"aria-labelledby":"".concat(r,"tab-").concat(l),flex:1,id:"".concat(r,"tabpanel"),overflow:"auto",padding:4,style:{outline:"none"},children:[s===pR&&(0,tc.jsx)(pH,{children:(0,tc.jsx)(nN(),{data:t,isExpanded:function e(t,n){let i=pD.get(t);return void 0===i?(pD.set(t,Array.isArray(n)||(0,tu.Uy$)(n)),e(t,n)):i},onClick:pL,search:pV})}),s===pO&&(0,tc.jsx)(tp.EK,{language:"json",tabIndex:0,onKeyDown:pU,onDoubleClick:pZ,onFocus:pZ,children:JSON.stringify(t,null,2)})]})]})})}var pK=Object.freeze,p$=Object.defineProperty;let pY=(0,tm.ZP)(tp.Zb)(e2||(e2=pK(p$(P=["\n  position: relative;\n  z-index: 50;\n"],"raw",{value:pK(P.slice())}))));function pX(e){let{revisionId:t}=e,{documentId:n,documentType:i}=rj(),{restore:r}=(0,tu.d9t)(n,i),{navigateIntent:l}=(0,tG.tv)(),a=(0,td.useCallback)(()=>{t&&(r.execute(t),l("edit",{id:n,type:i}))},[n,i,l,r,t]);return(0,tc.jsx)(pY,{"data-testid":"deleted-document-banner",shadow:1,tone:"transparent",children:(0,tc.jsx)(tp.W2,{paddingX:4,paddingY:t?2:3,sizing:"border",width:1,children:(0,tc.jsxs)(tp.kC,{align:"center",children:[(0,tc.jsx)(tp.xv,{size:1,children:(0,tc.jsx)(to.CPA,{})}),(0,tc.jsxs)(tp.kC,{align:"center",gap:2,flex:1,marginLeft:3,children:[(0,tc.jsx)(tp.xv,{size:1,children:"This document has been deleted."}),t&&(0,tc.jsx)(tp.zx,{fontSize:1,padding:2,mode:"bleed",tone:"primary",onClick:a,text:"Restore most recent version"})]})]})})})}var pG=Object.freeze,pQ=Object.defineProperty,pJ=(e,t)=>pG(pQ(e,"raw",{value:pG(t||e.slice())}));let p0=(0,tm.ZP)(tp.Zb)(e5||(e5=pJ(["\n  position: relative;\n  z-index: 50;\n"]))),p1=(0,tm.ZP)(tp.xv)(e3||(e3=pJ(["\n  & > * {\n    overflow: hidden;\n    overflow: clip;\n    white-space: nowrap;\n    text-overflow: ellipsis;\n  }\n"]))),p2=(0,td.memo)(()=>{var e,t,n,i,r,l;let a=(0,tu.rq_)(),{params:s,groupIndex:o,routerPanesState:d,replaceCurrent:c,BackLink:u}=ie(),h=null==(e=d[o])?void 0:e[0].id,p=d[o-1],m=null==p?void 0:p[0],f=null==m?void 0:m.id,x=!!(null==(t=null==m?void 0:m.params)?void 0:t.rev),g=(0,td.useMemo)(()=>(null==s?void 0:s.parentRefPath)&&(0,t0.mL)(s.parentRefPath)||null,[null==s?void 0:s.parentRefPath]),v=(0,tX.m2)(()=>{let e=null==g?void 0:g[0];if(!f||!e||!g)return(0,tv.of)({loading:!1});let t=(0,tu.vsM)(f),n=(0,t0.mL)(e),i=n.findIndex(e=>"object"==typeof e&&"_key"in e);return(0,t_.z)((0,tv.of)({loading:!0}),a.unstable_observePathsDocumentPair(t,-1===i?n:n.slice(0,i)).pipe((0,tF.b)(750),(0,tb.U)(e=>{var t;let{draft:n,published:i}=e;return{loading:!1,result:{availability:{draft:n.availability,published:i.availability},refValue:null==(t=(0,t0.U2)(n.snapshot||i.snapshot,g))?void 0:t._ref}}})))},[a,f,g],{loading:!0}),b=(0,td.useCallback)(()=>{var e;!v.loading&&(null==(e=v.result)?void 0:e.refValue)&&c({id:v.result.refValue,params:s})},[v.loading,v.result,c,s]);return f&&g&&!x&&!v.loading&&((null==(n=v.result)?void 0:n.availability.draft.available)||(null==(i=v.result)?void 0:i.availability.published.available))&&(null==(r=v.result)?void 0:r.refValue)!==h?(0,tc.jsx)(p0,{shadow:1,tone:"caution","data-testid":"reference-changed-banner",children:(0,tc.jsx)(tp.W2,{paddingX:4,paddingY:2,sizing:"border",width:1,children:(0,tc.jsxs)(tp.kC,{align:"center",children:[(0,tc.jsx)(tp.xv,{size:1,children:(0,tc.jsx)(to.foC,{})}),(null==(l=v.result)?void 0:l.refValue)?(0,tc.jsxs)(tc.Fragment,{children:[(0,tc.jsx)(tp.xu,{flex:1,marginLeft:3,children:(0,tc.jsx)(p1,{title:"This reference has changed since you opened it.",size:1,children:"This reference has changed since you opened it."})}),(0,tc.jsx)(tp.xu,{marginLeft:3,children:(0,tc.jsx)(tp.zx,{onClick:b,icon:to.bnu,fontSize:1,mode:"ghost",padding:2,space:2,text:"Reload reference"})})]}):(0,tc.jsxs)(tc.Fragment,{children:[(0,tc.jsx)(tp.xu,{flex:1,marginLeft:3,children:(0,tc.jsx)(p1,{title:"This reference has been removed since you opened it.",size:1,children:"This reference has been removed since you opened it."})}),(0,tc.jsx)(tp.xu,{marginLeft:3,children:(0,tc.jsx)(tp.zx,{as:u,icon:to.Two,fontSize:1,mode:"ghost",padding:2,space:2,text:"Close reference"})})]})]})})}):null});p2.displayName="ReferenceChangedBanner";var p5=Object.freeze,p3=Object.defineProperty;let p6=(0,tm.ZP)(tp.Zb)(e6||(e6=p5(p3(T=["\n  position: relative;\n  z-index: 50;\n"],"raw",{value:p5(T.slice())}))));function p8(e){var t,n;let{granted:i,requiredPermission:r}=e,l=(0,tu.xJ)(),a=(null==(t=null==l?void 0:l.roles)?void 0:t.length)!==1,s=((null==(n=null==l?void 0:l.roles)?void 0:n.map(e=>(0,tc.jsx)("code",{children:e.title},e.name)))||[]).reduce((e,t)=>null===e?[t]:e.concat([", ",t]),null);return i?null:(0,tc.jsx)(p6,{"data-testid":"permission-check-banner",shadow:1,tone:"transparent",children:(0,tc.jsx)(tp.W2,{paddingX:4,paddingY:3,sizing:"border",width:1,children:(0,tc.jsxs)(tp.kC,{align:"flex-start",children:[(0,tc.jsx)(tp.xv,{size:1,children:(0,tc.jsx)(to.CPA,{})}),(0,tc.jsx)(tp.xu,{flex:1,marginLeft:3,children:(0,tc.jsxs)(tp.xv,{size:1,children:["Your role",a&&"s"," ",s," ",a?"do":"does"," not have permissions to"," ",r," this document."]})})]})})})}let p4=e=>e.preventDefault(),p9=(0,td.forwardRef)(function(e,t){var n;let{hidden:i,margins:r}=e,{collapsedFieldSets:l,collapsedPaths:a,displayed:s,editState:o,documentId:d,documentType:c,fieldActions:u,onChange:h,validation:p,ready:m,formState:f,onFocus:x,onBlur:g,onSetCollapsedPath:v,onPathOpen:b,onSetCollapsedFieldSet:y,onSetActiveFieldGroup:j}=rj(),w=(0,tu.H__)(),_=(0,tu.Dqo)(d),k=(0,td.useMemo)(()=>(0,tu.fm0)(),[]),C=null==(n=null==o?void 0:o.transactionSyncLock)?void 0:n.enabled;!function(e){let t=(0,tp.pm)(),n=function(e){let t=(0,td.useRef)();return(0,td.useEffect)(()=>{t.current=e},[e]),t.current}(e.enabled);(0,td.useEffect)(()=>{!n&&e.enabled&&t.push({...e,duration:20736e5}),n&&!e.enabled&&t.push({...e,duration:.01})},[e,t,n])}({id:"sync-lock-".concat(d),status:"warning",enabled:C,title:"Syncing document…",description:"Please hold tight while the document is synced. This usually happens right after the document has been published, and it shouldn't take more than a few seconds"}),(0,td.useEffect)(()=>{let e=w.pair.documentEvents(d,c).pipe((0,tA.b)(e=>{"mutation"===e.type&&k.publish(function(e){let t=e.mutations.map(e=>e.patch).filter(Boolean);return{type:"mutation",snapshot:e.document,patches:(0,tu.Sis)(e.origin,t)}}(e)),"rebase"===e.type&&k.publish(function(e){let t=e.remoteMutations.map(e=>e.patch).filter(Boolean),n=e.localMutations.map(e=>e.patch).filter(Boolean);return{type:"rebase",snapshot:e.document,patches:(0,tu.Sis)("remote",t).concat((0,tu.Sis)("local",n))}}(e))})).subscribe();return()=>{e.unsubscribe()}},[d,w,c,k]);let z=!!(null==s?void 0:s._rev);(0,td.useEffect)(()=>{z&&k.publish({type:"mutation",patches:[],snapshot:s})},[z]);let[E,I]=(0,td.useState)(null);(0,td.useEffect)(()=>{m&&!(null==f?void 0:f.focusPath.length)&&E&&(0,tp.fo)(E)},[m]);let S=(0,td.useCallback)(e=>{I(e),"function"==typeof t?t(e):t&&(t.current=e)},[t]);return(0,tc.jsx)(tp.W2,{hidden:i,paddingX:4,paddingTop:5,paddingBottom:9,sizing:"border",width:1,children:(0,tc.jsx)(tu.$rW,{margins:r,children:(0,tc.jsx)(tp.xu,{as:"form",onSubmit:p4,ref:S,children:m?null===f?(0,tc.jsx)(tp.xu,{padding:2,children:(0,tc.jsx)(tp.xv,{children:"This form is hidden"})}):(0,tc.jsx)(tu.quP,{__internal_fieldActions:u,__internal_patchChannel:k,collapsedFieldSets:l,collapsedPaths:a,focusPath:f.focusPath,changed:f.changed,focused:f.focused,groups:f.groups,id:"root",members:f.members,onChange:h,onFieldGroupSelect:j,onPathBlur:g,onPathFocus:x,onPathOpen:b,onSetFieldSetCollapsed:y,onSetPathCollapsed:v,presence:_,readOnly:f.readOnly,schemaType:f.schemaType,validation:p,value:f.value}):(0,tc.jsx)(nW,{ms:300,children:(0,tc.jsxs)(tp.kC,{align:"center",direction:"column",height:"fill",justify:"center",children:[(0,tc.jsx)(tp.$j,{muted:!0}),(0,tc.jsx)(tp.xu,{marginTop:3,children:(0,tc.jsx)(tp.xv,{align:"center",muted:!0,size:1,children:"Loading document"})})]})})})})})});function p7(){let{activeViewId:e,paneKey:t,views:n}=rj(),i="".concat(t,"tabpanel");return(0,tc.jsx)(tp.td,{space:1,children:n.map((n,r)=>{var l;return(0,tc.jsx)(me,{icon:n.icon,id:"".concat(t,"tab-").concat(n.id),isActive:e===n.id,label:(0,tc.jsx)(tc.Fragment,{children:n.title}),tabPanelId:i,viewId:0===r?null:null!=(l=n.id)?l:null},n.id)})})}function me(e){let{isActive:t,tabPanelId:n,viewId:i,...r}=e,{ready:l}=rj(),{setView:a}=ie(),s=(0,td.useCallback)(()=>a(i),[a,i]);return(0,tc.jsx)(tp.OK,{...r,"aria-controls":n,disabled:!l,fontSize:1,selected:t,onClick:s})}function mt(){let{connectionState:e,schemaType:t,title:n,value:i}=rj(),{error:r,value:l}=(0,tu._2T)({enabled:!!i&&"connected"===e,schemaType:t,value:i});return"connected"!==e?(0,tc.jsx)(tc.Fragment,{}):n?(0,tc.jsx)(tc.Fragment,{children:n}):i?r?(0,tc.jsxs)(tc.Fragment,{children:["Error: ",r.message]}):(0,tc.jsx)(tc.Fragment,{children:(null==l?void 0:l.title)||(0,tc.jsx)("span",{style:{color:"var(--card-muted-fg-color)"},children:"Untitled"})}):(0,tc.jsxs)(tc.Fragment,{children:["New ",(null==t?void 0:t.title)||(null==t?void 0:t.name)]})}let mn=(0,td.memo)((0,td.forwardRef)(function(e,t){let{onMenuAction:n,onPaneClose:i,onPaneSplit:r,menuItems:l,menuItemGroups:a,schemaType:s,timelineStore:o,ready:d,views:c,unstable_languageFilter:u}=rj(),{features:h}=uK(),{index:p,BackLink:m,hasGroupSiblings:f}=ie(),{actions:x}=(0,tu.qGk)(),g=(0,td.useMemo)(()=>rs({actionHandler:n,fieldActions:x,menuItems:l,menuItemGroups:a}),[n,x,a,l]),v=(0,td.useMemo)(()=>g.filter(rl),[g]),b=(0,td.useMemo)(()=>g.filter(ra),[g]),y=c.length>1,j=(0,tu.P08)(o,e=>e.revTime),{collapsed:w,isLast:_}=iZ(),k=h.splitViews&&r&&c.length>1,C=k&&f,z=!C&&!h.backButton;return(0,tc.jsx)(i6,{ref:t,loading:!d,title:(0,tc.jsx)(mt,{}),tabs:y&&(0,tc.jsx)(p7,{}),tabIndex:_&&!w?-1:0,backButton:h.backButton&&p>0&&(0,tc.jsx)(tp.zx,{as:m,"data-as":"a",icon:to.Y4O,mode:"bleed",padding:2}),subActions:(0,tc.jsx)(ho,{chunk:j,mode:"rev",placement:"bottom-end"}),actions:(0,tc.jsxs)(tp.kC,{align:"center",gap:1,children:[u.length>0&&(0,tc.jsx)(tc.Fragment,{children:u.map((e,t)=>(0,td.createElement)(e,{key:"language-filter-".concat(t),schemaType:s}))}),v.map(e=>(0,tc.jsx)(i8,{node:e},e.key)),(0,tc.jsx)(iS,{nodes:b},"context-menu"),k&&(0,tc.jsx)(tp.u,{content:(0,tc.jsx)(tp.xv,{size:1,style:{whiteSpace:"nowrap"},children:"Split pane right"}),padding:2,placement:"bottom",portal:!0,children:(0,tc.jsx)(tp.zx,{"aria-label":"Split pane right",icon:to.iro,mode:"bleed",onClick:r},"split-pane-button")}),C&&(0,tc.jsx)(tp.zx,{icon:to.Two,mode:"bleed",onClick:i,title:"Close split pane"},"close-view-button"),z&&(0,tc.jsx)(tp.zx,{icon:to.Two,mode:"bleed",title:"Close pane group",as:m},"close-view-button")]})})}));var mi=Object.freeze,mr=Object.defineProperty,ml=(e,t)=>mi(mr(e,"raw",{value:mi(t||e.slice())}));let ma=(0,tm.ZP)(tp.xu)({position:"relative"}),ms=(0,tm.ZP)(tu.l$t)(e=>{let{$disabled:t}=e;return t?{height:"100%"}:(0,tm.iv)(e8||(e8=ml(["\n    height: 100%;\n    overflow: auto;\n    position: relative;\n    scroll-behavior: smooth;\n    outline: none;\n  "])))}),mo=function(e){let{footerHeight:t,isInspectOpen:n,rootElement:i,setDocumentPanelPortalElement:r}=e,{activeViewId:l,displayed:a,documentId:s,editState:o,inspector:d,value:c,views:u,ready:h,schemaType:p,permissions:m,isPermissionsLoading:f,isDeleting:x,isDeleted:g,timelineStore:v,formState:b}=rj(),{collapsed:y}=n8(),{collapsed:j}=iZ(),w=(0,tp.vI)(),{features:_}=uK(),[k,C]=(0,td.useState)(null),z=(0,tp.XL)(k),E=(0,td.useRef)(null),[I,S]=(0,td.useState)(null),P=(0,td.useRef)(null),T=c._createdAt?"update":"create",M=(0,td.useMemo)(()=>{if(b)return b.groups.find(e=>e.selected)},[b]),R=(0,td.useMemo)(()=>u.find(e=>e.id===l)||u[0]||{type:"form"},[l,u]),O=_.splitPanes&&E.current||w.element,A=(0,td.useMemo)(()=>y?[(null==z?void 0:z.height)||0,0,t?t+2:2,0]:[0,0,2,0],[y,t,z]),D="form"!==R.type,L=(0,td.useMemo)(()=>"component"===R.type&&R.component&&(0,td.createElement)(R.component,{document:{draft:(null==o?void 0:o.draft)||null,displayed:a||c,historical:a,published:(null==o?void 0:o.published)||null},documentId:s,options:R.options,schemaType:p}),[R,a,s,null==o?void 0:o.draft,null==o?void 0:o.published,p,c]),N=(0,tu.P08)(v,e=>e.lastNonDeletedRevId);(0,td.useEffect)(()=>{(null==I?void 0:I.scrollTo)&&I.scrollTo(0,0)},[s,I]),(0,td.useEffect)(()=>{O&&r(O)},[O,r]);let Z=(0,td.useMemo)(()=>n?(0,tc.jsx)(pW,{value:a||c}):null,[n,a,c]),U=!!(!j&&d);return(0,tc.jsxs)(tc.Fragment,{children:[(0,tc.jsx)(mn,{ref:C}),(0,tc.jsx)(iq,{children:(0,tc.jsxs)(tp.kC,{height:"fill",children:[(_.resizablePanes||!U)&&(0,tc.jsx)(ma,{flex:2,overflow:"hidden",children:(0,tc.jsx)(tp.Xp,{element:O,__unstable_elements:{documentScrollElement:I},children:(0,tc.jsx)(tp.NM,{element:I,children:(0,tc.jsxs)(tu.Ahg,{scrollElement:I,containerElement:P,children:["form"===R.type&&!f&&h&&(0,tc.jsxs)(tc.Fragment,{children:[(0,tc.jsx)(p8,{granted:!!(null==m?void 0:m.granted),requiredPermission:T}),!x&&g&&(0,tc.jsx)(pX,{revisionId:N}),(0,tc.jsx)(p2,{})]}),(0,tc.jsxs)(ms,{$disabled:y||!1,"data-testid":"document-panel-scroller",ref:S,children:[(0,tc.jsx)(p9,{hidden:D,margins:A,ref:P},s+(h?"_ready":"_pending")),L]},"".concat(null==M?void 0:M.name,"-").concat(s,"}")),Z,(0,tc.jsx)("div",{"data-testid":"document-panel-portal",ref:E})]})})})}),U&&(0,tc.jsx)(tp.NM,{element:i,children:(0,tc.jsx)(hb,{documentId:s,documentType:p.name,flex:1})})]})})]})},md=["left","bottom"],mc={small:0,medium:1,large:2,full:"auto"};function mu(e){let{dialog:t,referenceElement:n}=e;return(0,tc.jsx)(tp.J2,{content:(0,tc.jsx)(mh,{dialog:t}),fallbackPlacements:md,open:!0,placement:"top",portal:!0,preventOverflow:!0,referenceElement:n})}function mh(e){let{dialog:t}=e,{cancelButtonIcon:n,cancelButtonText:i,confirmButtonIcon:r,confirmButtonText:l,message:a,onCancel:s,onConfirm:o,tone:d}=t,{isTopLayer:c}=(0,tp.sJ)(),[u,h]=(0,td.useState)(null),p=(0,td.useCallback)(()=>{c&&s()},[c,s]),m=(0,td.useCallback)(e=>{"Escape"===e.key&&c&&s()},[c,s]);return(0,tp.O8)(p,[u]),(0,tp.qh)(m),(0,tc.jsxs)(tp.kC,{direction:"column",ref:h,style:{minWidth:304,maxWidth:400},children:[(0,tc.jsx)(tp.xu,{flex:1,overflow:"auto",padding:4,children:(0,tc.jsx)(tp.xv,{children:a})}),(0,tc.jsx)(tp.xu,{paddingX:4,paddingY:3,style:{borderTop:"1px solid var(--card-border-color)"},children:(0,tc.jsxs)(tp.rj,{columns:2,gap:2,children:[(0,tc.jsx)(tp.zx,{icon:n,onClick:s,mode:"ghost",text:i||"Cancel"}),(0,tc.jsx)(tp.zx,{icon:r,onClick:o,text:l||"Confirm",tone:d})]})})]})}function mp(e){let{dialog:t}=e,n=(0,td.useId)(),i=t.footer&&(0,tc.jsx)(tp.xu,{paddingX:4,paddingY:3,children:t.footer});return(0,tc.jsx)(tu.jr5,{zOffset:"fullscreen",children:(0,tc.jsx)(tp.Vq,{__unstable_hideCloseButton:!1===t.showCloseButton,footer:i,header:t.header,id:n,onClose:t.onClose,onClickOutside:t.onClose,width:void 0===t.width?1:mc[t.width],children:(0,tc.jsx)(tp.xu,{padding:4,children:t.content})})})}function mm(e){let{dialog:t,referenceElement:n}=e;return(0,tc.jsx)(tp.J2,{content:(0,tc.jsx)(mf,{dialog:t}),fallbackPlacements:md,open:!0,placement:"top",portal:!0,preventOverflow:!0,referenceElement:n})}function mf(e){let{dialog:t}=e,{content:n,onClose:i}=t,{isTopLayer:r}=(0,tp.sJ)(),[l,a]=(0,td.useState)(null),s=(0,td.useCallback)(()=>{r&&i()},[r,i]),o=(0,td.useCallback)(e=>{"Escape"===e.key&&r&&i()},[r,i]);return(0,tp.O8)(s,[l]),(0,tp.qh)(o),(0,tc.jsx)("div",{ref:a,children:n})}function mx(e){let{children:t}=e,{element:n,elements:i}=(0,tp.vI)(),r=(null==i?void 0:i[rD])||n;return(0,tc.jsx)(tp.Xp,{element:r,children:t})}function mg(e){let{dialog:t,referenceElement:n=null}=e,i=(0,td.useId)();return"confirm"===t.type?(0,tc.jsx)(mu,{dialog:t,referenceElement:n}):"popover"===t.type?(0,tc.jsx)(mm,{dialog:t,referenceElement:n}):"dialog"!==t.type&&t.type?"custom"===t.type?(0,tc.jsx)(mx,{children:null==t?void 0:t.component}):(console.warn("Unsupported modal type ".concat(t.type)),(0,tc.jsx)(tp.Vq,{id:i,onClose:t.onClose,onClickOutside:t.onClose,width:2,children:(0,tc.jsx)(tp.xu,{padding:4,children:t.content||(0,tc.jsxs)(tc.Fragment,{children:["Unexpected modal type (",(0,tc.jsx)("code",{children:t.type}),")"]})})})):(0,tc.jsx)(mx,{children:(0,tc.jsx)(mp,{dialog:t})})}function mv(e){let{actionStates:t,disabled:n}=e,i=(0,td.useId)(),r=(0,td.useRef)(null),[l,a]=(0,td.useState)(-1),[s,o]=(0,td.useState)(null),d=(0,td.useCallback)(e=>{a(e)},[]),c=(0,td.useMemo)(()=>({placement:"top-end",portal:!0,preventOverflow:!0}),[]),u=t[l];return(0,tc.jsxs)(tc.Fragment,{children:[(0,tc.jsx)(tp.j2,{id:"".concat(i,"-action-menu"),button:(0,tc.jsx)(tp.zx,{"data-testid":"action-menu-button","aria-label":"Open document actions",disabled:n,icon:to.v4q,mode:"ghost",ref:r}),menu:(0,tc.jsx)(tp.v2,{padding:1,children:t.map((e,t)=>(0,tc.jsx)(mb,{actionState:e,disabled:n,index:t,onAction:d},t))}),popover:c,ref:o}),u&&u.dialog&&(0,tc.jsx)(tu.jr5,{zOffset:"paneFooter",children:(0,tc.jsx)(mg,{dialog:u.dialog,referenceElement:s})})]})}function mb(e){let{actionState:t,disabled:n,index:i,onAction:r}=e,{onHandle:l}=t,a=(0,td.useCallback)(()=>{r(i),l&&l()},[i,r,l]),s=t.title&&(0,tc.jsx)(tp.xu,{padding:2,children:(0,tc.jsx)(tp.xv,{size:1,children:t.title})});return(0,tc.jsx)(tp.sN,{"data-testid":"action-".concat(t.label.replace(" ","")),disabled:n||!!t.disabled,onClick:a,padding:0,tone:t.tone,children:(0,tc.jsx)(tp.u,{content:s,disabled:!s,fallbackPlacements:["left","bottom"],placement:"top",portal:!0,children:(0,tc.jsxs)(tp.kC,{align:"center",paddingX:3,children:[(0,tc.jsxs)(tp.kC,{flex:1,paddingY:3,children:[t.icon&&(0,tc.jsx)(tp.xu,{marginRight:3,children:(0,tc.jsxs)(tp.xv,{children:[(0,td.isValidElement)(t.icon)&&t.icon,(0,nO.isValidElementType)(t.icon)&&(0,td.createElement)(t.icon)]})}),(0,tc.jsx)(tp.xv,{children:t.label})]}),t.shortcut&&(0,tc.jsx)(tp.xu,{marginLeft:3,children:(0,tc.jsx)(tu.SV0,{keys:String(t.shortcut).split("+").map(e=>e.slice(0,1).toUpperCase()+e.slice(1))})})]})})})}function my(e){let{disabled:t,showMenu:n,states:i}=e,[r,...l]=i,[a,s]=(0,td.useState)(null),o=(0,td.useMemo)(()=>r&&(r.title||r.shortcut)?(0,tc.jsxs)(tp.kC,{padding:2,style:{maxWidth:300},align:"center",children:[(0,tc.jsx)(tp.xv,{size:1,children:r.title}),r.shortcut&&(0,tc.jsx)(tp.xu,{marginLeft:r.title?2:0,children:(0,tc.jsx)(tu.SV0,{keys:String(r.shortcut).split("+").map(e=>e.slice(0,1).toUpperCase()+e.slice(1).toLowerCase())})})]}):null,[r]);return(0,tc.jsxs)(tp.kC,{children:[r&&(0,tc.jsx)(tp.li,{zOffset:200,children:(0,tc.jsx)(tp.u,{disabled:!o,content:o,portal:!0,placement:"top",children:(0,tc.jsx)(tp.Kq,{flex:1,children:(0,tc.jsx)(tp.zx,{"data-testid":"action-".concat(r.label),disabled:t||!!r.disabled,icon:r.icon,onClick:r.onHandle,ref:s,text:r.label,tone:r.tone||"primary"})})})}),n&&l.length>0&&(0,tc.jsx)(tp.xu,{marginLeft:1,children:(0,tc.jsx)(mv,{actionStates:l,disabled:t})}),r&&r.dialog&&(0,tc.jsx)(mg,{dialog:r.dialog,referenceElement:a})]})}let mj=(0,td.memo)(function(){let{actions:e,connectionState:t,documentId:n,editState:i}=rj();return e&&i?(0,tc.jsx)(n$,{actions:e,actionProps:i,children:i=>{let{states:r}=i;return(0,tc.jsx)(my,{disabled:"connected"!==t,showMenu:e.length>1,states:r},n)}}):null}),mw=(0,td.memo)(function(){let{connectionState:e,editState:t,timelineStore:n}=rj(),i=(0,tu.P08)(n,e=>e.revTime),r=(null==i?void 0:i.id)||"",l=((null==t?void 0:t.draft)||(null==t?void 0:t.published)||{})._rev===r,a=(0,td.useMemo)(()=>({...t||{},revision:r}),[t,r]),s=(0,td.useMemo)(()=>[rI],[]);return(0,tc.jsx)(n$,{actions:s,actionProps:a,children:t=>{let{states:n}=t;return(0,tc.jsx)(my,{disabled:"connected"!==e||!!l,showMenu:!1,states:n})}})}),m_={primary:"primary",success:"positive",warning:"caution",danger:"critical"};function mk(e){let{states:t}=e;return(0,tc.jsx)(tp.gF,{space:1,children:t.map((e,t)=>(0,tc.jsx)(tp.u,{content:e.title&&(0,tc.jsx)(tp.xu,{padding:2,children:(0,tc.jsx)(tp.xv,{size:1,children:e.title})}),disabled:!e.title,placement:"top",portal:!0,children:(0,tc.jsx)(tp.Ct,{fontSize:1,mode:"outline",paddingX:2,paddingY:1,radius:4,tone:e.color?m_[e.color]:void 0,style:{whiteSpace:"nowrap"},children:e.label})},String(t)))})}function mC(){let{badges:e,editState:t}=rj();return t&&e?(0,tc.jsx)(nY,{badges:e,badgeProps:t,children:e=>{let{states:t}=e;return(0,tc.jsx)(mk,{states:t})}}):null}var mz=Object.freeze,mE=Object.defineProperty;let mI=(0,tm.ZP)(tp.kC)(e4||(e4=mz(mE(M=["\n  cursor: default;\n"],"raw",{value:mz(M.slice())}))));function mS(e){let{collapsed:t,disabled:n,lastPublished:i,lastUpdated:r,liveEdit:l}=e,a=(0,tu.INm)(i||"",{minimal:!0,agoSuffix:!0}),s=(0,tu.INm)(i||"",{minimal:!0}),o=(0,tu.INm)(r||"",{minimal:!0,agoSuffix:!0}),d=(0,tu.INm)(r||"",{minimal:!0}),c=(0,tu.INm)(r||"",{minimal:!1,agoSuffix:!0}),u=(0,tu.INm)(i||"",{minimal:!1,agoSuffix:!0}),h=l?"Last updated ".concat(c):"Last published ".concat(u);return(0,tc.jsx)(mI,{align:"center","data-ui":"SessionLayout",sizing:"border",children:(0,tc.jsx)(tp.u,{placement:"top",portal:!0,content:(0,tc.jsx)(tp.Kq,{padding:3,space:3,children:(0,tc.jsx)(tp.xv,{size:1,children:l?(0,tc.jsxs)(tc.Fragment,{children:["Last updated"," ",(0,tc.jsx)("abbr",{"aria-label":r?c:u,children:r?o:a})]}):(0,tc.jsxs)(tc.Fragment,{children:["Last published ",(0,tc.jsx)("abbr",{"aria-label":u,children:a})]})})}),children:(0,tc.jsx)(tp.zx,{mode:"bleed",tone:l?"critical":"positive",tabIndex:-1,disabled:n,"aria-label":h,children:(0,tc.jsxs)(tp.kC,{align:"center",children:[(0,tc.jsx)(tp.xu,{marginRight:t?0:3,children:(0,tc.jsx)(tp.xv,{size:2,"aria-hidden":"true",children:l?(0,tc.jsx)(to.o1U,{}):(0,tc.jsx)(to.EI4,{})})}),!t&&(0,tc.jsx)(tp.xv,{size:1,weight:"medium",children:l?(0,tc.jsx)("abbr",{"aria-label":h,children:r?d:s}):(0,tc.jsx)("abbr",{"aria-label":h,children:s})})]})})})})}var mP=Object.freeze,mT=Object.defineProperty,mM=(e,t)=>mP(mT(e,"raw",{value:mP(t||e.slice())}));let mR=(0,tm.ZP)(ng.E.path)(e9||(e9=mM(["\n  transform-origin: center;\n"]))),mO=e=>(0,tc.jsx)(ng.E.circle,{fill:"none",r:"8",cx:"12.5",cy:"12.5",strokeWidth:"1.2",...e}),mA=e=>(0,tc.jsx)(mR,{fill:"none",d:"M14 17.5619L11.5 20.5L14.5 23.0619M11 7.43811L13.5 4.50001L10.5 1.93811",...e}),mD=e=>(0,tc.jsx)(ng.E.path,{d:"M9.5 12.1316L11.7414 14.5L16 10",...e}),mL=e=>(0,tc.jsx)(ng.E.path,{d:"M15 7L18 10M6 19L7 15L17 5L20 8L10 18L6 19Z",...e}),mN=(0,tm.F4)(e7||(e7=mM(["\n  0% {\n    transform: rotate(0);\n  }\n  100% {\n    transform: rotate(360deg);\n  }\n"]))),mZ=tm.ZP.g(te||(te=mM(["\n  transform-origin: center;\n\n  &[data-rotate] {\n    animation: "," 1s ease-in-out infinite;\n  }\n"])),mN),mU={syncing:{scale:1,transition:{duration:0}},saved:{scale:[1,.8,1.2,.9,1.1,.95,1.05,.99,1],transition:{duration:.5,delay:.2}},changes:{transition:{duration:0}}},mB={syncing:{strokeDasharray:"0, 0, 23, 3, 23, 3",strokeDashoffset:10,opacity:1,transition:{duration:0}},saved:{strokeDasharray:"0, 0, 23, 0, 23, 0",strokeDashoffset:10,opacity:1,transition:{duration:.2}},changes:{strokeDasharray:"0, 60, 23, 0, 23, 0",strokeDashoffset:0,opacity:0,transition:{duration:.5}}},mF={syncing:{opacity:1,transition:{duration:0}},saved:{opacity:0,transition:{duration:.2}},changes:{opacity:0}},mq={syncing:{pathLength:0,transition:{duration:0}},saved:{pathLength:1,transition:{delay:.4,duration:.3}},changes:{pathLength:0,transition:{duration:.2}}},mH={syncing:{pathLength:0,transition:{duration:0}},saved:{pathLength:0,transition:{duration:0}},changes:{pathLength:1,transition:{duration:.4,delay:.5}}};function mV(e){let{status:t}=e;return t?(0,tc.jsx)("svg",{width:"1em",height:"1em",viewBox:"0 0 25 25",fill:"none",stroke:"currentColor",strokeWidth:"1.2","data-sanity-icon":"",children:(0,tc.jsxs)(ng.E.g,{variants:mU,initial:t,animate:t,children:[(0,tc.jsxs)(mZ,{"data-rotate":"changes"===t?void 0:"",children:[(0,tc.jsx)(mA,{variants:mF,initial:t,animate:t}),(0,tc.jsx)(mO,{variants:mB,initial:t,animate:t})]}),(0,tc.jsx)(mD,{variants:mq,initial:t,animate:t}),(0,tc.jsx)(mL,{variants:mH,initial:t,animate:t})]})}):null}let mW=td.forwardRef(function(e,t){let{collapsed:n,status:i,lastUpdated:r,...l}=e,a=(0,tu.INm)(r||"",{minimal:!0}),s=(0,tu.INm)(r||"",{minimal:!0,agoSuffix:!0}),o=(0,tu.INm)(r||"",{minimal:!1,agoSuffix:!0}),d=(0,td.useMemo)(()=>"syncing"===i?{text:"Saving...",tone:void 0}:"changes"===i?{text:a,tone:"caution"}:"saved"===i?{text:"Saved!",tone:"positive"}:{},[i,a]);return i?(0,tc.jsx)(tp.u,{placement:"top",portal:!0,disabled:"changes"!==i,content:(0,tc.jsxs)(tp.Kq,{padding:3,space:3,children:[(0,tc.jsx)(tp.xv,{size:1,weight:"semibold",children:"Review changes"}),(0,tc.jsxs)(tp.xv,{size:1,muted:!0,children:["Changes saved ",(0,tc.jsx)("abbr",{"aria-label":o,children:s})]})]}),children:(0,tc.jsx)(tp.zx,{mode:"bleed",justify:"flex-start",tone:null==d?void 0:d.tone,...l,"data-testid":"review-changes-button",ref:t,"aria-label":"Review changes",children:(0,tc.jsxs)(tp.kC,{align:"center",children:[(0,tc.jsx)(tp.xu,{marginRight:n?0:3,"aria-hidden":"true",children:(0,tc.jsx)(tp.xv,{children:(0,tc.jsx)(mV,{status:i})})}),!n&&(0,tc.jsx)(tp.xv,{size:1,weight:"medium",children:null==d?void 0:d.text})]})})}):null}),mK=td.memo(mW),m$=(0,td.memo)(function(){var e;let{changesOpen:t,documentId:n,documentType:i,editState:r,onHistoryClose:l,onHistoryOpen:a,timelineStore:s,value:o}=rj(),d=(0,tu.nuD)(n,i),c=null==o?void 0:o._updatedAt,u=null==(e=null==r?void 0:r.published)?void 0:e._updatedAt,h=!!(null==r?void 0:r.liveEdit),p=!!(null==r?void 0:r.published),m=!!(null==r?void 0:r.draft),[f,x]=(0,td.useState)(null),g=(0,tp.XL)(f),v=!g||(null==g?void 0:g.width)<300,[b,y]=(0,td.useState)(null),j=(0,tu.P08)(s,e=>e.onOlderRevision);(0,td.useEffect)(()=>{if("syncing"===b&&!d.isSyncing){let e=setTimeout(()=>y("saved"),1e3);return()=>clearTimeout(e)}if("saved"===b){let e=setTimeout(()=>y(null),3e3);return()=>clearTimeout(e)}},[b,c,d.isSyncing]),(0,td.useLayoutEffect)(()=>{y(null)},[n]),(0,td.useLayoutEffect)(()=>{d.isSyncing&&y("syncing")},[d.isSyncing,c]);let w=(0,td.useMemo)(()=>(0,tc.jsx)(mK,{lastUpdated:c,status:b||(m?"changes":void 0),onClick:t?l:a,disabled:j,selected:t,collapsed:v}),[m,t,l,a,c,j,b,v]),_=(0,td.useMemo)(()=>(h||p)&&(0,tc.jsx)(tp.xu,{marginRight:1,children:(0,tc.jsx)(mS,{disabled:j,lastPublished:u,lastUpdated:c,liveEdit:h,collapsed:v})}),[v,u,c,h,p,j]);return(0,tc.jsxs)(tp.kC,{align:"center","data-ui":"DocumentSparkline",ref:x,children:[_,(0,tc.jsxs)(tp.kC,{align:"center",flex:1,children:[w,!v&&(0,tc.jsx)(tp.xu,{marginLeft:3,children:(0,tc.jsx)(mC,{})})]})]})});var mY=Object.freeze,mX=Object.defineProperty;let mG=(0,tm.ZP)(tp.xu)(tt||(tt=mY(mX(R=["\n  min-width: 10em;\n  max-width: 16em;\n"],"raw",{value:mY(R.slice())}))));function mQ(e){let{actionsBoxRef:t}=e,{badges:n,timelineStore:i}=rj(),r=(0,tu.P08)(i,e=>e.onOlderRevision);return(0,td.useMemo)(()=>(0,tc.jsx)(tp.xu,{paddingLeft:2,paddingRight:[2,3],paddingY:2,children:(0,tc.jsxs)(tp.kC,{align:"center",children:[(0,tc.jsx)(tp.xu,{flex:[1,2],children:n&&(0,tc.jsx)(m$,{})}),(0,tc.jsx)(mG,{flex:1,marginLeft:[1,3],ref:t,children:r?(0,tc.jsx)(mw,{}):(0,tc.jsx)(mj,{})})]})}),[t,n,r])}function mJ(e){let{actionsBoxElement:t,activeIndex:n,as:i="div",children:r,id:l,onActionStart:a,onKeyDown:s,rootRef:o,states:d,...c}=e,u=d[n],h=(0,td.useCallback)(e=>{let t=d.filter(t=>t.shortcut&&(0,nA.ZP)(t.shortcut,e)),n=t[0];if(t.length>1&&console.warn('Keyboard shortcut conflict: More than one document action matches the shortcut "'.concat(n.shortcut,'"')),n&&!n.disabled&&n.onHandle){e.preventDefault(),n.onHandle(),a(d.indexOf(n));return}s&&s(e)},[a,s,d]);return(0,td.createElement)(i,{id:l,onKeyDown:h,tabIndex:-1,...c,ref:o},[r,u&&u.dialog&&(0,tc.jsx)(tu.jr5,{zOffset:"paneFooter",children:(0,tc.jsx)(mg,{dialog:u.dialog,referenceElement:t})})])}let m0=td.memo(e=>{let{actionsBoxElement:t,as:n="div",children:i,...r}=e,{actions:l,editState:a}=rj(),[s,o]=(0,td.useState)(-1),d=(0,td.useCallback)(e=>{o(e)},[]),c=(0,td.useMemo)(()=>a&&{...a,onComplete:()=>void 0,revision:void 0},[a]);return c&&l?(0,tc.jsx)(n$,{actionProps:c,actions:l,children:e=>{let{states:l}=e;return(0,tc.jsx)(mJ,{...r,activeIndex:s,actionsBoxElement:t,as:n,onActionStart:d,states:l,children:i})}}):null});m0.displayName="DocumentActionShortcuts";var m1=Object.freeze,m2=Object.defineProperty;let m5=["fixed","fixed","absolute"],m3=(0,tm.ZP)(tu.jbM)(tn||(tn=m1(m2(O=["\n  flex: 1;\n  display: flex;\n  flex-direction: column;\n  min-height: 0;\n  min-width: 0;\n"],"raw",{value:m1(O.slice())})))),m6=(0,td.memo)(function(e){let{name:t}=(0,tu.Lky)();return(0,tc.jsx)(tu.cWh,{name:e.pane.source||t,children:(0,tc.jsx)(m8,{...e})})});function m8(e){var t;let{pane:n,paneKey:i}=e,{resolveNewDocumentOptions:r}=(0,tu.Lky)().document,l=ie(),a=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=(0,tu.zEW)();return(0,td.useMemo)(()=>{if(e.type&&"*"!==e.type)return e;let i=e.template||t.template,r=i?n.find(e=>e.id===i):void 0,l=null==r?void 0:r.schemaType;return l?{...e,type:l}:e},[e,t.template,n])}(n.options,l.params),{documentType:s,isLoaded:o}=(0,tu.Hdz)(a.id,a.type),d=(0,td.useMemo)(()=>r({type:"document",documentId:a.id,schemaType:a.type}),[a.id,a.type,r]),[c,u]=(0,tu.UMU)({templateItems:d}),h=o&&!u,p=(0,td.useMemo)(()=>h&&s&&a.type!==s?{...e,pane:{...e.pane,options:{...a,type:s}}}:e,[e,s,h,a]),{ReferenceChildLink:m,handleEditReference:f,groupIndex:x,routerPanesState:g}=l,v=(null==(t=g[x+1])?void 0:t[0].params)||{},b=g.length,{parentRefPath:y}=v,j=(0,td.useMemo)(()=>y?{path:(0,t0.mL)(y),state:x>=b-1?"none":x>=b-2?"selected":"pressed"}:{path:[],state:"none"},[y,x,b]);return"*"!==a.type||h?s?(0,tc.jsx)(pT,{...p,children:(0,tc.jsx)(tu.euX,{EditReferenceLinkComponent:m,onEditReference:f,initialValueTemplateItems:c,activePath:j,children:(0,tc.jsx)(m4,{})})},"".concat(s,"-").concat(a.id)):(0,tc.jsx)(py,{flex:2.5,minWidth:320,paneKey:i,title:(0,tc.jsx)(tc.Fragment,{children:"The document was not found"}),children:(0,tc.jsx)(tp.Kq,{space:4,children:(0,tc.jsxs)(tp.xv,{as:"p",children:["The document type is not defined, and a document with the ",(0,tc.jsx)("code",{children:a.id})," ","identifier could not be found."]})})}):(0,tc.jsx)(pC,{flex:2.5,minWidth:320,paneKey:i,title:"Loading document…"})}function m4(){let{changesOpen:e,documentType:t,inspector:n,inspectOpen:i,onFocus:r,onPathOpen:l,onHistoryOpen:a,onKeyUp:s,paneKey:o,schemaType:d,value:c}=rj(),{collapsed:u}=n8(),h=(0,tu.Cnp)(),[p,m]=(0,td.useState)(null),[f,x]=(0,td.useState)(null),[g,v]=(0,td.useState)(null),[b,y]=(0,td.useState)(null),j=(0,tp.XL)(f),w=null==j?void 0:j.height,_=(0,td.useCallback)(e=>{l(e),r(e)},[l,r]),k=600+(n?320:0),C=320+(n?320:0);return d?(0,tc.jsxs)(m0,{actionsBoxElement:g,as:iN,currentMinWidth:k,"data-testid":"document-pane",flex:2.5,id:o,minWidth:C,onKeyUp:s,rootRef:m,children:[(0,tc.jsx)(tp.Tu,{position:m5,zOffset:h.portal,children:(0,tc.jsx)(tp.kC,{direction:"column",flex:1,height:u?void 0:"fill",children:(0,tc.jsx)(m3,{"data-testid":"change-connector-root",isReviewChangesOpen:e,onOpenReviewChanges:a,onSetFocus:_,children:(0,tc.jsx)(mo,{footerHeight:w||null,isInspectOpen:i,rootElement:p,setDocumentPanelPortalElement:y})})})}),(0,tc.jsx)(tp.Xp,{__unstable_elements:{[rD]:b},children:(0,tc.jsx)(tp.Tu,{position:m5,zOffset:h.portal,children:(0,tc.jsx)(iY,{ref:x,children:(0,tc.jsx)(mQ,{actionsBoxRef:v})})})}),(0,tc.jsx)(pE,{})]}):(0,tc.jsx)(py,{currentMinWidth:k,flex:2.5,minWidth:C,paneKey:o,title:(0,tc.jsxs)(tc.Fragment,{children:["Unknown document type: ",(0,tc.jsx)("code",{children:t})]}),tone:"caution",children:(0,tc.jsxs)(tp.Kq,{space:4,children:[t&&(0,tc.jsxs)(tp.xv,{as:"p",children:["This document has the schema type ",(0,tc.jsx)("code",{children:t}),", which is not defined as a type in the local content studio schema."]}),!t&&(0,tc.jsx)(tp.xv,{as:"p",children:"This document does not exist, and no schema type was specified for it."}),tu.r8Q&&c&&(0,tc.jsxs)(tc.Fragment,{children:[(0,tc.jsx)(tp.xv,{as:"p",children:"Here is the JSON representation of the document:"}),(0,tc.jsx)(tp.Zb,{padding:3,overflow:"auto",radius:2,shadow:1,tone:"inherit",children:(0,tc.jsx)(tp.EK,{language:"json",size:[1,1,2],children:JSON.stringify(c,null,2)})})]})]})})}let m9={by:[{field:"_updatedAt",direction:"desc"}]},m7={},fe=/\b_type\s*==\s*(['"].*?['"]|\$.*?(?:\s|$))|\B(['"].*?['"]|\$.*?(?:\s|$))\s*==\s*_type\b/;function ft(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.match(fe);if(!n)return null;let i=(n[1]||n[2]).trim().replace(/^["']|["']$/g,"");if("$"===i[0]){let e=t[i.slice(1)];return"string"==typeof e?e:null}return i}var fn=Object.freeze,fi=Object.defineProperty,fr=(e,t)=>fn(fi(e,"raw",{value:fn(t||e.slice())}));let fl=(0,tm.ZP)(tp.xu)(ti||(ti=fr(["\n  position: relative;\n"]))),fa=(0,tm.ZP)(tp.xu)(tr||(tr=fr(["\n  position: absolute;\n  left: 0;\n  right: 0;\n  top: 0;\n  bottom: 0;\n"]))),fs=[...Array(30).keys()];function fo(e){let{layout:t}=e;return(0,tc.jsx)(tp.Kq,{padding:2,space:1,children:fs.map(e=>(0,tc.jsx)(tp.Zb,{padding:2,children:(0,tc.jsx)(tu.ogX,{isPlaceholder:!0,layout:t})},e))})}function fd(e){let{childItemId:t,error:n,filterIsSimpleTypeConstraint:i,hasMaxItems:r,hasSearchQuery:l,isActive:a,isLazyLoading:s,isLoading:o,items:d,layout:c,loadingVariant:u,onListChange:h,onRetry:p,paneTitle:m,searchInputElement:f,showIcons:x}=e,g=(0,tu.I_y)(),{collapsed:v}=n8(),{collapsed:b,index:y}=iZ(),[j,w]=(0,td.useState)(!1),_=(0,td.useCallback)(()=>{o||s||!j||h()},[s,o,h,j]);(0,td.useEffect)(()=>{if(b)return;let e=setTimeout(()=>{w(!0)},0);return()=>{clearTimeout(e)}},[b,d]);let k=(0,td.useCallback)((e,n)=>{let{activeIndex:i}=n,l=(0,tu.vsM)(e._id),o=t===l,u=!a&&o,h=a&&o,p=i===d.length-1,m=p&&s,f=p&&r;return(0,tc.jsxs)(tc.Fragment,{children:[(0,tc.jsx)(rb,{icon:!1!==x&&void 0,id:l,layout:c,marginBottom:1,pressed:u,schemaType:g.get(e._type),selected:h,value:e}),m&&(0,tc.jsx)(tp.kC,{align:"center",justify:"center",padding:4,children:(0,tc.jsx)(tp.$j,{muted:!0})}),f&&(0,tc.jsx)(tp.xu,{marginY:1,paddingX:3,paddingY:4,children:(0,tc.jsxs)(tp.xv,{align:"center",muted:!0,size:1,children:["Displaying a maximum of ",2e3," documents"]})})]})},[t,a,d.length,c,g,x,r,s]),C=(0,td.useMemo)(()=>l?(0,tc.jsx)(tp.kC,{align:"center",direction:"column",height:"fill",justify:"center",children:(0,tc.jsx)(tp.W2,{width:1,children:(0,tc.jsx)(tp.xu,{paddingX:4,paddingY:5,children:(0,tc.jsx)(tp.xv,{align:"center",muted:!0,children:"No results found"})})})}):(0,tc.jsx)(tp.kC,{align:"center",direction:"column",height:"fill",justify:"center",children:(0,tc.jsx)(tp.W2,{width:1,children:(0,tc.jsx)(tp.xu,{paddingX:4,paddingY:5,children:(0,tc.jsx)(tp.xv,{align:"center",muted:!0,children:i?"No documents of this type":"No matching documents"})})})}),[i,l]),z=(0,td.useMemo)(()=>{if(!j)return null;if(n)return(0,tc.jsx)(tp.kC,{align:"center",direction:"column",height:"fill",justify:"center",children:(0,tc.jsx)(tp.W2,{width:1,children:(0,tc.jsxs)(tp.Kq,{paddingX:4,paddingY:5,space:4,children:[(0,tc.jsx)(tp.X6,{as:"h3",children:"Could not fetch list items"}),(0,tc.jsxs)(tp.xv,{as:"p",children:["Error: ",(0,tc.jsx)("code",{children:n.message})]}),p&&(0,tc.jsx)(tp.xu,{children:(0,tc.jsx)(tp.zx,{icon:to.bnu,onClick:p,text:"Retry",tone:"primary"})})]})})});if(!o&&0===d.length)return C;if("initial"===u&&o)return(0,tc.jsx)(nW,{ms:300,children:(0,tc.jsx)(fo,{layout:c})});if("spinner"===u&&o)return null;let e="".concat(y,"-").concat(b);return(0,tc.jsx)(fl,{overflow:"hidden",height:"fill",children:(0,tc.jsx)(fa,{children:(0,tc.jsx)(tu.e8h,{activeItemDataAttr:"data-hovered",ariaLabel:m,canReceiveFocus:!0,focusRingOffset:-3,inputElement:f,itemHeight:51,items:d,onEndReached:_,onlyShowSelectionWhenActive:!0,overscan:10,padding:2,paddingBottom:1,renderItem:k,wrapAround:!1},e)})})},[b,n,_,y,o,d,c,u,p,k,f,j]);return(0,tc.jsx)(iq,{overflow:v||"initial"===u?"hidden":"auto",children:z})}let fc=(0,td.memo)(e=>{let{contentAfter:t,index:n,initialValueTemplates:i=[],menuItemGroups:r=[],menuItems:l=[],setLayout:a,setSortOrder:s,title:o}=e,{features:d}=uK(),{collapsed:c,isLast:u}=iZ(),h=(0,td.useMemo)(()=>({setLayout:e=>{let{layout:t}=e;a(t)},setSortOrder:e=>{s(e)}}),[a,s]);return(0,tc.jsx)(i6,{actions:(0,tc.jsx)(rf,{initialValueTemplateItems:i,actionHandlers:h,menuItemGroups:r,menuItems:l}),backButton:d.backButton&&n>0&&(0,tc.jsx)(tp.zx,{as:n3,"data-as":"a",icon:to.Y4O,mode:"bleed"}),contentAfter:t,tabIndex:u&&!c?-1:0,title:o})});fc.displayName="DocumentListPaneHeader";let fu=[],fh={error:null,onRetry:void 0,result:null},fp={result:null,error:null};var fm=Object.freeze,ff=Object.defineProperty,fx=(e,t)=>fm(ff(e,"raw",{value:fm(t||e.slice())}));let fg=[],fv=(0,tm.F4)(tl||(tl=fx(["\n  from {\n    transform: rotate(0deg);\n  }\n  to {\n    transform: rotate(360deg);\n  }\n"]))),fb=(0,tm.ZP)(to.L4p)(ta||(ta=fx(["\n  animation: "," 500ms linear infinite;\n"])),fv),fy=(0,tm.ZP)(tp.Zb)(ts||(ts=fx(["\n  [data-ui='TextInput'] {\n    border-radius: inherit;\n  }\n"]))),fj=e=>{let{menuItems:t,sortOrderRaw:n,layout:i}=e;return null==t?void 0:t.map(e=>{var t,r,l,a;return(null==(t=e.params)?void 0:t.layout)?{...e,selected:i===(null==(r=e.params)?void 0:r.layout)}:(null==(l=null==e?void 0:e.params)?void 0:l.by)?{...e,selected:ne()(null==n?void 0:n.by,(null==(a=null==e?void 0:e.params)?void 0:a.by)||fg)}:{...e,selected:!1}})},fw=(0,td.memo)(function(e){let{childItemId:t,index:n,isActive:i,isSelected:r,pane:l,paneKey:a}=e,s=(0,tu.I_y)(),{name:o}=(0,tu.Lky)(),{defaultLayout:d="default",displayOptions:c,initialValueTemplates:u=fg,menuItemGroups:h,menuItems:p,options:m,title:f}=l,{apiVersion:x,defaultOrdering:g=fg,filter:v}=m,b=function(e){let t=(0,td.useRef)(e);return nF()(t.current,e)||(t.current=e),t.current}(m.params||m7),y=l.source,j=(0,td.useMemo)(()=>ft(v,b),[v,b]),w=(null==c?void 0:c.showIcons)!==!1,[_,k]=pM(j,"layout",d),[C,z]=(0,td.useState)(""),[E,I]=(0,td.useState)(""),[S,P]=(0,td.useState)(null),T=(0,td.useRef)(!1),[M,R]=pM(j,"sortOrder",(0,td.useMemo)(()=>(null==g?void 0:g.length)>0?{by:g}:m9,[g])),O=j&&M?function(e,t){let n=e.by.map(e=>{if(e.mapWith)return e;let n=function(e,t){let n=t0.mL(t),i=e;for(let e of n){if(!i)return;if("string"==typeof e){i=function(e,t){if(!("fields"in e))return;let n=e.fields.find(e=>e.name===t);return n?n.type:void 0}(i,e);continue}if(!((0,th.Fd)(e)||(0,th.dw)(e))||"array"!==i.jsonType)return;let[t,n]=i.of||[];if(n||!t)return;if(!(0,th.dD)(t)){i=t;continue}let[r,l]=t.to||[];if(l||!r)return;i=r}return i}(t,e.field);return n?!function(e,t){let n=e.type;for(;n;){if(n.name===t||!n.type&&n.jsonType===t)return!0;n=n.type}return!1}(n,"datetime")?"string"===n.jsonType?{...e,mapWith:"lower"}:e:{...e,mapWith:"dateTime"}:e});return n.every((t,n)=>t===e.by[n])?e:{...e,by:n}}(M,s.get(j)):M,A=(0,tu.BoV)(O),D=/^_type\s*==\s*['"$]\w+['"]?\s*$/.test(v.trim()),{error:L,hasMaxItems:N,isLazyLoading:Z,isLoading:U,isSearchReady:B,items:F,onListChange:q,onRetry:H}=function(e){let{filter:t,params:n,sortOrder:i,searchQuery:r,apiVersion:l}=e,a=(0,tu.m85)({...tu.Dr7,apiVersion:l||tu.Dr7.apiVersion}),s=(0,tu.I_y)(),[o,d]=(0,td.useState)(fh),{onRetry:c,error:u,result:h}=o,p=null==h?void 0:h.documents,m=(0,td.useMemo)(()=>p?(0,tu.RgL)(p).map(e=>({...e.draft||e.published,hasPublished:!!e.published,hasDraft:!!e.draft})):fu,[p]),[f,x]=(0,td.useState)(!1),[g,v]=(0,td.useState)(!1),[b,y]=(0,td.useState)(!1),j=(0,td.useMemo)(()=>ft(t,n),[t,n]),w=null===h&&!u,_=(null==p?void 0:p.length)===2e3,k=(0,td.useCallback)(()=>{w||g||b||y(!0)},[w,g,b]),C=(0,td.useCallback)(e=>{var t,n;if(e.error){d(e);return}let i=(null==(n=null==(t=e.result)?void 0:t.documents)?void 0:n.length)||0;if(!e.error&&(null==e?void 0:e.result)===null&&b){x(!0);return}if(i<100&&0!==i&&!b&&v(!0),(null==e?void 0:e.result)===null){d(t=>({...t.error?e:t}));return}x(!1),d(e)},[b]),z=(0,td.useMemo)(()=>{let e=new tO.x,l=()=>e.next();return(function(e){let{client:t,schema:n,sort:i,limit:r,params:l,filter:a,searchQuery:s,staticTypeNames:o}=e,d=i.by,c=null==i?void 0:i.extendedProjection,u=(0,tE.P)(()=>t.listen("*[".concat(a,"]"),l,{events:["welcome","mutation","reconnect"],includeResult:!1,visibility:"query"})).pipe((0,tw.z)((e,t)=>0===t&&"welcome"!==e.type?(0,tI._)(()=>Error("reconnect"===e.type?"Could not establish EventSource connection":'Received unexpected type of first event "'.concat(e.type,'"'))):(0,tv.of)(e)),(0,tS.B)()),[h,p]=(0,tP.u)(u,e=>"welcome"===e.type);return(0,tC.T)(h.pipe((0,tT.q)(1)),p.pipe((0,tM.p)(1e3,tR.z,{leading:!0,trailing:!0}))).pipe((0,nq.q)(e=>(o?(0,tv.of)(o):t.observable.fetch("array::unique(*[".concat(a,"][]._type)"),l)).pipe((0,tw.z)(i=>{let o=i.flatMap(e=>n.get(e)||[]),{query:u,params:h}=(0,tu.kqP)({filter:a,query:s||"",types:o},{__unstable_extendedProjection:c,comments:["findability-source: ".concat(s?"list-query":"list")],limit:r,params:l,sort:d}),p=()=>t.observable.fetch(u,h);return"mutation"===e.type&&"query"!==e.visibility?(0,tx.H)(1200).pipe((0,tw.z)(p)):p()}))))})({client:a,filter:t,limit:b?2e3:100,params:n,schema:s,searchQuery:r||"",sort:i||m9,staticTypeNames:j?[j]:void 0}).pipe((0,tb.U)(e=>({result:{documents:e},error:null})),(0,tL.O)(fp),(0,tk.K)(e=>e instanceof ProgressEvent?(0,tI._)(()=>Error("Request error")):(0,tI._)(()=>e)),(0,tk.K)((t,n)=>(0,t_.z)((0,tv.of)({result:null,error:t}),(0,tC.T)((0,tf.R)(window,"online"),e).pipe((0,tT.q)(1),(0,tw.z)(()=>n)))),(0,tq.R)((e,t)=>({...e,...t,onRetry:l})))},[a,t,n,s,r,b,i,j]);(0,td.useEffect)(()=>{let e=z.subscribe(C);return()=>{e.unsubscribe()}},[C,z]);let E=(0,td.useCallback)(()=>{v(!1),x(!1),d(fh),y(!1)},[]);return(0,td.useEffect)(()=>{E()},[E,t,n,i,r]),{error:u,hasMaxItems:_,isLazyLoading:f,isLoading:w,isSearchReady:!u,items:m,onListChange:k,onRetry:c}}({apiVersion:x,filter:v,params:b,searchQuery:null==C?void 0:C.trim(),sortOrder:A}),V=(0,td.useMemo)(()=>fj({menuItems:p,sortOrderRaw:M,layout:_}),[_,p,M]),W=(0,tX.W2)(e=>e.pipe((0,tb.U)(e=>e.target.value),(0,tA.b)(I),(0,tD.D)(e=>""===e?(0,tv.of)(""):(0,tx.H)(300)),(0,tA.b)(z)),[]),K=(0,td.useCallback)(()=>{z(""),I("")},[]),$=(0,td.useCallback)(e=>{"Escape"===e.key&&K()},[K]);(0,td.useEffect)(()=>(!1!==T.current||U||(T.current=!0),()=>{T.current=!1}),[U]),(0,td.useEffect)(()=>{K(),T.current=!1},[a,K]);let Y=(0,td.useMemo)(()=>U&&0===F.length&&T.current?"spinner":"initial",[U,F.length]),X=(0,tc.jsx)(tp.xu,{paddingX:2,paddingBottom:2,children:(0,tc.jsx)(fy,{radius:4,tone:"transparent",children:(0,tc.jsx)(tp.oi,{"aria-label":"Search list",autoComplete:"off",border:!1,clearButton:!!C,disabled:!B,fontSize:[2,2,1],icon:"spinner"===Y?fb:to.W1M,onChange:W,onClear:K,onKeyDown:$,placeholder:"Search list",radius:2,ref:P,spellCheck:!1,value:E})})});return(0,tc.jsx)(tu.cWh,{name:y||o,children:(0,tc.jsxs)(iN,{currentMaxWidth:350,"data-ui":"DocumentListPane",id:a,maxWidth:640,minWidth:320,selected:r,children:[rR,(0,tc.jsx)(fc,{contentAfter:X,index:n,initialValueTemplates:u,menuItemGroups:h,menuItems:V,setLayout:k,setSortOrder:R,title:f}),(0,tc.jsx)(fd,{childItemId:t,error:L,filterIsSimpleTypeConstraint:D,hasMaxItems:N,hasSearchQuery:!!C,isActive:i,isLazyLoading:Z,isLoading:U,items:F,layout:_,loadingVariant:Y,onListChange:q,onRetry:H,paneTitle:f,searchInputElement:S,showIcons:w},a)]})})})}}]);